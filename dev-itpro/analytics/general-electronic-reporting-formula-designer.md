---
title: "Конструктор формул в электронной отчетности"
description: "В этом разделе описывается, как использовать конструктор формул в электронной отчетности (ER). При проектировании формата для определенного электронного документа в ER можно использовать формулы, сходные с Microsoft Excel, для преобразования данных, чтобы выполнить требования для выполнения и форматирования этого документа. Различные типы функций поддерживаются — текст, дата и время, математические логические, информация, преобразование типа данных, и другое (характерные для конкретных бизнес-доменов функции)."
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
audience: Application User, IT Pro
ms.search.scope: AX 7.0.0, Operations, Core
ms.custom: 58771
ms.assetid: 24223e13-727a-4be6-a22d-4d427f504ac9
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: Human Translation
ms.sourcegitcommit: 298ac47e2253f8add1aa3938dda15afe186afbeb
ms.openlocfilehash: 655a6fd99c0688b13c31c79f3322a287f902e7f1
ms.contentlocale: ru-ru
ms.lasthandoff: 06/20/2017


---

# <a name="formula-designer-in-electronic-reporting"></a>Конструктор формул в электронной отчетности

[!include[banner](../includes/banner.md)]


В этом разделе описывается, как использовать конструктор формул в электронной отчетности (ER). При проектировании формата для определенного электронного документа в ER можно использовать формулы, сходные с Microsoft Excel, для преобразования данных, чтобы выполнить требования для выполнения и форматирования этого документа. Различные типы функций поддерживаются — текст, дата и время, математические логические, информация, преобразование типа данных, и другое (характерные для конкретных бизнес-доменов функции).

<a name="formula-designer-overview"></a>Обзор конструктора формул
-------------------------

Электронная отчетность (ER) поддерживает конструктор формул. Поэтому во время разработки имеется возможность задать выражения, которые можно использовать для выполнения следующих задач во время выполнения:

-   преобразования данных, полученных из базы данных Microsoft Dynamics 365 Finance and Operations, которые будут заноситься в модель данных ER, играющую роль источника данных для форматов ER (фильтрация, группирование, преобразование типов данных и т. п.);
-   форматирования данных, которые должны выводиться в сформированный электронный документ в соответствии с макетом и условиями определенного формата ER (в соответствии с запрошенным языком или культурой, кодировкой и т. п.);
-   управления процессом формирования электронного документа (включение/выключение вывода определенных элементов формата в зависимости от обрабатываемых данных, прерывание создания документа, вывод сообщений для конечных пользователей и т. п.).

Страницу конструктора формул можно открыть при выполнении любого из следующих действий:

-   Связывание элементов источника данных с компонентами модели данных.
-   Связывание элементов источника данных с компонентами формата.
-   Завершение обслуживания вычисляемых полей как части источников данных.
-   Определение условий видимости для параметров пользовательского ввода.
-   Разработка преобразований формата.
-   Определение условий включения для компонентов формата.
-   Определение имен файлов для компонентов FILE формата.
-   Определение условий для проверок управления процессом.
-   Определение текста сообщения для проверок управления процессом.

## <a name="designing-er-formulas"></a>Конструирование формул ER
### <a name="data-binding"></a>Привязка данных

Конструктор формул ER можно использовать для определения выражения, которое конвертирует данные, полученные от источников данных, таким образом, чтобы эти данные можно было заполнить в потребителе данных во время выполнения:

-   Из источников данных Finance and Operations и параметров времени выполнения в модель данных ER.
-   из модели данных ER в формат ER;
-   Из источников данных Finance and Operations и параметров времени выполнения в формат ER.

На следующем рисунке показана разработка выражения этого типа. В этом примере выражение возвращает значение поля **Intrastat.AmountMST** таблицы **Интрастат** Finance and Operations, после того как значение округлено до двух десятичных знаков. [![рисунок-привязка-выражений](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg) На следующем рисунке показано, как выражение этого типа можно использовать. В этом примере результат сконструированного выражения заполняется в компоненте **Transaction.InvoicedAmount** модели данных **Модель налоговой отчетности**. [![рисунок-привязка-выражений2](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg) Во время выполнения сконструированная формула **ROUND (Intrastat.AmountMST, 2)** округлит значение поля **AmountMST** для каждой записи для таблицы **Интрастат** до двух десятичных знаков и заполнит округленное значение в компоненте **Transaction.InvoicedAmount** модели данных **Налоговая отчетность**.

### <a name="data-formatting"></a>Формат данных

Конструктор формул ER можно использовать для определения выражения, которое форматирует данные, полученные от источников данных, таким образом, чтобы эти данные можно было отправить как часть создания электронного документа. Если вы имеете форматирование, которое необходимо использовать как стандартное правило, которое должно быть повторно использовать для формата, можно ввести это форматирование один раз в конфигурации формата как именованное преобразование, которое имеет выражение форматирования. Позднее это именованное преобразование можно связывать с многими компонентами формата, выходные данные которых должны форматироваться в соответствии с созданным выражением. На следующем рисунке показана разработка преобразования этого типа. В этом примере преобразование **TrimmedString** принимает входящие данные типа данных **String** и усекает ведущий и конечный пробелы, когда оно возвращает значение строки. [![рисунок-разработка-преобразования](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg) На следующем рисунке показано, как может использоваться преобразование этого типа. В этом примере несколько компонентов формата, которые отправляют текст как вывод в создаваемый электронный документ во время выполнения, ссылается на преобразование **TrimmedString** по имени. [![рисунок-использование-преобразования](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg) Когда компоненты формата ссылаются на преобразование **TrimmedString** (например, компонент **partyName** на предыдущем рисунке), это отправляет текст как выходные данные в создающий документ. Текст не включает начальные и конечные пробелы. Если у вас есть форматирование, которое должно применяться индивидуально, его можно внедрить как отдельное выражение привязки определенного компонента "формат". На следующем рисунке показано выражение этого типа. В этом примере компонент формата **partyType** привязан к источнику данных через выражение, преобразующее входящие данные из поля **Model.Company.RegistrationType** в источнике данных в текст в верхнем регистре и отправляющее этот текст как вывод в электронный документ. [![рисунок-привязка-с-формулой](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)

### <a name="process-flow-control"></a>Управление процессом

Конструктор формул ER может использоваться для определения выражений для управления процессом формирования документов. Вы можете:

-   определения условий, определяющий, когда процесс создания документа должен быть остановлен.
-   задания выражений, которые либо будут создавать сообщения для конечного пользователя об остановленных процессах, либо записывать сообщения в журнал выполнения о продолжении процесса формирования отчетности;
-   Определение имен файлов генерируемых документов и управление условиями их создания.

Каждое из правил управления процессом конструируется в виде отдельной валидации. На следующем рисунке показана проверка этого типа. Здесь объяснение конфигурации в этом примере:

-   Проверка производится, когда узел **INSTAT** создан в создаваемом xml-файле.
-   Если список транзакций пуст, проверка останавливает процесс выполнения и возвращает значение **FALSE**.
-   Проверка возвращает сообщение об ошибке, которое включает текст метки SYS70894 на языке, предпочитаемом пользователем.

[![рисунок-проверка](./media/picture-validation.jpg)](./media/picture-validation.jpg) Конструктор формул GER используется также для указания имени файла для формируемого электронного документа и управления процессом создания файла. На следующем рисунке показана разработка управления процессом этого типа. Здесь объяснение конфигурации в этом примере:

-   список записей из источника данных **model.Intrastat** делится на пакеты, содержащие не более 1000 записей;
-   Выпуск создает ZIP-файл, который содержит один файл в формате XML для каждой партии, который была создана.
-   Выражение возвращает имя файла для генерации электронных документов путем объединения имени файла и расширения файла. Для второй партии и всех последующих партий имя файла содержит код партии в качестве суффикса.
-   выражение включает (возвратом значения **TRUE**) процесс создания файла для тех пакетов, которые содержат хотя бы одну запись.

[![рисунок-управление-файлами](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)

### <a name="basic-syntax"></a>Базовый синтаксис

Выражения ER могут содержать любые или все из следующих элементов:

-   Константы
-   Операторы
-   Ссылки
-   Пути
-   Функции

#### <a name="constants"></a>Константы

При конструировании выражений можно использовать текстовые и числовые константы (значения, которые не вычисляются). Например, выражение **VALUE ("100") + 20** использует числовую константу 20 и строковую константу "100" и возвращает числовое значение **120**. В конструкторе формул GER поддерживаются escape-последовательности, то есть можно задавать части строки выражения, которую следует обрабатывать иным образом: Например, выражение **"Лев Толстой ""Война и мир"" Том 1"** возвращает следующую текстовую строку: **Лев Толстой "Война и мир" Том 1**.

#### <a name="operators"></a>Операторы

В следующей таблице показаны арифметические операторы, которые можно использовать для выполнения основных математические операции, например сложение, вычитания, деление и умножение.

| Оператор | Значение              | Пример |
|----------|----------------------|---------|
| +        | Сложение             | 1+2     |
| -        | Вычитание Отрицание | 5-2 -1  |
| \*       | Умножение       | 7\*8    |
| /        | Подразделение             | 9/3     |

В следующей таблице показаны операторы сравнения, которые поддерживаются и которые можно использовать для сравнения двух значений.

| Оператор | Значение                  | Пример    |
|----------|--------------------------|------------|
| =        | Одинаковые                    | X=Y        |
| &gt;     | Больше             | X&gt;Y     |
| &lt;     | Меньше                | X&lt;Y     |
| &gt;=    | Больше или равен | X&gt;=Y    |
| &lt;=    | Меньше или равен    | X&lt;=Y    |
| &lt;&gt; | Не равно             | X&lt;&gt;Y |

Кроме того, можно использовать амперсанд (&) в качестве оператора объединения текста для присоединения или сцепить один или несколько текстовых строк в одну единицу текста.

| Оператор | Значение     | Пример                                        |
|----------|-------------|------------------------------------------------|
| &        | Объединить | "Нет данных для печати" & ": " & "записи не найдены" |

#### <a name="operator-precedence"></a>Приоритет операторов

Порядок, в котором оценены части составного выражения, важен. Например, результат выражения **1 + 4 / 2** различается в зависимости от того, выполняться ли первой операция сложения или операция деления. Можно использовать скобки для точного определения, как выражение рассчитывается. Например, чтобы указать, что операция сложения должна быть выполнена первой, вы можете изменить предшествующее выражение на **(1 + 4) / 2**. Если порядок операций, которые необходимо выполнить в выражении, явно не указан, порядок основан на приоритете по умолчанию, назначенный поддерживаемым операторам. В следующих таблицах показаны операторы и приоритет, который назначен каждому. Операторы, которые имеют более высокий приоритет (например, 7) вычисляются перед операторами с более низким приоритетом (например, 1).

| Приоритет | Операторы      | Синтаксис                                                   |
|------------|----------------|----------------------------------------------------------|
| 7          | Группировка       | ( … )                                                    |
| 6          | Доступ к членам  | … . …                                                    |
| 5          | Вызов функции  | … ( … )                                                  |
| 4          | Умножение | … \* … … / …                                             |
| 3          | Аддитивный       | … + … … - …                                              |
| 2          | Сравнение     | … &lt; … … &lt;= … … =&gt; … … &gt; … … = … … &lt;&gt; … |
| 1          | Разделение     | … , …                                                    |

Операторы в одной строке имеют равный приоритет. Если выражение включает несколько из этих операторов, выражение оценивается слева направо. Например, выражение **1 + 6 / 2 \* 3 &gt; 5** возвращает **true**. Рекомендуется использовать скобки для явного указания необходимого порядка оценки выражений, чтобы выражения было проще читать и обслуживать.

#### <a name="references"></a>Ссылки

Все источники данных текущего компонента ER (модель или формат), доступные в ходе разработки выражения, можно использовать как именованные ссылки. Например, текущая модель данных ER содержит источник данных **ReportingDate**, который возвращает значение типа данных **DATETIME**. Для правильного форматирования этого значения в создаваемом документе можно указать источник данных в выражении следующим образом: **DATETIMEFORMAT (ReportingDate, "dd-MM-yyyy")** Перед всеми знаками в имени источника данных, на который ссылка, которые не представляют собой букву алфавита, должна стоять одинарная кавычка ('). Если имя ссылающегося источника данных содержит хотя бы один символ, который не является буквой алфавита (например, знаки препинания или любые другие записанные символы), имя необходимо заключить в одинарные кавычки. Далее приводятся некоторые примеры.

-   На источник данных **Today’s date & time** в выражении ER необходимо ссылаться следующим образом: **'Today''s date & time’**
-   на метод **name()** источника данных **Customers** в выражении ER необходимо ссылаться следующим образом: **Customers.'name()'**

Обратите внимание, что следующий синтаксис используется для вызова методов Dynamics 365 for Finance and Operations источников данных с параметрами:

- Метод isLanguageRTL источника данных System с параметром EN-US строкового типа данных следует указывать в выражении ER следующим образом: System.'isLanguageRTL'("EN-US").
- Кавычки не являются обязательными, если имя метода содержит только буквенно-цифровые символы. Они являются обязательными для метода таблицы, если имя содержит скобки.

При добавлении источника данных System в сопоставление ER, которое относится к классу Global приложения Dynamics 365 for Operation, выражение возвращает логическое значение FALSE. Изменено выражение, System.' isLanguageRTL'("AR") возвращает логическое значение, TRUE.

Обратите внимание, что передача таких параметров методов может быть определена со следующими ограничениями:

- Только константы могут быть переданы в такие методы, значение которых определяется в запланированное время.
- Только примитивные (основные) типы данных поддерживаются для таких параметров (целое, действительное, логическое, строковое и т. п.).

#### <a name="path"></a>Путь

Когда выражение ссылается на структурированный источник данных, можно использовать определение пути для выбора конкретного примитивного элемента этого источника данных. Символ точки (.) используется для разделения отдельных элементов структурированного источника данных. Например, текущая модель данных ER содержит источник данных **InvoiceTransactions**, который возвращает список записей. Структура записи **InvoiceTransactions** содержит поля **AmountDebit** и **AmountCredit**, которые возвращают числовые значения. Поэтому Выражение для вычисления суммы по накладной может быть построено следующим образом: **InvoiceTransactions.AmountDebit - InvoiceTransactions.AmountCredit**

#### <a name="functions"></a>Функции

В следующих разделах описаны функции, которые можно использовать в выражениях ER. Все источники данных контекста выражения (текущие модель данных ER или формат ER), а также константы могут использоваться в качестве параметров вызывающих функций в соответствии со списком аргументов вызывающей функции. Например, текущая модель данных ER содержит источник данных **InvoiceTransactions**, который возвращает список записей. Структура записи **InvoiceTransactions** содержит поля **AmountDebit** и **AmountCredit**, которые возвращают числовые значения. Поэтому Выражение для вычисления суммы по накладной может быть построено с использованием встроенной функции округления ER: **ROUND (InvoiceTransactions.AmountDebit - InvoiceTransactions.AmountCredit, 2)**

## <a name="supported-functions"></a>Поддерживаемые функции
В следующей таблице описаны функции обработки данных, которые можно использовать для создания моделей данных ER и отчетов о ER. Этот перечень функций не является фиксированным, и разработчики могут его расширять. Для просмотра списка функций, которые вы используете, откройте область функций в конструкторе формул ER.

### <a name="date-and-time-functions"></a>Функции даты и времени

| Функция                                   | Описание                                                                                                                                                                                                                                                                                                                                                      | Пример                                                                                                                                                                                                                                                                                               |
|--------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ADDDAYS (дата и время, дни)                   | Добавление определенного количества дней к указанному значению даты и времени.                                                                                                                                                                                                                                                                                                | **ADDDAYS (NOW(), 7)** возвращает дату и время на 7 дней в будущем.                                                                                                                                                                                                                            |
| DATETODATETIME (дата)                      | Преобразование указанного значения даты в значение даты и времени.                                                                                                                                                                                                                                                                                                            | **DATETODATETIME (CompInfo. 'getCurrentDate()')** возвращает текущую дату сессии Finance and Operations 12.24.2015 как **12.24.2015 12:00:00 AM**. В этом примере **CompInfo** — источник данных ER типа **Finance and Operations/Table**, который ссылается на таблицу CompanyInfo. |
| NOW ()                                     | Возврат текущих даты и времени сервера приложений Finance and Operations в качестве значения даты и времени.                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                       |
| TODAY ()                                   | Возврат текущей даты сервера приложений Finance and Operations в качестве значения даты.                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                       |
| NULLDATE ()                                | Возврат значения даты **null**.                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                       |
| NULLDATETIME ()                            | Возврат значение даты и времени **null**.                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                       |
| DATETIMEFORMAT (дата и время, формат)          | Преобразование указанного значения даты и времени в строку в указанном формате. (Сведения о поддерживаемых форматах см. разделы [стандартный](https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx) и [настраиваемый](https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx).)                                                                        | **DATETIMEFORMAT (NOW(), "дд-ММ-гггг")** возвращает текущую дату сервера приложений Finance and Operations, 12.24.2015 как **"24-12-2015"**, в соответствии с указанным настраиваемым форматом.                                                                                                          |
| DATETIMEFORMAT (дата и время, формат, культура) | Преобразование указанного значения даты и времени в строку в указанном формате и [культуре](https://msdn.microsoft.com/en-us/goglobal/bb896001.aspx). (Сведения о поддерживаемых форматах см. в разделах [стандартный](https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx) и [настраиваемый](https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx).) | **DATETIMEFORMAT (NOW(), "d", "de")** возвращает текущую дату сервера приложений Finance and Operations 12.24.2015 как **"24.12.2015"**, в соответствии с выбранным немецким языковым стандартом.                                                                                                             |
| SESSIONTODAY ()                            | Возвращает текущую дату сессии Dynamics 365 for Finance and Operations в качестве значения даты.                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                       |
| SESSIONNOW ()                              | Возвращает текущие дату и время сеанса Dynamics 365 for Finance and Operations в качестве значения даты и времени.                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                       |
| DATEFORMAT (дата, формат)                  | Возвращает строковое представление даты с использованием указанного формата.                                                                                                                                                                                                                                                                                                    | **DATEFORMAT (SESSIONTODAY (), "dd-MM-yyyy")** возвращает текущую дату сеанса Dynamics 365 for Finance and Operations (12.24.2015) как "**24-12-2015**" в соответствии с указанным настраиваемым форматом.                                                                                                                      |
| DATEFORMAT (дата, формат, культура)         | Преобразование указанного значения даты в строку в указанном формате и [культуре](https://msdn.microsoft.com/en-us/goglobal/bb896001.aspx). (Сведения о поддерживаемых форматах см. в разделах [стандартный](https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx) и [настраиваемый](https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx).)     | **DATETIMEFORMAT (SESSIONNOW (), "d", "de")** возвращает текущую дату сессии Finance and Operations 12.24.2015 как **"24.12.2015"**, в соответствии с выбранным немецким языковым стандартом.                                                                                                                       |
| DAYOFYEAR (дата)              | Возвращает целочисленное представление числа дней между 1 января и указанной датой.       | **DAYOFYEAR (DATEVALUE ("01-03-2016", "dd-MM-yyyy"))** возвращает **61**.
**DAYOFYEAR (DATEVALUE ("01-01-2016", "dd-MM-yyyy"))** возвращает **1**.                                                                                                                       |

**Функции преобразования данных**

| Функция                                   | описание                                                                                                                                                                                                                                                                                                                                                      | Пример                                                                                                                                                                                                                                                                                               |
|--------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DATETODATETIME (дата)                 | Преобразование указанного значения даты в значение даты и времени.           | **DATETODATETIME (CompInfo. 'getCurrentDate()')** возвращает текущую дату сессии Finance and Operations 12.24.2015 как **12.24.2015 12:00:00 AM**. В этом примере **CompInfo** — источник данных ER типа **Finance and Operations/Table**, который ссылается на таблицу **CompanyInfo**.                                                                                                                       |
| DATEVALUE (строка, формат)              | Возвращает представление строки с использованием указанного формата.       | **DATEVALUE ("21-декабря-2016", "дд-МММ-гггг")** возвращает дату 12.21.2016 в соответствии с указанным настраиваемым форматом и приложение по умолчанию имеет стандарты **EN-US**.                                                                                                                       |
| DATEVALUE (строка, формат, культура)              | Возвращает представление даты строки с использованием указанных формата и региональных параметров.       | **DATEVALUE ("21-Gen-2016", "dd-MMM-yyyy", “IT”)** возвращает дату 01/21/2016 в соответствии с указанным настраиваемым форматом и региональными параметрами. При вызове этой функции будет создано исключение **DATEVALUE ("21-Gen-2016", "dd-MMM-yyyy", “EN-US”)** с информацией о том, что данная строка не является допустимой датой.                                                                                                                       |
| DATETIMEVALUE (строка, формат)              | Возвращает представление даты и времени строки с использованием указанного формата.       | **DATETIMEVALUE ("21-Dec-2016 02:55:00", "dd-MMM-yyyy hh:mm:ss")** возвращает 2:55:00 AM Дек 21, 2016 в соответствии с указанным настраиваемым форматом и приложение по умолчанию имеет стандарт **EN-US**.                                                                                                                       |
| DATETIMEVALUE (строка, формат, культура)              | Возвращает представление даты и времени строки с использованием указанных формата, языка и региональных параметров.       | **DATETIMEVALUE ("21-Gen-2016 02:55:00", "dd-MMM-yyyy hh:mm:ss", “IT”)** возвращает 2:55:00 AM Дек 21, 2016 в соответствии с указанным настраиваемым форматом и региональными параметрами. При вызове этой функции будет создано исключение **DATETIMEVALUE ("21-Gen-2016 02:55:00", "dd-MMM-yyyy hh:mm:ss", “EN-US”)** с информацией о том, что данная строка не является допустимой датой и временем.                                                                                                                       |
### <a name="list-functions"></a>Функции для работы со списками

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Функция</th>
<th>описание</th>
<th>Пример</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SPLIT (ввод, длина)</td>
<td>Разделение указанной строки ввода на подстроки, каждая из которых имеет заданную длину. Возврат результата как новый список.</td>
<td><strong>SPLIT (&quot;abcd&quot;, 3)</strong> возвращает новый список, который состоит из 2 записей, которые имеют поле <strong>STRING</strong>. Поле в первой записи содержит текст <strong>&quot;abc&quot;</strong>, и поле во второй записи содержит текст <strong>&quot;d&quot;</strong>.</td>
</tr>
<tr class="even">
<td>SPLITLIST (список, номер)</td>
<td>Разделение указанного списка на партии, каждый из содержит заданный количество записей. Возврат результата как новый список партий, который содержит следующие элементы:
<ul>
<li>Партии как регулярные списки (компонент <strong>Значение</strong>)</li>
<li>Номер текущего пакета (компонент <strong>BatchNumber</strong>)</li>
</ul></td>
<td>В следующем примере источник данных <strong>Строки</strong> создан как список записей из 3 записей, который делится на партии, каждая из которых содержит до 2 записей. <a href="./media/picture-splitlist-datasource.jpg"><img src="./media/picture-splitlist-datasource.jpg" alt="Data source that is divided into batches" class="alignnone wp-image-290681 size-full" width="397" height="136" /></a> Это показывает сконструированный макет формата, где привязки к источнику данных <strong>Строки</strong> созданы для генерации вывода в формате XML, который представляет отдельные узлы для каждой партии и записи в ней. <a href="./media/picture-splitlist-format.jpg"><img src="./media/picture-splitlist-format.jpg" alt="Format layout that has bindings to a data source" class="alignnone wp-image-290691 size-full" width="374" height="161" /></a> Ниже приведен результат выполнения сконструированного формата. <a href="./media/picture-splitlist-result.jpg"><img src="./media/picture-splitlist-result.jpg" alt="Result of running the format" class="alignnone wp-image-290701 size-full" width="358" height="191" /></a></td>
</tr>
<tr class="odd">
<td>LIST (запись 1 [, запись 2, ...])</td>
<td>Возвращает новый список, который создан из определенных аргументов.</td>
<td><strong>LIST (model.MainData, model.OtherData)</strong> возвращает пустую запись, где список полей содержит все поля списков записей <strong>MainData</strong> и <strong>OtherData</strong>.</td>
</tr>
<tr class="even">
<td>LISTJOIN (список 1, список 2,…)</td>
<td>Возвращает соединенный список, который создан из списков определенных аргументов.</td>
<td><strong>LISTJOIN (SPLIT (&quot;abc&quot;, 1), SPLIT (&quot;def&quot;, 1))</strong> возвращает список из шести записей, где одно поле типа данных <strong>STRING</strong> содержит по одной букве.</td>
</tr>
<tr class="odd">
<td>ISEMPTY (список)</td>
<td>Возврат <strong>TRUE</strong>, если указанный список не содержит элементы. В противном случае возврат <strong>FALSE</strong>.</td>
<td></td>
</tr>
<tr class="even">
<td>EMPTYLIST (список)</td>
<td>Возврат пустого списка с использованием указанного списка в качестве источника для структуры списка.</td>
<td><strong>EMPTYLIST (SPLIT (&quot;abc&quot;, 1))</strong> возвращает новый пустой список, который имеет такую же структуру, как список, который возвращен функцией <strong>SPLIT</strong>.</td>
</tr>
<tr class="odd">
<td>FIRST (список)</td>
<td>Возврат первой записи определенного списка, если эта запись не пуста. В противном случае создается исключение.</td>
<td></td>
</tr>
<tr class="even">
<td>FIRSTORNULL (список)</td>
<td>Возврат первой записи определенного списка, если эта запись не пуста. В противном случае возврат записи <strong>NULL</strong>.</td>
<td></td>
</tr>
<tr class="odd">
<td>LISTOFFIRSTITEM (список)</td>
<td>Возврат списка, содержащий только первый элемент указанного списка.</td>
<td></td>
</tr>
<tr class="even">
<td>ALLITEMS (путь)</td>
<td>Возврат нового плоского список, представляющий все элементы, соответствующие указанному пути. Путь должен быть определен как действительный путь источника данных к элементу источника данных с типом данных списка записей. Путь к строке, дате и т. д. элементов данных должен вызывать ошибку во время разработки в конфигураторе выражения ER.</td>
<td>Если ввести <strong>SPLIT(&quot;abcdef&quot; , 2)</strong> в качестве источника данных (DS), <strong>COUNT( ALLITEMS (DS.Value))</strong> возвращает <strong>3</strong>.</td>
</tr>
<tr class="odd">
<td>ORDERBY (список [,выражение 1, выражение 2, …])</td>
<td>Возврат указанного списка, который отсортирован по определенным аргументам, которые можно определить как выражения.</td>
<td>Когда <strong>Поставщик</strong> настраивается в качестве источника данных ER, который ссылается на таблицу VendTable, <strong>ORDERBY (Vendors, Vendors.'name()')</strong> возвращает список поставщиков, который отсортирован по имени в восходящем порядке.</td>
</tr>
<tr class="even">
<td>REVERSE (список)</td>
<td>Возврат указанного списка в обращенном порядке сортировки.</td>
<td>Когда <strong>Поставщик</strong> настраивается в качестве источника данных ER, который ссылается на таблицу VendTable, <strong>REVERSE (ORDERBY (Vendors, Vendors.'name()')) )</strong> возвращает список поставщиков, который отсортирован по имени в нисходящем порядке.</td>
</tr>
<tr class="odd">
<td>WHERE (список, условие)</td>
<td>Возвращает указанный список, который отфильтрован в соответствии с указанным состоянием. В отличие от функции <strong>FILTER</strong>, указанное условие применяется к списку в памяти.</td>
<td>Когда <strong>Поставщик</strong> настраивается в качестве источника данных ER, который ссылается на таблицу VendTable, <strong>WHERE(Vendors, Vendors.VendGroup = &quot;40&quot;)</strong> возвращает список поставщиков, который относится к группе поставщиков 40.</td>
</tr>
<tr class="even">
<td>ENUMERATE (список)</td>
<td>Возврат нового списка, состоящей из перечисленных записей определенного списка, и с использованием следующие элементов:
<ul>
<li>Определенные записи списка как регулярные списки (компонент <strong>Значение</strong>)</li>
<li>Индекс текущей записи (<strong>Номер</strong> компонента)</li>
</ul></td>
<td>В следующем примере источник данных <strong>Enumerated</strong> создается как нумерованный список записей поставщика из источника данных <strong>Vendors</strong>, который ссылается на таблицу <strong>VendTable</strong>. <a href="./media/picture-enumerate-datasource.jpg"><img src="./media/picture-enumerate-datasource.jpg" alt="Enumerated data source" class="alignnone wp-image-290711 size-full" width="387" height="136" /></a> Вот формат, где привязки данных создаются для генерации вывода в формате XML, который представляет отдельных поставщиков как нумерованные узлы. <a href="./media/picture-enumerate-format.jpg"><img src="./media/picture-enumerate-format.jpg" alt="Format that has data bindings" class="alignnone wp-image-290721 size-full" width="414" height="138" /></a> Это результат выполнения сконструированного формата. <a href="./media/picture-enumerate-result.jpg"><img src="./media/picture-enumerate-result.jpg" alt="Result of running the format" class="alignnone wp-image-290731 size-full" width="567" height="176" /></a></td>
</tr>
<tr class="odd">
<td>COUNT (список)</td>
<td>Возврат количества записей определенного списка, если список не пуст. В противном случае возврат <strong>0</strong> (ноль).</td>
<td><strong>COUNT (SPLIT(&quot;abcd&quot; , 3))</strong> возвращает <strong>2</strong>, поскольку функция <strong>SPLIT</strong> создает список, который состоит из двух записей.</td>
</tr>
<tr class="even">
<td>LISTOFFIELDS (путь)</td>
<td>Возвращает список записей, созданный из аргумента одного из следующих типов:
<ul>
<li>Перечисление модели</li>
<li>Перечисление форматов</li>
<li>Контейнер</li>
</ul>
Созданный список будет состоять из записей со следующими полями:
<ul>
<li>Наименование</li>
<li>Этикетка</li>
<li>описание</li>
</ul>
Поля "Этикетка" и "Описание" будут возвращаться значения времени выполнения на основе настроек языка в формате.</td>
<td>Следующий пример показывает перечисление, введенное в модели данных. <a href="./media/ger-listoffields-function-model-enumeration.png"><img src="./media/ger-listoffields-function-model-enumeration-e1474545790761.png" alt="GER LISTOFFIELDS function - model enumeration" class="alignnone wp-image-1203943 size-full" width="514" height="155" /></a>В следующим пример показаны:
<ul>
<li>Перечисление модели, вставленное в отчет в качестве источника данных.</li>
<li>Выражение ER, разработанное для использования перечисления модели в качестве параметра этой функции.</li>
<li>Источник данных типа списка записей, вставленный в отчет с помощью созданного выражения ER.</li>
</ul>
<a href="./media/ger-listoffields-function-in-format-expression.png"><img src="./media/ger-listoffields-function-in-format-expression-e1474546110395.png" alt="GER LISTOFFIELDS function - in format expression" class="alignnone wp-image-1204033 size-full" width="549" height="318" /></a> В следующем примере показаны элементы формата ER, привязанные к источнику данных типа списка записей, который был создан с помощью функции LISTOFFIELDS.<a href="./media/ger-listoffields-function-format-design.png"><img src="./media/ger-listoffields-function-format-design.png" alt="GER LISTOFFIELDS function - format design" class="alignnone size-full wp-image-1204043" width="466" height="221" /></a>Это результат выполнения разработанного формата.<a href="./media/ger-listoffields-function-format-output.png"><img src="./media/ger-listoffields-function-format-output.png" alt="GER LISTOFFIELDS function - format output" class="alignnone size-full wp-image-1204053" width="585" height="158" /></a><strong>Примечание.</strong> Переведенный текст для этикеток и описаний заполняется в выходных данных формата ER в соответствии с настройками языка, заданными для родительских элементов формата FILE и FOLDER.</td>
</tr>
<tr class="odd">
<td>STRINGJOIN (список, имя поля, разделитель)</td>
<td>Возвращает строку сцепленных значений поля из списка, разделенного выбранным разделителем.</td>
<td>Если ввести SPLIT(“abc” , 1) в качестве источника данных DS, выражение STRINGJOIN (DS, DS.Value, “:”) возвращает “a:b:c”</td>
</tr>
<tr class="even">
<td>SPLITLISTBYLIMIT (список, значение предела, источник предела)</td>
<td>Разделяет указанный список на новый список подсписков и возвращает результаты в содержимом списка записей. Параметр предельного значения определяет значение предела для разделения исходного списка. Параметр предела источника указывает шаг, на котором увеличивается общая сумма. Предел не применяется к одному элементу заданного списка, когда источник предела превышает заданный предел.</td>
<td>Следующий пример показывает образец формата с использованием источников данных. <a href="./media/ger-splitlistbylimit-format.png"><img src="./media/ger-splitlistbylimit-format.png" alt="GER SPLITLISTBYLIMIT - format" class="alignnone size-full wp-image-1204063" width="396" height="195" /></a><a href="./media/ger-splitlistbylimit-datasources.png"><img src="./media/ger-splitlistbylimit-datasources.png" alt="GER SPLITLISTBYLIMIT - datasources" class="alignnone size-full wp-image-1204073" width="320" height="208" /></a>Это результат выполнения формата, который представляет собой плоский список товарных позиций.<a href="./media/ger-splitlistbylimit-output.png"><img src="./media/ger-splitlistbylimit-output.png" alt="GER SPLITLISTBYLIMIT - output" class="alignnone size-full wp-image-1204083" width="462" height="204" /></a>Следующий пример показывает тот же формат, который скорректирован для представления списка товарных позиций в партиях, когда одна партия может содержать товары с общим весом, который не должен превышать 9.<a href="./media/ger-splitlistbylimit-format-1.png"><img src="./media/ger-splitlistbylimit-format-1.png" alt="GER SPLITLISTBYLIMIT - format 1" class="alignnone size-full wp-image-1204103" width="466" height="438" /></a><a href="./media/ger-splitlistbylimit-datasources-1.png"><img src="./media/ger-splitlistbylimit-datasources-1.png" alt="GER SPLITLISTBYLIMIT - datasources 1" class="alignnone size-full wp-image-1204093" width="645" height="507" /></a>Это результат выполнения скорректированного формата. <a href="./media/ger-splitlistbylimit-output-1.png"><img src="./media/ger-splitlistbylimit-output-1.png" alt="GER SPLITLISTBYLIMIT - output 1" class="alignnone size-full wp-image-1204113" width="676" height="611" /></a><strong>Примечание.</strong> Предел не применяется к последнему элементу исходного списка, так как значение (11) его источника предела (вес) превышает заданный предел (9). Используйте функцию <strong>WHERE</strong> или выражение <strong>Включено</strong> соответствующего элемента формата, чтобы игнорировать (пропустить) подсписки во время создания отчета (при необходимости).</td>
</tr>
<tr class="odd">
<td>FILTER (список, условие)</td>
<td>Возвращает заданный список, отфильтрованный по указанному условию путем изменения запроса. В отличие от функции <strong>WHERE</strong>, указанное условие применяется на уровне базы данных к любому источнику данных ER с типом записи "Таблица".</td>
<td>FILTER (Vendors, Vendors.VendGroup = &quot;40&quot;) возвращает список только поставщиков, входящих в группу поставщиков “40”, когда <strong>Поставщик</strong> настроен как источник данных ER, ссылающийся на таблицу <strong>VendTable</strong></td>
</tr>
</tbody>
</table>

### <a name="logical-functions"></a>Логические функции

| Функция                                                                                | описание                                                                                                                                                                                                                                                                     | Пример                                                                                                                                                                                                                                                      |
|-----------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CASE (выражение, параметр 1, результат 1 \[, вариант 2, результат 2\] ... \[, результат по умолчанию\]) | Оценка указанного значения выражения относительно указанных альтернативных вариантов. Возврат результата параметра, который равен значению выражения. В противном случае возврат необязательно введенного результата по умолчанию (последний параметр, который не предваряется параметром). | **CASE( DATETIMEFORMAT( NOW(), "MM"), "10", "WINTER", "11", "WINTER", "12", "WINTER", "")** возвращает строку **"WINTER"**, когда текущая дата сеанса Finance and Operations — между октябрем и декабрем. В противном случае она возвращает пустую строку. |
| ЕСЛИ (условие, значение 1, значение 2)                                                        | Возврат указанного значения 1, когда выполняется данное состояние. В противном случае возвращается значение 2. Если значение 1 и значение 2 — записи или списки записей, результат будет иметь только поля, существующие в обоих списках.                                                                     | **IF (1=2, "condition is met", "condition is not met")** возвращает строку **"condition is not met"**.                                                                                                                                                      |
| NOT (условие)                                                                         | Возврат обратного логического значения указанного состояния.                                                                                                                                                                                                                   | **NOT (TRUE)** возвращает **FALSE**.                                                                                                                                                                                                                            |
| И (условие 1\[, условие 2, ...\])                                                 | Возврат **TRUE**, если *все* определенные условия верны. В противном случае возврат **FALSE**.                                                                                                                                                                                            | **AND (1=1, "a"="a")** возвращает **TRUE**. **AND (1=2, "a"="a")** возвращает **FALSE**.                                                                                                                                                                           |
| OR (условие 1\[, условие 2, ...\])                                                  | Возврат **FALSE**, если *все* определенные условия неверны. Возврат **TRUE**, если *какое-либо* из определенных условий верно.                                                                                                                                                                 | **OR (1=2, "a"="a")** возвращает **TRUE**.                                                                                                                                                                                                                      |

### <a name="mathematical-functions"></a>Математические функции

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Функция</th>
<th>Описание</th>
<th>Пример</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABS (число)</td>
<td>Возврат абсолютное значение указанного числа (число без знака).</td>
<td><strong>ABS (-1)</strong> возвращает <strong>1</strong>.</td>
</tr>
<tr class="even">
<td>POWER (число, степень)</td>
<td>Возврат результата возведения указанного положительного значения в определенную степень.</td>
<td><strong>POWER (10, 2)</strong> возвращает <strong>100</strong>.</td>
</tr>
<tr class="odd">
<td>NUMBERVALUE (строка, десятичный разделитель, разделитель групп цифр)</td>
<td>Преобразование указанной строки в число. Указанный символ используется для разделения целой и нецелой частей десятичного числа, и определенный разделитель тысяч также используется.</td>
<td><strong>NUMBERVALUE(&quot;1 234,56&quot;, &quot;,&quot;, &quot; &quot;)</strong> возвращает значение <strong>1234.56</strong>.</td>
</tr>
<tr class="even">
<td>VALUE (строка)</td>
<td>Преобразование указанной строки в число. Символы запятой и точки (.) считаются десятичными разделителями, и ведущий дефис (-) используются в качестве отрицательного знака. Создается исключение, если другие не числовые символы возникают в определенной строке.</td>
<td><strong>VALUE (&quot;1 234,56&quot;)</strong> создает исключение.</td>
</tr>
<tr class="odd">
<td>ROUND (число, десятичных знаков)</td>
<td>Возвращает указанное число, которое округляется до указанного числа десятичных знаков:
<ul>
<li>Если указанное значение десятичных знаков больше 0 (нуля), указанное число округляется до указанного числа десятичных знаков.</li>
<li>Если указанное значение десятичных знаков 0 (ноль), указанное число округляется до ближайшего целого.</li>
<li>Если указанное значение десятичных знаков меньше 0 (нуля), указанное число округляется слева от десятичного разделителя.</li>
</ul></td>
<td><strong>ROUND (1200.767, 2)</strong> округляет до двух десятичных знаков и возвращает <strong>1200.77</strong>. <strong>ROUND (1200.767, -3)</strong> округляет до ближайшего числа, кратного тысяче, и возвращает <strong>1000</strong>.</td>
</tr>
<tr class="even">
<td>ROUNDDOWN (число, десятичных знаков)</td>
<td>Возвращает указанное число, которое округляется вниз (к нулю) до указанного числа десятичных знаков. <strong>Примечание:</strong> Эта функция поступает как <strong>ROUND</strong>, но она всегда округляет указанное число вниз.</td>
<td><strong>ROUNDDOWN (1200.767, 2)</strong> округляет вниз до двух десятичных знаков и возвращает <strong>1200.76</strong>. <strong>ROUNDDOWN (1700.767, -3)</strong> округляет вниз до ближайшего числа, кратного тысяче, и возвращает <strong>1000</strong>.</td>
</tr>
<tr class="odd">
<td>ROUNDUP (число, десятичных знаков)</td>
<td>Возвращает указанное число, которое округляется вверх (от нуля) до указанного числа десятичных знаков. <strong>Примечание:</strong> Эта функция поступает как <strong>ROUND</strong>, но она всегда округляет указанное число вверх.</td>
<td><strong>ROUNDUP (1200.763, 2)</strong> округляет вверх до двух десятичных знаков и возвращает <strong>1200.77</strong>. <strong>ROUNDUP (1200.767, -3)</strong> округляет вверх до ближайшего числа, кратного тысяче, и возвращает <strong>1,000</strong>.</td>
</tr>
</tbody>
</table>

**Функции преобразования данных**

| Функция             | описание                                                                                                                                                                                                                                     | Пример                                                                                                                                             |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| VALUE (строка) | Преобразование указанной строки в число. Символы запятой и точки (.) считаются десятичными разделителями, и ведущий дефис (-) используются в качестве отрицательного знака. Если другие не числовые символы возникают в определенной строке, возникает ошибка.                                                                                  | **VALUE ("1 234,56")** создает исключение.   |
| NUMBERVALUE (строка, десятичный разделитель, разделитель групп цифр) | Преобразование указанной строки в число. Указанный символ используется для разделения целой и нецелой частей десятичного числа, и определенный разделитель тысяч также используется.                                                                                  | **NUMBERVALUE("1 234,56", ",", " ")** возвращает значение **1234.56**.    |
| INTVALUE (строка) | Возвращает целочисленное представление строки. Все доступные десятичные части усекаются.                                                                                  | **INTVALUE (“100.77”)** возвращает **100**. |
| INTVALUE (номер) | Возвращает целочисленное представление номера. Все доступные десятичные части усекаются.                                                                                  | **INTVALUE (-100.77)** возвращает **-100**. |
| INT64VALUE (строка) | Возвращает представление int64 строки. Все доступные десятичные части усекаются.                                                                                  | **INT64VALUE (“22565422744”)** возвращает **22565422744**. |
| INT64VALUE (число) | Возвращает представление int64 номера. Все доступные десятичные части усекаются.                                                                                  | **INT64VALUE (22565422744.00)** возвращает **22565422744**. |



### <a name="record-functions"></a>Функции для работы с записями

| Функция             | описание                                                                                                                                                                                                                                     | Пример                                                                                                                                             |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| NULLCONTAINER (список) | Возвращает запись **NULL** с той же структурой, как указанный список записей или запись. **Примечание.** Эта функция является устаревшей. Используйте вместо **EMPTYRECORD**.                                                                                  | **NULLCONTAINER (SPLIT ("abc", 1))** возвращает новый пустой запись, который имеет такую же структуру, как список, который возвращен функцией **SPLIT**. |
| EMPTYRECORD (запись) | Возвращает запись **NULL** с той же структурой, как указанный список записей или запись. **Примечание.** Запись **null** — это запись, в которой все поля имеют пустое значение (**0** \[ноль\] для чисел, пустая строка для строк и т. д.). | **EMPTYRECORD (SPLIT ("abc", 1))** возвращает новый пустой запись, который имеет такую же структуру, как список, который возвращен функцией **SPLIT**.   |

### <a name="text-functions"></a>Текстовые функции

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Функция</th>
<th>Описание</th>
<th>Пример</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>UPPER (строка)</td>
<td>Возврат конкретной строки, которая преобразуется в верхний регистр.</td>
<td><strong>UPPER(&quot;Sample&quot;)</strong> возвращает <strong>&quot;SAMPLE&quot;</strong>.</td>
</tr>
<tr class="even">
<td>LOWER (строка)</td>
<td>Возврат конкретной строки, которая преобразуется в нижний регистр.</td>
<td><strong>LOWER (&quot;Sample&quot;)</strong> возвращает <strong>&quot;sample&quot;</strong>.</td>
</tr>
<tr class="odd">
<td>LEFT (строка, количество символов)</td>
<td>Возвращает указанное число символов с начала указанной строки.</td>
<td><strong>LEFT (&quot;Sample&quot;, 3)</strong> возвращает <strong>&quot;Sam&quot;</strong>.</td>
</tr>
<tr class="even">
<td>RIGHT (строка, количество символов)</td>
<td>Возвращает указанное число символов с конца указанной строки.</td>
<td><strong>RIGHT (&quot;Sample&quot;, 3)</strong> возвращает <strong>&quot;ple&quot;</strong>.</td>
</tr>
<tr class="odd">
<td>MID (строка, исходная позиция, количество символов)</td>
<td>Возвращает указанное число символов из указанной строки, начиная с указанного положения.</td>
<td><strong>MID (&quot;Sample&quot;, 2, 3)</strong> возвращает <strong>&quot;amp&quot;</strong>.</td>
</tr>
<tr class="even">
<td>LEN (строка)</td>
<td>Возвращает число символов в указанной строке.</td>
<td><strong>LEN (&quot;Sample&quot;)</strong> возвращает <strong>6</strong>.</td>
</tr>
<tr class="odd">
<td>CHAR (число)</td>
<td>Возврат строки символов, на которые имеются ссылки по указанному номеру юникод.</td>
<td><strong>CHAR (255)</strong> возвращает <strong>&quot;ÿ&quot;</strong>. <strong>Примечание.</strong> Возвращенная строка зависит от кодировки, выбранной в родительском элементе формата FILE. Список поддерживаемых кодировок можно найти в разделе <a href="https://msdn.microsoft.com/en-us/library/system.text.encoding(v=vs.110).aspx">Класс кодировки</a>.</td>
</tr>
<tr class="even">
<td>CONCATENATE (строка 1 [, строка 2, …])</td>
<td>Возврат все указанные текстовые строки, которые соединены в одну строку.</td>
<td><strong>CONCATENATE (&quot;abc&quot;, &quot;def&quot;)</strong> возвращает <strong>&quot;abcdef&quot;</strong>. <strong>Примечание.</strong> Выражение <strong>&quot;abc&quot; &amp; &quot;def&quot;</strong> также возвращает <strong>&quot;abcdef&quot;</strong>.</td>
</tr>
<tr class="odd">
<td>TRANSLATE (строка, шаблон, замена)</td>
<td>Возврат указанной строки, в которой все вхождения символов в определенной строке шаблона заменены символами на соответствующей позиции указанной строки-замены.</td>
<td><strong>TRANSLATE (&quot;abcdef&quot;, &quot;cd&quot;, &quot;GH&quot;)</strong> заменяет шаблон <strong>&quot;cd&quot;</strong> строкой <strong>&quot;GH&quot;</strong> и возвращает <strong>&quot;abGHef&quot;</strong>.</td>
</tr>
<tr class="even">
<td>REPLACE (строка, шаблон, замена, флаг регулярного выражения)</td>
<td>Когда определенный флаг регулярного выражения — <strong>true</strong>, вернуть указанную строку, которая изменяется, применяя регулярного выражения, которое определяется как аргумент шаблона для этой функции. Это выражение используется для обнаружения символов, которые необходимо заменить. Символы определенного аргумента замены используются для замены найденных символов. Когда определенный флаг регулярного выражения — <strong>false</strong>, эта функция ведет как <strong>TRANSLATE</strong>.</td>
<td>  <strong>REPLACE (&quot;+1 923 456 4971&quot;, &quot;[^0-9]&quot;, &quot;&quot;, true)</strong> применяет регулярное выражение, которое удаляет все нечисловые символы и возвращает <strong>&quot;19234564971&quot;</strong>. <strong>REPLACE (&quot;abcdef&quot;, &quot;cd&quot;, &quot;GH&quot;, false)</strong> заменяет шаблон <strong>&quot;cd&quot;</strong> строкой <strong>&quot;GH&quot;</strong> и возвращает <strong>&quot;abGHef&quot;</strong>.</td>
</tr>
<tr class="odd">
<td>TEXT (ввод)</td>
<td>Возврат указанного ввода, который преобразовывается в текстовую строке, которая отформатирована в соответствии с параметрами языкового стандарта сервера текущего экземпляра Finance and Operations. Для значений типа <strong>real</strong> преобразование строки ограничено до 2 десятичных знаков.</td>
<td>Если языковой стандарт экземпляра сервера Finance and Operations определен как <strong>EN-US</strong>, <strong>TEXT (NOW ())</strong> возвращает текущую дату сеанса Finance and Operations, 12/17/2015, как текстовую строку <strong>&quot;12/17/2015 07:59:23 AM&quot;</strong>. <strong>TEXT (1/3)</strong> возвращает <strong>&quot;0.33&quot;</strong>.</td>
</tr>
<tr class="even">
<td>FORMAT (строка 1, строка 2[, строка 3, ...])</td>
<td>Возврат указанной строки, которая отформатирована путем замены любых вхождений <strong>%N</strong> <em>n</em>-ным аргументом. Аргументы — строки. Если аргумент не предусмотрен для параметра, параметр возвращается как <strong>&quot;%N&quot;</strong> в строке. Для значений типа <strong>real</strong> преобразование строки ограничено до 2 десятичных знаков.</td>
<td>В этом примере источник данных <strong>PaymentModel</strong> возвращает список записей клиентов через компонент <strong>Customer</strong> и значение даты обработки в поле <strong>ProcessingDate</strong>. <a href="./media/picture-format-datasource.jpg"><img src="./media/picture-format-datasource.jpg" alt="PaymentModel data source" class="alignnone wp-image-290751 size-full" width="293" height="143" /></a> В формате ER, который создан для генерации электронного файла для выбранных клиентов, <strong>PaymentModel</strong> выбирается в качестве источника данных и управляет потоком операций. Исключение создается для конечных пользователей, если выбранный клиент остановлен на дату обработки отчета. Формула, которая предназначена для этого типа управления обработкой, может использовать следующие ресурсы:
<ul>
<li>Метка SYS70894 Finance and Operations которая имеет следующий текст:
<ul>
<li><strong>Для языка EN-US:</strong> &quot;Nothing to print&quot;</li>
<li><strong>Для языка DE:</strong> &quot;Nichts zu drucken&quot;</li>
</ul></li>
<li>Метка SYS18389 Finance and Operations которая имеет следующий текст:
<ul>
<li><strong>Для языка EN-US:</strong> &quot;Customer %1 is stopped for %2.&quot;</li>
<li><strong>Для языка DE:</strong> &quot;Debitor '%1' wird für %2 gesperrt.&quot;</li>
</ul></li>
</ul>
Вот формула, которую можно разработать: FORMAT (CONCATENATE (@&quot;SYS70894&quot;, &quot;. &quot;, @&quot;SYS18389&quot;), model.Customer.Name, DATETIMEFORMAT (model.ProcessingDate, &quot;d&quot;)) Если отчет обрабатывается для клиента <strong>Litware Retail</strong> 17 декабря 2015 г., в культуре <strong>EN-US</strong> и языке <strong>EN-US</strong>, эта формула возвращает следующий текст, который можно представить в виде сообщения исключения для конечного пользователя: &quot;Nothing to print. Customer Litware Retail is stopped for 12/17/2015.&quot; Если отчет обрабатывается для клиента <strong>Litware Retail</strong> 17 декабря 2015 г., в культуре <strong>DE</strong> и языке <strong>DE</strong>, эта формула возвращает следующий текст, который использует другой формат даты: &quot;Nichts zu drucken. Debitor 'Litware Retail' wird für 17.12.2015 gesperrt.&quot; <strong>Примечание.</strong>Следующий синтаксис применяется в формулах ER для меток:
<ul>
<li><strong>Для меток из ресурсов Finance and Operations:</strong> <strong>@&quot;X&quot;</strong>, где Х — идентификатор метки в репозитории прикладных объектов (AOT)</li>
<li><strong>Для меток, которые находятся в конфигурациях ER:</strong> <strong>@&quot;GER_LABEL:X&quot;</strong>, где Х — код метки в конфигурации ER</li>
</ul></td>
</tr>
<tr class="odd">
<td>NUMBERFORMAT (число, формат)</td>
<td>Возвращает строковое представление указанного числа в указанном формате. (Сведения о поддерживаемых форматах см. в разделах <a href="https://msdn.microsoft.com/en-us/library/dwhawy9k(v=vs.110).aspx">стандартный</a> и <a href="https://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx">настраиваемый</a>.) Контекст, в котором эта функция выполняется, определяет культуру, используемую для форматирования чисел.</td>
<td>Для культуры EN-US <strong>NUMBERFORMAT (0.45, &quot;p&quot;)</strong> возвращает <strong>&quot;45.00 %&quot;</strong>. <strong>NUMBERFORMAT (10.45, &quot;#&quot;)</strong> возвращает <strong>&quot;10&quot;</strong>.</td>
</tr>
<tr class="even">
<td>NUMERALSTOTEXT (номер, язык, валюта, флаг печати названия валюты, десятичные знаки)</td>
<td>Возвращает номер, преобразованный в текстовые строки на заданном языке. Код языка необязателен: когда он определен как пустая строка, код языка контекста выполнения (определяется для создающей папки или файла) будет использоваться. Код валюты указывать необязательно. Когда он определен как пустая строка, берется валюта компании. Обратите внимание, что параметр <strong>Название валюты для печати</strong> и параметр <strong>Десятичные знаки</strong> анализируются только для следующих кодов языков: <strong>CS</strong>, <strong>ET</strong>, <strong>HU</strong>, <strong>LT</strong>, <strong>LV</strong>, <strong>PL</strong>, <strong>RU</strong>. Обратите внимание, что параметр <strong>Название валюты для печати</strong> анализируется только для компаний Finance and Operations с контекстом страны, который поддерживает склонение валюты.</td>
<td>NUMERALSTOTEXT (1234.56, &quot;EN&quot;, &quot;&quot;, false, 2) возвращает “One Thousand Two Hundred Thirty Four and 56” NUMERALSTOTEXT (120, &quot;PL&quot;, &quot;&quot;, false, 0) возвращает “Sto dwadzieścia” NUMERALSTOTEXT (120.21, &quot;RU&quot;, &quot;EUR&quot;, true, 2) возвращает “Сто двадцать евро 21 евроцент”</td>
</tr>
<tr class="odd">
<td>PADLEFT (строка, длина, дополняющие символы)</td>
<td>Возвращает строку указанной длины, в которой в начало текущей строки добавлены указанные символы.</td>
<td>PADLEFT (“1234”, 10, “ “) возвращает текстовую строку «      1234»</td>
</tr>
<tr class="even">
<td>TRIM (строка)</td>
<td>Возвращает данный текст после усечения начальных и конечных пробелов и удаления нескольких пробелов между словами до одного. </td>
<td><strong>TRIM ("     Текст     примера     ")</strong> возвращает <strong>"Текст примера".</strong></td>
=======
<td>GETENUMVALUEBYNAME (путь к источнику данных перечисления, текст метки значения перечисления)</td>
<td>Возвращает значение указанного источника данных перечисления по указанному тексту этой метки перечисления.</td>
<td>Следующий пример показывает перечисление ReportDirection, введенное в модели данных. Обратите внимание, что метки определены для значений перечисления.
В следующих примерах показано:
<ul><li>Перечисление модели <strong>ReportDirection</strong> вставлено в отчет как источник данных <strong>$Direction</strong></li>
<li>Выражение <strong>$IsArrivals</strong>, разработанное для использования перечисления модели в качестве параметра этой функции. Значение этого выражения является <strong>TRUE</strong></li></ul></td>
</tr>
</tbody>
</table>

**Функции преобразования данных**

| Функция             | описание                                                                                                                                                                                                                                     | Пример                                                                                                                                             |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| TEXT (ввод) | Возврат указанного ввода, который преобразовывается в текстовую строке, которая отформатирована в соответствии с параметрами языкового стандарта сервера текущего экземпляра Finance and Operations.
Для значений типа real преобразование строки ограничено до 2 десятичных знаков.| Если языковой стандарт экземпляра сервера Finance and Operations определен как **EN-US, TEXT (NOW ())** текущая дата сеанса Finance and Operations, 12/17/2015 возвращается как текстовая строка **"12/17/2015 07:59:23 AM"**.
**TEXT (1/3) возвращает "0.33"**. |
| QRCODE (строка) | Возвращает изображение QR-кода заданной строки в двоичном формате base64. | **QRCODE (“Sample text”)** возвращает **U2FtcGxlIHRleHQ=**.   |

### <a name="data-collection-functions"></a>Функции сбора данных

| Функция             | описание                                                                                                                                                                                                                                     | Пример                                                                                                                                             |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| FORMATELEMENTNAME () | Возвращает имя элемента текущего формата. Возвращает пустую строку, когда флаг **Сбор сведений о результате** для текущих файлов выключен.| См. руководство по задаче **ER Использование выходных данных формата для инвентаризации и агрегирования** (часть бизнес-процесса **Приобретение/разработка компонентов ИТ-услуг и решений**) для получения дополнительных сведений об использовании этих функций. |
| SUMIFS (ключевая строка для суммирования, строка критериев range1, строка критериев value1 \[, строка критериев range2, строка критериев value2,…\]) |Возвращает сумму значений узлов (с именем, определенным как ключ) кода XML, который был собран во время выполнения этого формата и удовлетворяет введенным условиям (пары "диапазон-значение"). Возвращает нулевое значение, когда флаг **Сбор сведений о результате** для текущих файлов выключен. |            |
| SUMIF (ключевая строка для суммирования, строка диапазона критериев, строка значения критериев) | Возвращает сумму значений узлов (с именем, определенным как ключ) кода XML, который был собран во время выполнения этого формата и удовлетворяет введенному условию ("диапазон-значение"). Возвращает нулевое значение, когда флаг **Сбор сведений о результате** для текущих файлов выключен.|           |
| COUNTIFS (ключевая строка для суммирования, строка критериев range1, строка критериев value1 \[, строка критериев range2, строка критериев value2,…\]) | Возвращает количество узлов (с именем, определенным как ключ) кода XML, который был собран во время выполнения этого формата и удовлетворяет введенным условиям (пары "диапазон-значение"). Возвращает нулевое значение, когда флаг **Сбор сведений о результате** для текущих файлов выключен.|     |
| COUNTIF (строка диапазона критериев, строка значения критериев) | Возвращает количество узлов (с именем, определенным как ключ) кода XML, который был собран во время выполнения этого формата и удовлетворяет введенному условию ("диапазон-значение"). Возвращает нулевое значение, когда флаг **Сбор сведений о результате** для текущих файлов выключен.|          |
| COLLECTEDLIST (ключевая строка для суммирования, строка критериев range1, строка критериев value1 \[, строка критериев range2, строка критериев value2,…\]) | Возвращает список значений узлов кода XML, который был собран во время выполнения этого формата и удовлетворяет введенным условиям ("диапазон-значение"). Возвращает пустой список, когда флаг **Сбор сведений о результате** для текущих файлов выключен.|               |   




### <a name="other-business-domainspecific-functions"></a>Другие функции (характерные для конкретных бизнес-доменов)

| Функция                                                                         | описание                                                                                                                                                                                                                                                        | Пример                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CONVERTCURRENCY (сумма, валюта источника, валюта целевая, дата, компания)        | Преобразование указанной денежной суммы от валюты источника в валюту целевую, используя настройки определенной компании Finance and Operations на указанную дату.                                                                            | **CONVERTCURRENCY (1, "EUR", "USD", TODAY(), "DEMF")** возвращает эквивалент одного евро в долларах США на текущую дату сеанса на основе настроек для компании DEMF.                                                                                                                                  |
| ROUNDAMOUNT (число, десятичные знаки, правило округления)                                       | Округление указанной суммы в соответствии с указанным правилом округления и определенным количеством десятичных знаков. **Примечание.** Правило округления необходимо определить как значение перечисления **RoundOffType** Finance and Operations.                          | Если параметр **model.RoundOff** задан как ****Downward****, **ROUNDAMOUNT (1000.787, 2, model.RoundOff)** возвращает значение **1000.78**. Если параметр **model.RoundOff** задан как **Normal** или **Rounding-up**, **ROUNDAMOUNT (1000.787, 2, model.RoundOff)** возвращает значение **1000.79**. |
| CURCredRef (цифры)                                                              | Возврат ссылки кредитора на основе цифр определенного номера накладной.                                                                                                                                                                                  | **CURCredRef ("VEND-200002")** возвращает **"2200002"**.                                                                                                                                                                                                                                                         |
| MOD\_97 (цифры)                                                                 | Возврат ссылки кредитора как выражение MOD97 на основе цифр определенного номера накладной.                                                                                                                                                            | **MOD\_97 ("VEND-200002")** возвращает **"20000285"**.                                                                                                                                                                                                                                                           |
| ISOCredRef (цифры)                                                              | Возврат ссылки кредитора ISO на основе цифр и алфавитных символов определенного номера накладной. **Примечание.** Чтобы исключить символы из алфавитов, не совместимых с ISO, входной параметр необходимо перевести до передачи к этой функции. | **ISOCredRef ("VEND-200002")** возвращает **"RF23VEND-200002"**.                                                                                                                                                                                                                                                 |
| CN\_GBT\_AdditionalDimensionID (строка, номер)                                  | Получить код дополнительной финансовой аналитики. Аналитики представлены в этой строке как коды, отделенные запятыми. Номера определяют код серии запрошенной аналитики в этой строке.                                                                            | CN\_GBT\_AdditionalDimensionID ("AA,BB,CC,DD,EE,FF,GG,HH",3) возвращает “CC”                                                                                                                                                                                                                                      |
| GetCurrentCompany ()                                                             | Возвращает текстовое представление кода юридического лица (компании), в которую вошел пользователь.                                                                                                                                                                                                                    | **GETCURRENTCOMPANY ()** возвращает **USMF** для пользователя, выполнившего вход в компанию Finance and Operations **Contoso Entertainment System USA**.                                                                                                                                                                                                                                                                                                              |
| CH\_BANK\_MOD\_10 (цифры)                                                       | Возвращает ссылку кредитора как выражение MOD10 на основе цифр указанного номера накладной.                                                                                                                                                                      | CH\_BANK\_MOD\_10 ("VEND-200002") возвращает 3                                                                                                                                                                                                                                                                   |
| FA\_SUM (код основного средства, код модели стоимости, дата начала, дата окончания)               | Возвращает подготовленный контейнер данных сумм основных средств за период.                                                                                                                                                                                         | FA\_SUM ("COMP-000001", “Current”, Date1, Date2) возвращает подготовленный контейнер данных основного средства «COMP-000001» с моделью стоимости «Current» для периода от Date1 до Date2.                                                                                                                        |
| FA\_BALANCE (код основного средства, код модели стоимости, год отчета, дата отчета) | Возвращает подготовленный контейнер данных сальдо основных средств. Год отчета необходимо определить как значение перечисления **AssetYear** Finance and Operations.                                                                                           | FA\_SUM ("COMP-000001", “Current”, AxEnumAssetYear.ThisYear, SESSIONTODAY ()) возвращает подготовленный контейнер данных сальдо для основного средства «COMP-000001» с моделью стоимости «Current» для даты текущего сеанса 365 for Finance and Operations .                                                                |
| TABLENAME2ID (строка)                                                       | Возвращает целочисленное представление ИД таблицы для заданного имени таблицы.                                                                                                                                                                      | **TABLENAME2ID (“Intrastat”)** возвращает **1510**.                                                                                                                                                                                                                                                                   |
| ISVALIDCHARACTERISO7064 (строка)                                                       | Возвращает логическое значение **TRUE**, если заданная строка представляет допустимый международный номер банковского счета (IBAN). Возвращает логическое значение **False** в противном случае.                                                                                                                                                                      | **ISVALIDCHARACTERISO7064 ("AT61 1904 3002 3457 3201")** возвращает **TRUE**. **ISVALIDCHARACTERISO7064 ("AT61")** возвращает **FALSE**.                                                                                                                                                                                                                                                                   |

### <a name="functions-list-extension"></a>Расширение перечня функций

ER позволяет расширение перечня функций, используемых в выражениях ER. Для этого требуются некоторые усилия со стороны разработчика. Дополнительные сведения см. в разделе [Расширение списка функций электронной отчетности](general-electronic-reporting-formulas-list-extension.md).

<a name="see-also"></a>См. также
--------

[Обзор электронной отчетности](general-electronic-reporting.md)

[Расширение списка функций электронной отчетности (ER)](general-electronic-reporting-formulas-list-extension.md)




