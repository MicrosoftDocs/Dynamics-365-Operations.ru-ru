---
title: "Сброс киоска данных финансовой отчетности после восстановления базы данных"
description: "В этом разделе описывается, как сбросить киоск данных финансовой отчетности после восстановления базы данных Microsoft Dynamics 365 for Operations."
author: twheeloc
manager: AnnBe
ms.date: 2016-12-08 16 - 20 - 13
ms.topic: article
ms.prod: 
ms.service: Dynamics365Operations
ms.technology: 
audience: Application User, IT Pro
ms.search.scope: Operations, Core
ms.custom: 261824
ms.assetid: d0784b2c-fe10-428d-8d07-fd474ca50fcc
ms.search.region: Global
ms.author: kweekley
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
translationtype: Human Translation
ms.sourcegitcommit: 4d6cf88788dcc5e982e509137aa444a020137a5e
ms.openlocfilehash: 3967cbb869fbb23d5d7716f619e4c22b4a273921
ms.lasthandoff: 03/29/2017


---

# <a name="reset-the-financial-reporting-data-mart-after-restoring-a-database"></a>Сброс киоска данных финансовой отчетности после восстановления базы данных

В этом разделе описывается, как сбросить киоск данных финансовой отчетности после восстановления базы данных Microsoft Dynamics 365 for Operations. 

Существует несколько сценариев, в которых может потребоваться восстановление базы данных Dynamics 365 for Operations из резервной копии или копирование базы данных из другой среды. В этом случае необходимо также выполнить соответствующие шаги, чтобы убедиться, что киоск данных финансовой отчетности правильно использует восстановленную базу данных Dynamics 365 for Operations. При наличии вопросов о сбросе киоска данных финансовой отчетности по причине, не связанной с восстановлением базы данных Dynamics 365 for Operations, дополнительные сведения см. в разделе [Сброс киоска данных Management Reporter](https://blogs.msdn.microsoft.com/dynamics_financial_reporting/2016/06/28/resetting-the-management-reporter-data-mart/). Обратите внимание, что шаги в этом процессе поддерживаются для Dynamics 365 for Operations выпуска за май 2016 (сборка приложения 7.0.1265.23014 и сборка финансовой отчетности 7.0.10000.4) и более новых версий. Если имеется более ранняя версия Dynamics 365 for Operations, обратитесь к специалисту службы поддержки за помощью.

## <a name="export-report-definitions"></a>Экспорт определений отчетов
Сначала экспортируйте макеты отчетов, расположенные в конструкторе отчетов, выполнив следующие действия:

1.  В конструкторе отчетов откройте **Компания** &gt; **Группы строительных блоков**.
2.  Выберите группу строительных блоков, которую требуется экспортировать, и нажмите кнопку **Экспорт**. **Примечание.** Для Dynamics 365 for Operations поддерживается только одна группа строительных блоков, **По умолчанию**.
3.  Выберите определения отчета для экспорта:
    -   Для того, чтобы экспортировать все ваши определения отчета и связанные строительные блоки, щелкните **Выбрать все**.
    -   Чтобы экспортировать определенные отчеты, строки, столбцы, деревья или наборы аналитик, щелкните соответствующую вкладку и выберите элементы для экспорта. Нажмите и удерживайте нажатой клавишу CTRL, чтобы выбрать многочисленные элементы на вкладке. Когда вы выбираете отчеты для экспорта, выбираются связанные строки, столбцы, деревья, и наборы аналитик.

4.  Щелкните **Экспорт**.
5.  Введите имя файла и выберите безопасное место, где требуется сохранить экспортированные определения отчетов.
6.  Нажмите кнопку **Сохранить**.

Файл можно скопировать или отправить в безопасное место, что позволяет импортировать его в другую среду в другое время. Сведения об использовании учетной записи хранилища Microsoft Azure можно найти в разделе [Перенос данных с помощью служебной программы командной строки AzCopy](https://docs.microsoft.com/en-gb/azure/storage/storage-use-azcopy). **Примечание.** Корпорация Майкрософт не предоставляет учетную запись хранилища как часть договора на Dynamics 365 for Operations. Необходимо либо приобрести учетную запись хранилища, либо использовать учетную запись хранилища из отдельной подписки Azure. **Важно:** Помните о поведении диска D в виртуальных машинах Azure. Не следует постоянно хранить на нем свои экспортированные группы строительных блоков. Дополнительные сведения о временных дисках см. в разделе [Понимание временного диска на виртуальных машинах Windows Azure](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).

## <a name="stop-services"></a>Остановка служб
С помощью удаленного рабочего стола подключитесь ко всем компьютерам в среде и остановите следующие службы Windows с помощью services.msc:

-   Служба веб-публикаций (на всех компьютерах AOS)
-   Microsoft Dynamics 365 for Operations Batch Management Service (только на компьютерах открытых серверов AOS)
-   Management Reporter 2012 Process Service (только на компьютерах BI)

Эти службы будут иметь открытые подключения к базе данных Dynamics 365 for Operations.

## <a name="reset"></a>Сброс
#### <a name="locate-the-latest-dataupgradezip-package"></a>Найдите последнюю версию пакета DataUpgrade.zip

Найдите последний пакет DataUpgrade.zip с помощью инструкций из раздела [Загрузка сценария DataUpgrade.zip](..\migration-upgrade\upgrade-data-to-latest-update.md). Инструкции объясняют, как найти правильную версию пакета обновления данных для вашей среды.

#### <a name="execute-scripts-against-dynamics-365-for-operations-database"></a>Выполнение сценариев для базы данных Dynamics 365 for Operations

Запустите следующие сценарии для базы данных Dynamics 365 for Operations (не для базы данных финансовых отчетов).

-   DataUpgrade.zip\\AosService\\Scripts\\ConfigureAxReportingIntegration.sql
-   DataUpgrade.zip\\AosService\\Scripts\\GrantAzViewChangeTracking.sql

Эти сценарии обеспечивают правильность пользователей, ролей и параметров изменения отслеживания.

#### <a name="execute-powershell-command-to-reset-database"></a>Выполнение команды PowerShell для сброса базы данных

Выполните следующую команду, непосредственно на компьютере с сервером AOS, чтобы сбросить интеграцию между Dynamics 365 for Operations и финансовой отчетностью:

1.  Откройте Windows PowerShell от имени администратора.
2.  Выполните: F:
3.  Выполните: cd F:\\MRApplicationService\\MRInstallDirectory
4.  Выполните: Import-Module .\\Server\\MRDeploy\\MRDeploy.psd1
5.  Выполните: Reset-DatamartIntegration -Reason OTHER -ReasonDetail “&lt;моя причина для сброса&gt;”
    -   Будет предложено ввести «Y» для подтверждения.

Объяснение параметров:

-   Допустимые значения для параметра -Reason: SERVICING, BADDATA, OTHER.
-   Параметр -ReasonDetail является произвольным текстом.
-   Значения параметров reason и reasonDetail записываются в данных телеметрии/мониторинга среды.

## <a name="start-services"></a>Запуск служб
Используйте services.msc, чтобы перезапустить службы, остановленные ранее:

-   Служба веб-публикаций (на всех компьютерах AOS)
-   Microsoft Dynamics 365 for Operations Batch Management Service (только на компьютерах открытых серверов AOS)
-   Management Reporter 2012 Process Service (только на компьютерах BI)

## <a name="import-report-definitions"></a>Импорт определений отчетов
Импортируйте макеты отчетов из конструктора отчетов, используя файл, созданный во время экспорта:

1.  В конструкторе отчетов откройте **Компания** &gt; **Группы строительных блоков**.
2.  Выберите группу строительных блоков, которую требуется экспортировать, и нажмите кнопку **Экспорт**. **Примечание.** Для Dynamics 365 for Operations поддерживается только одна группа строительных блоков, **По умолчанию**.
3.  Выберите строительный блок **По умолчанию** и нажмите **Импорт**.
4.  Выберите файл, содержащий экспортированные определения отчетов, и нажмите кнопку **Открыть**.
5.  В диалоговом окнеИмпорт, выберите определения отчета для того, чтобы импортировать:
    -   Чтобы импортировать все определения отчетов и поддерживающие строительные блоки, щелкните **Выбрать все**.
    -   Для того, чтобы импортировать специфические отчеты, строки, столбцы, деревья, или Наборы аналитик, выбирают отчеты, строки, столбцы, деревья, или Наборы аналитик, которые импортировать.

6.  Нажмите кнопку **Импорт**.



