---
title: "Симулятор периферийных устройств для розничной торговли"
description: "В этом разделе описывается симулятор периферийных устройств, поставляемый с Microsoft Dynamics 365 for Operations - Retail."
author: josaw1
manager: AnnBe
ms.date: 04/04/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
audience: Application User
ms.search.scope: AX 7.0.0, Operations, Core, Retail
ms.custom: 266544
ms.assetid: 16f31e70-15fc-441e-9727-e6a31c3a48f5
ms.search.region: global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.translationtype: Human Translation
ms.sourcegitcommit: d421b161216d700f7819f1da8c0ca8ad089b5670
ms.openlocfilehash: 894aaaaa844447030dae73826d326f99366aa068
ms.contentlocale: ru-ru
ms.lasthandoff: 05/25/2017


---

# <a name="retail-peripheral-simulator"></a>Симулятор периферийных устройств для розничной торговли

[!include[banner](includes/banner.md)]


В этом разделе описывается симулятор периферийных устройств, поставляемый с Microsoft Dynamics 365 for Operations - Retail.

<a name="overview"></a>Обзор
--------

Симулятор периферийных устройств Microsoft Dynamics 365 for Operations - Retail является средством, которое помогает настраивать, тестировать и устранять неполадки периферийных устройств, которые используются в сфере розничной торговли. Симулятор периферийных устройств можно использовать для упрощения тестирования периферийных устройств розничной торговли и выявления проблем, вызванных неправильной настройкой или неправильной работой драйверов устройств. Симулятор периферийных устройств включает классическую программу с виртуальными версиями устройств, поддерживаемых Dynamics 365 for Operations - Retail. Раздел для каждого виртуального устройства показывает взаимодействие между устройством и POS-терминалом. Его также можно использовать для обеспечения ввода, который является действительным для различных сценариев POS. Симулятор периферийных устройств поддерживает взаимодействие между POS и следующими виртуальными устройствами:

-   **Принтер** — симулятор периферийных устройств может показывать чеки, которые настроены для принтера POS.
-   **Строковый дисплей** — можно настроить виртуальный строковый дисплей для отображения действий физическом строчном дисплее.
-   **Считыватель магнитных карт (MSR)** — из симулятора периферийных устройств можно отправлять в POS смоделированные события магнитных карт.
-   **Денежный ящик** — можно моделировать физический кассовый лоток.
-   **Денежный ящик 2** — настроив второй кассовый лоток в симуляторе периферийных устройств, можно моделировать сценарии, которые включают одну ККМ POS-терминала с двумя активными сменами.
-   **Сканер** — виртуальный сканер штрих-кодов, который поддерживает симулятор периферийных устройств, может выдавать события считывания штрих-кода.
-   **Весы** — виртуальные весы позволяют моделировать взаимодействие взвешивания номенклатуры с POS.
-   **Клавиатура для набора ПИН-кода** — можно моделировать операции клавиатуры для набора ПИН-кода. **Примечание.** Необходимо реализовать поддержку физической клавиатуры для набора ПИН-кода через соединитель платежей.
-   **Считывание рукописных подписей** — симулятор периферийных устройств включает в себя виртуальное устройство считывания рукописной подписи, которое можно настроить на выдачи запроса подписей, которые требуются для некоторых платежных средств, таких как платежи со счета клиента.

Можно также использовать симулятор периферийных устройств для моделирования событий электронного соединителя клавиатуры, которые создаются сканером штрих-кодов и считывателем магнитных карт. Симулятор периферийных устройств специально поддерживает связывание и внедрение объектов для устройств Retail POS (OPOS).

## <a name="key-scenarios"></a>Основные сценарии
### <a name="troubleshooting"></a>Устранение неполадок

Симулятор периферийных устройств можно использовать для устранения неполадок настройки устройства. При отсутствии симулятора периферийных устройств или второго устройства того же класса может быть трудно определить, где возникают проблемы. Однако при наличии симулятора периферийных устройств можно настроить виртуальные устройства и запустить эти же ветви кода и бизнес-логику, которые используются для физических устройств. С точки зрения симулятора периферийных устройств основное различие между виртуальными и физическими устройствами заключается в объекте сервисного обслуживания или драйвере устройства. Для физических устройств объект сервисного обслуживания поставляется изготовителем оборудования. Напротив, для симулятора периферийных устройств объекты сервисного обслуживания предоставляются в составе симулятора периферийных устройств. Когда симулятор периферийных устройств работает правильно, если устройство не работает правильно после изменения имени устройства в профиле оборудования на имя физического устройства, можно предположить, что имеется проблема с объектом сервисного обслуживания, предоставленным изготовителем.

### <a name="training"></a>Обучение

Симулятор периферийных устройств можно использовать для добавления реалистичного слоя в обучение кассира, когда настройка с физическим оборудованием недоступна. Когда симулятор периферийных устройств включен в сценарии обучения, кассир может более эффективно взаимодействовать с POS, предоставляя входные данные, например результаты сканирования штрих-кода продуктов и считывания подарочных карт и наблюдая, какие чеки печатаются для конкретной проводки.

### <a name="testing"></a>Тестирование

Симулятор периферийных устройств можно использовать для проверки штрих-кодов продуктов, форматов чеков и т. д., без необходимости развертывания физического оборудования в виртуальной среде. Так как физическое оборудование не требуется, и нет необходимости развертывания клиента POS на станции оборудования или физическом компьютере, можно быстрее проверять изменения, внесенные в бэк-офис.

## <a name="set-up-the-peripheral-simulator"></a>Настройка симулятора периферийных устройств
### <a name="set-up-a-hardware-profile"></a>Настройка профиля оборудования

1.  Чтобы настроить симулятор периферийных устройств, откройте **Розничная торговля и коммерция** &gt; **Настройка канала** &gt; **Настройка POS** &gt; **Профили POS** &gt; **Профили оборудования**.
2.  Чтобы создать новый профиль, щелкните **Создать**.
3.  Введите значения в поля **Номер профиля** и **Описание**.
4.  Воспользуйтесь следующей таблицей, чтобы настроить виртуальные устройства, которые подлежат проверке. Ниже приведено пояснение столбцов в этой таблице:
    -   **Устройство** — этот столбец содержит имя экспресс-вкладки, которую требуется развернуть для настройки устройства.
    -   **Тип устройства** — этот столбец предоставляет значение, выбранное в поле, которое помечено именем устройства.
    -   **Имя устройства** — в этом столбце показано точное значение, которое введено для имени устройства. **Важно.** Имена устройств, которые приведены здесь, являются обязательными, поскольку станция оборудования использует эти конкретные имена для адресации устройств. Если не использовать эти конкретные имена, использовать устройство невозможно.

    | Устройство            | Тип устройства | Наименование устройства              |
    |-------------------|-------------|--------------------------|
    | Принтер           | OPOS        | MockOPOSPrinter          |
    | Строковый дисплей      | OPOS        | MockOPOSLineDisplay      |
    | MSR / считыватель магнитных карт               | OPOS        | MockOPOSMSR              |
    | Трассант            | OPOS        | MockOPOSDrawer1          |
    | Drawer2           | OPOS        | MockOPOSDrawers          |
    | Сканер           | OPOS        | MockOPOSScanner          |
    | Шкала             | OPOS        | MockOPOSScale            |
    | Клавиатура для набора ПИН-кода           | OPOS        | MockOPOSPinPad           |
    | Считывание рукописных подписей | OPOS        | MockOPOSSignatureCapture |

**Примечание.** Не требуется никакая специальная настройка в профиле оборудования для моделирования событий электронного соединителя клавиатуры от сканера штрих-кодов и считывателя магнитных карт.

### <a name="assign-the-hardware-profile-to-a-register"></a>Назначение профиля оборудования ККМ

1.  После создания профиля оборудования перейдите к пункту **Розничная торговля и коммерция** &gt; **Настройка канала** &gt; **Настройка POS** &gt; **Регистры**.
2.  В списке **POS-регистраторы** щелкните ссылку в поле **Номер регистратора** для ККМ, которая должна использовать симулятор периферийных устройств.
3.  Выберите **Изменить**.
4.  В разделе **Профили** в поле **Профиль оборудования** выберите профиль оборудования, который вы создали для виртуальных периферийных устройств.
5.  Нажмите кнопку **Сохранить**.

### <a name="synchronize-changes-to-the-channel-database"></a>Синхронизация изменений с базой данных канала

1.  Перейдите к пункту **Розничная торговля и коммерция** &gt; **ИТ розничной торговли** &gt; **График распределения**.
2.  Выберите график распределения **1090**.
3.  Щелкните **Запустить сейчас** для синхронизации изменений в POS.

После синхронизации данных новый профиль оборудования и изменения в ККМ доступны в базе данных канала.

## <a name="install-the-peripheral-simulator"></a>Установка симулятора периферийных устройств
1.  Перейдите к пункту **Розничная торговля и коммерция** &gt; **Настройка канала** &gt; **Настройка POS** &gt; **Профили POS** &gt; **Профили оборудования**.
2.  Щелкните **Загрузить**, затем щелкните **PeripheralSimulator**. **Примечание.** Необходимо отключить блокировку всплывающих окон, чтобы можно было загрузить симулятор периферийных устройств.
3.  После завершения загрузки откройте папку **Загрузки** и дважды щелкните **VirtualPeripherals.msi**, чтобы запустить установщик.
4.  Установите симулятор периферийных устройств, используя настройки по умолчанию.

В дополнение к симулятору периферийных устройств необходимо установить компонент common control objects из служб Monroe Consulting Services. В противном случае симулятор периферийных устройств будет работать неправильно. Чтобы загрузить компонент common control objects, перейдите по адресу <http://monroecs.com/oposccos_current.htm>.

## <a name="using-the-peripheral-simulator"></a>Использование симулятора периферийных устройств
Чтобы запустить симулятор периферийных устройств, щелкните **Выполнить** на компьютере, введите **Retail peripheral simulator** и выберите это приложение, когда оно появится в результатах поиска. После запуска симулятора периферийных устройств щелкните имя устройства для просмотра поддерживаемых устройств. Эти устройства будут перечислены в виде вкладок с левой стороны окна. Для просмотра конкретного устройства перейдите на вкладку для этого устройства.

### <a name="line-display-capabilities"></a>Возможности строкового дисплея

Строковый дисплей является первым устройством, которое указано в симуляторе периферийных устройств. Если настрое виртуальный строковый дисплей, он показывает номенклатуры строки по мере их сканирования в проводку POS. В дополнение к номенклатурам строки, на дисплее отображается общая сумма к оплате при выборе платежного средства на POS. Он также показывает сальдо, которое должно быть выплачено, если введено платежное средство, но остается сальдо для оплаты по проводке. Если POS не используется, может отображаться сообщение о том, что денежный ящик закрыт. Необходимо настроить это сообщении на экспресс-вкладке **Строковый дисплей** в профиле оборудования.

### <a name="cash-drawer-capabilities"></a>Возможности кассового лотка

Кассовый лоток является вторым устройством, которое указано в симуляторе периферийных устройств. Если профиль оборудования настроен для использования виртуальных кассовых лотков, POS открывает кассовый лоток для активной смены в ответ на операции с лотком, такие как декларации платежных средств, чтобы кассир мог дать сдачу или депонировать денежные средства во время стандартной проводки "заплатил и забрал". Виртуальные денежные ящики имеют подписи **Главный денежный ящик** и **Дополнительный денежный ящик**. Эти метки представляют ящик и ящик 2 в профиле оборудования, соответственно. Когда ящик закрыт, отображается изображение закрытого кассового лотка, и кнопка на закрытом денежном ящике обозначается **Открыть денежный ящик**. При нажатии этой кнопки изображение меняется на изображение открытого кассового лотка для обозначения, что ящик теперь открыт. Кнопка на открытом денежном ящике обозначается как **Закрыть денежный ящик**. Несколько операций на POS могут привести к открытию денежного ящика. Большинство операций невозможно продолжить, пока открыт кассовый лоток. Исключение составляют некоторые процедуры, выполняемые в конце дня. Если пользователь POS получает сообщение об ошибке, в котором указано, что операция не может быть выполнена при открытом денежном ящике, пользователь должен закрыть виртуальный или физический денежный ящик для продолжения. Если денежный ящик помечен как **Общий** в профиле оборудования, система не проверяет, что ящик закрыт, перед выполнением операции. Операция продолжается как обычно, даже если открыт кассовый лоток. Это поведение поддерживает сценарии, когда денежные ящики совместно используются продавцами, при этом один продавец использует кассовый лоток, а другой продавец выполняет несвязанные задачи на своем устройстве POS. Изменения, вносимые в кассовый лоток, не очевидны, пока не закроется текущая смена и не откроется новая смена.

### <a name="msr-capabilities"></a>Возможности считывателя магнитных карт

Симулятор периферийных устройств обеспечивает надежную поддержку операций виртуального считывателя магнитных карт, работая в режиме OPOS или в режиме электронного соединителя клавиатуры. Режим OPOS требует, чтобы считыватель магнитных карт был настроен в профиле оборудования для работы в качестве устройства OPOS. Режим электронного соединителя клавиатуры просто отправляет события данных электронного соединителя клавиатуры в Microsoft Windows. Помимо различий в настройке, режимы OPOS и электронного соединителя клавиатуры отличаются следующим:

-   Клиент POS поддерживает устройства считывания магнитных карт в режиме OPOS для конкретных сценариев, таких как сценарии, поддерживающие данные магнитных карт для программ лояльности или ввод подарочных карт.
-   В режиме электронного соединителя клавиатуры симулятор периферийного оборудования отправляет данные электронного соединителя клавиатуры в поле, которое является активным при отправке данных. Это поведение аналогично поведению, которое происходит, если данные вводятся с помощью клавиатуры. Для использования считывателя магнитных карт в качестве электронного соединителя клавиатуры пользователь должен переключиться на Retail Modern POS (MPOS), чтобы обеспечить передачу данных в нужное поле данных. Поэтому можно настроить задержку, чтобы у пользователя было время убедиться, что данные будут отправлены в правильное поле.

#### <a name="testing-gift-and-payment-card-swipes"></a>Проверка считывания подарочных и платежных карт

Виртуальные считыватели магнитных карт, которые предоставляет симулятор периферийных устройств, также позволяют настраивать конкретные данные считывателя магнитных карт для проверки сценариев считывания подарочных и платежных карт. Чтобы создать карту, щелкните кнопку со знаком "плюс" (**+**) и выберите тип карты. Затем укажите номер карты или данные отслеживания, которые должны быть переданы в POS-терминал вместе с месяцем и годом срока действия карты, которую вы определяете. Значение, которое вы выбрали в поле **Тип карты**, является просто меткой, которая может быть сопоставлена карте. Эта метка упрощает идентификацию карт при их считывании через симулятор периферийных устройств. Можно выбрать карты, которые были настроены в симуляторе периферийных устройств, используя кнопки со стрелкой влево (**&lt;**) и вправо (**&gt;**) над изображением карты. Можно редактировать и удалять карты, используя кнопки **Изменить** и **Удалить** рядом с кнопкой со знаком "плюс" (**+**).

### <a name="pin-pad"></a>Клавиатура для набора ПИН-кода

Можно настроить симулятор клавиатуры для набора ПИН-кода, чтобы моделировать клавиатуру для набора ПИН-кода в режиме OPOS. Когда на POS-терминале выполняется проводка системы электронных платежей (EFT) и требуется ввод ПИН-кода, станции оборудования вызывает устройство ввода ПИН-кода для запроса ПИН-кода. Для работы клавиатуры для ввода ПИН-кодов в симуляторе периферийных устройств требуется поддержка соединителя электронных платежей EFT.

### <a name="printer"></a>Принтер

Виртуальный периферийный принтер только показывает чеки, напечатанные с POS-терминала. Если операция печати создает несколько чеков, можно прокручивать чеки.

#### <a name="configure-receipt-printing"></a>Настройка печати чеков

1.  Перейдите к пункту **Розничная торговля и коммерция** &gt; **Настройка канала** &gt; **Настройка POS** &gt; **Профили POS** &gt; **Профили оборудования**.
2.  Выберите профиль оборудования, который вы создали для виртуальных периферийных устройств.
3.  На экспресс-вкладке **Принтер** щелкните **Изменить**.
4.  В поле **Код профиля чеков** выберите профиль чеков.
5.  Нажмите кнопку **Сохранить**.

### <a name="scale"></a>Весы

Когда взвешиваемый продукт добавляется в проводку на POS и настроены весы, POS-терминал получает вес из весов. Как для виртуальных, так и для физических весов должен быть указан продукт или вес перед добавлением продукта в проводку. Прежде чем добавить взвешиваемый продукт в проводку, перейдите в весы в симуляторе периферийных устройств и используйте кнопки со знаком "плюс" (**+**) и "минус" (**–**) кнопки, чтобы скорректировать вес, которой должны показывать весы. Можно также ввести требуемый вес непосредственно в поле **Текущее значение**. Единицы измерения веса для весов можно настроить с помощью кнопок со знаком "плюс" (**+**), **Изменить** и **Удалить**. Таким образом единицы измерения могут быть указаны на основе продуктов, которые взвешиваются, или языкового стандарта, в котором используются весы.

#### <a name="configure-a-scale-product"></a>Настройка взвешиваемого продукта

1.  Перейдите в раздел **Розничная торговля и** **коммерция** &gt; **Продукты и категории** &gt; **Выпущенные продукты по категориям**.
2.  Откройте запись продукта.
3.  Выберите продукт для взвешивания.
4.  На экспресс-вкладке **Retail** измените значение параметра **Масштабировать продукт** с **Нет** на **Да**.

#### <a name="synchronize-changes-to-the-channel-database"></a>Синхронизация изменений с базой данных канала

1.  Перейдите к пункту **Розничная торговля и коммерция** &gt; **ИТ розничной торговли** &gt; **График распределения**.
2.  Выберите график распределения **1040**.
3.  Щелкните **Запустить сейчас** для синхронизации изменений в POS.

После синхронизации данных, когда взвешиваемый продукт добавляется в проводку на POS, POS-терминал проверяет вес, показываемый весами.

### <a name="signature-capture"></a>Считывание рукописных подписей

Устройство записи виртуальной подписи предлагает пользователю оставить свою подпись на панели считывания виртуальной подписи, когда используется платежное средство, требующее подписи. Пользователь может подтвердить подпись, чтобы отобразить ее на POS. Кассир может затем принять подпись. Подпись затем сохраняется вместе с платежным средством и синхронизируется с бэк-офис вместе с остальными данными проводки.

#### <a name="set-up-a-tender-to-require-a-signature"></a>Настройка платежного средства для запроса подписи

1.  Перейдите в раздел **Розничная торговля и коммерция** &gt; **Каналы** &gt; **Магазины розничной торговли** &gt; **Все розничные магазины**.
2.  Выберите розничный магазин.
3.  Выберите **Изменить**.
4.  Щелкните **Настройка**, затем, в разделе **Настройка**, щелкните **Способы оплаты**.
5.  Выберите **Изменить**.
6.  Выберите метод оплаты, который требует подписи.
7.  В разделе **Общее** в пункте **Считывание рукописных подписей** установите для параметра **Использовать устройство для считывания рукописных подписей** значение **Да**.
8.  В поле **Минимальное значение для считывания рукописных подписей** введите минимальную сумму, которая должна запускать считывание подписи.

#### <a name="synchronize-changes-to-the-channel-database"></a>Синхронизация изменений с базой данных канала

1.  Перейдите к пункту **Розничная торговля и коммерция** &gt; **ИТ розничной торговли** &gt; **График распределения**.
2.  Выберите график распределения **1070**.
3.  Щелкните **Запустить сейчас** для синхронизации изменений в POS.

После синхронизации данных, когда используется платежное средство, требующее подписи, и сумма превышает порог подписи, POS-терминал запрашивает подпись на виртуальном устройстве считывания рукописной подписи.

## <a name="additional-configuration"></a>Дополнительная конфигурация
Можно изменить файл конфигурации симулятора периферийных устройств, чтобы более точно соответствовать тестируемым сценариям. Файл конфигурации можно найти по пути C:\\Program Files (x86)\\Microsoft Dynamics 365\\70\\VirtualPeripherals\\Microsoft.Dynamics.Commerce.VirtualPeripherals.Client.exe.config. Файл конфигурации определяет единицы измерения, доступные для тестирования на весах, типы карт, доступных для тестирования, и типы штрих-кодов. Например, изменяя текстовые значения в файле конфигурации, можно добавить новый тип карт или единицы измерения, которые могут быть выбраны во время выполнения. Новые значения будут отображаться после перезапуска приложения.

## <a name="troubleshooting"></a>Устранение неполадок
Действия для симулятора периферийных устройств регистрируются в симуляторе периферийных устройств. Журнал можно найти по пути C:\\Program Files (x86)\\Microsoft Dynamics 365\\70\\VirtualPeripherals\\Microsoft.Dynamics.Commerce.VirtualPeripherals.Client.exe.config. Симулятор периферийных устройств также сообщает о проблемах в журнал событий Windows, к которому можно получить по пути **Журналы приложения и служб** &gt; **Microsoft** &gt; **DynamicsAX**. Если изменения, внесенные в профиле оборудования или других областях, не видны при использовании MPOS или симулятора периферийных устройств, проверьте задания планировщика распределения, которые использовались для синхронизации данных в базе данных канала. Если изменения были синхронизированы, но все еще не видны на POS, перезапустите клиент POS. Изменения в сконфигурированных денежных ящиках не вступают в силу, пока не будет создана новая смена. Поэтому при внесении изменений в денежные ящики убедитесь, что вы всегда закрываете существующую смену, чтобы проверить новую настройку денежного ящика. Иногда, если драйвер изготовителя был установлен после установки компонента common control objects из служб Monroe Consulting Services, этот драйвер может привести к неправильной работе компонента common control objects. В этом случае необходимо переустановить компонент common control objects.

<a name="see-also"></a>См. также
--------

[Обзор периферийных устройств для розничной торговли](retail-peripherals-overview.md)




