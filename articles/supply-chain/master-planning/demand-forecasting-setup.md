---
title: Настройка прогнозирования спроса
description: В этом разделе описывается, как настроить задачи, которые необходимо выполнить, чтобы подготовиться к прогнозированию спроса.
author: t-benebo
ms.date: 11/23/2021
ms.topic: article
ms.search.form: ReqDemPlanDefaultAlgorithmParameters, ReqDemPlanForecastParameters
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: benebotg
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: c3b52b970a8040dcba5a1fc59d297dc9ce1a3c53
ms.sourcegitcommit: ad1afc6893a8dc32d1363395666b0fe1d50e983a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2022
ms.locfileid: "8470019"
---
# <a name="demand-forecasting-setup"></a>Настройка прогнозирования спроса

[!include [banner](../includes/banner.md)]

В этой теме описывается, как настроить прогнозирование спроса.  

## <a name="item-allocation-keys"></a>Ключи распределения номенклатуры

Ключи распределения номенклатуры определяют группы номенклатур. Прогноз спроса рассчитан для номенклатуры и его аналитик, только если номенклатура является частью ключа распределения номенклатуры. Это правило применяется для группировки крупных количеств номенклатур, чтобы ускорить создание прогнозов спроса. Прогнозы создаются исключительно на основе данных за прошлые периоды.

Номенклатура и ее аналитики должны быть частью только одного ключа распределения номенклатуры, если ключ используется во время создания прогноза.

Чтобы создать ключи распределения номенклатур и добавить к ним единицу хранения (SKU), выполните следующие действия.

1. Перейдите к пункту **Сводное планирование \> Настройка \> Прогнозирование спроса \> Ключи распределения номенклатуры**.
1. Выберите ключ распределения номенклатур в области списка или выберите **Создать** на панели операций, чтобы создать новый. В заголовке для нового или выбранного ключа задайте следующие поля:

    - **Ключ распределения номенклатур** — введите уникальное имя для ключа.
    - **Имя** — введите описательное имя для ключа.

1. Выполните одно из следующих действий, чтобы добавить номенклатуры к выбранному ключу распределения номенклатур или удалить номенклатуры:

    - На экспресс-вкладке **Распределение номенклатур** для добавления или удаления номенклатур по мере необходимости используйте кнопки **Создать** и **Удалить** на панели инструментов. Для каждой строки выберите код номенклатуры, затем назначьте значения аналитик в других столбцах по мере необходимости. Выберите **Отобразить аналитики** на панели инструментов, чтобы изменить набор столбцов аналитик, отображаемых в сетке. (Значение в столбце **Процент** игнорируется, когда создаются прогнозы спроса.)
    - Если необходимо добавить в ключ большое число номенклатур, выберите **Назначить номенклатуры** на панели операций, чтобы открыть страницу, в которой можно найти и назначить несколько номенклатур для выбранного ключа.

> [!IMPORTANT]
> Будьте внимательны, чтобы включить в каждый ключ распределения номенклатур только соответствующие номенклатуры. Лишние номенклатуры могут стать причиной роста расходов при использовании Microsoft Azure Machine Learning.

## <a name="intercompany-planning-groups"></a>Группы внутрихолдингового планирования

Прогнозирование спроса может создавать межфирменные прогнозы. В Dynamics 365 Supply Chain Management компании, планирование для которых осуществляется вместе, сгруппированы в ту же группу внутрихолдингового планирования. Чтобы указать для каждой компании, какие ключи распределения номенклатур должны учитываться для прогнозирования спроса, свяжите ключ распределения номенклатур с внутрихолдинговым участником группы планирования.

> [!IMPORTANT]
> Оптимизация планирования в настоящее время не поддерживает внутрихолдинговые группы планирования. Для выполнения внутрихолдингового планирования с использованием оптимизации планирования настройте пакетные задания сводного планирования, которые включают в себя сводные планы для всех соответствующих компаний.

Для настройки групп внутрихолдингового планирования выполните следующие действия.

1. Перейдите в раздел **Сводное планирование \> Настройка \> Группы внутрихолдингового планирования**.
1. Выберите выбранную группу планирования в области списка или выберите **Создать** на панели операций, чтобы создать новую. В заголовке для новой или выбранной группы задайте следующие поля:

    - **Имя** — ввод уникального имени для группы планирования.
    - **Описание** — введите краткое описание группы планирования.

1. На экспресс-вкладке **Члены группы внутрихолдингового планирования** используйте кнопки на панели инструментов, чтобы добавить строку для каждой компании (юридического лица), которая должна быть частью группы. Для каждой строки заполните следующие поля:

    - **Юридическое лицо** — выберите имя компании (юридического лица), которая является участником выбранной группы.
    - **Последовательность планирования** — назначьте порядок, в котором компания должна обрабатываться относительно других компаний. Первыми обрабатываются младшие значения. Этот порядок может быть важен, когда спрос для одной компании оказывает влияние на другие компании. В таких случаях компания, которая поставляет спрос, должна быть обработана последней.
    - **Сводный план** — выберите сводный план, который будет запускаться для текущей компании.
    - **Автоматическое копирование в статический план** — этот флажок устанавливается, чтобы скопировать результат плана в статический план.
    - **Автоматическое копирование в динамический план** — этот флажок устанавливается, чтобы скопировать результат плана в динамический план.

1. По умолчанию если ни один ключ распределения номенклатуры не назначен участникам внутрихолдинговой группы планирования, прогноз спроса вычисляется для всех элементов, назначенных всем ключам распределения номенклатуры из всех компаний. Дополнительные параметры фильтрации для компаний и ключей распределения номенклатур доступны в диалоговом окне **Сгенерировать статистический базовый прогноз** (**Сводное планирование \> Прогнозирование \> Прогнозирование спроса \> Сгенерировать статистический базовый прогноз**). Чтобы назначить ключи распределения номенклатур для компании в выбранной группе внутрихолдингового планирования, выберите компанию, затем на экспресс-вкладке **Члены группы внутрихолдингового планирования** выберите **Ключи распределения номенклатур** на панели инструментов.

> [!IMPORTANT]
> Будьте внимательны, чтобы включить только соответствующие ключи распределения номенклатур в каждую группу внутрихолдингового планирования. Лишние номенклатуры могут стать причиной роста расходов при использовании Машинного обучения Azure.

## <a name="set-up-demand-forecasting-parameters"></a><a name="parameters"></a>Настройка параметров прогнозирования спроса

Страница **Параметры прогнозирования спроса** используется для настройки нескольких параметров, которые управляют тем, как прогнозирование спроса будет работать в системе.

### <a name="open-the-demand-forecasting-parameters-page"></a>Открытие страницы параметров прогнозирования спроса

Чтобы настроить параметры прогнозирования спроса, перейдите в раздел **Сводное планирование \> Настройка \> Прогнозирование спроса \> Параметры прогнозирования спроса**. Поскольку прогнозирование спроса выполняется на уровне компаний, настройка является глобальной. Другими словами, она применяется ко всем юридическим лицам (компаниям).

### <a name="general-settings"></a>Общие параметры

Вкладка **Общие** на странице **Параметры прогнозирования спроса** используется для определения общих настроек прогнозирования спроса.

#### <a name="demand-forecast-unit"></a>Единица прогноза спроса

Прогнозирование спроса составляет прогноз о количествах. Следовательно, единица измерения, в которой должно выражаться это количество, должна указываться в поле **Единица прогнозирования спроса**. Это поле определяет единицу, которая будет использоваться для всех прогнозов спроса, независимо от обычных складских единиц для каждого продукта. Использование согласованной единицы измерения спроса помогает убедиться, что суммирование и распределение процентов имеют смысл. Дополнительные сведения о суммировании и распределении процентов см. в разделе [Внесение ручных корректировок в базовый прогноз](manual-adjustments-baseline-forecast.md).

Для каждой единицы измерения, которая используется для SKU, которые включены в прогнозирование спроса, необходимо убедиться в наличии правила преобразования для единицы измерения и единицы измерения общего прогнозирования, которые выбраны здесь. При создании прогноза составляется список номенклатур без преобразования единиц измерения. Таким образом можно легко исправить настройку. Дополнительные сведения о единицах измерения и порядке их конвертирования между собой см. в разделе [Управление единицами измерения](../pim/tasks/manage-unit-measure.md).

#### <a name="transaction-types"></a>Типы проводок

Поля на экспресс-вкладке **Типы проводок** используются для выбора типов проводок, используемых при создании статистического базового прогноза.

Прогнозирование спроса можно использовать для прогнозирования зависимого спроса и независимого спроса. Например, если для параметра **Заказ на продажу** задано значение *Да* и все элементы, учитываемые при прогнозировании спроса, являются продаваемыми элементами, система вычисляет независимый спрос. Тем не менее, ключевые подкомпоненты можно добавить в ключи распределения номенклатур и прогнозирование спроса. В этом случае, если для параметра **Строка производства** задано значение *Да*, вычисляется зависимый прогноз.

Можно переопределить типы проводок для одного или нескольких определенных ключей распределения номенклатур, используя вкладку **Ключи распределения номенклатур**. На вкладке представлены похожие поля.

#### <a name="choose-how-to-create-the-baseline-forecast"></a>Выбор способа создания базового прогноза

Поле **Стратегия создания прогноза** позволяет выбрать метод, который используется для создания базового прогноза. Доступно три метода:

- *Копирование по историческому спросу* — создание прогнозов путем простого копирования исторических данных.
- *Служба машинного обучения Azure* — используется модель прогнозирования, в которой используется служба машинного обучения Azure. Служба машинного обучения Azure — это текущее решение по машинному обучению для Azure. Поэтому рекомендуется использовать его, если требуется использовать модель прогнозирования.
- *Машинное обучение Azure* — используется модель прогнозирования, в которой используется студия машинного обучения Azure (классическая). Студия машинного обучения Azure (классическая) устарела и скоро будет удалена из Azure. Поэтому рекомендуется выбрать *службу машинного обучения Azure*, если настройка прогноза спроса выполняется в первый раз. Если в настоящее время используется Студия машинного обучения Azure (классическая), следует как можно скорее запланировать переход на службу машинного обучения Azure.

Можно переопределить метод создания прогнозов для одного или нескольких определенных ключей распределения номенклатур, используя вкладку **Ключи распределения номенклатур**. На вкладке представлены похожие поля.

#### <a name="override-default-forecast-algorithm-parameters-globally"></a>Глобальное переопределение параметров по умолчанию алгоритма прогноза

Параметры по умолчанию алгоритма прогноза назначаются на странице **Параметры прогнозирования спроса** (**Сводное планирование \> Настройка \> Прогнозирование спроса \> Параметры прогнозирования спроса**). Однако их можно переопределить глобально, используя экспресс-вкладку **Параметры алгоритма прогнозирования** на вкладке **Общие** на странице **Параметры прогнозирования спроса**. (Также можно переопределить их для определенных ключей распределения, используя вкладку **Ключи распределения номенклатур** на странице **Параметры прогнозирования спроса**.)

Используйте кнопки **Добавить** и **Удалить** на панели инструментов, чтобы установить требуемую коллекцию переопределений параметров. Для каждого параметра в списке выберите значение в поле **Имя**, а затем введите соответствующее значение в поле **Значение**: Все параметры, не перечисленные здесь, будут принимать значения из параметров на странице **Параметры прогнозирования спроса**. Дополнительные сведения об использовании стандартного набора параметров и выборе значений для них см. в разделе [Параметры и значения по умолчанию для моделей прогнозирования спроса](#model-parameters).

### <a name="set-forecast-dimensions"></a>Задание аналитик прогноза

Аналитика прогноза указывает на степень подробности, для которой определен прогноз. Компания, сайт и ключ распределения номенклатур являются обязательными аналитиками прогноза. Можно также создавать прогнозы на уровне склада, статуса запасов, группы клиентов, счета клиента, страны или региона, области и/или уровня номенклатуры, а также все уровни аналитик номенклатуры. Используйте вкладку **Аналитики прогноза** на странице **Параметры прогнозирования спроса** для выбора набор аналитик прогноза, используемого при создании прогноза спроса.

В любое время вы можете добавить аналитики прогноза в список аналитик, используемых для прогнозирования спроса. Можно также удалить аналитики прогноза из списка. Тем не менее, при добавлении и удалении аналитики прогноза ручные корректировки будут потеряны.

### <a name="set-up-overrides-for-specific-item-allocation-keys"></a>Настройка переопределений для определенных ключей распределения номенклатур

Не все номенклатуры работают одинаково с точки зрения прогнозирования спроса. Таким образом, можно создать переопределения, специфичные для ключа распределения, для большинства параметров, определенных на вкладке **Общие**. Исключением является единица прогноза спроса. Чтобы настроить переопределения для конкретного ключа распределения номенклатур, выполните следующие действия.

1. На странице **Параметры прогнозирования спроса** на вкладке **Ключи распределения номенклатур** используйте кнопки панели инструментов, чтобы добавить ключи распределения номенклатур в сетку слева, или удалить их, как требуется. Затем выберите ключ распределения, для которого необходимо настроить переопределения.
1. На экспресс-вкладке **Типы проводок** включите типы проводок, которые требуется использовать для создания статистического базового прогноза для продуктов, относящихся к выбранному ключу распределения. Параметры работают так же, как они работают на вкладке **Общие**, но они применимы только к выбранному ключу распределения номенклатур. Все параметры здесь (значения *Да* и значения *Нет*) переопределяют все параметры **Типы проводок** на вкладке **Общие**.
1. На экспресс-вкладке **Параметры алгоритма прогноза** выберите переопределения стратегии создания прогноза и параметров алгоритма прогноза для продуктов, принадлежащих выбранному ключу распределения. Эти параметры работают так же, как они работают на вкладке **Общие**, но они применимы только к выбранному ключу распределения номенклатур. Используйте кнопки **Добавить** и **Удалить** на панели инструментов, чтобы определить требуемую коллекцию переопределений параметров. Для каждого параметра в списке выберите значение в поле **Имя**, а затем введите соответствующее значение в поле **Значение**: Дополнительные сведения об использовании стандартного набора параметров и выборе значений для них см. в разделе [Параметры и значения по умолчанию для моделей прогнозирования спроса](#model-parameters).

### <a name="set-up-the-connection-to-the-azure-machine-learning-service"></a>Настройка подключения к службе машинного обучения Azure

Для настройки подключения к службе машинного обучения Azure используется вкладка **Служба машинного обучения Azure**. Это решение является одним из вариантов создания базового прогноза. Эти параметры на этой вкладке действуют только в том случае, если в поле **Стратегия создания прогноза** задано значение *Служба машинного обучения Azure*.

Дополнительные сведения о настройке службы машинного обучения Azure и использовании параметров здесь для подключения к ней см. в разделе [Настройка службы машинного обучения Azure](#setup-amls).

### <a name="set-up-the-connection-to-azure-machine-learning-studio-classic"></a>Настройка подключения к студии машинного обучения Azure (классической)

> [!IMPORTANT]
> Студия машинного обучения Azure (классическая) устарела. Таким образом, вы больше не сможете создавать новые рабочие области для нее в Azure. Она заменена службой машинного обучения Azure, предоставляющей аналогичные функции и многое еще. Если вы еще не используете машинное обучение Azure, вы должны начать пользоваться службой машинного обучения Azure. Если у вас уже есть рабочая область, созданная для студии машинного обучения Azure (классической), можно продолжать использовать ее, пока функция не будет полностью удалена из Azure. Однако рекомендуется как можно скорее выполнить обновление до службы машинного обучения Azure. Хотя это приложение продолжит предупреждать об устаревании студии машинного обучения Azure (классической), это не повлияет на результаты прогнозирования. Дополнительные сведения о новой службе машинного обучения Azure и порядке ее настройки см. в разделе [Настройка службы машинного обучения Azure](#setup-amls).
>
> Можно свободно переключаться между новым и старым решениями машинного обучения с помощью Supply Chain Management, пока остается доступной старая рабочая область студии машинного обучения Azure (классической).

Если у вас уже есть доступная рабочая область студии машинного обучения Azure (классической), ее можно использовать для создания прогнозов путем подключения ее к Supply Chain Management. Это подключение можно установить, используя вкладку **Машинное обучение Azure** на странице **Параметры прогнозирования спроса**. (Настройки на этой вкладке действуют только в том случае, если в поле **Стратегия создания прогнозов** установлено значение *Машинное обучение Azure*.) Введите следующие сведения о рабочей области студии машинного обучения Azure (классической):

- Ключ API-интерфейса приложения веб-сервиса
- URL-адрес конечной точки веб-сервиса
- Имя учетной записи хранения Azure
- Ключ учетной записи хранения Azure

> [!NOTE]
> Имя и ключ учетной записи хранения Azure требуются, только если используется пользовательская учетная запись хранения. При развертывании локальной версии необходимо иметь пользовательскую учетную запись хранения в Azure, чтобы служба Machine Learning могла получить доступ к данным за прошлые периоды.

## <a name="default-parameters-and-values-for-demand-forecasting-models"></a><a name="model-parameters"></a>Параметры и значения по умолчанию для моделей прогнозирования спроса

При использовании машинного обучения для создания моделей прогноза можно управлять параметрами машинного обучения, настроив значения для *параметров алгоритма прогнозирования*. Эти значения отправляются из Supply Chain Management в машинное обучение Azure. Страница **Параметры алгоритма прогнозирования** используется для управления типом значений, которые должны быть предоставлены, и значениями, которые каждый из них должен иметь.

Для настройки параметров и значений по умолчанию для моделей прогнозирования спроса перейдите в раздел **Сводное планирование \> Настройка \> Прогнозирование спроса \> Параметры алгоритма прогнозирования**. Предусмотрен стандартный набор параметров. Каждый параметр имеет следующие поля:

- **Имя** — имя параметра, используемого Azure. Обычно не следует изменять это имя, если только вы не настроили эксперимент в машинном обучении Azure.
- **Описание** — общее название параметра. Это имя используется для идентификации параметра в других местах системы (например, на странице **Параметры прогнозирования спроса**).
- **Значение** — значение по умолчанию для параметра. Значение, которое требуется ввести, зависит от редактируемого параметра. 
- **Объяснение** — краткое описание параметра и порядок его использования. Обычно это описание содержит совет о допустимых значениях для поля **Значение**.

Следующие параметры предоставлены по умолчанию. (Если необходимо когда-либо вернуться к этому стандартному списку, выберите **Восстановить** в области действий.)

- **Уровень достоверности в процентах**: — интервал доверия состоит из диапазона значений, которые функционируют в качестве достоверных оценок прогноза спроса. Уровень доверия 95% показывает, что имеется 5% риск того, что будущий спрос окажется за пределами диапазона интервала доверия.
- **Принудительная сезонность** — определяет, должна ли модель принудительно использовать конкретный тип сезонности. Этот параметр применяется только к ARIMA и ETS. Параметры: *АВТО(по умолчанию)*, *НЕТ*, *АДДИТИВНЫЙ*, *МУЛЬТИПЛИКАТИВНЫЙ*.
- **Модель прогнозирования** — определяет, какую модель прогнозирования использовать. Параметры: *ARIMA*, *ETS*, *STL*, *ETS+ARIMA*, *ETS+STL*, *ВСЕ*. Чтобы выбрать модель наилучшего соответствия, используйте *ВСЕ*.
- **Максимальное прогнозируемое значение**: — определяет максимальное значение, которое будет использоваться для прогнозов. Формат: +1E[n] или числовая константа.
- **Минимальное прогнозируемое значение**: — определяет минимальное значение, которое будет использоваться для прогнозов. Формат: -1E[n] или числовая константа.
- **Подстановка отсутствующего значения**: — определяет, как заполняются пропуски в исторических данных. Параметры: *числовое значение*, *СРЕДНЕЕ*, *ПРЕДЫДУЩЕЕ*, *ЛИНЕЙНАЯ ИНТЕРПОЛЯЦИЯ*, *ПОЛИНОМИАЛЬНАЯ ИНТЕРПОЛЯЦИЯ*.
- **Диапазон подстановки отсутствующего значения**: — определяет, применяется ли подстановка значений только к диапазону дат каждого отдельного атрибута или ко всему набору данных. Доступны следующие параметры для задания диапазона дат, используемого системой при заполнении пропусков в исторических данных:

    - *GLOBAL* — система использует полный диапазон дат атрибутов детализации.
    - *HISTORY_DATE_RANGE* — система использует конкретный диапазон дат, определяемый полями **Начальная дата** и **Конечная дата** в разделе **Исторический горизонт** в диалоговом окне **Сгенерировать статистический базовый прогноз**.
    - *GRANULARITY_ATTRIBUTE* — система использует диапазон дат в обрабатываемом в данный момент атрибуте детализации.

    > [!NOTE]
    > Атрибут детализации представляет собой комбинацию аналитик прогноза, по которым выполняется прогноз. Можно определить аналитики прогноза на странице **Параметры прогнозирования спроса**.

- **Подсказка сезонности**: — для сезонных данных введите подсказку для модели прогнозирования, чтобы повысить точность прогноза. Формат: целое число, представляющее количество сегментов, через которое повторяется схема спроса. Например, введите *6* для данных, которые повторяются каждые шесть месяцев.
- **Размер тестового набора в процентах**: — процент исторических данных для использования в качестве тестового набора при расчете точности прогноза.

Значения этих параметров можно перезаписать путем перехода к **Сводное планирование \> Настройка \> Прогнозирование спроса \> Параметры прогнозирования спроса**. На странице **Параметры прогнозирования спроса** можно переопределить параметры следующими способами:

- Вкладка **Общие** используется для глобального переопределения параметров.
- Вкладка **Ключи распределения номенклатур** предназначена для переопределения параметров для конкретных ключей распределения номенклатур. Параметры, которые переопределены для конкретного ключа распределения номенклатур, влияют только на прогноз номенклатур, которые связаны с ключом.

> [!NOTE]
> На странице **Параметры алгоритма прогнозирования** можно использовать кнопки на панели операций для добавления параметров в список или удаления параметров из списка. Однако обычно не следует изменять использовать такой подход, если только вы не настроили эксперимент в машинном обучении Azure.

## <a name="set-up-the-azure-machine-learning-service"></a><a name="setup-amls"></a>Настройка службы машинного обучения Azure

Supply Chain Management рассчитывает прогнозы спроса с помощью службы машинного обучения Azure, которую необходимо настроить и выполнить для вашей собственной подписки Azure. В этом разделе описывается, как настроить службу машинного обучения Azure в Azure и затем подключить ее к среде Supply Chain Management.

### <a name="enable-the-azure-machine-learning-service-in-feature-management"></a>Включение службы машинного обучения Azure в управлении функциями

Прежде чем можно будет использовать службу машинного обучения Azure для прогнозирования спроса, необходимо включить функцию в Supply Chain Management, чтобы включить интеграцию. Администраторы могут использовать параметры [управления компонентами](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) для проверки статуса функции и ее включения. В рабочей области **Управление функциями** эта функция перечисляется следующими способами:

- **Модуль:** *Сводное планирование*
- **Имя функции:** *Служба машинного обучения Azure для прогнозирования спроса*

### <a name="set-up-machine-learning-in-azure"></a><a name="ml-workspace"></a>Настройка машинного обучения в Azure

Чтобы включить в Azure использование машинного обучения для обработки прогнозов, необходимо настроить рабочую область машинного обучения Azure для этой цели. Имеется два варианта:

- Чтобы настроить рабочую область, выполнив сценарий, предоставляемый корпорацией Microsoft, следуйте указаниям, приведенным в разделе [Вариант 1: запуск сценария для автоматической настройки рабочей области машинного обучения](#ml-workspace-script), затем переходите к разделу [Настройка параметров подключения к службе машинного обучения Azure в Supply Chain Management](#demand-forecast-parameters).
- Чтобы вручную настроить вашу рабочую область, следуйте указаниям, приведенным в разделе [Вариант 2: настройка рабочей области машинного обучения вручную](#ml-workspace-manual), затем переходите к разделу [Настройка параметров подключения к службе машинного обучения Azure в Supply Chain Management](#demand-forecast-parameters). Этот вариант занимает больше времени, но обеспечивает больший контроль.

#### <a name="option-1-run-a-script-to-automatically-set-up-your-machine-learning-workspace"></a><a name="ml-workspace-script"></a>Вариант 1: выполнение сценария для автоматической настройки рабочей области машинного обучения

В этом разделе описывается, как настроить рабочую область машинного обучения с помощью автоматизированного сценария, предоставляемого корпорацией Майкрософт. При желании все ресурсы можно настроить вручную, следуя указаниям из раздела [Вариант 2: настройка рабочей области машинного обучения вручную](#ml-workspace-manual). Выполнять оба эти варианта не требуется.

1. В GitHub откройте репозиторий (репо) [Шаблоны для прогнозирования спроса Dynamics 365 Supply Chain Management с помощью машинного обучения Azure](https://github.com/microsoft/Dynamics-365-Supply-Chain-Management-Demand-Forecasting-With-Azure-Machine-Learning-Service) и загрузите следующие файлы:

    - quick_setup.ps1
    - sampleInput.csv
    - src/parameters.py
    - src/api_trigger.py
    - src/run.py
    - src/REntryScript/forecast.r

1. Откройте окно PowerShell и запустите сценарий **quick_setup.ps1**, загруженный на предыдущем шаге. Следуйте инструкциям на экране. Сценарий настроит требуемую рабочую область, хранилище, хранилище данных по умолчанию и вычислительные ресурсы. Однако все же необходимо создать требуемые конвейеры, выполнив оставшиеся шаги этой процедуры. (Конвейеры обеспечивают способ запуска сценариев прогнозирования из Supply Chain Management.)
1. В студии машинного обучения Azure отправьте файл **sampleInput.csv**, загруженный на шаге 1, в контейнер с именем *demplan-azureml*. (Этот контейнер создан с помощью сценария quick_setup.ps1.) Этот файл необходим для публикации конвейера и создания тестового прогноза. Инструкции см. в разделе [Отправка блочного BLOB-объекта](/azure/storage/blobs/storage-quickstart-blobs-portal#upload-a-block-blob).
1. В студии машинного обучения Azure выберите **Записные книжки** в навигаторе.
1. В структуре **Файлы** найдите следующую папку: **Пользователи/\[текущийпользователь\]/src**.
1. Отправьте оставшиеся четыре файла, загруженные на шаге 1, в местоположение, найденное на предыдущем шаге.
1. Выберите только что отправленный файл **api_trigger.py** и выполните его. Он создаст конвейер, который может быть запущен через API-интерфейс.
1. Рабочая область теперь настроена. Переходите дальше к разделу [Настройка параметров подключения к службе машинного обучения Azure в Supply Chain Management](#demand-forecast-parameters).

#### <a name="option-2-manually-set-up-your-machine-learning-workspace"></a><a name="ml-workspace-manual"></a>Вариант 2: настройка рабочей области машинного обучения вручную

В этом разделе описывается, как вручную настроить рабочую область машинного обучения. Процедуры, описанные в этом разделе, необходимо выполнить только в том случае, если вы решили не выполнять сценарий автоматической настройки, как описано в разделе [Вариант 1: выполнение сценария для автоматической настройки рабочей области машинного обучения](#ml-workspace-script).

##### <a name="step-1-create-a-new-workspace"></a><a name="create-workspace"></a>Шаг 1. Создайте новую рабочую область

Используйте следующую процедуру, чтобы создать новую рабочую область машинного обучения.

1. Выполните вход на ваш портал Azure.
1. Откройте службу **Машинное обучение**.
1. Выберите **Создать** на панели инструментов, чтобы открыть мастер **Создать**.
1. Выполните мастер, следуя инструкциям на экране. При работе необходимо учитывать следующие моменты:

    - Используйте настройки по умолчанию, если в других местах этого списка не рекомендуются другие параметры.
    - Убедитесь, что выбрана географическая область, соответствующая региону, в которой развернут ваш экземпляр Supply Chain Management. В противном случае некоторые данные могут переходить через границы регионов. Дополнительные сведения см. в [уведомлении о конфиденциальности](#privacy) далее в этой теме.
    - Используйте выделенные ресурсы, такие как группы ресурсов, учетные записи хранения, контейнерные реестры, хранилища ключей Azure и сетевые ресурсы.
    - На странице **Настройка параметров подключения к службе машинного обучения Azure** в мастере необходимо указать имя учетной записи хранения. Используйте учетную запись, которая предназначена для прогнозирования спроса. Входные и выходные данные прогнозирования спроса будут храниться в этой учетной записи хранения.

Дополнительные сведения см. в разделе [Создание рабочей области](/azure/machine-learning/quickstart-create-resources#create-the-workspace).

##### <a name="step-2-configure-storage"></a><a name="config-storage"></a>Шаг 2. Настройка хранилища

Для настройки вашего хранилища используется следующая процедура.

1. В GitHub откройте репозиторий (репо) [Шаблоны для прогнозирования спроса Dynamics 365 Supply Chain Management с помощью машинного обучения Azure](https://github.com/microsoft/Dynamics-365-Supply-Chain-Management-Demand-Forecasting-With-Azure-Machine-Learning-Service) и загрузите файл **sampleInput.csv**.
1. Откройте учетную запись хранения, созданную в разделе [Шаг 1. Создание новой рабочей области](#create-workspace).
1. Следуйте инструкциям в разделе [Создание контейнера](/azure/storage/blobs/storage-quickstart-blobs-portal#create-a-container), чтобы создать контейнер с именем *demplan-azureml*.
1. Отправьте файл **sampleInput.csv**, загруженный на шаге 1, в только что созданный контейнер. Этот файл необходим для публикации конвейера и создания тестового прогноза. Инструкции см. в разделе [Отправка блочного BLOB-объекта](/azure/storage/blobs/storage-quickstart-blobs-portal#upload-a-block-blob).

##### <a name="step-3-configure-a-default-datastore"></a>Шаг 3. Настройка хранилища данных по умолчанию

Для настройки вашего хранилища данных по умолчанию используется следующая процедура.

1. В студии машинного обучения Azure выберите **Хранилища данных** в навигаторе.
1. Создайте новое хранилище данных типа *Хранилище BLOB-объектов Azure*, которое указывает на контейнер хранилища больших двоичных объектов *demplan-azureml*, созданный в разделе [Шаг 2. Настройка хранилища](#config-storage). (Если для нового хранилища данных используется тип проверки подлинности *Ключ учетной записи*, предоставьте ключ учетной записи для созданной учетной записи хранения. Инструкции см. в разделе [Управление ключами доступа к учетным записям хранения](/azure/storage/common/storage-account-keys-manage?tabs=azure-portal).)
1. Сделайте новое хранилище данных хранилищем данных по умолчанию, открыв его детали и выбрав **Установить в качестве хранилища данных по умолчанию**.

##### <a name="step-4-configure-compute-resources"></a><a name="config-compute-resources"></a>Шаг 4. Настройка вычислительных ресурсов

Используйте следующую процедуру, чтобы настроить вычислительный ресурс в студии машинного обучения Azure для выполнения сценариев создания прогнозов.

1. Откройте страницу сведений о рабочей области машинного обучения, созданной в разделе [Шаг 1. Создание новой рабочей области](#create-workspace). Найдите значение **URL-адрес студии** и выберите ссылку, чтобы открыть ее.
1. Выберите **Вычисление** на панели навигации.
1. На вкладке **Вычислительный экземпляр** выберите **Создать**, чтобы открыть мастер, который поможет создать новый вычислительный экземпляр. Следуйте инструкциям на экране. Вычислительный экземпляр будет использоваться для создания конвейера прогнозирования спроса (он может быть удален после публикации конвейера). Используйте настройки по умолчанию.
1. На вкладке **Вычислительные кластеры** выберите **Создать**, чтобы открыть мастер, который поможет создать новый вычислительный кластер. Следуйте инструкциям на экране. Вычислительный кластер будет использоваться для создания прогнозов спроса. Его параметры влияют на производительность и максимальный уровень параллелизма выполнения. Установите следующие поля, но используйте настройки по умолчанию для всех остальных полей:

    - **Имя** — введите *e2ecpucluster*.
    - **Размер виртуальной машины** — настройте этот параметр в соответствии с объемом данных, который предполагается использовать в качестве входных данных для прогнозирования спроса. Количество узлов не должно превышать 11, поскольку один узел требуется для запуска создания прогноза спроса, а максимальное число узлов, которое затем может быть использовано для создания прогноза, равно 10. (Вы также зададите число узлов в файле parameters.py в разделе [Шаг 5. Создание конвейеров](#create-pipelines).) На каждом узле будет несколько рабочих процессов, которые параллельно выполняют сценарии прогнозирования. Общее число рабочих процессов в задании будет *Количество ядер, имеющихся на узле* × *Число узлов*. Например, если вычислительный кластер имеет тип *Standard\_D4* (восемь ядер) и максимум 11 узлов, и если значение `nodes_count` равно *10* в файле parameters.py, эффективный уровень параллелизма равен 80.

##### <a name="step-5-create-pipelines"></a><a name="create-pipelines"></a>Шаг 5. Создание конвейеров

Конвейеры обеспечивают способ запуска сценариев прогнозирования из Supply Chain Management. Следующая процедура используется для создания требуемых конвейеров.

1. В GitHub откройте репозиторий [Шаблоны для прогнозирования спроса Dynamics 365 Supply Chain Management с помощью машинного обучения Azure](https://github.com/microsoft/Dynamics-365-Supply-Chain-Management-Demand-Forecasting-With-Azure-Machine-Learning-Service) и загрузите следующие файлы:

    - src/parameters.py
    - src/api_trigger.py
    - src/run.py
    - src/REntryScript/forecast.r

1. В студии машинного обучения Azure выберите **Записные книжки** в навигаторе.
1. В структуре **Файлы** найдите следующую папку: **Пользователи/\[текущийпользователь\]/src**.
1. Отправьте четыре файла, загруженные на шаге 1, в местоположение, найденное на предыдущем шаге.
1. В Azure откройте и просмотрите только что отправленный файл **parameters.py**. Убедитесь, что значение `nodes_count` на единицу меньше значения, настроенного для вычислительного кластера в разделе [Шаг 4. Настройка вычислительных ресурсов](#config-compute-resources). Если значение `nodes_count` больше или равно числу узлов в вычислительном кластере, запуск конвейера может быть возможен. Однако он затем перестает отвечать на запросы, ожидая необходимых ресурсов. Дополнительные сведения о числе узлов см. в разделе [Шаг 4. Настройка вычислительных ресурсов](#config-compute-resources).
1. Выберите только что отправленный файл **api_trigger.py** и выполните его. Он создаст конвейер, который может быть запущен через API-интерфейс.

### <a name="set-up-a-new-active-directory-application"></a><a name="aad-app"></a>Настройка нового приложения Active Directory

Приложение Active Directory требуется для проверки подлинности с ресурсами, выделенными для прогнозирования спроса с помощью субъекта-службы. Поэтому приложение должно иметь самый низкий уровень привилегий, который требуется для создания прогноза.

1. Выполните вход на ваш портал Azure.
1. Зарегистрируйте новое приложение в клиенте Azure Active Directory (Azure AD). Инструкции см. в разделе [Использование портала для создания приложения Azure AD и субъекта-службы, которые имеют доступ к ресурсам](/azure/active-directory/develop/howto-create-service-principal-portal).
1. Следуйте инструкциям на экране по мере выполнения мастера. Используйте параметры по умолчанию.
1. Предоставьте новому приложению Active Directory доступ к следующим ресурсам, созданным в разделе [Настройка машинного обучения в Azure](#ml-workspace). Инструкции см. в разделе [Назначение ролей Azure с помощью портала Azure](/azure/role-based-access-control/role-assignments-portal?tabs=current). Этот шаг позволит системе импортировать и экспортировать данные прогноза и запустить выполнение конвейера машинного обучения из Supply Chain Management.

    - Роль участника в рабочей области машинного обучения
    - Роль участника для выделенной учетной записи хранения
    - Роль участника данных хранилища BLOB-объектов для выделенной учетной записи хранения

1. В разделе **Сертификаты и секреты** созданного приложения создайте секрет для приложения. Инструкции см. в разделе [Добавление секрета клиента](/azure/active-directory/develop/quickstart-register-app#add-a-client-secret).
1. Запишите идентификатор приложения и его секрет. Сведения этого приложения потребуются позже при настройке страницы **Параметры прогнозирования спроса** в Supply Chain Management.

### <a name="set-up-azure-machine-learning-service-connection-parameters-in-supply-chain-management"></a><a name="demand-forecast-parameters"></a>Настройка параметров подключения к службе машинного обучения Azure в Supply Chain Management

Используйте следующую процедуру для подключения среды Supply Chain Management к службе машинного обучения, которую вы только что настроили в Azure.

1. Войдите в Supply Chain Management.
1. Перейдите в раздел **Сводное планирование \> Настройка \> Прогнозирование спроса \> Параметры прогнозирования спроса**.
1. На вкладке **Общие** убедитесь, что в поле **Стратегия создания прогноза** указано значение *Служба машинного обучения Azure*.
1. На вкладке **Ключи распределения номенклатур** убедитесь, что в поле **Стратегия создания прогноза** установлена *Служба машинного обучения Azure* для каждого ключа распределения, который должен использовать службу машинного обучения Azure для прогнозирования спроса.
1. На вкладке **Служба машинного обучения Azure** настройте следующие поля:

    - **Код арендатора** — введите идентификатор вашего клиента Azure. Supply Chain Management будет использовать этот идентификатор для проверки подлинности в службе машинного обучения Azure. Идентификатор клиента можно найти на странице **Обзор** для Azure AD на портале Azure.
    - **Код приложения субъекта-службы** — введите код приложения для приложения, созданного в разделе [Приложение Active Directory](#aad-app). Это значение используется для авторизации запросов API к службе машинного обучения Azure.
    - **Секрет субъекта-службы** — введите секрет приложения субъекта-службы для приложения, созданного в разделе [Приложение Active Directory](#aad-app). Это значение используется для получения маркера доступа для участника безопасности, созданного для выполнения авторизованных операций в отношении хранилища Azure и рабочей области машинного языка Azure.
    - **Имя учетной записи хранения** — введите имя учетной записи хранения Azure, указанное при запуске мастера установки в рабочей области Azure. (Дополнительные сведения см. в разделе [Настройка машинного обучения в Azure](#ml-workspace).)
    - **Адрес конечной точки конвейера** — введите URL-адрес конечной точки конвейера REST для вашей службы машинного обучения Azure. Вы создали этот конвейер в качестве последнего шага при [настройке машинного обучения в Azure](#ml-workspace). Чтобы получить URL-адрес конвейера, выполните вход на портал Azure, выберите **Конвейеры** в области переходов. На вкладке **Конвейер** выберите конечную точку конвейера с именем **TriggerDemandForecastGeneration**. Затем скопируйте показанную конечную точку REST.

    ![Параметры на вкладке службы машинного обучения Azure страницы параметров прогнозирования спроса.](media/azure-ml-service-parameters.png "Параметры на вкладке службы машинного обучения Azure страницы параметров прогнозирования спроса")

## <a name="privacy-notice"></a><a name="privacy"></a>Уведомление о конфиденциальности

При выборе варианта *Служба машинного обучения Azure* в качестве стратегии создания прогнозов Supply Chain Management автоматически отправляет данные клиентов для исторического спроса, такие как агрегированные количества, названия продуктов и их аналитики продукта, местоположения отгрузки и приемки, идентификаторы клиентов, а также параметры прогноза, в географический регион, где размещена рабочая область машинного обучения и связанная учетная запись хранения для целей прогнозирования будущего спроса. Служба машинного обучения Azure может находиться в регионе, отличном от географического региона, в котором развернуто приложение Supply Chain Management. Некоторые пользователи могут управлять тем, включены ли эти функции, выбирая стратегию создания прогноза на странице **Параметры прогнозирования спроса**.

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Обзор прогнозирования спроса](introduction-demand-forecasting.md)
- [Создание статистического базового прогноза](generate-statistical-baseline-forecast.md)
- [Внесение ручных корректировок в базовый прогноз](manual-adjustments-baseline-forecast.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
