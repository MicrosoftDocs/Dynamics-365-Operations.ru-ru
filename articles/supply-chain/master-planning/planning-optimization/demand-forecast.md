---
title: Сводное планирование с прогнозами спроса
description: В этой теме объясняется, как включать прогнозы спроса при сводном планировании с оптимизацией планирования.
author: ChristianRytt
manager: tfehr
ms.date: 12/02/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: MpsIntegrationParameters, MpsFitAnalysis
audience: Application User
ms.reviewer: kamaybac
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Manufacturing
ms.author: crytt
ms.search.validFrom: 2020-12-02
ms.dyn365.ops.version: AX 10.0.13
ms.openlocfilehash: cb696c365e02ab3e3b28da19b8b33f1975c142f8
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "4983552"
---
# <a name="master-planning-with-demand-forecasts"></a>Сводное планирование с прогнозами спроса

[!include [banner](../../includes/banner.md)]

Можно использовать прогноз спроса вместе с оптимизацией планирования, чтобы учитывать ожидаемый спрос в сводном планировании. Можно вручную создать прогноз спроса, импортировать его или создать его с помощью функции прогнозирования спроса в Microsoft Dynamics 365 Supply Chain Management. Дополнительные сведения о прогнозировании спроса см. в разделе [Обзор прогнозирования спроса](../introduction-demand-forecasting.md).

> [!NOTE]
> Отдельное прогнозное планирование не поддерживается с оптимизацией планирования. Поэтому параметр **Текущий прогнозный план** на странице **Параметры сводного планирования** не действует при использовании оптимизации планирования.

## <a name="set-up-a-master-plan-to-include-a-demand-forecast"></a>Настройка сводного плана для включения прогноза спроса

Чтобы настроить сводный план так, чтобы он включал прогноз спроса, выполните следующие действия.

1. Выберите **Сводное планирование \> Настройка \> Планы \> Сводные планы**.
1. Выберите существующий план или создайте новый план.
1. На экспресс-вкладке **Общие** настройте следующие поля:

    - **Прогнозная модель** — выберите прогнозную модель для применения. Эта модель будет учитываться при создании предложений поставки для текущего сводного плана.
    - **Включить прогноз спроса** — установите для этого параметра значение *Да*, чтобы включить прогноз спроса в текущий сводный план. Если задать для него значение *Нет*, проводки прогноза спроса не включаются в сводный план.
    - **Метод, используемый для сокращения потребностей по прогнозу** — выберите метод, который должен использоваться для снижения требований прогноза. Дополнительные сведения см. в разделе [Ключи сокращение прогноза](#reduction-keys) далее в этой теме.

1. На экспресс-вкладке **Временная граница в днях** можно настроить следующие поля, чтобы указать период, в течение которого включается прогноз спроса:

    - **Прогнозный план** — установите этот параметр в значение *Да*, чтобы переопределить временную границу прогнозного плана, созданную на основе отдельных групп покрытия. Установите для этого параметра значение *Нет*, чтобы использовать значения из отдельных групп покрытия для текущего сводного плана.
    - **Период времени прогноза** — если для параметра **Прогнозный план** установлено значение *Да*, укажите количество дней (начиная с сегодняшней даты), к которым должен применяться прогноз спроса.

    > [!IMPORTANT]
    > Параметр **Прогнозный план** еще не поддерживается с оптимизацией планирования.

## <a name="set-up-a-coverage-group-to-include-a-demand-forecast"></a>Настройка группы покрытия для включения прогноза спроса

Чтобы настроить группу покрытия так, чтобы она включала прогноз спроса, выполните следующие действия.

1. Выберите **Сводное планирование \> Настройка \> Планы \> Группы покрытия**.
1. Выберите существующую группу покрытия или создайте новую группу.
1. На экспресс-вкладке **Прочие** настройте следующие поля:

    - **Временная граница прогнозного плана** — введите количество дней (начиная с сегодняшней даты), для которого должен применяться прогноз спроса. Это значение может быть переопределено с помощью параметра **Прогнозный план** в сводном плане, как описано в предыдущем разделе.
    - **Ключ сокращения** — выберите применяемый ключ сокращения. Дополнительные сведения см. в разделах [Создание и настройка ключа сокращения прогнозов](#create-reduction-key) и [Использование ключа сокращения](#use-reduction-key) далее в этой теме.
    - **Уменьшить прогноза на** — для сводных планов, в которых в поле **Метод, используемый для сокращения потребностей по прогнозу** задано значение *Проводки — ключ сокращения* или *Проводки — динамический период*, укажите, какие проводки должны уменьшать прогноз. Выберите одно из следующих значений:

        - **Все проводки** — все проводки должны уменьшать прогноз.
        - **Заказы** — сокращение прогноза только по заказам на продажу.

        > [!NOTE]
        > Если выбрать *Все проводки*, проводки, имеющие как спрос, так и поставки в одну и ту же складскую аналитику, считаются нейтральными и не учитываются во время снижения прогноза. Например, если аналитика планирования задана только для сайта, не для склада, заказ на перемещение между сайтом 1, склад 11, и сайтом 1, склад 13, будет проигнорирован и не снизит прогноз остатка спроса.

    - **Включить внутрихолдинговые заказы** — установите для этого параметра значение *Да*, если при уменьшении прогноза должны включаться внутрихолдинговые заказы. В противном случае задайте для него значение *Нет*.
    - **Включить прогноз клиента в прогноз спроса** — укажите, следует ли включать прогноз клиента в общий прогноз. Этот параметр определяет, как фактический спрос уменьшает прогнозируемый спрос. Его можно использовать, чтобы гарантировать, что в сводное планирование будут включены поставки номенклатур, приобретенных конкретными клиентами.

        - Установите для этого параметра значение *Да*, чтобы включить прогноз клиента в общий прогноз. В этом случае фактический спрос клиента уменьшает и прогноз клиента, и общий прогноз. При сводном планировании создаются спланированные заказы, чтобы удовлетворить только общее прогнозируемое количество.
        - Установите для этого параметра значение *Нет*, если вы не хотите включать прогноз клиента в общий прогноз. В этом случае фактический спрос клиента уменьшает только прогноз клиента. При сводном планировании создаются спланированные заказы, чтобы удовлетворить и общее прогнозное количество, и количество для каждого прогноза клиента.

## <a name="forecast-reduction-keys"></a><a name="reduction-keys"></a>Ключи сокращение прогноза

В этом разделе приводятся сведения о различных методах, используемых для снижения требований прогноза. Он включает примеры результатов каждого метода. В нем также описываются способы создания, настройки и использования ключа сокращения прогноза. В некоторых методах используется ключ сокращения прогноза для снижения требований прогноза.

### <a name="methods-that-are-used-to-reduce-forecast-requirements"></a>Методы, используемые для сокращения потребностей по прогнозу

При включении прогноза в сводный план можно выбрать, как требования прогноза уменьшаются при включении фактического спроса. Обратите внимание, что сводное планирование не включает прогнозных требований из прошлого, то есть все требования прогноза до сегодняшней даты.

Чтобы включить прогноз в сводный план и выбрать метод, который используется для снижения требований прогноза, выберите **Сводное планирование \> Настройка \> Планы \> Сводные планы**. В поле **Прогнозная модель** выберите прогнозную модель. В поле **Метод, используемый для сокращения потребностей по прогнозу** выберите метод. Имеются следующие варианты:

- Не допускается
- Процент — ключ сокращения
- Проводки — ключ сокращения (еще не поддерживается с оптимизацией планирования)
- Проводки — динамический период

В следующих разделах приведены дополнительные сведения о каждом из параметров.

#### <a name="none"></a>Нет

Если выбрать **Нет**, требования к прогнозу во время сводного планирования уменьшаться не будут. В этом случае сводное планирование создает спланированные заказы на поставку планируемого спроса (прогноз требований). Эти спланированные заказы поддерживают предлагаемое количество, независимо от других типов спроса. Например, если заказы на продажу размещены, сводное планирование создает дополнительные спланированные заказы для поставки для заказов на продажу. Количество прогнозируемых требований не уменьшается.

#### <a name="percent--reduction-key"></a>Процент — ключ сокращения

Если выбрать **Процент — ключ сокращения**, требования к прогнозу снижаются в соответствии с процентами и периодами, определенными ключом сокращения. В этом случае сводное планирование создает спланированные заказы, в которых количество рассчитывается как прогнозируемое количество × ключ сокращения в каждом периоде. Если существуют другие типы спроса, сводное планирование также создает спланированные заказы, чтобы покрыть этот спрос.

##### <a name="example-percent--reduction-key"></a>Пример. Процент — ключ сокращения

В этом примере показано, как ключ сокращения уменьшает требования к прогнозу спроса в соответствии с процентами и периодами, определенными ключом сокращения.

В данном примере вы включаете следующий прогноз спроса в сводный план.

| Месяц    | Прогноз спроса |
|----------|-----------------|
| января  | 1000           |
| февраля | 1000           |
| марта    | 1000           |
| апреля    | 1000           |

На странице **Ключи сокращения** настраиваются следующие строки.

| Изменение | Ед. изм.  | Процент |
|--------|-------|---------|
| 1      | Месяц | 100     |
| 2      | Месяц | 75      |
| 3      | Месяц | 50      |
| 4      | Месяц | 25      |

Назначьте ключ сокращения группе покрытия номенклатуры. Затем на странице **Сводные планы** в поле **Метод, используемый для сокращения потребностей по прогнозу**, выберите **Процент - ключ сокращения**.

В этом случае если начать прогнозное планирование 1-го января, требования к прогнозу спроса используются в соответствии с процентами, которые настроены на странице **Ключи сокращения**. Следующие требуемые количества передаются в сводный план.

| Месяц                | Количество спланированного заказа | Расчет    |
|----------------------|------------------------|----------------|
| января              | 0                      | = 0% × 1 000   |
| февраля             | 250                    | = 25% × 1 000  |
| марта                | 500                    | = 50% × 1 000  |
| апреля                | 750                    | = 75% × 1 000  |
| Май – декабрь | 1000                  | = 100% × 1 000 |

#### <a name="transactions--reduction-key"></a>Проводки — ключ сокращения

Если выбрать **Проводки — ключ сокращения**, требования к прогнозу снижаются по проводкам, которые имеют место во время временных периодов, определяемых ключом сокращения.

##### <a name="example-transactions--reduction-key"></a>Пример. Проводки — ключ сокращения

В этом примере показано, как фактические заказы, которые возникают в течение периодов, которые определены ключом сокращения, уменьшают требования к прогнозу спроса.

В этом примере выберите **Проводки — ключ сокращения** в поле **Метод, используемый для сокращения потребностей** на странице **Сводные планы**.

На 1 января существуют следующие заказы.

| Месяц    | Количество заказанных единиц |
|----------|--------------------------|
| Январь  | 956                      |
| Февраль | 1 176                    |
| Март    | 451                      |
| Апрель    | 119                      |

Если использовать тот же самый прогноз спроса на 1 000 шт. в месяц, который использовался в предыдущем примере, в сводный план попадут следующие требуемые количества.

| Месяц                | Необходимое количество фрагментов |
|----------------------|---------------------------|
| Январь              | 44                        |
| февраля             | 0                         |
| марта                | 549                       |
| апреля                | 881                       |
| Май – декабрь | 1000                     |

#### <a name="transactions--dynamic-period"></a>Проводки — динамический период

При выборе **Проводки - динамический период** требования прогноза уменьшаются на фактические проводки заказов, которые возникают в динамический период. Динамический период охватывает даты текущего прогноза и заканчивается в начале следующего прогноза. В этом случае сводное планирование создает спланированные заказы на поставку планируемого спроса (прогноз требований). Тем не менее при размещении фактических проводок заказов прогнозные требования уменьшаются. Фактические проводки потребляют часть требований прогноза.

Когда используется этот вариант, поведение будет следующим:

- Ключи сокращения не требуются или не используются. 
- Если прогноз полностью уменьшен, требования прогноза для текущего прогноза будут равно 0 (нулю).
- Если будущие прогнозы отсутствуют, сокращаются прогнозируемые требования из последнего введенного прогноза.
- Временные границы включаются в расчеты уменьшения прогноза.
- Положительные дни включаются в расчеты уменьшения прогноза.
- Если фактические проводки по заказам превышают прогнозированные требования, то остальные проводки не передаются в следующий период прогноза.

##### <a name="example-1-transactions--dynamic-period"></a>Пример 1. Проводки — динамический период

Ниже приведен простой пример, показывающий, как работает метод **Проводки - динамический период**.

В данном примере вы включаете следующий прогноз спроса в сводный план.

| Дата       | Прогноз спроса |
|------------|-----------------|
| 1 января  | 1000           |
| 1 февраля | 1000             |

Можно также создать следующие заказы на продажу.

| Дата        | Количество заказа на продажу |
|-------------|----------------------|
| 15 января  | 200                  |
| 15 февраля | 400                  |

В этом случае создаются следующие спланированные заказы.

| Дата прогноза спроса | Количество | Пояснение                           |
|--------------------- |----------|---------------------------------------|
| 1 января            | 800      | Требования прогноза (= 1 000 – 200) |
| 15 января           | 200      | Требования по заказам на продажу             |
| 1 февраля           | 600      | Требования прогноза (= 1 000 – 400) |
| 15 февраля          | 400      | Требования по заказам на продажу             |

##### <a name="example-2-transactions--dynamic-period"></a>Пример 2. Проводки — динамический период

В большинстве случаев системы настроены так, что проводки уменьшают прогноз спроса в определенных периодах прогноза: недели, месяцы и так далее. Эти периоды определены в ключе сокращения. Однако время между двумя строками прогноза спроса также может *подразумевать* период.

Для этого примере создайте прогноз спроса для следующих дат и количеств.

| Дата       | Прогноз спроса |
|------------|-----------------|
| 1 января  | 1000           |
| 5 января  | 500             |
| 12 января | 1000           |

Обратите внимание, что в этом прогнозе не существует чистого периода между датами прогноза. Между первой и второй датами имеется диапазон четыре дня, а между второй и третьей датами имеется диапазон семь дней. Эти диапазоны представляют собой динамические периоды.

Можно также создать следующие строки заказа на продажу.

| Дата                             | Количество заказа на продажу |
|----------------------------------|----------------------|
| 15-е декабря предыдущего года | 500                  |
| 3 января                        | 100                  |
| 10 января                       | 200                  |

В этом случае прогноз уменьшается следующим образом:

- Поскольку первый заказ на продажу не входит ни в один из периодов, он не уменьшает никакой прогноз.
- Поскольку второй заказ на продажу лежит между 1 января и 5 января, он уменьшит прогноз на 1-е января на 100.
- Поскольку третий заказ на продажу лежит между 5 января и 12 января, он уменьшит прогноз на 5-е января на 200.

Таким образом, создаются следующие спланированные заказы.

| Дата прогноза спроса             | Количество | Пояснение                                                         |
|----------------------------------|----------|---------------------------------------------------------------------|
| 15-е декабря предыдущего года | 500      | Требования по заказу на продажу                                            |
| 1 января                        | 900      | Период потребностей по прогнозу с 1 января по 5 января (= 1 000 – 100) |
| 3 января                        | 100      | Требования по заказу на продажу                                            |
| 5 января                        | 300      | Период потребностей по прогнозу с 5 января по 10 января (= 500 – 200)  |
| 12 января                       | 1000    | Период потребностей по прогнозу с 12 января и до конца                      |

### <a name="create-and-set-up-a-forecast-reduction-key"></a><a name="create-reduction-key"></a>Создание и настройка ключа сокращения прогноза

Ключ сокращения прогноза используется в методах **Проводки - ключ сокращения** и **Процент - ключа сокращения** для сокращения требований прогноза. Выполните следующие действия для создания и настройки ключа сокращения.

1. Выберите **Сводное планирование \> Настройка \> Покрытие \> Ключи сокращения**.
2. Выберите **Создать** или нажмите **Ctrl+N** для создания ключа сокращения.
3. В поле **Ключ сокращения** введите уникальный идентификатор для ключа сокращения прогнозов. Затем в поле **Имя** введите имя. 
4. Определите периоды и процент ключа сокращения в каждый период:

    - Поле **Действует с** указывает дату начала создания периодов. Если для параметра **Использовать поле даты вступления в силу** задано значение **Да**, периоды начинаются с даты вступления в силу. Если он имеет значение **Нет**, периоды начинаются в день запуска сводного планирования.
    - Определите периоды, в которые должны происходить сокращение прогнозов.
    - Для определенного периода укажите проценты, на которые требования прогноза должны быть уменьшены. Можно ввести положительное значение, чтобы снизить требования, или отрицательные значения, чтобы увеличить требования.

### <a name="use-a-reduction-key"></a><a name="use-reduction-key"></a>Использование ключа сокращения

Ключ сокращения прогноза должен быть назначен группе покрытия номенклатуры. Выполните следующие действия, чтобы назначить ключ сокращения группе покрытия номенклатуры.

1. Выберите **Сводное планирование \> Настройка \> Покрытие \> Группы покрытия**.
2. На экспресс-вкладке **Прочее** в поле **Ключ сокращения** выберите ключ сокращения для назначения группе покрытия. Ключ сокращения затем применяется для всех номенклатур, относящихся к этой группе покрытия.
3. Для использования ключа сокращения в целях расчета прогнозного снижения во время сводного планирования необходимо указать значение этого параметра в настройке сводного плана или прогнозного плана. Перейдите в одно из следующих мест:

    - Сводное планирование \> Настройка \> Планы \> Прогнозные планы
    - Сводное планирование \> Настройка \> Планы \> Сводные планы

4. На странице **Прогнозные планы** или **Сводные планы** на экспресс-вкладке **Общие** в поле **Метод, используемый для сокращения потребностей по прогнозу** выберите **Процент - ключ сокращения** или **Проводки - ключ сокращения**.

### <a name="reduce-a-forecast-by-transactions"></a>Сокращение прогноза по проводкам

При выборе **Проводки - ключ сокращения** или **Проводки - динамический период** как метода уменьшения требований прогноза, можно указать, какие проводки снижают прогноз. На странице **Группы покрытия** на экспресс-вкладке **Прочее** в поле **Уменьшить прогноз по** выберите **Все проводки**, если все проводки должны снижать прогноз или **Заказы**, если только заказы на продажу должны снижать прогноз.
