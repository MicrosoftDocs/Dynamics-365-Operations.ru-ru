---
title: Сводное планирование с коммерческими соглашениями о покупке
description: В этом разделе описывается, как оптимизация планирования может найти поставщика и/или время упреждения для спланированного заказа на основе наилучшей цены или времени упреждения, которые находятся в коммерческих соглашениях о покупке.
author: ChristianRytt
manager: tfehr
ms.date: 06/29/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ReqCreatePlanWorkspace
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Manufacturing
ms.author: crytt
ms.search.validFrom: 2020-05-29
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: b302c5ace34a11a53a98c733b59633a11a463bfa
ms.sourcegitcommit: 3fa1e8583003a90ba486f757c3826b139e1b3f73
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/02/2020
ms.locfileid: "3421539"
---
# <a name="master-planning-with-purchase-trade-agreements"></a>Сводное планирование с коммерческими соглашениями о покупке

[!include [banner](../../includes/banner.md)]

В этом разделе описывается, как оптимизация планирования может найти поставщика и/или время упреждения для спланированного заказа на основе наилучшей цены или времени упреждения, которая найдена среди всех коммерческих соглашений о покупке, указанных для данного продукта.

## <a name="turn-on-the-purchase-trade-agreements-for-planning-optimization-feature"></a>Включение коммерческих соглашений о покупке для функции оптимизации планирования

Прежде чем использовать эту функцию, она должна быть включена в системе. Администраторы могут использовать рабочую область [Управление функциями](../../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) для проверки статуса функции и ее включения, если это требуется. В этом случае функция указана следующим образом:

- **Модуль:** *Сводное планирование*
- **Имя функции:** *Включение коммерческих соглашений о покупке для оптимизации планирования*

## <a name="prepare-your-system-to-evaluate-purchase-trade-agreements-during-master-planning"></a>Подготовка системы для оценки коммерческих соглашений о покупке при сводном планировании

Выполните следующие действия, чтобы настроить свою систему для применения оптимизации планирования, когда оцениваются коммерческие соглашения о покупке.

1. Перейдите в раздел **Сводное планирование \> Настройка \> Параметры сводного планирования**. На вкладке **Спланированные заказы** в разделе **Поставщик** установите следующие значения:

    - **Поиск коммерческих соглашений** — установите для этого параметра значение **Да**, чтобы включить коммерческие соглашения о покупке в сводное планирование.
    - **Критерий поиска** — выберите коэффициент, по которому необходимо установить приоритет для каждого коммерческого соглашения о покупке: **минимальное время упреждения** или **наименьшая цена ед. измерения**.

1. Перейдите в раздел **Закупки и источники \> Настройка \> Цены и скидки \> Активировать цену/скидку** и убедитесь, что для параметра **Поставщик** установлено значение **Да**.
1. Перейдите в раздел **Управление сведениями о продукте \> Настройка \> Группы аналитик и вариантов \> Группы аналитик хранения** и выберите группу аналитик хранения, которая применяется к продуктам, для которых сводное планирование должно оценивать коммерческие соглашения о покупке. Убедитесь, что для каждой соответствующей аналитике хранения в этой группе установлен флажок в столбце **Для закупочных цен**. Повторите этот шаг для всех других нужных групп аналитик хранения.

## <a name="prepare-a-released-product-to-evaluate-purchase-trade-agreements-during-master-planning"></a>Подготовка выпущенного продукта для оценки коммерческих соглашений о покупке при сводном планировании

После подготовки системы, как описано в предыдущем разделе, необходимо выполнить следующие действия, чтобы убедиться, что все продукты, которые предполагается использовать с этой функцией, правильно настроены.

1. Перейдите в раздел **Управление сведениями о продукте \> Продукты \> Выпущенные продукты** и откройте целевой продукт.
1. На экспресс-вкладке **Покупка** убедитесь, что в поле **Поставщик** не назначен поставщик.
1. В области действий на вкладке **План**, в группе **Покрытие**, выберите **Покрытие номенклатуры**, чтобы открыть страницу **Покрытие номенклатуры** для выбранного продукта. Проверьте следующие параметры:

    - На вкладке **Общие** можно настроить переопределения поставщика. Если необходимо, чтобы оптимизация планирования использовала коммерческие соглашения о покупке для выбора поставщика, следует запретить переопределения поставщика, убрав флажок **Использовать определенные параметры**.
    - На вкладке **Время упреждения** можно настроить переопределения времени упреждения. Если необходимо, чтобы оптимизация планирования использовала коммерческие соглашения о покупке для выбора времени упреждения, необходимо запретить переопределения времени упреждения. Снимите флажок для каждого типа времени упреждения, который необходимо выбрать с помощью коммерческих соглашений о покупке (**Покупка**, **Производство** и/или **Перемещение**).

1. Закройте страницу **Покрытие номенклатуры**, чтобы вернуться на страницу сведений о выбранном продукте.
1. На панели операций на вкладке **План** в группе **Прогноз** выберите **Прогноз поставки**, чтобы открыть страницу **Прогноз поставки**. Убедитесь, что ни одна показанная здесь строка не содержит значение в столбце **Счет поставщика**.
1. Закройте страницу **Прогноз поставки**, чтобы вернуться на страницу сведений о выбранном продукте.
1. В области действий на вкладке **Покупка** в группе **Коммерческие соглашения** выберите **Просмотр коммерческих соглашений**. Убедитесь, что в список включены все соответствующие коммерческие соглашения о покупке. Кроме того, убедитесь, что для параметра **Игнорировать время упреждения** установлено значение **Нет** для каждого соглашения, в котором оптимизация планирования должна использовать время упреждения, указанное для этого соглашения.
1. В области действий на вкладке **План**, в группе **Настройки заказа**, выберите **Параметры заказа по умолчанию**, чтобы открыть страницу **Параметры заказа по умолчанию** для выбранного продукта. На экспресс-вкладке **Заказ на покупку** просмотрите значение поля **Время упреждения покупки**. Если не определено переопределение времени упреждения покрытия номенклатуры, оптимизация планирования будет использовать это значение при выборе коммерческих соглашений, где для параметра **Игнорировать время упреждения** задано значение **Да**. Таким образом, это значение следует изменять по мере необходимости.
1. Повторите эту процедуру для каждого нужного продукта.

> [!NOTE]
> Валюта в строке коммерческого соглашения о покупке должна соответствовать валюте выбранного поставщика. Сводное планирование будет включать информацию только из строк коммерческого соглашения о покупке, в которых валюта совпадает с валютой, используемой поставщиком.

## <a name="examples-of-how-planning-optimization-finds-vendor-and-lead-times"></a>Примеры, как оптимизация планирования находит поставщика и время упреждения

В следующей таблице приводятся примеры, в которых показано, как различные настройки для выпущенного продукта и соответствующие коммерческие соглашения о покупке влияют на значения, найденные для результирующего спланированного заказа на покупку. **Полужирные** значения в двух крайних правых столбцах являются значениями, выбранными оптимизацией планирования. ***Полужирные и курсивные*** значения в других столбцах представляют собой настройки, в результате которых создаются результирующие значения для каждой строки.

| Выпущенный продукт: поставщик | Параметры заказа по умолчанию: время упреждения | Покрытие номенклатуры: переопределить поставщика | Покрытие номенклатуры: переопределить время упреждения | Коммерческое соглашение: поставщик | Коммерческое соглашение: время упреждения | Коммерческое соглашение: игнорировать время упреждения | Результирующий поставщик | Результирующее время упреждения |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ***US001*** | ***1*** | Нет | Нет | US003 | 3 | Нет | **US001** | **1** |
| US001 | 1 | ***Да: US002*** | ***Да: 2*** | US003 | 3 | Нет | **US002** | **2** |
| *(Пусто)* | 1 | Нет | Нет | ***US003*** | ***3*** | Нет | **US003** | **3** |
| *(Пусто)* | ***1*** | Нет | Нет | ***US003*** | 3 | Да | **US003** | **1** |
| *(Пусто)* | ***1*** | ***Да: US002*** | Нет | US003 | 3 | Нет | **US002** | **1** |
| *(Пусто)* | ***1*** | ***Да: US002*** | Нет | US003 | 3 | Нет | **US002** | **1** |
| *(Пусто)* | 1 | Нет | Да: 2 | ***US003*** | ***3*** | Нет | **US003** | **3** |
| *(Пусто)* | 1 | Нет | ***Да: 2*** | ***US003*** | 3 | Да | **US003** | **2** |

## <a name="additional-resources"></a>Дополнительные ресурсы

[Договоры покупки](../../procurement/purchase-agreements.md)
