---
title: Повышение производительности сводного планирования
description: В этом разделе описываются различные параметры, которые могут помочь улучшить производительность сводного планирования и устранения неполадок.
author: t-benebo
manager: AnnBe
ms.date: 05/31/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ReqCreatePlanWorkspace
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Manufacturing
ms.author: benebotg
ms.search.validFrom: 2019-05-31
ms.dyn365.ops.version: AX 10.0.0
ms.openlocfilehash: f0d075bbcc8a6671054f227a13c75ca7fb1e954f
ms.sourcegitcommit: 432481001b986b54937d423516efd8f2af1511d6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "1631551"
---
# <a name="improve-master-planning-performance"></a>Повышение производительности сводного планирования

[!include [banner](../includes/preview-banner.md)]
[!include [banner](../includes/banner.md)]

В этом разделе описываются различные параметры, которые могут помочь улучшить производительность сводного планирования и устранения неполадок. В нем содержатся сведения о параметрах и настройках, а также о рекомендуемых конфигурациях и действиях. Кроме того, в нем содержится сводка всех важных параметров, которые следует учитывать, когда выполняются продолжительные задания сводного планирования.

Этот раздел предназначен для администраторов системы или ИТ-пользователей, обладающих возможностью устранения неполадок Он также предназначен для планировщиков производства или поставок, поскольку включает информацию о параметрах, которые относятся к требованиям бизнес-планирования. 

## <a name="parameters-that-are-related-to-master-planning-performance"></a>Параметры, которые относятся к производительности сводного планирования

Различные параметры влияют на время выполнения сводного планирования и должны учитываться.

### <a name="number-of-threads"></a>Количество потоков

Параметр **Количество потоков** позволяет настроить процесс сводного планирования, чтобы он лучше работал с конкретным набором данных. В нем указывается общее число потоков, которые будут использоваться для выполнения сводного планирования. Это приводит к параллельному выполнению сводного планирования, и эта параллельное выполнение помогает уменьшить время выполнения. 

Параметр **Количество потоков** можно задать в диалоговом окне **Выполнение сводного планирования**. Чтобы открыть это диалоговое окно, перейдите к пункту **Сводное планирование \> Сводное планирование \> Выполнить \> Сводное планирование** или выберите команду **Выполнить** в рабочей области **Сводное планирование**. Чтобы определить оптимальное значение для этого параметра, необходимо полагаться на процесс проб и ошибок. Однако для расчета начального значения можно использовать следующие формулы:

- **Если ваша отрасль — производство**: Количество потоков = Количество спланированных заказов ÷ 1 000
- **В противном случае**: Количество потоков = Количество номенклатур ÷ 1 000

Число вспомогательных методов, используемых при сводном планировании, должно быть меньше или равно максимальному количеству потоков, разрешенных на сервере обработки пакетных заданий. Если количество вспомогательных методов превышает число потоков на сервере обработки пакетных заданий, дополнительные потоки не выполняют никаких действий.

> [!NOTE]
> Значение **0** (ноль) для параметра **Количество потоков** увеличивает время выполнения сводного планирования. Поэтому рекомендуется всегда задавать значение, большее 0.

### <a name="number-of-tasks-in-helper-task-bundle"></a>Число задач в наборе задач помощников

Изменяя параметр **Число задач в наборе задач помощников** (то есть, размер набора), можно уменьшить время выполнения. Этот параметр управляет количеством номенклатур, планируемых вместе одним помощником.

Можно задать параметр **Число задач в наборе задач помощников** в разделе **Производительность** на вкладке **Общее** на странице **Параметры сводного планирования** (**Сводное планирование \> Настройка \> Параметры сводного планирования**). Оптимальное значение для этого параметра зависит от данных. Поэтому рекомендуется начать со значения **1**, а затем воспользоваться процедурой проб и ошибок, чтобы определить наилучшее значение для вашей настройки.

В общем случае рекомендуется увеличивать число задач, когда количество номенклатур очень велико (сотни тысяч). В противном случае число задач должно быть уменьшено. В следующих конкретных отраслях рассматриваются следующие моменты:

- В отраслях розничной торговли и распределения, где имеется множество независимых номенклатур, используется множество помощников, поскольку отсутствует зависимость между номенклатурами. 
- В производственной отрасли, где имеется много спецификаций и общих подкомпонентов, используется меньшее число помощников, поскольку зависимости между номенклатурами могут вызывать время ожидания.

> [!TIP]
> Если имеются неполадки с производительностью, рекомендуется уменьшить значение параметра **Число задач в наборе задач помощников** до **1**. После этого можно запустить процесс проб и ошибок", чтобы найти наилучшее значение для настройки. В общем случае снижение производительности происходит, когда одна номенклатура обрабатывается дольше, чем остальные номенклатуры. В этом случае будет видно, что две последующие задачи, имеющие статус **Покрытия** в сводном планировании, будут иметь значительные разное время выполнения. В чрезвычайных случаях эта разница может достигать 30 минут. Время выполнения каждой задачи можно оценить, посмотрев длительность каждой задачи.

### <a name="use-of-cache"></a>Использование кэша

Параметр **Использование кэша** позволяет настроить процесс сводного планирования, чтобы он лучше работал с конкретным набором данных. Например, можно настроить его для достижения следующих результатов:

- Если выполняется больше кэширования, в памяти данных собираются дополнительные данные. Ожидается, что данные будут использоваться снова позже. Если данные находятся в памяти, можно сохранить некоторые запросы к базе данных. Однако если выполняется дополнительное кэширование, требования к памяти увеличиваются.
- Если выполняется меньшее количество кэширования, одни и те же данные более чаще извлекаться из базы данных. Кроме того, в течение всего процесса сервер Application Object Server (AOS) хранит мало данных в памяти.

Сложно предсказать, какой вариант будет лучше, поскольку каждый из вариантов зависит не только от данных, но и от оборудования. Например, поскольку уменьшение объема кэширования приводит к дополнительной нагрузке на сервер базы данных, то, вероятно, не рекомендуется использовать этот вариант, если сервер базы данных уже перегружен.

Можно задать параметр **Использовать кэш** в разделе **Производительность** на вкладке **Общее** на странице **Параметры сводного планирования** (**Сводное планирование \> Настройка \> Параметры сводного планирования**). Эффективность кэширования сильно зависит от данных клиента. Например, если кэшированные данные больше не потребуются, впустую затрачивается память, если данные будут храниться до завершения процесса планирования. В этом случае при уменьшении кэширования производительность может увеличиться, так как сервер AOS требует меньше памяти и ресурсы сервера освобождаются для других задач.

> [!TIP]
> В общем случае рекомендуется задать для параметра **Использовать кэш** значение **Максимум**, поскольку этот параметр предназначен для повышения производительности. Рекомендуется установить для параметра значение **Минимум**, если выполнение производится локально и доступна ограниченная память (приблизительно 2 гигабайта \[ГБ\]).

### <a name="number-of-orders-in-firming-bundle"></a>Количество заказов в наборе утверждения

Параметр **Количество заказов в наборе утверждения** указывает общее число заказов, которые будут обрабатываться в каждый момент времени каждым потоком или пакетом. Это приводит к параллельному выполнению процесса автоподтверждения.

Можно задать параметр **Количество заказов в наборе утверждения** в разделе **Производительность** на вкладке **Общее** на странице **Параметры сводного планирования** (**Сводное планирование \> Настройка \> Параметры сводного планирования**). Параллельное выполнение процесса автоподтверждения базируется на заказах, которые должны обрабатываться вместе. Таким образом, если этот параметр имеет значение, например, **50**, то каждый поток или пакетная задача будет комплектовать 50 заказов за один раз и обрабатывать их вместе. Для поиска наилучшего значения рекомендуется использовать процесс проб и ошибок. Однако для расчета начального значения можно использовать следующую формулу:

Количество заказов в наборе = Количество номенклатур спроса ÷ Количество потоков

> [!NOTE]
> Если для параметра **Количество заказов в наборе утверждения** задано значение **0** (ноль), параллельный процесс автоматического подтверждения не выполняется. Весь процесс будет выполняться в одной пакетной задаче и иметь кумулятивное время выполнения. Поэтому время выполнения сводного планирования увеличится. По этой причине рекомендуется присвоить этому параметру значение больше **0** (нуля)

### <a name="time-fences"></a>Временные границы

Временные границы указывают, насколько далеко в будущем расчеты и другие потребности должны рассчитываться при сводном планировании. Чем длиннее временная граница, тем больше времени потребуется для выполнения сводного планирования. Поэтому задайте временные границы в соответствии с деловыми требованиями. Дополнительные сведения о временных границах см. в разделе [Настройка сводного планирования](master-planning-setup.md).

### <a name="actions"></a>Действия

Среди временных границ можно также найти параметр **Сообщение по действию**. Расчет сообщений по действиям приводит к более длительному времени выполнения сводного планирования. Если сообщения по действиям не анализируются и не применяются регулярно (ежедневно, еженедельно и т. д.), следует отключать этот расчет во время выполнения сводного планирования. Чтобы отключить расчет, на странице **Сводные планы** (**Сводное планирование \> Настройка \> Планы \> Сводные планы**) установите для временной границы **Сообщение по действию** значение **0** (ноль) для сводного плана, который вы выполняете. Кроме того, убедитесь, что параметр **Сообщение по действию** отключен для всех групп покрытия.

### <a name="futures"></a>Фьючерсы

Расчет фьючерсов приводит к более длительному времени выполнения сводного планирования. Если спецификации не планируются, или если задержки не должны распространяться из поставок в спрос во время планирования, рассмотрите возможность выключения расчетов фьючерсов при сводном планировании. Чтобы отключить расчеты , установите для временной границы **Фьючерсы** значение **0** (ноль) для выполняемого сводного плана. Кроме того, убедитесь, что параметр **Фьючерсы** отключен для всех групп покрытия.

## <a name="one-heavy-routine-at-a-time"></a>Один сложный процесс за раз

При планировании сводного планирования не планируйте никакие другие пакетные задания одновременно. Будьте особенно осторожны, чтобы не запланировать какие-либо другие сложные процедуры, такие как закрытие запасов, на это же время.

## <a name="review-the-session-log"></a>Просмотр журнала сеансов

Система может собирать дополнительные сведения о задачах, выполняемых во время сводного планирования. Чтобы система собирала эту информацию, включите настройку **Отслеживать время обработки** в диалоговом окне **Выполнение сводного планирования**. Собираемая информация может помочь в обнаружении узких мест в работе системы. Например , если для параметра **Число задач в наборе задач помощников** задано значение **1**, можно определить номенклатуру с самым длительным временем выполнения. Можно также сравнить время выполнения для различных потоков, имеющих статус **Покрытие**, и сравнить продолжительность каждой задачи.

Чтобы просмотреть выполнения сводного планирования вашей системы, выполните один из этих шагов.

- В рабочей области **Сводное планирование** выберите сводный план в раскрывающемся поле, затем на плитке **Сводное планирование** выберите **Журнал**. Выберите задание, выберите **Запросы** на экспресс-вкладке, затем выберите **Длительность задачи процесса**.
- На странице **Сводные планы** выберите план в левой области, затем выберите **Журнал** на экспресс-вкладке. Выберите задание, выберите **Запросы** на экспресс-вкладке, затем выберите **Длительность задачи процесса**.

При просмотре журнала сеанса проанализируйте следующие моменты:

- **Обновление** не должно занимать много времени (в целом оно должно занимать до 30 минут). Однако это единственный поток.
- **Копирование плана** не должно занять много времени (должно занимать примерно одну минуту).
- **Автоматическое подтверждение** обычно занимает 30 минут. Однако в зависимости от количества заказов и сложности номенклатуры может потребоваться несколько часов.
- **Автоматическое подтверждение** должно занимать меньше времени, чем **Покрытие**.
- **Покрытие** должно занимать самое большое время относительно всего остального.
- **Сообщение по действие** и **Сообщение по фьючерсу** могут занять много времени, в зависимости от данных и количества спецификаций.

## <a name="filtering-of-items"></a>Фильтрация номенклатур

Фильтры, применяемые в диалоговом окне **Выполнение сводного планирования**, влияют на длительность выполнения сводного планирования. Перейдите к пункту **Сводное планирование \> Сводное планирование \> Выполнить \> Сводное планирование** или выберите команду **Выполнить** в рабочей области **Сводное планирование**. Чтобы исключить номенклатуры из выполнения, рекомендуется выполнить фильтрацию по состоянию жизненного цикла номенклатуры (а не по номерам номенклатуры). При фильтрации по состоянию жизненного цикла процесс обновления займет меньше времени, чем при фильтрации по номерам номенклатуры.

## <a name="performance-checklist-summary"></a>Сводка контрольного списка производительности

- **Число потоков** — задано значение, большее **0** (нуля).
- **Число задач в наборе задач помощников** — задано значение, большее **0** (нуля). (Используйте формулы, приведенные ранее в этом разделе.)
- **Использование кэша** — задано значение **Максимум**, кроме случая, когда в системе не хватает памяти.
- **Количество заказов в наборе утверждения** — задано значение, большее **0** (нуля). (Используйте формулу, приведенную ранее в этом разделе.)
- **Временные границы** — корректируйте в соответствии с потребностями бизнеса.
- **Действия и фьючерсы** — отключите действия и фьючерсы, если они не используются.
- **Один сложный процесс за раз** — не запускайте сводное планирование вместе с любым другим сложным процессом.
- **Просмотр журнала сеансов.**
- **Фильтрация номенклатур** — используйте статус жизненного цикла, чтобы исключить номенклатуры из процесса сводного планирования. (Не используйте номера номенклатур.)
