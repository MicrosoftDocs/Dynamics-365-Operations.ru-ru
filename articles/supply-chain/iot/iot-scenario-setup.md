---
title: Настройка сценария для бизнес-аналитики Интернета вещей
description: В этом разделе описывается, как настроить сценарий в Supply Chain Management для бизнес-аналитики Интернета вещей.
author: robinarh
manager: tfehr
ms.date: 08/16/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: ''
ms.search.scope: Core, Operations
ms.custom: ''
ms.search.region: Global
ms.author: ''
ms.search.validFrom: 2020-04-04
ms.dyn365.ops.version: 10.0.5
ms.openlocfilehash: 5633741fcd9c04b68e5b174447d7ead3c521ccd7
ms.sourcegitcommit: f64fce03ec52f844b05a9e8cac286cb201385002
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2020
ms.locfileid: "3597176"
---
# <a name="scenario-setup-for-iot-intelligence"></a>Настройка сценария для бизнес-аналитики Интернета вещей

[!include [banner](../../includes/banner.md)]

В этом разделе описывается, как настроить сценарий в Supply Chain Management для бизнес-аналитики Интернета вещей. Прежде чем настраивать сценарии, необходимо [настроить LCS](iot-lcs-setup.md).

В этом разделе можно настроить сценарий **простой оборудования**, чтобы создать уведомление в Supply Chain Management при отключении компьютера.

## <a name="configure-the-equipment-downtime-scenario-in-supply-chain-management"></a>Настройка сценария **простой оборудования** в Supply Chain Management

В сценарии **простой оборудования** отображается сигнал частичного выхода для порога оповещения компьютера. Наблюдение за станком осуществляется только в том случае, если компьютер выбрана для сценария и настроен на выполнение в Supply Chain Management. Если время, прошедшее с момента получения сигнала о частичном выходе компьютера, превышает порог оповещения, то уведомление об **отключении компьютера** запускается. Если компьютер все еще работает, при получении следующего сигнала **PartOut** запускается уведомление о **включении компьютера**. Если компьютер остановлен в течение 30 минут, будет запущено новое уведомление об **отключении компьютера**.

В сценарии **простой оборудования** имеются следующие зависимости:

+ Для запуска оповещения производственный заказ должен быть запущен на сопоставленном станке.
+ Сигнал, представляющий сигнал частичного выхода сопоставленного компьютера, должен быть отправлен в узел Интернета вещей с уникальным именем свойства.
+ В сообщении узла Интернета вещей должно присутствовать свойство метки времени для миллисекунд UNIX.

Выполните следующие действия, чтобы настроить сценарий:

1. Войдите в Supply Chain Management.
2. Включите флаг функции аналитики Интернета вещей. Дополнительные сведения см. в разделе [Обзор управления функциями](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md).
3. Настройка метрик. Дополнительные сведения см. в [Как настроить метрики](iot-metrics-setup.md#configure-metrics).
4. Перейдите в **Управление производством**.
5. Перейдите в раздел **Настройка \> аналитика Интернета вещей \> управление сценариями**.
6. Щелкните **настроить** на плитке **простой оборудования**. Мастер настройки запускается со страницы **определение схемы датчика оборудования**. Целью этого является настройка схемы в Supply Chain Management так, чтобы она соответствовала формату JSON сообщений Интернета вещей. Можно определить несколько схем сообщений. Дополнительные сведения см. в разделе [форматы схем сообщений для узла Интернета вещей](iot-schema-format.md). В данном примере полезная нагрузка сообщения содержит пакет сообщений с данным форматом:

    ```json
    {
        "timestamp": 1576016821614,
        "payload": [
            {
                "id": "IoTInt.Machine1225.PartOut",
                "timestamp": 1576016821614,
                "value": True
            },
            {
                "id": "IoTInt.Machine1226.PartOut",
                "timestamp": 1576016991616,
                "value": True
            }
        ]
    }
    ```

7. Добавление строки в таблицу.

    1. Установите **Имя схемы** на **Код**.
    2. Установите **Имя схемы** на **/полезная нагрузка[\*]/код**.
    3. Установите **описание** на **Код сообщения**.

8. Добавление строки в таблицу.

    1. Установите **Имя схемы** на **Метка времени**.
    2. Установите **Имя схемы** на **/полезная нагрузка[\*]/метка времени**.
    3. Установите **описание** на **Метка времени сообщения**.

9. Добавление строки в таблицу.

    1. Установите **Имя схемы** на **Значение**.
    2. Установите **Имя схемы** на **/полезная нагрузка[\*]/значение**.
    3. Установите **описание** на **Значение сообщения**.

    Нет необходимости определять все свойства в сообщении, а не только те, которые необходимы. В этом примере не была создана строка для **корневой метки времени**. Путь для **корневой метки времени** должен быть **/метка времени**.
  
10. Нажмите кнопку **Далее**, чтобы перейти на страницу **Сопоставление схемы датчика оборудования**.
11. В строке **кода ресурса оборудования** задайте **имя схемы** значение **Код**. В раскрывающейся таблице отображаются допустимые значения.
12. В строке для **времени UTC** задайте для **имени схемы** значение **Метка времени**. В раскрывающейся таблице отображаются допустимые значения.
13. В строке для **сигнал произведенной части** задайте **имя схемы** значение **Значение**. В раскрывающейся таблице отображаются допустимые значения.
14. Щелкните **Далее**, чтобы получить страницу **Конфигурация кода ресурса оборудования**.
15. На этом шаге значения сообщения узла Интернета вещей сопоставляются с ресурсами Supply Chain Management.

    1. В таблице **значения данных сигнала** добавьте новую строку и введите **IoTInt.Machine1225.PartOut** в столбце **значение**. Значение **IoTInt.Machine1225.PartOut** поступает из свойства **код** JSON в сообщении узла Интернета вещей.
    2. Нажмите кнопку **Сохранить**.
    3. В таблице **сопоставление бизнес-записей** щелкните **создать**. Значение по умолчанию для **типа бизнес-записи** заполняется автоматически, и его не нужно менять.
    4. В столбце **Бизнес-запись** выберите ресурс компьютера Supple Chain Management, с которого отсылается значение этого сигнала.
    5. Нажмите кнопку **Сохранить**.
    6. Повторите эти шаги, добавляя сопоставление новых бизнес-записей для **Machine1226**. Можно сопоставить несколько значений данных сигналов одной записи в Supply Chain Management.

16. Используйте столбец **Выбрано** для выбора компьютеров, которые необходимо обработать. Нет необходимости определять все значения сигнала, и вам не придется выбирать все компьютеры.
17. Нажмите кнопку **Далее**, чтобы перейти на страницу **Конфигурация сигнала произведенных частей**.
18. В таблице **значения данных сигнала** добавьте строку и установите **значение** в **Истина**. Значение **Истина** поступает из свойства **значение** JSON в сообщении узла Интернета вещей. Можно добавить столько значений, сколько необходимо для сценария.
19. Нажмите кнопку **Сохранить**.
20. Нажмите кнопку **Далее**, чтобы перейти на страницу **Порог простоя оборудования**. В списке приведены компьютеры, ранее сопоставленные со значениями сигналов. На этом шаге определяется пороговое значение, чтобы определить, отключен ли компьютер. Например, если установить пороговое значение 10, Supply Chain Management создает уведомление, если в течение 10 минут не поступило сообщение о выходе части с компьютера.
21. Щелкните **Далее**, чтобы перейти к странице **Включить сценарий**. Чтобы включить сценарий, переключите слайдер.
22. Нажмите кнопку **Готово**.

Настройка сценария завершена. Аналитика Интернета вещей автоматически начнет обрабатывать сообщения узла Интернета вещей.

## <a name="configure-the-product-quality-scenario-in-supply-chain-management"></a>Настройка сценария **качество продукта** в Supply Chain Management

Сценарий **качество продукта** создает уведомление, если атрибут номенклатуры выходит за пределы указанного диапазона. Например, с помощью датчика можно отсылать вес каждой номенклатуры в узел Интернета вещей. В Supply Chain Management будет создано уведомление, если номенклатура слишком большая или слишком маленькая.

Сценарий имеет следующие зависимости:

+ Производственный заказ должен выполняться на сопоставленном компьютере и создавать продукт с сопоставленным атрибутом партии для срабатывания оповещения.
+ Сигнал, представляющий атрибут партии, должен быть отправлен в узел Интернета вещей с уникальным именем свойства.
+ В сообщении узла Интернета вещей должно присутствовать свойство метки времени для миллисекунд UNIX.

## <a name="configure-the-production-delays-scenario-in-supply-chain-management"></a>Настройка сценария **задержки производства** в Supply Chain Management

Сценарий **задержки производства** создает уведомление, если пропускная способность производства падает ниже порогового значения. В этом случае сигнал **PartOut** для каждой произведенной номенклатуры направляется в узел Интернета вещей. В Supply Chain Management задержка заказа рассчитывается на основе времени, в течение которого запланировано выполнение производственного заказа, сколько номенклатур должно быть произведено, как долго выполняется задание и сколько сигналов **PartOut** поступает. Уведомление о задержке будет создано, если число сигналов **PartOut** для задания оказывается ниже порогового значения ожидаемого значения.

Сценарий имеет следующие зависимости:

+ Для запуска оповещения производственный заказ должен быть запущен на сопоставленном станке.
+ Сигнал, представляющий сигнал частичного выхода сопоставленного компьютера, должен быть отправлен в узел Интернета вещей с уникальным именем свойства.
+ В сообщении узла Интернета вещей должно присутствовать свойство метки времени для миллисекунд UNIX.

## <a name="how-to-disable-a-scenario"></a>Как отключить сценарий

Для отключения сценария выполните следующие действия:

1. В Supply Chain Management перейдите к **Управление производством \> Настройка \> аналитика Интернета вещей \> Управление сценарием**.
2. Щелкните **Настройка** в сценарии.
3. Щелкните **Далее**, чтобы перейти к последней вкладке мастера.
4. Чтобы отключить сценарий, переключите слайдер.
