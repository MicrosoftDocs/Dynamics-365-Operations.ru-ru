---
title: Объекты проводок по затратам
description: В этой статье содержится информация об объектах транзакций стоимости, которые позволяют разделить значение стоимости между содержимым области стоимости путем выбора метода распределения.
author: yufeihuang
ms.date: 05/27/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2022-05-27
ms.dyn365.ops.version: 10.0.28
ms.openlocfilehash: 0084d47bf85050749b2668d273db07670aaeae2a
ms.sourcegitcommit: 5b34b41ae74269ba639e2876bc5862ef468da1cc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2022
ms.locfileid: "9166814"
---
# <a name="cost-transaction-entities"></a>Объекты проводок по затратам

[!include [banner](../includes/banner.md)]

## <a name="apportionment"></a>Распределение

Стоимость доставки позволяет разделить значение стоимости между содержимым области стоимости (рейс, транспортный контейнер и т. д.) путем выбора метода распределения. Метод распределения устанавливается в рамках настройки автоматических затрат на основе бизнес-правил. Он оплачивается как часть стоимости при создании линии рейса

### <a name="configure-the-apportionment-mapping-for-use-with-data-entities"></a>Настройте сопоставление распределения для использования с объектами данных

Когда стоимость создается из внешнего источника, такого как экспедитор груза, этот внешний источник не может указать предпочтительный метод распределения себестоимости. Отображение распределения определяет метод распределения по умолчанию для каждого кода типа стоимости. Доступ к таблице сопоставления распределения осуществляется со страницы **Сопоставление распределения** в Microsoft Dynamics 365 Supply Chain Management (**Дополнительная стоимость \> Настройка стоимости \> Сопоставление распределения**).

Если определена комбинация сопоставления и стоимость, соответствующая коду типа затрат, создается с использованием объекта транзакции затрат, метод сопоставленного распределения будет использоваться вместо любого значения, которое было предоставлено объекту.

Если в таблице сопоставления нет значения, но для объекта было предоставлено значение, будет использоваться заданное значение.

Если ни одно значение не существует ни в таблице сопоставления, ни в записи, которая была отправлена в объект, создание завершится с ошибкой.

### <a name="apportionment-mapping-itmapportionmentmapping"></a>Сопоставление распределения (ITMApportionmentMapping)

Объект сопоставления распределения ( `ITMApportionmentMapping`) создает отношения сопоставления распределений и позволяет пользователям создавать и обновлять записи.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Метод распределения | ITMApportionmentMapping.ApportionmentMethod | Int | Нет | Нет |
| Код типа затрат | ITMApportionmentMapping.ShipCostTypeId | Nvarchar (20) | **Да** | Нет |

## <a name="voyage-costs-itmcosttransvoyageentity"></a>Затраты на поездку (ITMCostTransVoyageEntity)

Объект затрат на поездку (`ITMCostTransVoyageEntity`) создает проводки по затратам на поездку, которые применяются на уровне поездки. В процессе импорта система использует значения **Категория** и **Метод распределения**, которые включены в объект, чтобы определить, как стоимость распределяется по содержимому поездки.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Метод распределения | ITMCostTrans.ApportionmentMethod | Int | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение(32, 6) | Нет | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Поездка | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |

## <a name="shipping-container-costs-itmcosttransshippingcontainerentity"></a>Затраты на грузовой контейнер (ITMCostTransShippingContainerEntity)

Объект стоимости грузового контейнера (`ITMCostTransShippingContainerEntity`) создает затраты на грузовой контейнер, которые применяются на уровне грузового контейнера. В процессе импорта система использует значения **Категория** и **Метод распределения**, которые включены в объект, чтобы определить, как стоимость распределяется по содержимому поездки.

Поля **Агрегат**, **Участок пути** и **Связанный участок пути** относятся к записям, для которых параметр **Область стоимости** имеет значение *Грузовой контейнер*. Поэтому они отсутствуют в объектах данных для других областей стоимости.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Общее | ITMCostTrans.AggregatedCost | Int | Нет | Нет |
| Метод распределения | ITMCostTrans.ApportionmentMethod | Int | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Связанный участок пути | ITMCostTrans.LinkLegId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение (32, 6) | Нет | Нет |
| Грузовой контейнер | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Поездка | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Участок пути | ITMCostTrans.ShipLegId | Nvarchar(20) | Нет | Нет |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |

## <a name="folio-costs-itmcosttransfolioentity"></a>Затраты листа (ITMCostTransFolioEntity)

Объект затрат листа (`ITMCostTransFolioEntity`) создает записи транзакций затрат, которые относятся к уровню листа. В процессе импорта система использует значения **Категория** и **Метод распределения**, которые включены в объект, чтобы определить, как стоимость распределяется по содержимому каждого листа.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Метод распределения | ITMCostTrans.ApportionmentMethod | Int | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение(32, 6) | Нет | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Лист | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |

## <a name="purchase-order-costs-itmcosttranspurchaseentity"></a>Затраты на заказ на покупку (ITMCostTransPurchaseEntity)

Объект затрат для заказа на покупку (`ITMCostTransPurchaseEntity`) создает проводки затрат, которые относятся к заголовку заказа на покупку. В процессе импорта система использует значения **Категория** и **Метод распределения**, которые включены в объект, чтобы определить, как стоимость распределяется по содержимому каждого листа.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Метод распределения | ITMCostTrans.ApportionmentMethod | Int | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение(32, 6) | Нет | Нет |
| Заказ на покупку | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |

## <a name="item-costs-itmcosttransitementity"></a>Затраты на номенклатуру (ITMCostTransItemEntity)

Объект затрат на номенклатуру (`ITMCostTransItemEntity`) создает транзакций затрат, которые относятся к уровню номенклатуры. Этот объект относится к номенклатурам в строках заказа на покупку. Значение затрат применяется полностью в строке.

Поля **Сумма корректировки** и **Корректировка стоимости** являются специфическими для областей затрат уровня строки. Поэтому они отсутствуют в объектах данных для других областей стоимости.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Сумма корректировки | ITMCostTrans.AdjustmentAmount | Числовое значение(32, 6) | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение(32, 6) | Нет | Нет |
| Заказ на покупку | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Номер строки заказа на покупку | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |
| Корректировка стоимости | ITMCostTrans.ValueAdjustmentMethod | Int | Нет | Нет |

## <a name="transfer-line-costs-itmcosttranstransferlineentity"></a>Затраты строки перемещения (ITMCostTransTransferLineEntity)

Объект проводок по затратам строки перемещения (`ITMCostTransTransferLineEntity`) создает проводки затрат, которые применяются на уровне строки заказа на перемещение. Значение затрат применяется полностью в строке заказа на перемещения.

Поля **Сумма корректировки** и **Корректировка стоимости** являются специфическими для областей затрат уровня строки. Поэтому они отсутствуют в объектах данных для других областей стоимости.

| Имя | Сопоставление | Тип данных | Ключ | Обязательная аналитика |
|---|---|---|---|---|
| Сумма корректировки | ITMCostTrans.AdjustmentAmount | Числовое значение(32, 6) | Нет | Нет |
| Себестоимость | ITMCostTrans.CostValue | Числовое значение(32, 6) | Нет | Нет |
| Валюта | ITMCostTrans.CurrencyCode | Nvarchar(3) | Нет | **Да** |
| Номер строки | ITMCostTrans.LineNum | Числовое значение(32, 16) | **Да** | Нет |
| Связанный тип затрат | ITMCostTrans.LinkCostTypeId | Nvarchar(20) | Нет | Нет |
| Минимальная стоимость | ITMCostTrans.MinCostAmount | Числовое значение(32, 6) | Нет | Нет |
| Категория | ITMCostTrans.ShipCostCategory | Int | Нет | Нет |
| Код типа затрат | ITMCostTrans.ShipCostTypeId | Nvarchar(20) | Нет | Нет |
| Компания | ITMCostTrans.ShipDataArea | Nvarchar(4) | Нет | **Да** |
| Заказ на перемещение | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Номер строки заказа на перемещение | ITMCostTrans.TransRecId | Nvarchar(20) | **Да** | Нет |
| Налоговая группа номенклатур | ITMCostTrans.TaxItemGroup | Nvarchar(10) | Нет | Нет |
| Корректировка стоимости | ITMCostTrans.ValueAdjustmentMethod | Int | Нет | Нет |

### <a name="transaction-table"></a>Таблица проводок

Запись проводки по затратам связана с областью стоимости с помощью назначения таблицы проводок с номером ( `TransTableId`). Когда требуются идентификационные номера отдельных таблиц, эти объекты разбиваются на основе этих значений, так что для каждой области затрат существует объект.

Значение для таблицы транзакций (`TransTableId`) является неявным в выборе объекта проводки затрат.

### <a name="calculated-fields"></a>Вычисляемые поля

Следующие поля недоступны для вставки или обновления при использовании объекта проводки затрат, поскольку эти поля задаются только в том случае, когда выполняются определенные действия с записью рейса:

- **Оценочная стоимость** — это поле устанавливается, когда счет публикуется для поездки (заказ на покупку) или полученного перемещения.
- **Валюта оценочной стоимости** — это поле устанавливается, когда счет публикуется для поездки (заказ на покупку) или получено перемещение.
- **Фактические затраты** — это поле устанавливается при разноске накладной поставщика. Оно связано с затратами.

### <a name="find-auto-costs"></a>Поиск автоматических затрат

**Кнопка найти автоматические затраты**, доступная для каждой области стоимости (поездка, грузовой контейнер и т. д.), предоставляет способ обновления проводок затрат для этой области стоимости на основе информации в таблицах конфигурации. При выборе кнопки для области стоимости система удаляет существующие затраты для этой области стоимости и создает новые записи на основе текущей конфигурации таблиц настройки автоматических затрат.

Записи проводок по затратам, созданные с использованием объекта данных, помечаются как импортированные Эти записи не удаляются при выборе кнопки **Поиск автоматических затрат**, поскольку они не будут повторно созданы из таблиц настройки автоматических затрат. Однако запись проводки затрат, помеченная как импортированная, по-прежнему может быть удалена.

### <a name="linked-fields"></a>Связанные поля

Каждая проводка по затратам может быть связана с другой записью в одной и той же области стоимости. Эта связь устанавливается с помощью поля **Связанный тип затрат**. Это позволяет рассчитывать себестоимость в процентах от других затрат

Поле **Связанный тип затрат** может проверяться только в том случае, если запись, на которую дается ссылка, обрабатывается в первую очередь или уже существует в таблице. То же требование распространяется только на поле **Связанный участок пути**, которое используется для затрат в области стоимости грузового контейнера.
