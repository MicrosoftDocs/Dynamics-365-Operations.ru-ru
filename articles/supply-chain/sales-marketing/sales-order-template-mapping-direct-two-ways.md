---
title: Синхронизация заказов на продажу напрямую между Sales и Supply Chain Management
description: В этой теме рассматриваются шаблоны и базовые задачи, которые используются для выполнения синхронизации заказов на продажу напрямую между Dynamics 365 Sales и Dynamics 365 Supply Chain Management.
author: ChristianRytt
manager: tfehr
ms.date: 05/09/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User, IT Pro
ms.reviewer: kamaybac
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: ''
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.openlocfilehash: ddc6159480d1ff9fb823dbd95465c991ae51f9c4
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "4974993"
---
# <a name="synchronization-of-sales-orders-directly-between-sales-and-supply-chain-management"></a><span data-ttu-id="755c7-103">Синхронизация заказов на продажу напрямую между Sales и Supply Chain Management</span><span class="sxs-lookup"><span data-stu-id="755c7-103">Synchronization of sales orders directly between Sales and Supply Chain Management</span></span>

[!include [banner](../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

<span data-ttu-id="755c7-104">В этой теме рассматриваются шаблоны и базовые задачи, которые используются для выполнения синхронизации заказов на продажу напрямую между Dynamics 365 Sales и Dynamics 365 Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-104">The topic discusses the templates and underlying tasks that are used to run synchronization of sales orders directly between Dynamics 365 Sales and Dynamics 365 Supply Chain Management.</span></span>

## <a name="data-flow-in-prospect-to-cash"></a><span data-ttu-id="755c7-105">Поток данных в решение "Перспективный клиент в наличные деньги"</span><span class="sxs-lookup"><span data-stu-id="755c7-105">Data flow in Prospect to cash</span></span>

<span data-ttu-id="755c7-106">Решение "Перспективный клиент в наличные деньги" использует функцию интеграции данных для синхронизации данных между экземплярами Supply Chain Management и Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-106">The Prospect to cash solution uses the Data integration feature to synchronize data across instances of Supply Chain Management and Sales.</span></span> <span data-ttu-id="755c7-107">Шаблоны "Перспективный клиент в наличные деньги", доступные в компоненте интеграции данных, обеспечивают движение данных для организаций, контактов, продуктов, предложений по продажам, заказов на продажу и накладных по продажам между Supply Chain Management и Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-107">The Prospect to cash templates that are available with the Data integration feature enable the flow of data for accounts, contacts, products, sales quotations, sales orders, and sales invoices between Supply Chain Management and Sales.</span></span> <span data-ttu-id="755c7-108">На следующем рисунке показано, как данные синхронизируются между Supply Chain Management и Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-108">The following illustration shows how the data is synchronized between Supply Chain Management and Sales.</span></span>

<span data-ttu-id="755c7-109">[![Поток данных в решение "Перспективный клиент в наличные деньги"](./media/prospect-to-cash-data-flow.png)](./media/prospect-to-cash-data-flow.png)</span><span class="sxs-lookup"><span data-stu-id="755c7-109">[![Data flow in Prospect to cash](./media/prospect-to-cash-data-flow.png)](./media/prospect-to-cash-data-flow.png)</span></span>

## <a name="templates-and-tasks"></a><span data-ttu-id="755c7-110">Шаблоны и задачи</span><span class="sxs-lookup"><span data-stu-id="755c7-110">Templates and tasks</span></span>

<span data-ttu-id="755c7-111">Чтобы получить доступ к доступным шаблонам, откройте [Центр администрирования Power Apps](https://preview.admin.powerapps.com/dataintegration).</span><span class="sxs-lookup"><span data-stu-id="755c7-111">To access the available templates, open [Power Apps Admin Center](https://preview.admin.powerapps.com/dataintegration).</span></span> <span data-ttu-id="755c7-112">Выберите **Проекты**, затем в правом верхнем углу выберите **Создать проект**, чтобы выбрать общие шаблоны.</span><span class="sxs-lookup"><span data-stu-id="755c7-112">Select **Projects**, and then, in the upper-right corner, select **New project** to select public templates.</span></span>

<span data-ttu-id="755c7-113">Следующие шаблоны и базовые задачи используются для выполнения синхронизации заказов на продажу напрямую между Sales и Supply Chain Management:</span><span class="sxs-lookup"><span data-stu-id="755c7-113">The following templates and underlying tasks are used to run synchronization of sales orders directly between Sales and Supply Chain Management.</span></span>

- <span data-ttu-id="755c7-114">**Имена шаблонов в интеграции данных:**</span><span class="sxs-lookup"><span data-stu-id="755c7-114">**Names of the templates in Data integration:**</span></span> 

    - <span data-ttu-id="755c7-115">Заказы на продажу (из Sales в Supply Chain Management) — напрямую</span><span class="sxs-lookup"><span data-stu-id="755c7-115">Sales Orders (Sales to Supply Chain Management) - Direct</span></span>
    - <span data-ttu-id="755c7-116">Заказы на продажу (из Supply Chain Management в Sales) — напрямую</span><span class="sxs-lookup"><span data-stu-id="755c7-116">Sales Orders (Supply Chain Management to Sales) - Direct</span></span>

- <span data-ttu-id="755c7-117">**Имена задач в проекте интеграции данных:**</span><span class="sxs-lookup"><span data-stu-id="755c7-117">**Names of the tasks in the Data integration project:**</span></span>

    - <span data-ttu-id="755c7-118">OrderHeader</span><span class="sxs-lookup"><span data-stu-id="755c7-118">OrderHeader</span></span>
    - <span data-ttu-id="755c7-119">OrderLine</span><span class="sxs-lookup"><span data-stu-id="755c7-119">OrderLine</span></span>

<span data-ttu-id="755c7-120">Перед синхронизацией заголовков и строк накладных по продаже требуются следующие задачи синхронизации:</span><span class="sxs-lookup"><span data-stu-id="755c7-120">The following synchronization tasks are required before synchronization of sales invoice headers and lines can occur:</span></span>

- <span data-ttu-id="755c7-121">Продукты (из Supply Chain Management в Sales) — напрямую</span><span class="sxs-lookup"><span data-stu-id="755c7-121">Products (Supply Chain Management to Sales) - Direct</span></span>
- <span data-ttu-id="755c7-122">Счета (из Sales в Supply Chain Management) — напрямую (если используется)</span><span class="sxs-lookup"><span data-stu-id="755c7-122">Accounts (Sales to Supply Chain Management) - Direct (if used)</span></span>
- <span data-ttu-id="755c7-123">Из контактов в клиенты (из Sales в Supply Chain Management) - напрямую (если используются)</span><span class="sxs-lookup"><span data-stu-id="755c7-123">Contacts to Customers (Sales to Supply Chain Management) - Direct (if used)</span></span>

## <a name="entity-set"></a><span data-ttu-id="755c7-124">Набор объектов</span><span class="sxs-lookup"><span data-stu-id="755c7-124">Entity set</span></span>

| <span data-ttu-id="755c7-125">Управление цепочкой поставок</span><span class="sxs-lookup"><span data-stu-id="755c7-125">Supply Chain Management</span></span>  | <span data-ttu-id="755c7-126">Прод.</span><span class="sxs-lookup"><span data-stu-id="755c7-126">Sales</span></span>             |
|-------------------------|-------------------|
| <span data-ttu-id="755c7-127">Заголовки заказов на продажу Dataverse</span><span class="sxs-lookup"><span data-stu-id="755c7-127">Dataverse sales order headers</span></span> | <span data-ttu-id="755c7-128">SalesOrders</span><span class="sxs-lookup"><span data-stu-id="755c7-128">SalesOrders</span></span>       |
| <span data-ttu-id="755c7-129">Строки заказа на продажу Dataverse</span><span class="sxs-lookup"><span data-stu-id="755c7-129">Dataverse sales order lines</span></span>   | <span data-ttu-id="755c7-130">SalesOrderDetails</span><span class="sxs-lookup"><span data-stu-id="755c7-130">SalesOrderDetails</span></span> |

## <a name="entity-flow"></a><span data-ttu-id="755c7-131">Поток объектов</span><span class="sxs-lookup"><span data-stu-id="755c7-131">Entity flow</span></span>

<span data-ttu-id="755c7-132">Заказы на продажу создаются в Sales и синхронизируются в Supply Chain Management, когда запущена команда **Выполнить проект** для проекта, основанного на шаблоне **Заказы на продажу (из Sales в Supply Chain Management) - напрямую**.</span><span class="sxs-lookup"><span data-stu-id="755c7-132">Sales orders are created in Sales and synchronized to Supply Chain Management when **Run project** is triggered for a project based on the **Sales Orders (Sales to Supply Chain Management) - Direct** template.</span></span> <span data-ttu-id="755c7-133">Можно активировать и синхронизировать заказы из Sales только в том случае, если весь **Заказ продуктов** состоит только из продуктов, которые управляются извне.</span><span class="sxs-lookup"><span data-stu-id="755c7-133">You can only activate and synchronize orders from Sales if all **Order Products** consist of products that are externally maintained.</span></span> <span data-ttu-id="755c7-134">Таким образом, не может быть вписываемых продуктов.</span><span class="sxs-lookup"><span data-stu-id="755c7-134">Therefore, there can be no write-in products.</span></span> <span data-ttu-id="755c7-135">После активизации заказа заказ на продажу становится доступным только для чтения в интерфейсе пользователя (UI).</span><span class="sxs-lookup"><span data-stu-id="755c7-135">After the order is activated, the sales order becomes read-only in the user interface (UI).</span></span> <span data-ttu-id="755c7-136">На этом этапе обновления выполняются из Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-136">At that point, the updates are made from Supply Chain Management.</span></span> <span data-ttu-id="755c7-137">После того как заказ на продажу получает статус **Подтверждено**, проект на основе шаблона **Заказы на продажу (из Supply Chain Management в Sales) - напрямую** может использоваться для синхронизации любых обновлений или статуса выполнения из Supply Chain Management в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-137">After the sales order has a status of **Confirmed**, the a project based on the **Sales Orders (Supply Chain Management to Sales) - Direct** template can be used to synchronize updates or fulfillment status from Supply Chain Management to Sales.</span></span>

<span data-ttu-id="755c7-138">Не нужно создавать заказы в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-138">You don't have to create orders in Sales.</span></span> <span data-ttu-id="755c7-139">Вместо этого можно создавать новые заказы на продажу в Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-139">You can create new sales orders in Supply Chain Management instead.</span></span> <span data-ttu-id="755c7-140">После того как заказ на продажу получил статус **Подтверждено**, он синхронизируется с Sales, как описано в предыдущем параграфе.</span><span class="sxs-lookup"><span data-stu-id="755c7-140">After a sales order has a status of **Confirmed**, it's synchronized to Sales as described in the previous paragraph.</span></span>

<span data-ttu-id="755c7-141">В Supply Chain Management фильтры в шаблоне помогают гарантировать, что в синхронизацию включаются только необходимые заказы на продажу:</span><span class="sxs-lookup"><span data-stu-id="755c7-141">In Supply Chain Management, filters in the template help guarantee that only the relevant sales orders are included in the synchronization:</span></span>

- <span data-ttu-id="755c7-142">В заказе на продажу как заказывающий клиент, так и клиент для выставления накладной должны быть взяты из Sales, чтобы они включались в синхронизацию.</span><span class="sxs-lookup"><span data-stu-id="755c7-142">On the sales order, both the ordering customer and the invoicing customer have to originate from Sales to be included in the synchronization.</span></span> <span data-ttu-id="755c7-143">В Supply Chain Management столбцы **OrderingCustomerIsExternallyMaintained** и **InvoiceCustomerIsExternallyMaintained** используются для фильтрации заказов на продажу из таблиц данных.</span><span class="sxs-lookup"><span data-stu-id="755c7-143">In Supply Chain Management, the **OrderingCustomerIsExternallyMaintained** and **InvoiceCustomerIsExternallyMaintained** columns are used to filter sales orders from the data tables.</span></span>
- <span data-ttu-id="755c7-144">Заказ на продажу в Supply Chain Management должен быть подтвержден.</span><span class="sxs-lookup"><span data-stu-id="755c7-144">The sales order in Supply Chain Management must be confirmed.</span></span> <span data-ttu-id="755c7-145">С Sales синхронизируются только подтвержденные заказы на продажу или заказы на продажу с более высоким статусом обработки, например **Отгружено** или **Выставлена накладная**.</span><span class="sxs-lookup"><span data-stu-id="755c7-145">Only confirmed sales orders or sales orders that have a higher processing status, such as **Shipped** or **Invoiced**, are synchronized to Sales.</span></span>
- <span data-ttu-id="755c7-146">После того, как заказ на продажу создан или изменен, необходимо выполнить в Supply Chain Management пакетное задание **Рассчитать итоги продаж**.</span><span class="sxs-lookup"><span data-stu-id="755c7-146">After a sales order is created or modified, the **Calculate sales totals** batch job in Supply Chain Management must be run.</span></span> <span data-ttu-id="755c7-147">Только заказы на продажу, для которых рассчитаны итоговые значения продаж, будут синхронизироваться с Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-147">Only sales orders where sales totals are calculated will be synchronized to Sales.</span></span>

## <a name="freight-tax"></a><span data-ttu-id="755c7-148">Налог на фрахт</span><span class="sxs-lookup"><span data-stu-id="755c7-148">Freight tax</span></span>

<span data-ttu-id="755c7-149">Sales не поддерживает налог на уровне заголовка, так как налог хранится на уровне строк.</span><span class="sxs-lookup"><span data-stu-id="755c7-149">Sales doesn't support tax at the header level, because tax is stored at the line level.</span></span> <span data-ttu-id="755c7-150">Для поддержки налога на уровне заголовка из Supply Chain Management, например налога на фрахт, система синхронизирует налог с Sales как вписанный продукт с именем **Налог на фрахт**, который имеет сумму налога из Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-150">To support tax at the header level from Supply Chain Management, such as tax on freight, the system synchronizes tax to Sales as a write-in product that is named **Freight Tax**, and that has the tax amount from Supply Chain Management.</span></span> <span data-ttu-id="755c7-151">Таким образом, стандартный расчет цены в Sales может использоваться для итоговых значений, даже если налог на уровне заголовка взят из Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-151">In this way, the standard price calculation in Sales can be used for totals, even when there is tax at the header level from Supply Chain Management.</span></span>

## <a name="discount-calculation-and-rounding"></a><span data-ttu-id="755c7-152">Расчет и округление скидок</span><span class="sxs-lookup"><span data-stu-id="755c7-152">Discount calculation and rounding</span></span>

<span data-ttu-id="755c7-153">Модель расчета скидки в Sales отличается от модели расчета скидки в Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-153">The discount calculation model in Sales differs from the discount calculation model in Supply Chain Management.</span></span> <span data-ttu-id="755c7-154">В Supply Chain Management конечная сумма скидка по строке продаж могут возникнуть в результате сочетания сумм скидок и процентов скидок.</span><span class="sxs-lookup"><span data-stu-id="755c7-154">In Supply Chain Management, the final discount amount on a sales line can be the result of a combination of discount amounts and discount percentages.</span></span> <span data-ttu-id="755c7-155">Если эта конечная сумма скидки делится на количество в строке, может произойти округление.</span><span class="sxs-lookup"><span data-stu-id="755c7-155">If this final discount amount is divided by the quantity on the line, rounding can occur.</span></span> <span data-ttu-id="755c7-156">Однако это округление не учитывается, если округленная сумма скидки на единицу синхронизируется с Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-156">However, this rounding isn't considered if a rounded per-unit discount amount is synchronized to Sales.</span></span> <span data-ttu-id="755c7-157">Чтобы обеспечить, чтобы полная сумма скидки из строки продаж в Supply Chain Management правильно синхронизировалась с Sales, должна синхронизироваться полная сумма без деления на количество в строке.</span><span class="sxs-lookup"><span data-stu-id="755c7-157">To help guarantee that the full discount amount from a sales line in Supply Chain Management is correctly synchronized to Sales, the full amount must be synchronized without being divided by the line quantity.</span></span> <span data-ttu-id="755c7-158">Таким образом, необходимо определить **Способ расчета скидки** как **Позиция строки** в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-158">Therefore, you must define the **Discount calculation method** as **Line item** in Sales.</span></span>

<span data-ttu-id="755c7-159">Когда строки заказа на продажу синхронизируется из Sales в Supply Chain Management, используется полная сумма скидки по строке.</span><span class="sxs-lookup"><span data-stu-id="755c7-159">When a sales order line is synchronized from Sales to Supply Chain Management, the full line discount amount is used.</span></span> <span data-ttu-id="755c7-160">Поскольку в Supply Chain Management нет поля для хранения полной суммы скидки для строки, эта сумма делится на количество и хранится в поле **Скидка по строке**.</span><span class="sxs-lookup"><span data-stu-id="755c7-160">Because Supply Chain Management has no field that can store the full discount amount for a line, the amount is divided by the quantity and stored in the **Line discount** field.</span></span> <span data-ttu-id="755c7-161">Все округления, возникающие при этом делении, хранятся в поле **Накладные расходы на продажи** в строке продажи.</span><span class="sxs-lookup"><span data-stu-id="755c7-161">Any rounding that occurs in this division is stored in the **Sales charges** field on the sales line.</span></span>

### <a name="example"></a><span data-ttu-id="755c7-162">Пример</span><span class="sxs-lookup"><span data-stu-id="755c7-162">Example</span></span>

<span data-ttu-id="755c7-163">**Синхронизация из Sales в Supply Chain Management**</span><span class="sxs-lookup"><span data-stu-id="755c7-163">**Synchronization from Sales to Supply Chain Management**</span></span>

- <span data-ttu-id="755c7-164">**Sales:** количество = 3, скидка по строке = $10,00</span><span class="sxs-lookup"><span data-stu-id="755c7-164">**Sales:** Quantity = 3, per-line discount = $10.00</span></span>
- <span data-ttu-id="755c7-165">**Supply Chain Management** : количество = 3, сумма скидки по строке = $3,33, накладные расходы на продажи =-$0,01</span><span class="sxs-lookup"><span data-stu-id="755c7-165">**Supply Chain Management:** Quantity = 3, line discount amount = $3.33, sales charge = -$0.01</span></span> 

<span data-ttu-id="755c7-166">**Синхронизация из Supply Chain Management в Sales**</span><span class="sxs-lookup"><span data-stu-id="755c7-166">**Synchronization from Supply Chain Management to Sales**</span></span>

- <span data-ttu-id="755c7-167">**Supply Chain Management** : количество = 3, сумма скидки по строке = $3,33, накладные расходы на продажи =-$0,01</span><span class="sxs-lookup"><span data-stu-id="755c7-167">**Supply Chain Management:** Quantity = 3, line discount amount = $3.33, sales charge = -$0.01</span></span>
- <span data-ttu-id="755c7-168">**Sales:** количество = 3, скидка по строке = (3 × $3,33) + $0,01 = $10,00</span><span class="sxs-lookup"><span data-stu-id="755c7-168">**Sales:** Quantity = 3, per-line discount = (3 × $3.33) + $0.01 = $10.00</span></span>

## <a name="prospect-to-cash-solution-for-sales"></a><span data-ttu-id="755c7-169">Решение "Перспективный клиент в наличные деньги" для Sales</span><span class="sxs-lookup"><span data-stu-id="755c7-169">Prospect to cash solution for Sales</span></span>

<span data-ttu-id="755c7-170">В таблице **Заказ** добавлены новые столбцы, которые отображаются на странице:</span><span class="sxs-lookup"><span data-stu-id="755c7-170">New columns have been added to the **Order** table and appear on the page:</span></span>

- <span data-ttu-id="755c7-171">**Хранится во внешней системе** — задайте значение **Да**, когда заказ поступает из Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-171">**Is Maintained Externally** – Set this option to **Yes** when the order is coming from Supply Chain Management.</span></span>
- <span data-ttu-id="755c7-172">**Состояние обработки** — в этом столбце отображается статус обработки заказа в Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-172">**Processing status** – This column shows the processing status of the order in Supply Chain Management.</span></span> <span data-ttu-id="755c7-173">Доступны следующие значения:</span><span class="sxs-lookup"><span data-stu-id="755c7-173">The following values are available:</span></span>

    - <span data-ttu-id="755c7-174">**Черновик** — исходный статус, когда заказ создается в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-174">**Draft** – The initial status when an order is created in Sales.</span></span> <span data-ttu-id="755c7-175">В Sales только заказы с этим статусом обработки допускают редактирование.</span><span class="sxs-lookup"><span data-stu-id="755c7-175">In Sales, only orders with this processing status can be edited.</span></span>
    - <span data-ttu-id="755c7-176">**Активный** — статус после того, как заказ активируется в Sales с помощью кнопки **Активировать**.</span><span class="sxs-lookup"><span data-stu-id="755c7-176">**Active** – The status after the order is activated in Sales by using the **Activate** button.</span></span>
    - <span data-ttu-id="755c7-177">**Подтверждено**</span><span class="sxs-lookup"><span data-stu-id="755c7-177">**Confirmed**</span></span>
    - <span data-ttu-id="755c7-178">**Отборочная накладная**</span><span class="sxs-lookup"><span data-stu-id="755c7-178">**Packing Slip**</span></span>
    - <span data-ttu-id="755c7-179">**Выставлена накладная**</span><span class="sxs-lookup"><span data-stu-id="755c7-179">**Invoiced**</span></span>
    - <span data-ttu-id="755c7-180">**Скомплектовано**</span><span class="sxs-lookup"><span data-stu-id="755c7-180">**Picked**</span></span>
    - <span data-ttu-id="755c7-181">**Частично скомплектовано**</span><span class="sxs-lookup"><span data-stu-id="755c7-181">**Partially Picked**</span></span>
    - <span data-ttu-id="755c7-182">**Частично упаковано**</span><span class="sxs-lookup"><span data-stu-id="755c7-182">**Partially Packed**</span></span>
    - <span data-ttu-id="755c7-183">**Отгружено**</span><span class="sxs-lookup"><span data-stu-id="755c7-183">**Shipped**</span></span>
    - <span data-ttu-id="755c7-184">**Частично отправлено**</span><span class="sxs-lookup"><span data-stu-id="755c7-184">**Partially Shipped**</span></span>
    - <span data-ttu-id="755c7-185">**Частично выставлен счет**</span><span class="sxs-lookup"><span data-stu-id="755c7-185">**Partially Invoiced**</span></span>
    - <span data-ttu-id="755c7-186">**Отменено**</span><span class="sxs-lookup"><span data-stu-id="755c7-186">**Cancelled**</span></span>

<span data-ttu-id="755c7-187">Настройка **Имеет только управляемые извне продукты** используется при активации заказа для постоянного отслеживания того, состоит ли заказ на продажу полностью из управляемых извне продуктов.</span><span class="sxs-lookup"><span data-stu-id="755c7-187">The **Has Externally Maintained Products Only** setting is used during order activation to consistently track whether a sales order consists entirely of externally maintained products.</span></span> <span data-ttu-id="755c7-188">Если заказ на продажу состоит исключительно из управляемых извне продуктов, продукты управляются в Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-188">If a sales order consists entirely of externally maintained products, the products are maintained in Supply Chain Management.</span></span> <span data-ttu-id="755c7-189">Эта настройка помогает гарантировать, что вы не будете активировать и пытаться синхронизировать строки заказа на продажу, содержащие продукты, которые неизвестны для Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-189">This setting helps guarantee that you don't activate and try to synchronize sales order lines that have products that are unknown to Supply Chain Management.</span></span>

<span data-ttu-id="755c7-190">Кнопки **Создать накладную**, **Отменить заказ**, **Пересчитать**, **Получить продукты** и **Искать адрес** на странице **Заказ на продажу** скрываются для заказов, хранящихся во внешней системе, потому что накладные будут создаваться в Supply Chain Management и синхронизироваться в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-190">The **Create Invoice**, **Cancel Order**, **Recalculate**, **Get Products**, and **Lookup Address** buttons on the **Sales order** page are hidden for externally maintained orders, because invoices will be created in Supply Chain Management and synchronized to Sales.</span></span> <span data-ttu-id="755c7-191">Эти заказы не могут редактироваться, потому что информация заказа на продажу будет синхронизироваться из Supply Chain Management после активации.</span><span class="sxs-lookup"><span data-stu-id="755c7-191">These orders can't be edited, because sales order information will be synchronized from Supply Chain Management after activation.</span></span>

<span data-ttu-id="755c7-192">Статус заказа на продажу будет оставаться **Активный**, чтобы помочь гарантировать, что изменения из Supply Chain Management будут передаваться в заказ на продажу в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-192">The sales order status will remain **Active** to help guarantee that changes from Supply Chain Management can flow to the sales order in Sales.</span></span> <span data-ttu-id="755c7-193">Для управления таким поведением задайте для **Statecode \[Статус\]** значение по умолчанию **Active** в проекте интеграции данных.</span><span class="sxs-lookup"><span data-stu-id="755c7-193">To control this behavior, set the default **Statecode \[Status\]** value to **Active** in the Data integration project.</span></span>

## <a name="preconditions-and-mapping-setup"></a><span data-ttu-id="755c7-194">Предварительные условия и настройка сопоставления</span><span class="sxs-lookup"><span data-stu-id="755c7-194">Preconditions and mapping setup</span></span>

<span data-ttu-id="755c7-195">Перед синхронизацией заказов на продажу необходимо обновить следующие параметры в системах.</span><span class="sxs-lookup"><span data-stu-id="755c7-195">Before you synchronize sales orders, it's important that you update the following settings in the systems.</span></span>

### <a name="setup-in-sales"></a><span data-ttu-id="755c7-196">Настройка в Sales</span><span class="sxs-lookup"><span data-stu-id="755c7-196">Setup in Sales</span></span>

- <span data-ttu-id="755c7-197">Убедитесь, что настроены разрешения для группы, которой назначен пользователь, из вашего набора подключений Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-197">Make sure that permissions are set up for the team that the user from your Sales connection set is assigned to.</span></span> <span data-ttu-id="755c7-198">Если вы используете демонстрационные данные, обычно пользователь имеет доступ администратора, но группа не имеет доступа администратора.</span><span class="sxs-lookup"><span data-stu-id="755c7-198">If you're using demo data, the user usually has admin access, but the team doesn't have admin access.</span></span> <span data-ttu-id="755c7-199">Если группа не имеет доступа администратора при запуске проекта из интеграции данных, вы получите сообщение об ошибке, в котором будет указано, что рабочая группа-участник отсутствует.</span><span class="sxs-lookup"><span data-stu-id="755c7-199">If the team doesn't have admin access, when you run the project from Data integration, you will receive an error message that states that the Principal team is missing.</span></span>

    <span data-ttu-id="755c7-200">Откройте **Параметры** &gt; **Безопасность** &gt; **Группы**, выберите необходимую группу, выберите **Управление ролями** и выберите роль с требуемыми разрешениями, например **Системный администратор**.</span><span class="sxs-lookup"><span data-stu-id="755c7-200">Go to **Settings** &gt; **Security** &gt; **Teams**, select the relevant team, select **Manage Roles**, and select a role that has the desired permissions, such as **System Administrator**.</span></span>

- <span data-ttu-id="755c7-201">Для обеспечения правильного расчета скидок как в Sales, так и в Supply Chain Management для параметра **Способ расчета скидки** должно быть установлено значение **Номенклатура строки**.</span><span class="sxs-lookup"><span data-stu-id="755c7-201">To ensure correct calculation of discounts in both Sales and Supply Chain Management **Discount calculation method** must be set to **Line item**.</span></span>
- <span data-ttu-id="755c7-202">Откройте **Параметры** &gt; **Администрирование** &gt; **Параметры системы** &gt; **Продажи** и убедитесь, что используются следующие настройки:</span><span class="sxs-lookup"><span data-stu-id="755c7-202">Go to **Settings** &gt; **Administration** &gt; **System settings** &gt; **Sales**, and make sure that the following settings are used:</span></span>

    - <span data-ttu-id="755c7-203">Для параметра **Использовать системный расчет цен** установлено значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="755c7-203">The **Use system prizing calculation system** option is set to **Yes**.</span></span>
    - <span data-ttu-id="755c7-204">Для столбца **Способ расчета скидки** установлено значение **Номенклатура строки**.</span><span class="sxs-lookup"><span data-stu-id="755c7-204">The **Discount calculation method** column is set to **Line item**.</span></span>

### <a name="setup-in-supply-chain-management"></a><span data-ttu-id="755c7-205">Настройка в Supply Chain Management</span><span class="sxs-lookup"><span data-stu-id="755c7-205">Setup in Supply Chain Management</span></span>

- <span data-ttu-id="755c7-206">Откройте **Продажи и маркетинг** &gt; **Периодические задачи** &gt; **Рассчитать итоги продаж** и настройте задание для выполнения в качестве пакетного задания.</span><span class="sxs-lookup"><span data-stu-id="755c7-206">Go to **Sales and marketing** &gt; **Periodic tasks** &gt; **Calculate sales totals**, and set the job to run as a batch job.</span></span> <span data-ttu-id="755c7-207">Задайте для параметра **Рассчитанные итоги для заказов на продажу** значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="755c7-207">Set the **Calculate totals for sales orders** option to **Yes**.</span></span> <span data-ttu-id="755c7-208">Этот шаг важен, так как только заказы на продажу, для которых рассчитаны итоговые значения продаж, будут синхронизироваться с Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-208">This step is important, because only sales orders where sales totals are calculated will be synchronized to Sales.</span></span> <span data-ttu-id="755c7-209">Частота пакетного задания должна соответствовать частоте синхронизации заказов на продажу.</span><span class="sxs-lookup"><span data-stu-id="755c7-209">The frequency of the batch job should be aligned with the frequency of sales order synchronization.</span></span>

<span data-ttu-id="755c7-210">Если используется также интеграция заказов на работу, необходимо настроить происхождение заказа на продажу.</span><span class="sxs-lookup"><span data-stu-id="755c7-210">If you also use work order integration, you need to set up the sales origin.</span></span> <span data-ttu-id="755c7-211">Происхождение заказов на продажу используется для различения заказов на продажу в Supply Chain Management, которые были созданы на основе заказов на выполнение работ в Field Service.</span><span class="sxs-lookup"><span data-stu-id="755c7-211">The sales origin is used to distinguish sales orders in Supply Chain Management that were created from work orders in Field Service.</span></span> <span data-ttu-id="755c7-212">Когда заказ на продажу имеет происхождение продаж типа **Интеграция заказов на выполнение работ**, поле **Статус внешнего заказа на выполнение работ** появляется в заголовке заказа на продажу.</span><span class="sxs-lookup"><span data-stu-id="755c7-212">When a sales order has a sales origin of the **Work order integration** type, the **External work order status** field appears on the sales order header.</span></span> <span data-ttu-id="755c7-213">Кроме того, происхождение заказов на продажу гарантирует, что заказы на продажу, которые были созданы на основе заказов на выполнение работ в Field Service, исключаются при фильтрации во время синхронизации заказов на продажу из Supply Chain Management в Field Service.</span><span class="sxs-lookup"><span data-stu-id="755c7-213">Additionally, the sales origin ensures that sales orders that were created from work orders in Field Service are filtered out during sales order synchronization from Supply Chain Management to Field Service.</span></span>

1. <span data-ttu-id="755c7-214">Перейдите в раздел **Продажи и маркетинг** \> **Настройка** \> **Заказы на продажу** \> **Происхождение заказа на продажу**.</span><span class="sxs-lookup"><span data-stu-id="755c7-214">Go to **Sales and marketing** \> **Setup** \> **Sales orders** \> **Sales origin**.</span></span>
2. <span data-ttu-id="755c7-215">Выберите **Создать** для создания нового происхождения заказов на продажу.</span><span class="sxs-lookup"><span data-stu-id="755c7-215">Select **New** to create a new sales origin.</span></span>
3. <span data-ttu-id="755c7-216">В столбце **Происхождение заказа на продажу** введите имя происхождения заказа на продажу, например **SalesOrder**.</span><span class="sxs-lookup"><span data-stu-id="755c7-216">In the **Sales origin** column, enter a name for the sales origin, such as **SalesOrder**.</span></span>
4. <span data-ttu-id="755c7-217">В столбце **Описание** введите описание, например **Заказ на продажу из Sales**.</span><span class="sxs-lookup"><span data-stu-id="755c7-217">In the **Description** column, enter a description, such as **Sales Order from Sales**.</span></span>
5. <span data-ttu-id="755c7-218">Установите флажок **Назначение типа источника**.</span><span class="sxs-lookup"><span data-stu-id="755c7-218">Select the **Origin type assignment** check box.</span></span>
6. <span data-ttu-id="755c7-219">Задайте в столбце **Тип источника продаж** значение **Интеграция заказов на продажу**.</span><span class="sxs-lookup"><span data-stu-id="755c7-219">Set the **Sales origin type** column to **Sales order integration**.</span></span>
7. <span data-ttu-id="755c7-220">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="755c7-220">Select **Save**.</span></span>

### <a name="setup-in-the-sales-orders-sales-to-supply-chain-management---direct-data-integration-project"></a><span data-ttu-id="755c7-221">Настройка в проекте интеграции данных "Заказы на продажу (из Sales в Supply Chain Management) - напрямую"</span><span class="sxs-lookup"><span data-stu-id="755c7-221">Setup in the Sales Orders (Sales to Supply Chain Management) - Direct Data integration project</span></span>

- <span data-ttu-id="755c7-222">Убедитесь в наличии необходимого сопоставления для **Shipto\_country** в **DeliveryAddressCountryRegionISOCode**.</span><span class="sxs-lookup"><span data-stu-id="755c7-222">Make sure that the required mapping exists for **Shipto\_country** to **DeliveryAddressCountryRegionISOCode**.</span></span> <span data-ttu-id="755c7-223">Можно сделать пустым значение по умолчанию в карте соответствия, чтобы избежать необходимости ввода страны/региона для заказов внутри страны/региона.</span><span class="sxs-lookup"><span data-stu-id="755c7-223">You can make blank a default value in the value map to avoid having to type country for national orders.</span></span> <span data-ttu-id="755c7-224">Задайте в левой стороне значение "Пусто", а с правой стороны задайте нужную страну или регион.</span><span class="sxs-lookup"><span data-stu-id="755c7-224">Set the left side to 'Blank', and set the right side to the desired country or region.</span></span>

    <span data-ttu-id="755c7-225">Значение шаблона является схемой значений, где сопоставляются нескольких стран или регионов, и где "Пусто" = США.</span><span class="sxs-lookup"><span data-stu-id="755c7-225">The template value is a value map where several countries or regions are mapped, and where 'Blank' = US.</span></span>

### <a name="setup-in-the-sales-orders-supply-chain-management-to-sales---direct-data-integration-project"></a><span data-ttu-id="755c7-226">Настройка в проекте интеграции данных "Заказы на продажу (из Supply Chain Management в Sales) - напрямую"</span><span class="sxs-lookup"><span data-stu-id="755c7-226">Setup in the Sales Orders (Supply Chain Management to Sales) - Direct Data integration project</span></span>

#### <a name="salesheader-task"></a><span data-ttu-id="755c7-227">Задача SalesHeader</span><span class="sxs-lookup"><span data-stu-id="755c7-227">SalesHeader task</span></span>

- <span data-ttu-id="755c7-228">Для создания заказов в Sales требуется прайс-лист.</span><span class="sxs-lookup"><span data-stu-id="755c7-228">A price list is required in order to create orders in Sales.</span></span> <span data-ttu-id="755c7-229">Обновите схему сопоставления для **pricelevelid.name \[имя прайс-листа\]** на прайс-лист, используемый в Sales для данной валюты.</span><span class="sxs-lookup"><span data-stu-id="755c7-229">Update the value map for **pricelevelid.name \[Price List Name\]** to the price list that is used in Sales per currency.</span></span> <span data-ttu-id="755c7-230">Можно использовать прайс-лист по умолчанию для одной валюты.</span><span class="sxs-lookup"><span data-stu-id="755c7-230">You can use the default price list for a single currency.</span></span> <span data-ttu-id="755c7-231">Если имеются прайс-листы в нескольких валютах, можно использовать схему сопоставления.</span><span class="sxs-lookup"><span data-stu-id="755c7-231">Alternatively, if you have price lists in multiple currencies, you can use a value map.</span></span>

    <span data-ttu-id="755c7-232">Значение по умолчанию шаблона для **pricelevelid.name \[имя прайс-листа\]** — **CRM Service USA (sample)**.</span><span class="sxs-lookup"><span data-stu-id="755c7-232">The default template value for **pricelevelid.name \[Price List Name\]** is **CRM Service USA (sample)**.</span></span>

#### <a name="salesline-task"></a><span data-ttu-id="755c7-233">Задача SalesLine</span><span class="sxs-lookup"><span data-stu-id="755c7-233">SalesLine task</span></span>

- <span data-ttu-id="755c7-234">Убедитесь, что существует требуемая схема сопоставления значений для **SalesUnitSymbol** в Supply Chain Management.</span><span class="sxs-lookup"><span data-stu-id="755c7-234">Make sure that the required value map for **SalesUnitSymbol** in Supply Chain Management exists.</span></span>
- <span data-ttu-id="755c7-235">Убедитесь в том, что требуемые единицы определены в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-235">Make sure that the required units are defined in Sales.</span></span>

    <span data-ttu-id="755c7-236">Значение шаблона, которое имеет сопоставление значений, определено для **SalesUnitSymbol** в **oumid.name**.</span><span class="sxs-lookup"><span data-stu-id="755c7-236">A template value that has a value map is defined for **SalesUnitSymbol** to **oumid.name**.</span></span>

## <a name="template-mapping-in-data-integration"></a><span data-ttu-id="755c7-237">Сопоставление шаблона в интеграции данных</span><span class="sxs-lookup"><span data-stu-id="755c7-237">Template mapping in Data integration</span></span>

> [!NOTE]
> <span data-ttu-id="755c7-238">Столбцы **Условия оплаты**, **Условия фрахта**, **Условия поставки**, **Способ доставки** и **Режим доставки** не являются частью сопоставлений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="755c7-238">The **Payment terms**, **Freight terms**, **Delivery terms**, **Shipping method**, and **Delivery mode** columns aren't part of the default mappings.</span></span> <span data-ttu-id="755c7-239">Чтобы сопоставить эти столбцы, необходимо настроить преобразование значений, характерное для данных в организациях, между которыми синхронизируется таблица.</span><span class="sxs-lookup"><span data-stu-id="755c7-239">To map these columns, you must set up a value mapping that is specific to the data in the organizations that the table is synchronized between.</span></span>

<span data-ttu-id="755c7-240">На следующем рисунке показан пример сопоставления шаблона в интеграции данных.</span><span class="sxs-lookup"><span data-stu-id="755c7-240">The following illustrations show an example of a template mapping in Data integration.</span></span>

> [!NOTE]
> <span data-ttu-id="755c7-241">Сопоставление показывает, какие данные столбцов будут синхронизированы из Sales в Supply Chain Management или из Supply Chain Management в Sales.</span><span class="sxs-lookup"><span data-stu-id="755c7-241">The mapping shows which column information will be synchronized from Sales to Supply Chain Management, or from Supply Chain Management to Sales.</span></span>

### <a name="sales-orders-supply-chain-management-to-sales---direct-orderheader"></a><span data-ttu-id="755c7-242">Заказы на продажу (из Supply Chain Management в Sales) — напрямую: OrderHeader</span><span class="sxs-lookup"><span data-stu-id="755c7-242">Sales Orders (Supply Chain Management to Sales) - Direct: OrderHeader</span></span>

<span data-ttu-id="755c7-243">[![Сопоставление шаблона в интеграции данных](./media/sales-order-direct-template-mapping-data-integrator-1.png)](./media/sales-order-direct-template-mapping-data-integrator-1.png)</span><span class="sxs-lookup"><span data-stu-id="755c7-243">[![Template mapping in Data integration](./media/sales-order-direct-template-mapping-data-integrator-1.png)](./media/sales-order-direct-template-mapping-data-integrator-1.png)</span></span>

### <a name="sales-orders-supply-chain-management-to-sales---direct-orderline"></a><span data-ttu-id="755c7-244">Заказы на продажу (из Supply Chain Management в Sales) — напрямую: OrderLine</span><span class="sxs-lookup"><span data-stu-id="755c7-244">Sales Orders (Supply Chain Management to Sales) - Direct: OrderLine</span></span>

<span data-ttu-id="755c7-245">[![Сопоставление шаблона в интеграции данных](./media/sales-order-direct-template-mapping-data-integrator-2.png)](./media/sales-order-direct-template-mapping-data-integrator-2.png)</span><span class="sxs-lookup"><span data-stu-id="755c7-245">[![Template mapping in Data integration](./media/sales-order-direct-template-mapping-data-integrator-2.png)](./media/sales-order-direct-template-mapping-data-integrator-2.png)</span></span>

### <a name="sales-orders-sales-to-supply-chain-management---direct-orderheader"></a><span data-ttu-id="755c7-246">Заказы на продажу (из Sales в Supply Chain Management) — напрямую: OrderHeader</span><span class="sxs-lookup"><span data-stu-id="755c7-246">Sales Orders (Sales to Supply Chain Management) - Direct: OrderHeader</span></span>

<span data-ttu-id="755c7-247">[![Сопоставление шаблона в интеграции данных](./media/sales-order-direct-template-mapping-data-integrator-3.png)](./media/sales-order-direct-template-mapping-data-integrator-3.png)</span><span class="sxs-lookup"><span data-stu-id="755c7-247">[![Template mapping in Data integration](./media/sales-order-direct-template-mapping-data-integrator-3.png)](./media/sales-order-direct-template-mapping-data-integrator-3.png)</span></span>

### <a name="sales-orders-sales-to-supply-chain-management---direct-orderline"></a><span data-ttu-id="755c7-248">Заказы на продажу (из Sales в Supply Chain Management) — напрямую: OrderLine</span><span class="sxs-lookup"><span data-stu-id="755c7-248">Sales Orders (Sales to Supply Chain Management) - Direct: OrderLine</span></span>

<span data-ttu-id="755c7-249">[![Сопоставление шаблона в интеграции данных](./media/sales-order-direct-template-mapping-data-integrator-4.png)](./media/sales-order-direct-template-mapping-data-integrator-4.png)</span><span class="sxs-lookup"><span data-stu-id="755c7-249">[![Template mapping in Data integration](./media/sales-order-direct-template-mapping-data-integrator-4.png)](./media/sales-order-direct-template-mapping-data-integrator-4.png)</span></span>

## <a name="related-topics"></a><span data-ttu-id="755c7-250">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="755c7-250">Related topics</span></span>

[<span data-ttu-id="755c7-251">Решение "Перспективный клиент в наличные деньги"</span><span class="sxs-lookup"><span data-stu-id="755c7-251">Prospect to cash</span></span>](prospect-to-cash.md)
