---
title: "Синхронизация заголовков и строк предложений по продажам из Sales с Finance and Operations"
description: "В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации заголовков и строк предложений по продажам из Microsoft Dynamics 365 for Sales с Microsoft Dynamics 365 for Finance and Operations, Enterprise Edition."
author: ChristianRytt
manager: AnnBe
ms.date: 08/28/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: 
audience: Application User, IT Pro
ms.reviewer: yuyus
ms.search.scope: Core, Operations
ms.custom: 
ms.assetid: 
ms.search.region: global
ms.search.industry: 
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.translationtype: HT
ms.sourcegitcommit: 2771a31b5a4d418a27de0ebe1945d1fed2d8d6d6
ms.openlocfilehash: c8cfc484eed02423dbf0c7caaf8ac2337b6ac38d
ms.contentlocale: ru-ru
ms.lasthandoff: 11/03/2017

---

# <a name="synchronize-sales-quotation-headers-and-lines-from-sales-to-finance-and-operations"></a>Синхронизация заголовков и строк предложений по продажам из Sales с Finance and Operations

[!include[banner](../includes/banner.md)]

> [!NOTE]
> Перед использованием решения "Перспективный клиент в наличные деньги" ознакомьтесь с разделом [Интеграция данных Dynamics 365](/common-data-service/entity-reference/dynamics-365-integration). 

В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации заголовков и строк предложений по продажам из Microsoft Dynamics 365 for Sales (Sales) с Microsoft Dynamics 365 for Finance and Operations , выпуск Enterprise, (Finance and Operations). 

## <a name="template-and-tasks"></a>Шаблон и задачи

Следующие шаблоны и базовые задачи используются для синхронизации заголовков и строк предложений по продажам из Sales с Finance and Operations:

- **Имя шаблона:** предложения по продажам (Sales в Fin and Ops)
- **Имена задач в проекте:**

    - QuoteHeader
    - QuoteLine

Перед синхронизацией заголовков и строк предложений по продажам требуются следующие задачи синхронизации:

- Продукты (из Fin and Ops в Sales)
- Счета (из Sales в Fin and Ops) (если используются)
- Из контактов в клиенты (из Sales в Fin and Ops) (если используются)

## <a name="entity-set"></a>Набор объектов

| Прод.        | CDS           | Finance and Operations    |
|--------------|---------------|---------------------------|
| Цитаты       | Предложение     | Заголовки предложений по продаже   |
| QuoteDetails | QuotationLine | Строки предложения по продаже CDS |

## <a name="entity-flow"></a>Поток объектов

Предложения по продажам создаются в Sales и синхронизируются с Finance and Operations.

Предложения по продажам из Sales синхронизируются, только если выполняются следующие условия:

- Все продукты в строках предложения по продаже управляются извне.
- Предложение по продаже активно или активировано.

## <a name="prospect-to-cash-solution-for-sales"></a>Решение "Перспективный клиент в наличные деньги" для Sales

Добавлено поле **Имеет только управляемые извне продукты** к объекту "Предложение по продаже" для постоянного отслеживания того, состоит ли предложение по продаже полностью из управляемых извне продуктов. Если предложение по продаже содержит только управляемые извне продукты, продукты управляются в Finance and Operations. Это поведение помогает гарантировать, что вы не будете пытаться синхронизировать строки предложения по продаже с продуктами, которые неизвестны для Finance and Operations.

Все продукты и строки в предложении обновляются сведениями **Имеет только управляемые извне продукты** из заголовка предложения. Эти сведения можно найти в поле **Предложения имеет только управляемые извне продукты** в объекте строки предложения.

Поля **Скидка**, **Расходы** и **Налог** управляются сложной настройкой в Finance and Operations. Эта настройка не поддерживает сопоставление интеграции в данный момент. В текущем дизайне поля **Цена**, **Скидка**, **Расходы** и **Налог** управляются и обрабатываются в Finance and Operations.

В Sales решение делает следующие поля доступными только для чтения, поскольку значения не синхронизируются с Finance and Operations:

- **Доступные только для чтения поля в заголовке предложения по продаже:** "% скидки", "Скидка", "Сумма транспортировки"
- **Доступные только для чтения поля в строках предложения по продаже:** "Налог"

## <a name="preconditions-and-mapping-setup"></a>Предварительные условия и настройка сопоставления

Перед синхронизацией заказов на продажу необходимо задать в системах следующие параметры:

### <a name="setup-in-sales"></a>Настройка в Sales

- Выберите **Параметры** &gt; **Администрирование** &gt; **Параметры системы** &gt; **Продажи** и убедитесь, что в поле **Способ расчета скидки** установлено значение **За единицу**. Этот параметр помогает гарантировать соответствие скидки номенклатуры строки из Sales с параметром в Finance and Operations. В противном случае скидка будет неправильной в Finance and Operations, поскольку Finance and Operations будет считывать скидку как скидку на единицу, даже если это скидка по строке в Sales.

### <a name="setup-in-finance-and-operations"></a>Настройка в Finance and Operations

- Выберите **Расчеты с клиентами** &gt; **Настройка** &gt; **Параметры модуля расчетов с клиентами**. На вкладке **Номерная серия** выберите номерную серию для предложений по продажам, а затем щелкните **Просмотр сведений**. Затем в разделе **Общая Настройка** установите в поле **Вручную** значение **Да**.
- Выберите **Расчеты с клиентами** &gt; **Настройка** &gt; **Параметры модуля расчетов с клиентами**. Затем на вкладке **Отгрузки** установите для поля **Контроль даты поставки** значение **Нет**. Этот параметр позволяет избежать сбоя синхронизации предложений по продажам.

### <a name="setup-in-the-data-integration-project"></a>Настройка в проекте интеграции данных

#### <a name="quoteheader"></a>QuoteHeader

- Поле **Запрошенная дата доставки** является обязательным в Finance and Operations, и синхронизация завершится с ошибкой, если оставить его пустым. Чтобы предотвратить эту проблему, если это поле пусто, используется дата по умолчанию из раздела **Источник &gt; CDS**. Дата должна быть обновлена до нужного значения. В настоящее время невозможно ввести значение, такое как **Сегодня**, для представления текущей даты. Необходимо ввести определенную дату. Значение шаблона по умолчанию для поля **Запрошенная дата доставки** — **1/1/2020**.
- Поле **Код страны/региона адреса** является обязательным в Finance and Operations. Чтобы предотвратить ошибки синхронизации, можно указать значение по умолчанию, которое используется, если это поле пусто в Sales. Это значение по умолчанию также является полезным, поскольку вам не нужно вручную вводить значение в поле **Страна/регион** для локальных адресов. Не существует значения шаблона по умолчанию для **DeliveryAddressCountryRegionISOCode**.
- Обновите сопоставление для полей **Код организации CDS** в разделе **Источник &gt; CDS**, чтобы оно соответствовало значению **Организации CDS** в объекте "Организация":

    - Значение шаблона по умолчанию для **Organization_OrganizationId** — **ORG001**.
    - Значение шаблона по умолчанию для **Account_Organization_OrganizationId** — **ORG001**.
    - Значение шаблона по умолчанию для **InvoiceAccount_OrganizationId** — **ORG001**.

#### <a name="quoteline"></a>QuoteLine

- Обновите сопоставление для полей **Код организации CDS** в разделе **Источник &gt; CDS**, чтобы оно соответствовало значению **Организации CDS** в объекте "Организация":

    - Значение шаблона по умолчанию для **Organization_OrganizationId** — **ORG001**.
    - Значение шаблона по умолчанию для **Product_Organization_Organization_OrganizationId** — **ORG001**.
    - Значение шаблона по умолчанию для **Quotation_Organization_Organization_OrganizationId** — **ORG001**.

- Поле **Запрошенная дата доставки** является обязательным в Finance and Operations, и синхронизация завершится с ошибкой, если оставить его пустым. Чтобы предотвратить эту проблему, если это поле пусто, используется дата по умолчанию из раздела **Источник &gt; CDS**. Дата должна быть обновлена до нужного значения. В настоящее время невозможно ввести значение, такое как **Сегодня**, для представления текущей даты. Необходимо ввести определенную дату. Значение шаблона по умолчанию для поля **Запрошенная дата доставки** — **1/1/2020**.
- Можно добавить следующие сопоставления из раздела **CDS &gt; Назначение** для гарантии того, что строки этого предложения будут импортироваться в Finance and Operations, если отсутствует информация по умолчанию от клиента или продукта:

    - **SiteId** — сайт необходим для создания предложений и строк заказов на продажу в Finance and Operations. Не существует значения шаблона по умолчанию для **SiteId**.
    - **WarehouseId** — склад необходим для обработки предложений и строк заказов на продажу в Finance and Operations. Не существует значения шаблона по умолчанию для **WarehouseId**.

- Убедитесь, что требуемое соответствие значений для единицы измерения продажи в Finance and Operations существует в сопоставлении **CDS &gt; Назначение** для **Quantity_UOM** как **SALESUNITSYMBOL**.

## <a name="template-mapping-in-data-integrator"></a>Сопоставление шаблона в интеграторе данных

> [!NOTE]
> - Поля **Скидка**, **Расходы** и **Налог** управляются сложной настройкой в Finance and Operations. Эта настройка не поддерживает сопоставление интеграции в данный момент. В текущем дизайне поля **Цена**, **Скидка**, **Расходы** и **Налог** обрабатываются в Finance and Operations.
> - Поля **Условия оплаты**, **Условия фрахта**, **Условия поставки**, **Способ доставки** и **Режим доставки** не являются частью сопоставлений по умолчанию. Чтобы сопоставить эти поля, необходимо настроить преобразование значений, характерное для данных в организациях, между которыми синхронизируется объект.

На следующем рисунке показан пример сопоставления шаблона в интеграторе данных.

### <a name="quoteheader"></a>QuoteHeader

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-template-mapping-data-integrator-1.png)

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-template-mapping-data-integrator-2.png)

### <a name="quoteline"></a>QuoteLine

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-template-mapping-data-integrator-3.png)

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-template-mapping-data-integrator-4.png)

## <a name="related-topics"></a>Связанные разделы

[Синхронизация продуктов из Finance and Operations с продуктами в Sales](products-template-mapping.md)

[Синхронизация организаций из Finance and Operations с клиентами в Sales](accounts-template-mapping.md)

[Синхронизация контактов из Sales с контактами или клиентами в Finance and Operations](contacts-template-mapping.md)



