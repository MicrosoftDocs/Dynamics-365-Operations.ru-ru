---
title: "Синхронизация накладных соглашения в Field Service с накладными с произвольным текстом в Finance and Operations"
description: "В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации накладных по соглашению в Microsoft Dynamics 365 for Field Service с накладными с произвольным текстом в Microsoft Dynamics 365 for Finance and Operations."
author: ChristianRytt
manager: AnnBe
ms.date: 04/10/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: 
audience: Application User, IT Pro
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 
ms.assetid: 
ms.search.region: global
ms.search.industry: 
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.translationtype: HT
ms.sourcegitcommit: ace66c037953f4b1b2e8b93a315faefdb090b1eb
ms.openlocfilehash: 6672e283a5e56b068e3494d53a0fd6dd08253ba9
ms.contentlocale: ru-ru
ms.lasthandoff: 05/08/2018

---

# <a name="synchronize-agreement-invoices-in-field-service-to-free-text-invoices-in-finance-and-operations"></a>Синхронизация накладных соглашения в Field Service с накладными с произвольным текстом в Finance and Operations

[!include[banner](../includes/banner.md)]

В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации накладных по соглашению в Microsoft Dynamics 365 for Field Service с накладными с произвольным текстом в Microsoft Dynamics 365 for Finance and Operations.

## <a name="templates-and-tasks"></a>Шаблоны и задачи

Следующий шаблон и базовые задачи используются для выполнения синхронизации накладных по соглашению из Field Service с накладными с произвольным текстом в Finance and Operations.

**Имя шаблона в интеграции данных:**

- Накладные по соглашению (из Field Service в Fin and Ops)

**Имена задач в проекте интеграции данных:**

- Заголовки накладной
- Строки накладной

Перед синхронизацией накладных по соглашению требуется следующая синхронизация:

- Организации (из Sales в Fin and Ops) — напрямую

## <a name="entity-set"></a>Набор объектов

| Field Service  | Finance and Operations                 |
|----------------|----------------------------------------|
| накладные       | Заголовки накладных с произвольным текстом клиента CDS |
| invoicedetails | Строки накладных с произвольным текстом клиента CDS   |

## <a name="entity-flow"></a>Поток объектов

Накладные, которые создаются из соглашения в Field Service, можно синхронизировать с Finance and Operations через проект интеграцию данных службы Common Data Service (CDS). Обновления в этих накладных будут синхронизированы с накладными с произвольным текстом в Finance and Operations, если накладные с произвольным текстом имеют состояние учета **В процессе**. После того как накладные с произвольным текстом разносятся в Finance and Operations и статус учета обновляется на **Завершено**, вы больше не сможете синхронизировать обновления из Field Service.

## <a name="field-service-crm-solution"></a>Решение Field Service CRM

Поле **Имеет строки с происхождением из соглашения** было добавлено в объект **Накладная**. Это поле помогает гарантировать, что синхронизируются только накладные, созданные из соглашения. Значение равно **true**, если накладная содержит по крайней мере одну строку накладной, которая происходит из соглашения.

Поле **Имеет происхождение из соглашения** было добавлено в объект **Строка накладной**. Это поле помогает гарантировать, что синхронизируются только строки накладных, созданные из соглашения. Значение равно **true**, если строка накладной происходит из соглашения.

**Дата накладной** является обязательным полем в Finance and Operations. Таким образом, это поле должно иметь какое-то значение в Field Service, прежде чем произойдет синхронизация. Для выполнения этого условия добавлена следующая логика:

- Если поел **Дата накладной** не заполнено в объекте **Накладная** (то есть, если оно не имеет никакого значения), для него задается текущая дата при добавлении строки накладной, происходящей из соглашения.
- Пользователь может изменить поле **Дата накладной**. Тем не менее, когда пользователь пытается сохранить накладную, которая происходит из соглашения, он или она получает ошибку бизнес-процесса, если поле **Дата накладной** не заполнено в накладной.

## <a name="prerequisites-and-mapping-setup"></a>Необходимые условия и настройка сопоставления

### <a name="in-finance-and-operations"></a>В Finance and Operations

Исходная накладная должна быть настроена для интеграции, чтобы отличать накладные с произвольным текстом в Finance and Operations, которые создаются из накладных по соглашениям в Field Service. Когда накладная имеет источник накладной типа **Интеграция накладных договора**, поле **Внешний номер накладной** будет отображаться в заголовке **Накладная заказа на продажу**.

Помимо появления в заголовке накладной, информация **Внешний номер накладной** может использоваться, чтобы помочь гарантировать, что накладные, которые созданы из накладных по договору Field Service, отфильтровывались во время синхронизации накладных из Finance and Operations в Field Service.

1. Выберите **Расчеты с клиентами** \> **Настройка** \> **Коды источников накладных**.
2. Выберите **Создать** для создания нового происхождения накладных.
3. В поле **Источник накладной** введите имя источника накладной, например **FS**.
4. В поле **Описание** введите описание, например **Накладная по договору Field Service**.
5. Установите флажок **Назначение типа источника**.
6. Задайте в поле **Тип источника накладной** значение **Интеграция накладных договора**.
7. Выберите **Сохранить**.

### <a name="in-the-data-integration-project"></a>В проекте интеграции данных

Задача: **Строки накладной**  

Убедитесь, что значение по умолчанию для поля Finance and Operations **Отображаемое значение счета ГК** обновлено в соответствии с нужным значением.

Значение шаблона по умолчанию — **401100**.

## <a name="template-mapping-in-data-integration"></a>Сопоставление шаблона в интеграции данных

На следующем рисунке показано сопоставление шаблона в интеграции данных.

### <a name="agreement-invoices-field-service-to-fin-and-ops-invoice-headers"></a>Накладные по соглашению (из Field Service в Fin and Ops): заголовки накладной

[![Сопоставление шаблона в интеграции данных](./media/FSFreeTextInvoice1.png)](./media/FSFreeTextInvoice1.png)

### <a name="agreement-invoices-field-service-to-fin-and-ops-invoice-lines"></a>Накладные по соглашению (из Field Service в Fin and Ops): строки накладной

[![Сопоставление шаблона в интеграции данных](./media/FSFreeTextInvoice2.png)](./media/FSFreeTextInvoice2.png)

