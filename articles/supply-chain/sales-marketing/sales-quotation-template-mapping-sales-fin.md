---
title: Синхронизация заголовков и строк предложений по продаже непосредственно из Sales с Supply Chain Management
description: В этой теме рассматриваются шаблоны и базовые задачи, которые используются для синхронизации заголовков и строк предложений по продаже непосредственно из Dynamics 365 Sales в Dynamics 365 Supply Chain Management.
author: ChristianRytt
manager: tfehr
ms.date: 10/25/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User, IT Pro
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: ''
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.openlocfilehash: c7d4cacbf56243830633f4d0fd3c57071b08ab56
ms.sourcegitcommit: e89bb3e5420a6ece84f4e80c11e360b4a042f59d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "4527346"
---
# <a name="synchronize-sales-quotation-headers-and-lines-directly-from-sales-to-supply-chain-management"></a>Синхронизация заголовков и строк предложений по продаже непосредственно из Sales с Supply Chain Management

[!include [banner](../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

В этой теме рассматриваются шаблоны и базовые задачи, которые используются для синхронизации заголовков и строк предложений по продаже непосредственно из Dynamics 365 Sales в Dynamics 365 Supply Chain Management.

> [!NOTE]
> Перед использованием решения "Перспективный клиент в наличные деньги" следует ознакомиться с разделом [Интеграция данных в Common Data Service для приложений](https://docs.microsoft.com/powerapps/administrator/data-integrator).

## <a name="data-flow-in-prospect-to-cash"></a>Поток данных в решение "Перспективный клиент в наличные деньги"

Решение "Перспективный клиент в наличные деньги" использует функцию интеграции данных для синхронизации данных между экземплярами Supply Chain Management и Sales. Шаблоны "Перспективный клиент в наличные деньги", доступные в компоненте интеграции данных, обеспечивают движение данных для организаций, контактов, продуктов, предложений по продажам, заказов на продажу и накладных по продажам между Supply Chain Management и Sales. На следующем рисунке показано, как данные синхронизируются между Supply Chain Management и Sales.

[![Поток данных в решение "Перспективный клиент в наличные деньги"](./media/prospect-to-cash-data-flow.png)](./media/prospect-to-cash-data-flow.png)

## <a name="template-and-tasks"></a>Шаблон и задачи

Следующий шаблон и базовые задачи используются для синхронизации заголовков и строк предложений по продажам напрямую из Sales с Supply Chain Management:

- **Имя шаблона в интеграции данных:** "Предложения по продажам (из Sales в Supply Chain Management) — напрямую"
- **Имена задач в проекте интеграции данных:**

    - QuoteHeader
    - QuoteLine

Перед синхронизацией заголовков и строк предложений по продажам требуются следующие задачи синхронизации:

- Продукты (из Supply Chain Management в Sales) — напрямую
- Счета (из Sales в Supply Chain Management) — напрямую (если используется)
- Из контактов в клиенты (из Sales в Supply Chain Management) - напрямую (если используются)

## <a name="entity-set"></a>Набор объектов

| Прод.        | Управление цепочкой поставок     |
|--------------|----------------------------|
| Цитаты       | Заголовок предложения по продаже CDS |
| QuoteDetails | Строки предложения по продаже CDS  |

## <a name="entity-flow"></a>Поток объектов

Предложения по продажам создаются в Sales и синхронизируются с Supply Chain Management.

Предложения по продажам из Sales синхронизируются, только если выполняются следующие условия:

- Все предлагаемые продукты в предложении по продаже управляются извне.
- После нажатия кнопки **Активировать предложение** это предложение по продажам становится активным.

## <a name="prospect-to-cash-solution-for-sales"></a>Решение "Перспективный клиент в наличные деньги" для Sales

Добавлено поле **Имеет только управляемые извне продукты** к объекту **Предложение по продаже** для постоянного отслеживания того, состоит ли предложение по продаже полностью из управляемых извне продуктов. Если предложение по продаже содержит только управляемые извне продукты, продукты управляются в Supply Chain Management. Это поведение помогает гарантировать, что вы не будете пытаться синхронизировать строки предложения по продаже, которые содержат продукты, неизвестные для Supply Chain Management.

Все предлагаемые продукты в предложении по продажам обновляются сведениями **Имеет только управляемые извне продукты** из заголовка предложения по продажам. Эти сведения находятся в поле **Предложения имеет только управляемые извне продукты** в объекте **QuoteDetails**.

Скидка может быть добавлена для продукта предложения с расценками и будет синхронизирована с Supply Chain Management. Поля **Скидка**, **Расходы** и **Налог** в заголовке управляются настройкой в Supply Chain Management. В настоящее время эта настройка не поддерживает сопоставление интеграции. В текущем дизайне поля **Цена**, **Скидка**, **Расходы** и **Налог** управляются и обрабатываются в Supply Chain Management.

В Sales решение делает следующие поля доступными только для чтения, поскольку значения не синхронизируются с Supply Chain Management:

- Доступные только для чтения поля в заголовке предложения по продаже: **% скидки**, **Скидка** и **Сумма транспортировки**
- Поля только для чтения в продуктах предложения с расценками: **Налог**

## <a name="preconditions-and-mapping-setup"></a>Предварительные условия и настройка сопоставления

Перед синхронизацией предложений по продажам необходимо обновить следующие параметры:

### <a name="setup-in-sales"></a>Настройка в Sales

- Убедитесь, что настроены разрешения для группы, которой назначен пользователь, из вашего набора подключений в Sales. Если вы используете демонстрационные данные, обычно пользователь имеет доступ администратора, но группа не имеет доступа администратора. Если группа не имеет доступа администратора при запуске проекта из интеграции данных, вы получите сообщение об ошибке, в котором будет указано, что рабочая группа-участник отсутствует.

    Чтобы настроить разрешения для группы, откройте **Параметры** &gt; **Контроль доступа** &gt; **Группы** и выберите соответствующую группу. Выберите **Управление ролями**, выберите роль с требуемыми разрешениями, например **Системный администратор**.

- Откройте **Параметры** &gt; **Администрирование** &gt; **Параметры системы** &gt; **Продажи** и убедитесь, что используются следующие настройки:

    - Для параметра **Использовать системный расчет цен** установлено значение **Да**.
    - Для параметра **Способ расчета скидки** установлено значение **Номенклатура строки**.

### <a name="setup-in-the-data-integration-project"></a>Настройка в проекте интеграции данных

#### <a name="quoteheader"></a>QuoteHeader

- Убедитесь в наличии необходимого сопоставления для **Shipto\_country** в **DeliveryAddressCountryRegionISOCode**. В схеме значений можно определить значение по умолчанию, которое используется, если значение не заполнено. Просто оставьте левой сторону пустой, а с правой стороны задайте нужную страну или регион. Таким образом, нет необходимости вводить страну или регион для заказов внутри страницы.

    Значение шаблона является схемой значений, где сопоставляются нескольких стран или регионов, и где пустое значение равно значению **США**.

#### <a name="quoteline"></a>QuoteLine

- Убедитесь, что требуемая схема сопоставления значений существует для **SalesUnitSymbol** в Supply Chain Management.
- Убедитесь в том, что требуемые единицы определены в Sales.

    Значение шаблона, которое имеет сопоставление значений, определено для **oumid.name** в **SalesUnitSymbol**.

- Дополнительно: можно добавить следующие сопоставления для гарантии того, что строки этого предложения по продажам будут импортироваться в Supply Chain Management, если отсутствует информация по умолчанию от клиента или продукта:

    - **SiteId** — сайт необходим для создания предложений и строк заказов на продажу в Supply Chain Management. Не существует значения шаблона по умолчанию для **SiteId**.
    - **WarehouseId** — склад необходим для обработки предложений и строк заказов на продажу в Supply Chain Management. Не существует значения шаблона по умолчанию для **WarehouseId**.

## <a name="template-mapping-in-data-integrator"></a>Сопоставление шаблона в интеграторе данных

> [!NOTE]
> - Поля **Скидка**, **Расходы** и **Налог** управляются комплексной настройкой в Supply Chain Management. В настоящее время эта настройка не поддерживает сопоставление интеграции. В текущем дизайне поля **Цена**, **Скидка**, **Расходы** и **Налог** обрабатываются в Supply Chain Management.
> - Поля **Условия оплаты**, **Условия фрахта**, **Условия поставки**, **Способ доставки** и **Режим доставки** не являются частью сопоставлений по умолчанию. Чтобы сопоставить эти поля, необходимо настроить преобразование значений, характерное для данных в организациях, между которыми синхронизируется объект.

На следующем рисунке показан пример сопоставления шаблона в интеграторе данных.

### <a name="quoteheader"></a>QuoteHeader

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-direct-template-mapping-data-integrator-1.png)

### <a name="quoteline"></a>QuoteLine

![Сопоставление шаблона в интеграторе данных](./media/sales-quotation-direct-template-mapping-data-integrator-2.png)

## <a name="related-topics"></a>Связанные разделы

[Решение "Перспективный клиент в наличные деньги"](prospect-to-cash.md)



[!INCLUDE[footer-include](../../includes/footer-banner.md)]