---
title: "Синхронизация контактов непосредственно из Sales с контактами и клиентами в Finance and Operations"
description: "В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации объектов Контакт (контакты) и Контакт (клиенты) из Microsoft Dynamics 365 for Sales с Microsoft Dynamics 365 for Finance and Operations, Enterprise Edition."
author: ChristianRytt
manager: AnnBe
ms.date: 10/25/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: 
audience: Application User, IT Pro
ms.reviewer: yuyus
ms.search.scope: Core, Operations
ms.custom: 
ms.assetid: 
ms.search.region: global
ms.search.industry: 
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.translationtype: HT
ms.sourcegitcommit: 0d409b3b7f19ca31d9c720bca191f1ddba81caa3
ms.openlocfilehash: 6269b73dfca46d455784046199463d3f86e653ae
ms.contentlocale: ru-ru
ms.lasthandoff: 03/13/2018

---

# <a name="synchronize-contacts-directly-from-sales-to-contacts-or-customers-in-finance-and-operations"></a>Синхронизация контактов непосредственно из Sales с контактами и клиентами в Finance and Operations

[!include[banner](../includes/banner.md)]

> [!NOTE]
> Перед использованием решения "Перспективный клиент в наличные деньги" следует ознакомиться с разделом [Интеграция данных Dynamics 365](/common-data-service/entity-reference/dynamics-365-integration).

В этой теме обсуждаются шаблоны и базовые задачи, которые используются для синхронизации объектов Контакт (контакты) и Контакт (клиенты) непосредственно из Microsoft Dynamics 365 for Sales с Microsoft Dynamics 365 for Finance and Operations, Enterprise Edition.

## <a name="data-flow-in-prospect-to-cash"></a>Поток данных в решение "Перспективный клиент в наличные деньги"

Решение "Перспективный клиент в наличные деньги" использует функцию интеграции данных для синхронизации данных между экземплярами Finance and Operations и Sales. Шаблоны "Перспективный клиент в наличные деньги", доступные в компоненте интеграции данных, обеспечивают движение данных об организациях, контактах, продуктах, предложениях по продажам, заказах на продажу и накладных по продажам между Finance and Operations и Sales. На следующем рисунке показано, как данные синхронизируются между Finance and Operations и Sales.

[![Поток данных в решение "Перспективный клиент в наличные деньги"](./media/prospect-to-cash-data-flow.png)](./media/prospect-to-cash-data-flow.png)

## <a name="templates-and-tasks"></a>Шаблоны и задачи

Чтобы получить доступ к доступным шаблонам, откройте [Центр администрирования PowerApps](https://preview.admin.powerapps.com/dataintegration). Выберите **Проекты**, затем в правом верхнем углу выберите **Создать проект**, чтобы выбрать общие шаблоны.

Следующие шаблоны и базовые задачи используются для синхронизации объектов "Контакт" (контакты) в Sales с объектами "Контакт" (клиенты) в Finance and Operations:

- **Имена шаблонов в интеграции данных:**

    - Контакты (из Sales в Fin and Ops) — напрямую
    - Контакты с клиентом (из Sales в Fin and Ops) — напрямую

- **Имена задач в проекте интеграции данных:**

    - Контактные лица
    - ContactToCustomer

Следующая задача синхронизации необходима, чтобы стала возможна синхронизации контактов: счета (из Sales в Fin and Ops)

## <a name="entity-sets"></a>Наборы объектов

| Прод.    | Finance and Operations |
|----------|------------------------|
| Контактные лица | Контакты CDS           |
| Контактные лица | Клиенты V2           |

## <a name="entity-flow"></a>Поток объектов

Контакты управляются в Sales и синхронизируются с Finance and Operations.

Контакт в Sales может стать контактом или клиентом в Finance and Operations. Чтобы определить, должен ли контакт в Sales синхронизироваться в Finance and Operations в качестве контакта или клиента, система проверяет следующие свойства контакта в Sales:

- **Синхронизация с клиентом в Finance and Operations:** контакты, в которых для параметра **Является активным клиентом** задано значение **Да**.
- **Синхронизация с контактом в Finance and Operations:** контакты, у которых для параметра **Является активным клиентом** задано значение **Нет**, а параметр **Компания** (родительская организация/контакт) указывает на организацию (не на контакт).

## <a name="prospect-to-cash-solution-for-sales"></a>Решение "Перспективный клиент в наличные деньги" для Sales

Новое поле **Является активным клиентов** добавлено к контакту. Это поле используется для разделения контактов, имеющих мероприятия по продаже, и контактов, не имеющих мероприятий по продаже. В поле **Является активным клиентом** установлено значение **Да** только для контактов, с которыми связаны предложения, заказы или счета. Только эти контакты синхронизируются с Finance and Operations как клиенты.

Новое поле **IsCompanyAnAccount** добавлено к контакту. Это поле указывает, связан ли контакт с компанией (родительской организацией/контактом) типа **Организация**. Эта информация используется для определения контактов, которые должны синхронизироваться с Finance and Operations как контакты.

Новое поле **Номер контакта** добавлено к контакту для предоставления естественного и уникального ключа для интеграции. Когда создается новый контакт, значение **Номер контакта** обновляется автоматически с использованием номерной серии. Значение состоит из **CON**, после чего следует увеличивающая номерная серия и суффикс из шести символов. Пример: **CON-01000-BVRCPS**

При применении решения интеграции для Sales сценарий обновления задает значение в поле **Номер контакта** для существующих контактов с использованием номерной серии, как описано выше. Сценарий обновления также задает для поля **Является активным клиентом** значение **Да** для всех контактов, имеющие мероприятия по продажам.

## <a name="in-finance-and-operations"></a>В Finance and Operations

Контакты, помеченные с помощью свойства **IsContactPersonExternallyMaintained**. Это свойство указывает, что данный контакт ведется извне. В этом случае контакты, ведение которых выполняется извне, ведутся в Sales.

## <a name="preconditions-and-mapping-setup"></a>Предварительные условия и настройка сопоставления

### <a name="contact-to-customer"></a>Контакт в клиента

- Поле **CustomerGroup** является обязательным в Finance and Operations. Чтобы помочь избежать ошибок синхронизации, можно указать значение по умолчанию в сопоставлении. Это значение по умолчанию будет использоваться, если это поле оставить пустым в Sales.

    Значение шаблона по умолчанию — **10**.

- Добавляя следующие сопоставления, можно уменьшить число обновлений вручную, необходимых в Finance and Operations. Можно использовать значение по умолчанию или сопоставление значений, например, из поля **Страна/регион** или **Город**.

    - **SiteId** — сайт по умолчанию также может быть определен в продуктах в Finance and Operations. Сайт необходим для создания предложений и заказов на продажу в Finance and Operations.

        Значение шаблона для **SiteId** не определено.

    - **WarehouseId** — склад по умолчанию также может быть определен в продуктах в Finance and Operations. Склад необходим для создания предложений и заказов на продажу в Finance and Operations.

        Значение шаблона для **WarehouseId** не определено.

    - **LanguageId** — язык необходим для создания предложений и заказов на продажу в Finance and Operations.
    
        Значение шаблона по умолчанию — **en-us**.

## <a name="template-mapping-in-data-integration"></a>Сопоставление шаблона в интеграции данных

На следующем рисунке показан пример сопоставления шаблона в интеграции данных. 

> [!NOTE]
> Сопоставление показывает, какие данные полей будут синхронизированы из Sales в Finance and Operations.

### <a name="contact-to-contact"></a>Контакт в контакт

![Сопоставление шаблона в интеграторе данных](./media/contacts-direct-template-mapping-data-integrator-1.png)

### <a name="contact-to-customer"></a>Контакт в клиента

![Сопоставление шаблона в интеграторе данных](./media/contacts-direct-template-mapping-data-integrator-2.png)


## <a name="related-topics"></a>Связанные разделы

[Решение "Перспективный клиент в наличные деньги"](prospect-to-cash.md)

[Синхронизация организаций непосредственно из Sales с клиентами в Finance and Operations](accounts-template-mapping-direct.md)

[Прямая синхронизация продуктов из Finance and Operations с продуктами в Sales](products-template-mapping-direct.md)

[Синхронизация заголовков и строк заказов на продажу непосредственно из Finance and Operations в Sales](sales-order-template-mapping-direct-two-ways.md)

[Синхронизация заголовков и строк счетов продажи непосредственно из Finance and Operations в Sales](sales-invoice-template-mapping-direct.md)



