---
title: Запечатывание предложений для запросов предложений
description: В этом разделе описывается, как настроить запечатанное предложение, чтобы сохранить ответы на предложение поставщика в секрете, пока они не будут распечатаны сотрудниками по закупкам.
author: Henrikan
ms.date: 08/02/2021
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: henrikan
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 96549b6053ba75f2d5b9a85bcd5b7feb006f0f1b
ms.sourcegitcommit: 3b87f042a7e97f72b5aa73bef186c5426b937fec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2021
ms.locfileid: "7578088"
---
# <a name="sealed-bidding-for-rfqs"></a>Запечатывание предложений для запросов предложений

[!include [banner](../includes/banner.md)]

Запечатанное предложение хранит ответы на предложение поставщика в секрете, пока они не будут распечатаны сотрудниками по закупкам. Все предложения, имеющие отношение к запросу предложения, сначала могут быть распечатаны после истечения срока действия предложения. Прежде чем предложение будет распечатано, только пользователи, имеющие выделенные роли пользователей и представляющие поставщика, могут получить доступ к нему.

> [!IMPORTANT]
> Изменение или расширение форм или создание новых форм или бизнес-логики могут привести к нарушению защиты, предоставляемой корпорацией Майкрософт для запечатанных предложений. Вы несете риск использования каких-либо модификаций, расширений, новых форм или бизнес-логики или невозможности использования функции запечатанных предложений вследствие таких модификаций, расширений, новых форм или бизнес-логики.  Корпорация Майкрософт не несет ответственности за любые убытки, возникающие в результате каких-либо модификаций или расширений форм, либо создания любых новых форм или бизнес-логики вами или любой другой сторонней компанией для вас. Корпорация Майкрософт не предоставляет технической или иной поддержки каких-либо модификаций, расширений, новых форм или коммерческой логики, созданных вами или любой третьей стороной от вашего имени. Вы несете единоличную ответственность за соблюдение всех применимых законов или законодательных положений относительно запечатанных предложений.

## <a name="how-bids-are-kept-secure"></a>Как предложения сохраняется в секрете

Запечатанное предложение использует асимметричное шифрование для шифрования ключа шифрования предложения (KEK) и симметричное шифрование для шифрования текущего предложения. Система интегрируется с Microsoft Azure Key Vault для создания и управления ключами шифрования, которые используются для шифрования запечатанных предложений. Каждое предложение имеет собственный ключ шифрования. Это шифрование сохраняется в хранилище ключей, которое принадлежит организации, которая использует Dynamics 365 Supply Chain Management. При необходимости шифрования и расшифровки система обращается к хранилищу ключей по запросу.

## <a name="setup-and-configuration"></a>Настройка и конфигурация

В этом разделе описываются необходимые компоненты, которые должны быть выполнены, прежде чем можно будет отсылать запросы предложений, требующие запечатанных предложений.

### <a name="step-1-set-up-user-access-to-sealed-bidding"></a>Шаг 1: настройка доступа пользователя к запечатанным предложениям

Когда используется запечатанное предложение, только пользователи, настроенные в качестве контактного лица для поставщика, могут просматривать, изменять и отправлять предложения для данного поставщика, пока не истечет период торгов. Эти пользователи должны иметь роль **поставщик (внешний)**, и они должны быть указаны в качестве контактного лица для учетной записи поставщика. Контактное лицо должно также иметь разрешение на сотрудничество с поставщиком, как описано в разделе [Настройка и ведение совместной работы с поставщиками](set-up-maintain-vendor-collaboration.md).

Так как пользователи с соответствующими разрешениями и, настроенные как контактное лицо поставщика, могут получить доступ к запечатанным предложениям для поставщика, важно следить за тем, кто эти пользователи. Системный администратор, который настраивает пользователей и роли безопасности, несет ответственность за ограничение доступа к запечатанным предложениям тем пользователям, которым действительно разрешено их просматривать.

### <a name="step-2-enable-the-sealed-bidding-feature"></a>Шаг 2: включите функцию запечатанных предложений

Прежде чем начать настройку или использовать эту функцию, необходимо убедиться, что она доступна в системе. Администраторы могут использовать рабочую область **[управления компонентами](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)** для проверки статуса этой функции и ее включения. В рабочей области **Управление функциями** эта функция перечисляется следующими способами:

- **Модуль:** *Закупки и источники*
- **Имя функции:** *запечатанное предложение для запроса предложения*

### <a name="step-3-set-up-azure-key-vault"></a>Шаг 3: настройка Azure Key Vault

Supply Chain Management использует ключи шифрования для защиты всех запечатанных предложений и сохранения их секретности до наступления соответствующего времени. Для создания и управления необходимыми ключами используются преимущества возможностей Key Vault. Поэтому необходимо настроить подключение из Supply Chain Management к хранилище ключей, чтобы включить систему.

> [!IMPORTANT]
> Хранилища ключей, используемые для запечатанных ставок, должны удовлетворять следующим требованиям:
>
> - Если вы используете изолированную среду песочницы для разработки и тестирования, вам необходимо иметь одно специализированное хранилище ключей для "песочницы", и отдельное хранилище для производственной среды.
> - Необходимо создать каждое хранилище ключей в подписке Azure, владельцем которой является ваша организация (а не в подписке, в которой выполняется Supply Chain Management).
> - Каждое хранилище ключей должно использоваться исключительно для запечатанных ставок. Не следует использовать собственные хранилища ключей запечатанных ставок ни для каких других целей.

Каждая из предложений получает свой собственный секретный ключ. Этот ключ используется каждый раз, когда пользователь просматривает, обновляет или распечатает предложение.

Key Vault создает ключ, который используется для получения секрета, когда поставщик выбирает **предложение** в интерфейсе совместной работы с поставщиками. Срок действия ключа истекает через фиксированное время, которое менеджер по закупкам устанавливает на странице **Параметры модуля "Закупки и источники"** в Supply Chain Management. После истечения срока действия ключа никто не сможет просматривать, изменять или распечатывать предложение. Следовательно, важно настроить срок действия ключа таким образом, чтобы было достаточно времени для завершения процесса предложений.

В следующих трех шагах вы настроите подключение к Key Vault. Во-первых, вы настроите хранилище ключей для использования с запечатанными предложениями. Далее необходимо настроить Supply Chain Management для связи с хранилищем ключей. Наконец, будет задано время истечения срока действия ключа.

### <a name="step-4-set-up-a-key-vault-to-use-with-sealed-bidding"></a>Шаг 4: настроите хранилище ключей для использования с запечатанными предложениями

Чтобы настроить ваше хранилище ключей, сделайте следующее. Порядок шагов очень важен.

1. Если вы еще не настроили подписку Azure, отдельную от подписки, для которой вы используете Supply Chain Management, настройте ее.
1. Настройте хранилище ключей в отдельной службе хранилища Azure. Дополнительные сведения см. в разделе [Управление хранилищем Azure Key Vault](https://support.microsoft.com/help/4040294/maintaining-azure-key-vault-storage).
1. Настройте приложение Supply Chain Management для работы в качестве клиента для вашего хранилища ключей. Дополнительные сведения см. в разделе [Настройка клиента Azure Key Vault](https://support.microsoft.com/help/4040305/setting-up-azure-key-vault-client).

### <a name="step-5-configure-key-vault-parameters-in-supply-chain-management"></a>Шаг 5: настройка параметров Key Vault в Supply Chain Management

Чтобы настроить Supply Chain Management для связи с хранилищем ключей во время запечатывания предложения, выполните следующие действия.

1. Войдите в Supply Chain Management и перейдите к **Администрирование системы \> Настройка \> Параметры Key Vault**.
1. Выберите **создать**, чтобы создать запись, и установите для нее следующие поля:

    - **Имя** — введите имя.
    - **Описание** — введите описание.
    - **URL-адрес Key Vault** — введите URL-адрес по умолчанию для вашего хранилища ключей.
    - **Клиент Key Vault** — введите код интерактивного клиента приложения Active Directory, связанного с хранилищем ключей для проверки подлинности.
    - **Секретный ключ Key Vault** — введите секретную ссылку для сертификата.
    - **Включено для запечатанных предложений** — установите для этого параметра значение *Да*.

![Страница параметров Key Vault](media/sealed-bidding-key-vault-param.png "Страница параметров Key Vault")

> [!NOTE]
> В каждый момент времени для запечатанных предложений можно включить только одну конфигурацию хранилища ключей. Перед отключением существующей конфигурации хранилища ключей необходимо убедиться, что все запечатанные предложения, которые используют ее, не запечатаны. Проверьте все случаи запроса предложений *запечатанного* типа и убедитесь, что все ответы на него были распечатаны.

### <a name="step-6-set-the-key-expiration-time"></a>Шаг 6: установите время окончания действия ключа

Чтобы задать срок действия, применяемый к ключу, создаваемому для каждой нового предложения, выполните следующие действия.

1. Выберите **Параметры модуля "Закупки и источники" \> Настройка \> Параметры модуля "Закупки и источники"**.
1. На вкладке **Запрос предложения** в поле **Смещение в днях** введите количество дней, в течение которых должен длиться период запроса предложения. При создании запроса предложения число дней, введенное в это поле, добавляется к системной дате, чтобы определить дату истечения срока действия запроса предложения по умолчанию.
1. В поле **смещение даты окончания срока действия ключа шифрования** введите число дней, в течение которых каждый ключ шифрования должен быть действительным после его выпуска. После истечения срока действия ключа шифрования никто не сможет просматривать, изменять или распечатывать запечатанное предложение, использующее его.

> [!TIP]
> Значение поля **смещение даты окончания срока действия ключа шифрования** не должно быть меньше значения поля **смещение в днях**.

### <a name="step-7-set-the-default-bid-type"></a><a name="set-default-bid-type"></a>Шаг 7: настройка типа предложения по умолчанию

Каждый случай запроса предложения имеет тип предложения. Тип предложения определяет, будет ли этот случай запроса предложения иметь открытое или запечатанное предложение.

#### <a name="rfq-cases-that-dont-have-a-solicitation-type"></a>Случаи запроса предложения, у которых нет типа обращения

Чтобы задать тип предложения по умолчанию, назначаемый новым случаям запроса предложения, которые не назначены типу обращения при их создании, выполните следующие действия.

1. Выберите **Параметры модуля "Закупки и источники" \> Настройка \> Параметры модуля "Закупки и источники"**.
1. На вкладке **Запрос предложения** задайте для поля **Тип предложения** значение *Запечатанное*.

#### <a name="rfq-cases-that-have-a-solicitation-type"></a>Случаи запроса предложения, у которых есть тип обращения

Чтобы задать тип предложения по умолчанию, назначаемый новым случаям запроса предложения, которые назначены типу обращения при их создании, выполните следующие действия.

1. Перейдите в раздел **Закупки и источники \> Настройка \> Запрос предложения \> Тип обращения**.
1. Создайте новый тип обращения или выберите существующий тип запроса, в котором будет использоваться тип предложения *Запечатанное*.
1. Задайте в поле **Тип предложения** значение *Запечатанное*.
1. Повторите эти шаги для каждого дополнительного типа запроса, в котором необходимо реализовать запечатанные предложения.

> [!TIP]
> Тип обращения не обязательно должен назначаться при создании нового запроса предложения. Если назначен тип обращения, тип предложения, используемый по умолчанию, может быть получен из запроса предложения. В противном случае можно использовать тип обращения по умолчанию, который определен в параметрах модуля "закупки и источники".

## <a name="the-sealed-bidding-process"></a>Процесс запечатанных предложений

Запечатанные предложения следуют практически одному процессу, описанному в [обзор запросов предложений](request-quotations.md). Основное различие заключается в том, что данные по предложениям и их вложения шифруются до тех пор, пока не будет распечатано предложение.

> [!IMPORTANT]
> [Анкеты](/dynamicsax-2012/appuser-itpro/view-and-respond-to-questionnaires) не шифруются и не должны использоваться для сбора конфиденциальных сведений

Ниже приведена структура процесса:

1. Вы создаете и отправляете запрос предложения одному или нескольким поставщикам.
1. Поставщики отреагируют, отправляя запечатанное предложение.
1. После истечения срока действия для ввода предложения вы распечатываете предложения.
1. Эти предложения становятся видимыми, и их можно оценивать и сравнивать.
1. После принятия предложения создается заказ на покупку, создается договор покупки или обновляется заявка на закупку.

### <a name="create-an-rfq-case-that-uses-sealed-bidding"></a>Создание случая запроса предложения, в котором используется запечатанное предложение

Процесс создания случая запроса предложения для запечатанных предложений практически не отличается от процесса для незапечатанных предложений. Сведения о создании обоих типов случаев запроса предложения см. в разделе [Создание запроса предложения](tasks/create-request-quotation.md). В этом разделе выделено несколько важных вопросов при создании запроса предложения для запечатанных предложений.

Случаи запроса предложения для запечатанных предложений должны иметь значение **Тип предложения** *Запечатанное*. Существует три способа назначения этого значения для случая запроса предложения:

- Установите значение непосредственно в случае запроса предложения после его создания.
- Определение запечатанных предложений как типа предложения по умолчанию для всех случаев запроса предложения в параметрах модуля "закупки и источники". (См. [настройка типа предложения по умолчанию](#set-default-bid-type) ранее в этом разделе).
- При создании нового случая запроса предложений выберите тип запроса, настроенный для запечатанных предложений. (См. [настройка типа предложения по умолчанию](#set-default-bid-type)).

Для запечатанных предложений значение **Дата и время окончания срока действия** случаев запроса предложения устанавливается в том случае, когда отправленные предложения могут быть распечатаны. Значение **Дата и время окончания срока действия** для каждой строки будет соответствовать значению в заголовке.

Невозможно изменить тип предложения после отправки случая запроса предложения.

### <a name="vendors-respond-to-an-rfq"></a>Поставщики отвечают на запрос предложения

Поставщики, отвечающие на запечатанное предложение, используют ту же процедуру, которая используется для ответа на открытые предложения, как описано в разделе [Работа с запросами предложений в рабочей области предложения цен поставщиками](vendor-collaboration-work-customers-dynamics-365-operations.md#working-with-rfqs-in-the-vendor-bidding-workspace). Подробные инструкции по работе с открытыми предложениями и запечатанными предложениями см. в разделе [Ввод и сравнение предложений по запросу предложения и заключение контрактов](tasks/enter-compare-rfq-bids-award-contracts.md). Единственная разница между обработкой запечатанных предложений и открытых предложений заключается в том, что до истечения срока подачи предложений специалисты по закупкам не могут открыть запечатанное предложение поставщика. Только контактное лицо поставщика может открыть запечатанное предложение данного поставщика.

> [!IMPORTANT]
> Для запечатанных предложений поставщики могут загружать вложения только в формате PDF. Другие форматы приниматься не будут.

После того как зарегистрированный пользователь поставщика выбирает **предложение** в виде предложения с запечатанным предложением, они могут ввести свои данные предложения, и эти данные будут защищены. Поставщики могут сохранить их работу при подготовке предложения, возвращаться к ней так часто, как требуется, а затем отправить ее по готовности. Поставщики также могут просмотреть свою предложение после их отправки. Если поставщики должны изменить свою предложение после отправки, они могут отозвать их, обновить и отправить повторно в любое время до окончания срока подачи предложений.

При запечатанном предложении действуют следующие условия:

- При запечатанном предложении система создает журнал *запросов предложения*.
- Когда поставщик отправит предложение, создаются журналы запросов предложения без строк, имеющие запечатанную цену.
- После распечатывания случая создаются журналы запросов предложений, которые содержат цену и сумму. Доступ к этому журналу осуществляется путем выбора **журналов запросов предложений** на странице **все запросы предложений**.
- В системе хранится журнал всех действий, выполняемых пользователями по запечатанному предложению. Эти действия включают просмотр, редактирование и сохранение предложения. Этот журнал видим как для поставщика, так и для специалистов по закупкам, имеющих доступ к данному предложению.
- По мере продвижения предложения у специалистов по закупкам можно просмотреть его статус. Статус будет либо *Поставщик выполняет обновление*, либо *Отправлено поставщиком*.
- Статус строк в запечатанном предложении остается *Отправлено*, пока не будет распечатано предложение.
- Если поставщик решил отклонить предложение, предложение будет иметь статус **Ход выполнения ответа** *Отклонено поставщиком*. Этот статус будет видимым для персонала по закупкам.
- Ответы в анкетах **не** сохраняются в зашифрованной форме в базе данных. Поэтому они не запечатаны. Однако они не будут отображаться в пользовательском интерфейсе запроса предложения до тех пор, пока не будет распечатан этот случай.

### <a name="all-sealed-bid-activities-are-logged"></a>Вся деятельность запечатанных предложений регистрируется

В подробном журнале записываются все действия пользователя и действия для предложения. Журнал действий позволяет организациям определить, кто обновил предложение в течение его срока существования, и какие обновления были внесены. Он также позволяет организациям подтверждать, что только авторизованные лица имеющие доступ к запечатанному предложению. Журнал действий доступен на странице **Действия** каждого приложения.

### <a name="review-rfq-activity"></a>Просмотр действий запроса предложения

Каждое взаимодействие с предложением регистрируется и может просматриваться на странице **действия**. Следующая иллюстрация показывает пример.

![Пример страницы действия](media/sealed-bidding-rfq-activity.png "Пример страницы действия")

Поставщики могут получить доступ к странице **деятельности**, щелкнув **действие** на странице **Запечатанное предложение запроса предложения**. Персоналу по закупкам можно получить доступ, выбрав **действие** на странице **запрос предложения**. Журнал изменений обеспечивает полную видимость поставщикам и персоналу по закупкам, который получил доступ к данной предложению. Таким образом, может быть виден любой несанкционированный доступ.

### <a name="unseal-sealed-bids"></a>Распечатывание запечатанных предложений

После того, как значение **Дата и время окончания срока действия**, которое было настроено для случая запроса запечатанного предложения, кнопка **Распечатать** становится доступной. Выберите **распечатать**, чтобы распечатать все предложения для выбранного случая запроса предложения. Все данные предложения и вложения затем становятся видимыми, чтобы можно было управлять ответами на случай. Кроме того, создаются журналы, содержащие отправленные данные предложения.

Событие распечатывания регистрируется и может быть просмотрено на странице **действия**.

### <a name="process-accepted-bids"></a>Обработка принятых предложений

Процесс сравнения и утверждения ранее запечатанных предложений аналогичен процессу для открытых предложений. Сведения о том, как оценить, сравнить, отклонить и принять незапечатанные предложения см. в разделе [Ввод и сравнение предложений по запросу предложения и заключение контрактов](tasks/enter-compare-rfq-bids-award-contracts.md).

## <a name="the-rfq-activity-log-can-never-be-deleted"></a>Журнал изменений запроса предложения никогда не может быть удален

Никто, даже администраторы и поддержка Microsoft, не может редактировать или удалять журнал изменений запроса предложения. Это ограничение помогает обеспечить равноправие процесса запечатанных предложений. Это также помогает гарантировать ведение точный журнал аудита.
