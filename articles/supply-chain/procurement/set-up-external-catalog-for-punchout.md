---
title: "Настройка внешнего каталога для внешних eProcurement"
description: "В этом разделе описывается использование внешнего каталога или каталога PunchOut для сбора информации о ценовых предложениях от поставщика и добавления этой информации в заявку."
author: mkirknel
manager: AnnBe
ms.date: 11/02/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: PurchTable, PurchVendorPortalRequests
audience: Application User
ms.reviewer: bis
ms.search.scope: Core, Operations
ms.custom: 30211
ms.assetid: 3c7e0e1c-703c-4bbf-b90c-84d29a131360
ms.search.region: Global
ms.author: mkirknel
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: a0739304723d19b910388893d08e8c36a1f49d13
ms.openlocfilehash: 2892feff0ab8845515543af1a71d8f9642113726
ms.contentlocale: ru-ru
ms.lasthandoff: 03/26/2018

---

# <a name="set-up-an-external-catalog-for-punchout-eprocurement"></a>Настройка внешнего каталога для внешних eProcurement

[!INCLUDE [banner](../includes/banner.md)]

Использование внешнего каталога позволяет гарантировать, что информация о продуктах и ценах, которую вы впоследствии обрабатываете в Dynamics 365 for Finance and Operations от июля 2017 г., будет точной и актуальной. После этого заявку можно будет утвердить и преобразовать в заказ на покупку, и разместить заказ у поставщика.

Если внешний каталог настроен, когда сотрудник составляет заявку, у него будет возможность перейти на внешний сайт, к внешнему каталогу, и вернуться в систему с корзиной для покупок, созданной на внешнем сайте. Этот обмен данными основан на протоколе cXML, и его необходимо настроить между системами организации-покупателя и организации-продавца.

Для настройки обмена данными поставщик должен предоставить вам информацию, которую вы будете использовать для конфигурирования внешнего каталога, такую как удостоверение, домен компании-покупателя, например, "DUNS" и "номер DUNS", учетные данные, а также URL-адрес для доступа к каталогу поставщика.

## <a name="setting-up-an-external-catalog"></a>Настройка внешнего каталога

Внешний каталог должен давать сотруднику, занимающемуся вводом заявки на покупку, возможность перейти на внешний сайт для выбора продуктов. Продукты, которые сотрудник выбирает из внешнего каталога, возвращаются в Dynamics 365 for Finance and Operations с актуальной ценовой информацией, откуда их можно добавить в заявку на покупку. Речь не идет о том, чтоб дать сотрудникам возможность размещать заказы на внешнем сайте. При настройке внешнего каталога, необходимо убедиться, что назначение сайта, доступ к которому осуществляется через внешний каталог, — это сбор ценовой информации, а не размещение реального заказа.

### <a name="to-set-up-an-external-vendor-catalog-complete-the-following-tasks"></a>Для настройки внешнего каталога поставщика выполните следующие задачи:

1. Настройка иерархии категорий закупаемой продукции. Более подробные сведения см. в разделе [Настройка политик для иерархий категорий приобретаемой продукции](tasks/set-up-policies-procurement-category-hierarchies.md).
2. Зарегистрируйте поставщика в Finance and Operations. Прежде чем настраивать доступ к внешнему каталогу поставщика, необходимо настроить поставщика и его контактное лицо в Microsoft Dynamics 365. Поставщика внешнего каталога также необходимо добавить в выбранную категорию закупаемой продукции. Дополнительные сведения о регистрации поставщиков в Microsoft Dynamics 365 см. в разделе [Управление пользователями совместной работы с поставщиками](manage-vendor-collaboration-users.md). О том, как назначить поставщиков категории закупаемой продукции, см. в разделе [Утверждение поставщиков для определенных категорий закупаемой продукции](tasks/approve-vendors-specific-procurement-categories.md).
3. Убедитесь, что настроены единицы измерения и валюта, которую использует поставщик. О том, как создать единицу измерения, см. в разделе [Управление единицами измерения](../pim/tasks/manage-unit-measure.md).
4. Настройте внешний каталог поставщика, используя требования к сайту внешнего каталога этого поставщика. Дополнительные сведения об этой задаче см. в разделе [Настройка внешнего каталога поставщика](#configure-the-external-vendor-catalog).
5. Протестируйте конфигурацию внешнего каталога поставщика, чтобы убедиться в правильности настроек и возможности доступа к внешнему каталогу поставщика. Используйте действие **Проверить параметры** для проверки определенного вами сообщения запроса настройки. Это сообщение должно привести к открытию сайта внешнего каталога поставщика в окне браузера. Во время проверки заказать номенклатуры и услуги у поставщика нельзя. Для заказа номенклатур и услуг необходимо осуществить доступ к каталога поставщика через заявку на покупку.
6. Активируйте внешний каталог с помощью кнопки **Активировать каталог** на странице **Внешние каталоги**. Внешний каталог необходимо активировать, прежде чем сотрудники смогут им пользоваться. Вы можете в любой момент деактивировать внешний каталог.


## <a name="configure-the-external-vendor-catalog"></a>Настройка внешнего каталога поставщика

В этом разделе содержатся дополнительные сведения о задаче 4 из предыдущего раздела.

1. Введите название и описание для внешнего каталога поставщика. Введенное название будет отображаться на представляющей внешний каталог корзине, которую будут видеть сотрудники при создании заявки. Сотрудник может щелкнуть на корзине, чтобы открыть каталог на сайте внешнего каталога поставщика.
2. Добавьте изображение с помощью действия **Изображение внешнего каталога**. Это изображение будет отображаться на представляющей внешний каталог корзине, которую будут видеть сотрудники при создании заявки. Обратите внимание, что ширина и высота изображения должны быть равны. В противном случае изображение будет отображаться некорректно.
3. Выберите, должен ли веб-сайт внешнего каталога поставщика открываться в том же окне браузера, в котором сотрудник создал заявку, или в новом окне.
4. Выберите поставщика для каталога. В списке **Юридические лица** имеется строка для каждого юридического лица, где настроен поставщик. Чтобы разрешить пользователям запрашивать продукты непосредственно из каталога поставщика только в некоторых юридических лицах, можно использовать кнопку **Запретить доступ** или **Разрешить доступ** для каждого юридического лица, чтобы сделать каталог недоступным или доступным.
5. В поле **Истечение срока действия по умолчанию (дней)** введите количество дней, в течение которых ценовое предложение, полученное из внешнего каталога, будет действительным и может использоваться для приобретения продуктов у внешнего поставщика. При создании и получении предложения с сайта внешнего каталога поставщика предложение действительно с момента текущей системной даты и остается действительным в течение количества дней, введенного в этом поле.
6. Нажмите кнопку **Добавить**, чтобы начать сопоставление категорий закупаемой продукции с внешним каталогом. Затем в списке "Имя категории" выберите категорию. Список категорий представляет собой надмножество категорий закупаемой продукции, которым поставщик сопоставлен во всех юридических лицах, настроенных для этого поставщика.
[!NOTE]
Политики закупок используются для предоставления или ограничения доступа к категориям для юридического-лица покупателя или операционной единицы-получателя. Для перехода сотрудника к внешнему каталогу требуется, чтобы доступ был разрешен хотя бы к одной из категорий закупаемой продукции, сопоставленных каталогу.
7. Настройте сообщение запроса настройки cXML, которое будет отправлено поставщику. Автоматически сгенерированный формат сообщения — это минимальный шаблон, необходимый для запуска сеанса. Заполните значения для тегов.

Вы можете в любой момент перезагрузить созданный системой шаблон сообщения, щелкнув **Восстановить формат сообщения**. Обратите внимание, что если восстановить формат сообщения, текущее сообщение будет заменено автоматически сгенерированным форматом сообщения с пустыми тегами.

### <a name="cxml-setup-message"></a>Сообщение настройки cXML
Ниже приведено описание тегов, входящих в шаблон:

| Поле | описание | 
|---------|---------|
|< Header >< From >< Credential domain=”” >|Домен компании-покупателя.|
|< Header >< From >< Credential>< Identity >< /Identity > | Удостоверение компании-покупателя.|
|< Header >< To >< Credential domain=”” > | Домен компании-поставщика.|
|< Header >< To >< Credential>< Identity >< /Identity> | Удостоверение компании-поставщика.|
|< Header >< Sender >< Credential domain=”” > | Домен компании-покупателя.|
|< Header >< Sender >< Credential >< Identity >< /Identity> | Удостоверение компании-покупателя.|
|< Header >< Sender >< Credential >< SharedSecret >< /SharedSecret >|Общий секрет для компании-покупателя.|
|< Request deploymentMode=”” >|Тестовая или рабочая среда.|
|< Request >< PunchOutSetupRequest >< SupplierSetup >< URL >< /URL>|URL-адрес конечной точки с каталогом поставщика.|

### <a name="extrinsic-elements"></a>Внешние элементы

Внешний элемент — это дополнительная информация, например имя пользователя, зависящее от пользователя, осуществляющего переход к каталогу. Внешний элемент задается в момент перехода и может быть отправлен в сообщении запроса настройки.
У поставщика может быть требование, состоящее в получении внешнего элемента в запросе настройки. В этом случае следует добавить внешний элемент в список внешних элементов в разделе **Формат сообщения** страницы **Внешний каталог**. Укажите имя для внешнего элемента, которое сможет распознать поставщик, и сопоставьте его значению. Возможные варианты значения — имя пользователя, адрес электронной почты пользователя или случайное значение.
Дополнительные сведения о протоколе cXML см. по адресу: http://cxml.org/

## <a name="post-back-message"></a>Обратное сообщение
Обратное сообщение — это сообщение, получаемое от поставщика, когда пользователь заканчивает работу на внешнем сайте и возвращается в Finance and Operations. Обратные сообщения не настраиваются. Эти сообщения основаны на определении протокола cXML. Ниже приведена информация, которая может входить в состав обратного сообщения, полученного по строке заявки:

| Сообщение, полученное от поставщика | Копируется в строку заявки в Finance and Operations|
|------------------------------|----------------------------------------------------------|
|< ItemIn quantity=”” > |Количество|
|< ItemIn>< ItemID >< SupplierPartID >< /SupplierPartID >|Внешний код номенклатуры|
|< ItemDetail>< UnitPrice >< Money currency=”” >| Валютное|
|< ItemDetail >< UnitPrice >< Money >< /Money >| Цена за ед. изм.|
|< ItemDetail >< Description ShortName=”” >|Имя продукта|
|< ItemDetail >< Description >< /Description >|Входит в описание номенклатуры; название продукта, если краткое название (ShortName) не указано.|
|< ItemDetail >< UnitOfMeasure >< /UnitOfMeasure >|Ед. изм.|
|< ItemDetail >< Classification >< /Classification >|Входит в описание номенклатуры|
|< ItemDetail >< Classification domain=”” >|Входит в описание номенклатуры|

## <a name="delete-an-external-catalog"></a>Удаление внешнего каталога
Удалить внешний каталог можно с помощью действия "Удалить" на странице.

Если был запрошен какой-либо продукт из внешнего каталога поставщика, внешний каталог поставщика удалить нельзя. Вместо этого внешнему каталогу поставщика присваивается неактивный статус. Если вы хотите прекратить доступ к сайту внешнего каталога поставщика, но не удалить его, измените статус внешнего каталога на "Неактивно".


