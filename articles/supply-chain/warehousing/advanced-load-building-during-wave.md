---
title: Расширенное формирование загрузки во время волны
description: В этой теме приводятся сведения о расширенном формировании загрузки волны, которая автоматически назначает отгрузки существующим волнам в ходе выполнения волн. Таким образом, можно создать осмысленные загрузки, представляющую грузовики, без необходимости использования рабочего места планирования загрузки.
author: mirzaab
manager: tfehr
ms.date: 07/01/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: WHSPostMethod,WHSWaveTemplateTable,WHSLoadMixGroup,WHSLoadBuildTemplate, WHSWaveTableListPage, TMSLoadBuildTemplateApply, TMSLoadBuildTemplates, TMSLoadBuildTemplateCreate
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-07-01
ms.dyn365.ops.version: Release 10.0.9
ms.openlocfilehash: e4abe1a03997853053f60c750199874a61fc68c0
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "5006399"
---
# <a name="advanced-load-building-during-wave"></a>Расширенное формирование загрузки во время волны

[!include [banner](../includes/banner.md)]

Формирование расширенной загрузки волны автоматически назначает отгрузки существующим волнам в ходе выполнения волн. Таким образом, можно создать осмысленные загрузки, представляющую грузовики, без необходимости использования рабочего места планирования загрузки. Эта возможность полезна для компаний, которые хотят использовать концепцию загрузок для отслеживания и планирования отгрузки товаров на грузовике или прицепе, но не хотят создавать каждую загрузку вручную каждый день.

Во время обработки волн система обычно создает новую загрузку для каждой отгрузки, для которой не назначена загрузка. Однако когда включено расширенное формирование загрузки волны, система назначает каждую неназначенную отгрузку существующей загрузке (если существует соответствующая загрузка), а новые загрузки создаются только тогда, когда это необходимо. Расширенное формирование загрузки волны автоматически создает новые загрузки на основе определяемых вами критериев.

Чтобы использовать эту функцию, необходимо настроить систему следующим образом:

- Создайте *шаблоны волн*, которые включают новый метод **buildLoads**. Этот метод делает расширенное формирование загрузки волны доступным для волн, использующих эти шаблоны.
- Настройте *шаблоны формирования загрузки*, каждый из которых связан с конкретным шаблоном и методом волны. Шаблоны формирования загрузки управляют тем, к какой загрузке (существующей или новой) добавляются строки загрузки, входящие в волну. Можно объединять или разделять отгрузки на основе таких критериев, как шаблон загрузки, оборудование и другие значения полей в строке загрузки.
- Определите *группы смешивания загрузки* для управления тем, какие номенклатуры должны, а какие не должны объединяться в одной загрузке. Кроме того, необходимо указать, должно ли ограничение генерировать предупреждение или ошибку, а также следует ли оценивать объемные ограничения шаблона загрузки.

## <a name="turn-on-advanced-wave-load-building-in-your-system"></a>Включение в системе расширенного формирования загрузки волны

Прежде чем можно будет использовать расширенное формирование загрузки волны, в системе должны быть включены две функции. Администраторы могут использовать параметры [управления компонентами](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) для проверки статуса этих функций и их включения, если это требуется. В рабочей области **Управление функциями** эти функции перечисляется следующими способами:

- Функция формирования загрузки волны:

    - **Модуль:** *Управление складом*
    - **Имя функции:** *Функция формирования загрузки волны*

- Код этапа волны для всей организации:

    - **Модуль:** *Управление складом*
    - **Имя функции:** *Код этапа волны для всей организации*

### <a name="make-sample-data-available"></a>Сделать образцы данных доступными

Для работы с этой демонстрацией с помощью образцов записей и значений, указанных здесь, необходимо использовать систему, в которой установлены стандартные [демонстрационные данные](../../fin-ops-core/dev-itpro/deployment/deploy-demo-environment.md). Дополнительно перед началом необходимо выбрать юридическое лицо **USMF**.

Эту демонстрацию можно также использовать в качестве руководства по использованию этой функции при работе в производственной системе. Однако в этом случае необходимо подставить собственные значения, и у вас могут отсутствовать некоторые типы необходимых записей, предоставляемых стандартными демонстрационными данными.

### <a name="make-sure-that-the-scenario-setup-includes-enough-available-inventory"></a>Убедитесь, что в настройке сценария имеется достаточное количество доступных запасов

При работе с демонстрационными данными **USMF** необходимо убедиться, что ваша система настроена таким образом, что имеется достаточное количество запасов для каждого соответствующего местоположения. В этой демонстрации предполагается, что следующие запасы доступны на складе *62*:

- **Номенклатура A0001:** 10 шт.
- **Номенклатура A0002:** 10 шт.
- **Номенклатура M9200:** 10 шт.

Номенклатура **M9200** должна быть добавлена на склад. Выполните процедуры в следующих подразделах, чтобы добавить запасы номенклатуры.

#### <a name="create-a-new-license-plate-id"></a>Создание нового кода грузоместа

1. Перейдите в раздел **Управление складом** \> **Настройка** \> **Склад** \> **Грузоместа**.
1. В области действий выберите **Создать**.
1. В новой строке в поле **Грузоместо** введите *LP6203*.
1. Нажмите **Сохранить**.

#### <a name="create-a-standard-cost-for-item-m9200-in-site-6"></a>Создайте стандартную себестоимость для номенклатуры M9200 на сайте 6

1. Щелкните **Управление сведениями о продукте** \> **Продукты** \> **Выпущенные продукты**.
1. Выполните поиск по **M9200**.
1. Выберите строку для номенклатуры, а затем в области действий на вкладке **Управление затратами** в группе **Настройка** выберите **Цена номенклатуры**.
1. На странице **Цена номенклатуры** выберите вкладку **Ожидающие цены**.
1. В области действий выберите **Создать**.
1. В новой строке установите следующие значения:

    - **Тип цены:** *Плановые затраты*
    - **Тип цены:** *Затраты*
    - **Версия:** *10*
    - **Сайт:** *6*
    - **Цена:** *1,60*

1. На панели операций выберите **Сохранить**.
1. В области действий выберите **Активировать ожидающие цены**.
1. Перейдите на вкладку **Активные цены**, чтобы убедиться, что была добавлена новая себестоимость для сайта *6*.

#### <a name="create-inventory-in-warehouse-62"></a>Создайте запасы на складе 62

1. Перейдите к пункту **Управление запасами** \> **Записи журнала** \> **Номенклатуры** \> **Корректировка запасов**.
1. В области действий выберите **Создать**.
1. В диалоговом окне **Создание журнала запасов** на экспресс-вкладке **Обзор** в поле **Склад** введите *62*. Примите во всех остальных полях значения по умолчанию.
1. Выберите **OK**, чтобы закрыть диалоговое окно.
1. Будет открыта страница **Корректировка запасов**. На экспресс-вкладке **Строки журнала** выберите **Создать**, чтобы добавить новую строку.
1. В новой строке установите следующие значения. Примите во всех остальных полях значения по умолчанию.

    - **Код номенклатуры:** *M9200*
    - **Местонахождение:** *bulk-003*
    - **Количество:** измените значение на *10*.

1. На панели операций выберите **Сохранить**.
1. На панели операций выберите **Проверить**, чтобы проверить ошибки.
1. В диалоговом окне **Проверка журнала** выберите **ОК**, чтобы начать проверку. После завершения проверки пользователь получает сообщение.
1. В области действий выберите **Разнести**, чтобы подтвердить корректировку запасов.
1. В диалоговом окне **Разноска журнала** выберите **ОК**, чтобы начать разноску. После завершения разноски пользователь получает сообщение.

## <a name="set-up-advanced-wave-load-building"></a>Настройка расширенного формирования загрузки волны

### <a name="regenerate-wave-process-methods"></a>Повторное создание методов обработки волн

Возможно, придется повторно создать методы обработки волны, чтобы сделать доступным метод формирования загрузки (**buildLoads**).

1. Перейдите в раздел **Управление складом** \> **Настройка** \> **Волны** \> **Шаблоны волны**.
2. Убедитесь, что метод **buildLoads** есть в списке. Если его нет, выберите **Повторно создать методы** на панели операций, чтобы добавить его.

### <a name="set-up-wave-templates"></a>Настройка шаблонов волны

Чтобы воспользоваться преимуществами расширенного создания загрузки волны, необходимо включить метод **buildLoads** в каждый соответствующий [шаблон волны](tasks/configure-wave-processing.md).

1. Перейдите в раздел **Управление складом** \> **Настройка** \> **Волны** \> **Шаблоны волны**.
1. Выберите шаблон волны.

    При работе с демонстрационными данными **USMF** выберите шаблон **62 Отгрузка по умолчанию**.

1. В области действий выберите **Правка**, чтобы перевести страницу в режим редактирования.
1. На экспресс-вкладке **Методы** в сетке **Оставшиеся методы** выберите метод **buildLoads**.
1. Выберите кнопку со стрелкой вправо, чтобы переместить метод **buildLoads** в сетку **Выбранные методы**.
1. Чтобы назначить значение **Код шага волны** для метода **buildLoads**, необходимо сначала создать код на странице **Коды шагов волны**. Можно использовать любое требуемое значение, но обязательно запишите его, так как это будет необходимо в дальнейшем. Выполните следующие действия, чтобы создать код **WSC2112**:

    1. В строке для метода **buildLoads** щелкните правой кнопкой мыши стрелку вниз в поле **Код шага волны**, затем выберите команду **Просмотреть сведения**.
    1. На странице **Коды шагов волны** в области действий выберите **Создать**.
    1. В поле **Код шага волны** введите *WSC2112*.
    1. В поле **Описание шага волны** введите *WSC2112*.
    1. В поле **Тип шага волны** выберите *Формирование загрузки*.

1. Выберите **Сохранить** и закройте страницу.
1. В строке метода **buildLoads** в поле **Код шага волны** выберите только что созданный код (**WSC2112**).
1. На панели операций выберите **Сохранить**.

> [!NOTE]
> Коды шагов волны — это коды, которые пользователи могут настроить и использовать для связывания определенных экземпляров методов волны с соответствующими шаблонами. Шаблоны включают шаблоны для пополнения, контейнеризации, печати меток, создания загрузки и сортировки.
>
> Когда коды шагов волны не используются, пользователи должны ввести произвольный текст, чтобы создать ссылку на конкретный шаблон из экземпляра метода волны. Свободный текст подвержен ошибкам, так как пользователь должен обеспечить, что текст шага волн, добавляемый к конкретному методу шага волны, будет точно соответствовать тексту шага волны в конечном шаблоне.
>
> Коды шагов волны для определенного типа шага волны настраиваются на отдельной странице. Для каждого экземпляра метода шага волны в шаблоне волны, для которого требуется код шага волны, код шага волны необходимо выбрать в раскрывающемся списке. Выбор в раскрывающемся списке заменяет ввод свободного текста и помогает снизить риск воздействия ошибки человека. Коды настройки используются для связи метода шага волны в шаблоне волны с целевым шаблоном для метода.

### <a name="set-up-load-mix-groups"></a>Настройка групп смешанной загрузки

Группы смешанной загрузки определяют правила для типов номенклатур, которые могут быть объединены в одной загрузке. Можно настроить столько групп смешанной загрузки, сколько требуется. Однако для использования расширенного формирования загрузки волны необходима хотя бы одна. Для создания группы смешанной загрузки выполните следующие действия.

1. Перейдите в раздел **Управление складом** \> **Настройка** \> **Загрузка** \> **Группы смешанной загрузки**.
1. На панели операций выберите **Создать** для создания группы загрузки.
1. В поле **Идентификатор группы смешанной загрузки** введите имя новой группы.

    При работе с демонстрационными данными **USMF** установите следующие значения:

    - **Код группы смешанной загрузки:** *ТВ*
    - **Описание:** *ТВ*

1. В области действий выберите **Сохранить**, чтобы сделать экспресс-вкладку **Критерии группы смешанной загрузки** доступной.
1. На экспресс-вкладке **Критерии группы смешанной загрузки** выберите **Создать**, чтобы добавить строку в сетку.
1. В новой строке задайте нужные значения в каждом поле. Эти значения определяют группы номенклатур, которые рассматриваются для смешанной загрузки.

    При работе с демонстрационными данными **USMF** выберите *ТВ и видео* в поле **Номенклатурная группа**.

1. В области действий выберите **Сохранить**, чтобы сделать экспресс-вкладку **Ограничения группы смешанной загрузки** доступной.
1. На экспресс-вкладке **Ограничения группы смешанной загрузки** выберите **Создать**, чтобы добавить строку в сетку.
1. В новой строке задайте нужные значения в каждом поле.

    При работе с демонстрационными данными **USMF** установите следующие значения:

    - **Номенклатурная группа:** *CarAudio*
    - **Действие формирования загрузки:** *Ограничить* (Это значение исключит нахождение номенклатур, принадлежащей группе **CarAudio**, в той же загрузке, что и номенклатуры, принадлежащие к группе номенклатур **ТВ и видео**.)

1. Продолжайте работать с правилами до тех пор, пока не будут добавлены все критерии и ограничения, необходимые для группы смешанной загрузки.

Если вы работаете с демонстрационными данными **USMF**, вы теперь завершили настройку.

### <a name="set-up-load-build-templates"></a>Настройка шаблонов формирования загрузок

Можно настроить столько шаблонов формирования загрузки, сколько требуется. Однако для использования расширенного формирования загрузки волны необходима хотя бы одна. Чтобы создать шаблон формирования загрузки, выполните следующие действия.

1. Перейдите в раздел **Управление складом** \> **Настройка** \> **Загрузка** \> **Шаблоны формирования загрузки волны**.
1. На панели операций выберите **Создать**, чтобы добавить строку в сетку.
1. В новой строке установите следующие значения.

    | Поле | описание | Значение в демонстрационных данных USMF |
    |---|---|---|
    | Порядковый номер | Порядок, в котором будет выполняться оценка шаблона. | *1* |
    | Имя шаблона формирования загрузок | Введите уникальный идентификатор шаблона формирования загрузок. Следует ввести имя шаблона, который был создан или обновлен ранее в этой настройке. | *62 Отгрузка по умолчанию* |
    | Код шага волны | Введите код этапа волны для использования для связывания шаблона с методом волны. Следует ввести код, который был выбран для метода **buildLoads** при настройке шаблона волны ранее в этой настройке. | *WSC2112* |
    | Код шаблона загрузки | Выберите шаблон загрузки для использования при создании новых загрузок, с которым выполняется сравнение при назначении существующих загрузок. Шаблон загрузки определяет максимальный вес и объем, разрешенный для всей загрузки. | *Стандартный шаблон загрузки* |
    | Оборудование | Оборудование, с которым выполняется сравнение при назначении существующих загрузок и для ввода в новых загрузках, которые созданы. | Оставьте это поле пустым. |
    | Код группы смешивания в загрузке | Выберите группу смешанной загрузки для использования, если номенклатура разрешена в загрузке. Группа смешанной загрузки определяет правила для типов номенклатур, которые могут быть объединены в одной загрузке. Следует выбрать одну из групп смешанной загрузки, которая была создана ранее в этой настройке. | *TV* |
    | Использовать открытые загрузки | Выберите, следует ли добавить существующие открытые загрузки. Имеются следующие варианты:<ul><li>**Нет** — не добавлять открытые загрузки к существующим загрузкам.</li><li>**Любой** — добавлять открытые загрузки к любым существующим загрузкам, допустимым для строки.</li><li>**Назначено** — добавить открытые загрузки к загрузке, которая назначена для волны.</li></ul> | *Любое* |
    | Создать загрузки | Укажите, следует ли создавать новые загрузки, если ни одна из существующих загрузок не соответствует критериям. | Выбрано (= *Да*) |
    | Разрешение разбиение строки отгрузки | Укажите, разрешается ли разбиение одной строки загрузки на несколько загрузок, если полная строка превышает максимальную вместимость шаблона загрузки. | Очищено (= *Нет*) |
    | Проверять метрики объема | Укажите требуется ли при формировании загрузки выполнять проверку веса и объема при добавлении каждой строки загрузки, чтобы обеспечить соблюдение весогабаритных ограничений шаблона загрузки. | Очищено (= *Нет*) |

1. В области действий выберите **Сохранить**, чтобы сделать доступным параметр **Изменить запрос**.
1. На панели операций выберите **Изменить запрос**, чтобы открыть диалоговое окно для редактирования запроса.
1. В диалоговом окне на вкладке **Сортировка** выберите **Добавить**, чтобы добавить строку в сетку.
1. В новой строке определите правила сортировки, которые необходимо использовать. Например, чтобы отсортировать результаты поиска по возрастанию номеров заказов, установите следующие значения:

    - **Таблица:** *Сведения о загрузке*
    - **Производная таблица:** *Сведения о загрузке*
    - **Поле:** *Номер заказа*
    - **Направление поиска:** *Восходящее*

1. Выберите **ОК**, чтобы сохранить изменения и закрыть диалоговое окно.
1. На экспресс-вкладке **С разбивкой по** настройте правила для управления разбиением загрузок на части. Как правило, можно разбивать по настраиваемым полям, которые были расширены на строку загрузки, например **Маршрут**, **Тур** или **Выполнение**. Например, чтобы создать одну загрузку для каждого номера заказа, установите флажок **С разбивкой по** для строки, которая имеет следующие значения:

    - **Имя таблицы ссылок:** *Сведения о загрузке*
    - **Имя поля ссылки:** *Номер заказа*

## <a name="scenario"></a>Сценарий

Этот сценарий показывает, как параметры, описанные ранее в этом разделе, влияют на складские операции во время обработки заказа на продажу. В этом сценарии используются демонстрационные данные **USMF** вместе с другими демонстрационными значениями, предусмотренными в этих инструкциях по настройке.

### <a name="create-sales-orders"></a>Создание заказов на продажу

1. Перейдите в раздел **Продажи и маркетинг** \> **Заказы на продажу** \> **Все заказы на продажу**.
1. На панели операций выберите **Создать**, чтобы открыть диалоговое окно **Создание заказа на продажу**.
1. В диалоговом окне задайте следующие значения:

    - На экспресс-вкладке **Клиент** задайте для поля **Счет клиента** значение *US-007*.
    - На экспресс-вкладке **Общее** задайте в поле **Склад** значение *62*.

1. Выберите **ОК**, чтобы создать заказ на продажу и закрыть диалоговое окно.
1. Открывается ваш новый заказ на продажу. Он должно включать новую пустую строку в сетке на экспресс-вкладке **Строки заказа на продажу**. В этой новой строке задайте в поле **Код номенклатуры** значение *A0001*, а в поле **Количество** — значение *1*.
1. В меню **Запасы** над сеткой выберите **Резервирование**.
1. На странице **Резервирование** в области действий выберите **Зарезервировать лот**.
1. Выберите кнопку **Закрыть** (**X**) в верхнем правом углу страницы, чтобы вернуться к заказу на продажу.
1. На панели операций на вкладке **Склад** в группе **Действия** выберите вариант **Запуск на склад**. Система создает отгрузку и добавляет ее в новую загрузку, так как ни одна существующая загрузка не содержит строк загрузки с этим номером заказа.

    Вы получаете информационные сообщения, которые указывают работу, волну и отгрузку, созданные для данного заказа.

1. Чтобы подтвердить сведения о загрузке, отгрузке и работе в строке продаж, выберите строку, а затем в меню **Склад** над сеткой выберите **Сведения о загрузке**, **Сведения об отгрузке** или **Сведения о работе**.
1. В только что созданном заказе на продажу на экспресс-вкладке **Строки заказа на продажу** выберите **Добавить строку**, чтобы добавить новую строку.
1. В новой строке задайте в поле **Код номенклатуры** значение *A0002*, а в поле **Количество** — значение *1*.
1. Повторите строки с 6 по 9, чтобы зарезервировать строку и выпустить ее на склад. Система создает **новую** отгрузку для добавленной строки. Однако поскольку используется расширенное формирование загрузки волны, система добавляет эту отгрузку и строку загрузки в существующую волну. Если бы вы не использовали расширенное формирование загрузки волны, система создала бы новую загрузку для отгрузки.
1. В только что созданном заказе на продажу на экспресс-вкладке **Строки заказа на продажу** выберите **Добавить строку**, чтобы добавить новую строку.
1. В новой строке задайте в поле **Код номенклатуры** значение *M9200*, а в поле **Количество** — значение *1*.
1. Повторите строки с 6 по 9, чтобы зарезервировать строку и выпустить ее на склад. Как и ранее, система создает **новую** отгрузку для добавленной строки. Однако, поскольку номенклатура берется из группы номенклатур **CarAudio**, она **не проходит ограничения, настроенные для группы смешанной загрузки**. Таким образом, она **добавляется к новой загрузке**. Если группа смешанной загрузки не указана в шаблоне формирования загрузки, данная отгрузка будет добавлена к первой загрузке.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]