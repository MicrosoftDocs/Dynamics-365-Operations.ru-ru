---
title: Установка и подключение приложения склада
description: В этом разделе описан порядок установки приложения склада на каждом из мобильных устройств и его настройки для подключения к среде Microsoft Dynamics 365 Supply Chain Management. Можно настроить каждое устройство вручную или импортировать параметры подключения из файла или путем сканирования QR-кода.
author: MarkusFogelberg
ms.date: 05/25/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: SysAADClientTable, WHSMobileAppField, WHSMobileAppFieldPriority, WHSRFMenu, WHSRFMenuItem, WHSWorker
audience: Application User, IT Pro
ms.reviewer: kamaybac
ms.custom: 267694
ms.assetid: d95d43b2-13ff-4189-a71a-3a1fb57d55ed
ms.search.region: global
ms.search.industry: Manufacturing
ms.author: mafoge
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: aeb9675477e728c28c38b1ef43fa6055acd23360
ms.sourcegitcommit: 34b478f175348d99df4f2f0c2f6c0c21b6b2660a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2021
ms.locfileid: "5909387"
---
# <a name="install-and-connect-the-warehouse-app"></a>Установка и подключение приложения склада

[!include [banner](../includes/banner.md)]

> [!NOTE]
> В этой теме описывается, как настроить старое приложение склада (которое сейчас стало устаревшим). Если вы ищите сведения о том, как настроить новое мобильное приложение управления складом см. тему [Установка и подключение мобильного приложения управления складом](install-configure-warehouse-management-app.md).

> [!NOTE]
> В этой теме описывается, как настроить приложение склада для размещения в облаке. Если требуется сведения о настройке приложения склада для локальных развертываний, см. тему [Складские операции для локальных развертываний](../../fin-ops-core/dev-itpro/deployment/warehousing-for-on-premise-deployments.md).

Приложение склада доступно в магазине Google Play и Microsoft Store. Оно предоставляется как отдельный компонент. Поэтому необходимо загрузить его на каждое устройство, а затем настроить его для подключения к среде Microsoft Dynamics 365 Supply Chain Management.

В этом разделе описан порядок установки приложения склада на каждом из мобильных устройств и его настройки для подключения к среде Supply Chain Management. Можно настроить каждое устройство вручную или импортировать параметры подключения из файла или путем сканирования QR-кода.

## <a name="system-requirements"></a>Требования к системе

Приложение склада доступно в операционных системах Windows и Android. Чтобы использовать последнюю версию приложения, на мобильном устройстве должна быть установлена одна из следующих операционных систем:

- Windows 10 (универсальная платформа Windows \[UWP\]) обновление 1709 (Сборка 10.0.16299) или более поздней версии
- Android 4.4 или более поздняя версия

> [!NOTE]
> Если необходимо поддерживать старые устройства Windows, которые не могут работать с последней версией Windows, можно загружать версию 1.6.3.0 приложения склада в магазине Microsoft Store. Эта версия будет работать в Windows 10 (UWP) с обновлением 1511 (сборка 10.0.10586) или более поздней версии. Однако имейте в виду, что данная версия приложения склада не поддерживает массовый развертывание параметров подключения. Поэтому необходимо [вручную настроить подключение](#config-manually) для каждого устройства, которое запускает эту версию приложения.

## <a name="get-the-warehouse-app"></a>Получение приложения склада

Для загрузки приложения воспользуйтесь одной из следующих ссылок:

- **Windows (UWP):** [Dynamics 365 for Finance and Operations — Warehousing в магазине Microsoft Store](https://www.microsoft.com/store/apps/9p1bffd5tstm)
- **Android:** [Warehousing - Dynamics 365 в магазине Google Play Store](https://play.google.com/store/apps/details?id=com.Microsoft.Dynamics365forOperationsWarehousing)

Для небольших развертываний может потребоваться установить приложение из соответствующего магазина на каждом устройстве, а затем вручную настроить подключение к используемым средам. Однако в версии приложения склада 1.7.0.0 и более поздних также можно автоматизировать развертывание и настройку приложений. Такой подход удобен, если вы управляете многими устройствами, и используете решение управления мобильными устройствами и мобильным приложением, такое как [Microsoft Intune](/mem/intune/fundamentals/what-is-intune). Сведения об использовании Intune для добавления приложений см. в разделе [Добавление приложений в Microsoft Intune](/mem/intune/apps/apps-add).

## <a name="create-a-web-service-application-in-azure-active-directory"></a><a name="create-service"></a>Создание приложения веб-службы в Azure Active Directory

Чтобы приложение склада могло взаимодействовать с определенным сервером Supply Chain Management, необходимо зарегистрировать приложение веб-службы для клиента в Azure Active Directory (Azure AD). Следующая процедура показывает один из способов выполнить эту задачу. Для получения дополнительных сведений и альтернативных режимов см. ссылки после процедуры.

1. В веб-браузере перейдите к [https://portal.azure.com](https://portal.azure.com/).
1. Введите имя и пароль пользователя, который имеет доступ к подписке Azure.
1. На портале Azure в левой области навигации выберите **Azure Active Directory**.

    ![Azure Active Directory](media/app-connect-azure-aad.png "Azure Active Directory")

1. Убедитесь, что вы работаете с экземпляром Azure AD, который используется в Supply Chain Management.
1. В списке **Управление** выберите **Регистрации приложений**.

    ![Регистрации приложений](media/app-connect-azure-register.png "Регистрации приложений")

1. На панели инструментов выберите **создать регистрацию**, чтобы открыть мастер **Регистрация приложения**.
1. Введите имя приложения и выберите **Только организации в этом организационном каталоге**, а затем выберите **Регистрация**.

    ![Мастер регистрации приложения](media/app-connect-azure-register-wizard.png "Мастер регистрации приложения")

1. Открыта новая регистрация приложения. Запишите значение **Код приложения (клиента)**, поскольку оно потребуется позже. Этот код далее в этом разделе будет называться *Код клиента*.

    ![Код приложения (клиента)](media/app-connect-azure-app-id.png "Код приложения (клиента)")

1. В списке **Управление** выберите **Сертификат и секреты**. Затем выберите одну из следующих кнопок, в зависимости от того, как вы хотите настроить приложение для проверки подлинности. (Дополнительные сведения см. в [Аутентификация с использованием сертификата или секрета клиента](#authenticate) далее в этом разделе.)

    - **Загрузить сертификат** — Загрузка сертификата для использования в качестве секрета. Этот подход рекомендуется, поскольку он является более безопасным и может быть автоматизирован в более полной степени. Если вы выполняете приложение склада на устройствах Windows, сохраните значение **Отпечаток**, отображаемое после загрузки сертификата. Это значение потребуется при настройке сертификата на устройствах Windows.
    - **Создать секрет клиента** — Создайте ключ, введя описание ключа и продолжительность в разделе **пароли** , а затем нажмите кнопку **Добавить**. Создайте копию ключа и храните ее в надежном месте.

    ![Сертификат и секреты](media/app-connect-azure-authentication.png "Сертификат и секреты")

Дополнительные сведения о настройке приложений веб-служб в Azure AD см. в следующих источниках:

- Инструкции, демонстрирующие использование Windows PowerShell для настройки приложений веб-служб в Azure AD, см. в разделе [Использование Azure PowerShell для создания субъекта-службы с сертификатом](/azure/active-directory/develop/howto-authenticate-service-principal-powershell).
- Полные сведения о том, как создать приложение веб-службы вручную в Azure AD, см. в следующих разделах:

    - [Краткое описание: регистрация приложения на платформе Microsoft Identity](/azure/active-directory/develop/quickstart-register-app)
    - [Использование портала для создания приложения Azure AD и субъекта-службы, которые имеют доступ к ресурсам](/azure/active-directory/develop/howto-create-service-principal-portal)

## <a name="create-and-configure-a-user-account-in-supply-chain-management"></a>Создание и настройка учетной записи пользователя в Supply Chain Management

Чтобы включить Supply Chain Management для использования приложения Azure AD, выполните следующие действия.

1. Создайте пользователя, который соответствует учетным данным пользователя приложения склада:

    1. В Supply Chain Management перейдите к **Администрирование системы \> Пользователи \> Пользователи**.
    1. Создание пользователя.
    1. Назначьте пользователя складского мобильного устройства.

    ![Назначьте пользователя складского мобильного устройства](media/app-connect-app-users.png "Назначьте пользователя складского мобильного устройства")

1. Свяжите приложение Azure AD с пользователем приложения склада:

    1. Перейдите в раздел **Администрирование системы \> Настройка \> Приложения Azure Active Directory**.
    1. Создайте строку.
    1. Введите код клиента, для которого была создана заметка в предыдущем разделе, присвойте ему имя и выберите только что созданного вами пользователя. Рекомендуется отмечать все свои устройства. Затем, если они теряются, можно легко удалить их доступ к Supply Chain Management с этой страницы.

    ![Приложения Azure Active Directory](media/app-connect-aad-apps.png "Приложения Azure Active Directory")

## <a name="authenticate-by-using-a-certificate-or-client-secret"></a><a name="authenticate"></a>Аутентификация с помощью сертификата или секрета клиента

Аутентификация с помощью Azure AD обеспечивает безопасный способ подключения мобильного устройства к Supply Chain Management. Можно выполнить аутентификацию с помощью секрета клиента или сертификата. Если будут импортированы параметры подключения, рекомендуется вместо секрета клиента использовать сертификат. Поскольку секрет клиента всегда должен храниться надежно, его нельзя импортировать из файла параметров подключения или QR-кода, как описано далее в этом разделе.

Сертификаты могут использоваться в качестве секретов, чтобы предоставить удостоверение приложения при запросе токена. Открытая часть сертификата загружается в регистрацию приложения на портале Azure, в то время как полный сертификат должен быть развернут на каждом устройстве, где установлено приложение склада. Ваша организация несет ответственность за управление сертификатом с точки зрения ротации и т.д. Можно использовать самозаверяющие сертификаты, но всегда следует использовать сертификаты, которые не могут быть экспортированы.

Сертификат необходимо сделать доступным локально на каждом устройстве, где выполняется приложение склада. Сведения об управлении сертификатами для устройств под управлением Intune если используется Intune, см. раздел [Использование сертификатов для проверки подлинности в Microsoft Intune](/mem/intune/protect/certificates-configure).

## <a name="configure-the-application-by-importing-connection-settings"></a>Настройка приложения путем импортирования параметров подключения

Для облегчения поддержки и развертывания приложения на многих мобильных устройствах можно импортировать параметры подключения вместо того, чтобы вводить их вручную на каждом устройстве. В этом разделе объясняется, как создавать и импортировать параметры.

### <a name="create-a-connection-settings-file-or-qr-code"></a>Создание файла параметров подключения или QR кода

Можно импортировать настройки подключения из файла или QR-кода. Для обоих подходов необходимо сначала создать файл параметров, использующий формат и синтаксис JavaScript Object Notation (JSON). Файл должен включать список подключений, содержащий отдельные подключения, которые необходимо добавить. В следующей таблице перечислены параметры, которые необходимо указать в файле параметров подключения.

| Параметр | описание |
| --- | --- |
| ConnectionName | Укажите имя параметра подключения. Оно может содержать до 20 знаков. Поскольку это значение является уникальным идентификатором для параметра подключения, убедитесь, что он уникален в списке. Если на устройстве уже существует подключение с таким именем, оно будет переопределено настройками из импортированного файла. |
| ActiveDirectoryClientAppId | Указание кода клиента, для которого была создана заметка во время настройки Azure AD в разделе [Создание приложения веб-службы в Azure Active Directory](#create-service). |
| ActiveDirectoryResource | Укажите корневой URL-адрес Supply Chain Management. |
| ActiveDirectoryTenant | Укажите клиент Azure AD, используемый с сервером Supply Chain Management. Это значение имеет форму `https://login.windows.net/<your-Azure-AD-tenant-ID>`. Рассмотрим пример: `https://login.windows.net/contosooperations.onmicrosoft.com`. |
| Организация | Укажите юридическое лицо в Supply Chain Management, к которому должно подключаться приложение. |
| ConnectionType | (Необязательно) Укажите, должен ли параметр подключения использовать сертификат или секрет клиента для подключения к среде. Допустимыми значениями являются *"certificate"* и *"clientsecret"*. Значение по умолчанию равно *"certificate"*.<p>**Примечание:** секреты клиента невозможно импортировать.</p> |
| IsEditable | (Необязательно) Укажите, должен ли пользователь приложения иметь возможность редактирования параметров подключения. Допустимыми значениями являются *"true"* и *"false"*. Значение по умолчанию равно *"true"*. |
| IsDefault | (Необязательно) Укажите, является ли подключение подключением по умолчанию. Подключение, установленное в качестве подключения по умолчанию, будет автоматически выбрано при открытии приложения. Установить в качестве подключения по умолчанию можно только одно подключение. Допустимыми значениями являются *"true"* и *"false"*. Значение по умолчанию равно *"false"*. |
| CertificateThumbprint | (Необязательно) Для устройств Windows можно указать отпечаток сертификата для подключения. Для устройств Android пользователь приложения должен выбрать сертификат при первом использовании подключения. |

В следующем примере показан допустимый файл параметров подключения, содержащий два подключения. Как можно видеть, список подключений (под именем *"ConnectionList"* в файле) — это объект с массивом, в котором каждое подключение хранится как объект. Каждый объект должен быть заключен в фигурные скобки ({}) и разделяться запятыми, а массив должен быть заключен в квадратные скобки (\[\]).

```json
{
    "ConnectionList": [
        {
            "ActiveDirectoryClientAppId":"aaaaaaaa-bbbb-ccccc-dddd-eeeeeeeeeeee",
            "ConnectionName": "Connection1",
            "ActiveDirectoryResource": "https://yourenvironment.cloudax.dynamics.com",
            "ActiveDirectoryTenant": "https://login.windows.net/contosooperations.onmicrosoft.com",
            "Company": "USMF",
            "IsEditable": false,
            "IsDefaultConnection": true,
            "CertificateThumbprint": "aaaabbbbcccccdddddeeeeefffffggggghhhhiiiii",
            "ConnectionType": "certificate"
        },
        {
            "ActiveDirectoryClientAppId":"aaaaaaaa-bbbb-ccccc-dddd-eeeeeeeeeeee",
            "ConnectionName": "Connection2",
            "ActiveDirectoryResource": "https://yourenvironment2.cloudax.dynamics.com",
            "ActiveDirectoryTenant": "https://login.windows.net/contosooperations.onmicrosoft.com",
            "Company": "USMF",
            "IsEditable": true,
            "IsDefaultConnection": false,
            "ConnectionType": "clientsecret"
        }
    ]
}
```

Можно либо сохранить сведения в формате JSON, либо создать QR-код с тем же содержимым. Если сохранить информацию в виде файла, рекомендуется сохранить их, используя имя по умолчанию *connections.json*, особенно если оно будет храниться в местонахождении по умолчанию на каждом мобильном устройстве.

### <a name="save-the-connection-settings-file-on-each-device"></a>Сохраните файл параметров подключения на каждом устройстве

Обычно для распределения файлов параметров подключения на каждое управляемое устройство будет использоваться средство управления устройствами или сценарий. Если вы используете имя и местонахождение по умолчанию при сохранении файла параметров подключения на каждом устройстве, приложение склада будет автоматически импортировать его, даже в ходе первого запуска после установки приложения. Если для файла используется пользовательское имя или местонахождение, пользователь приложения должен указать значения во время первого выполнения. Однако приложение будет продолжать использовать указанное имя и местонахождение позже.

При каждом запуске приложения выполняется повторное импортирование параметров подключения из их предыдущего местонахождения, чтобы определить, были ли внесены какие-либо изменения. Приложение обновит только подключения, имеющие те же имена, что и подключения в файле параметров подключения. Созданные пользователем подключения, использующие другие имена, не обновляются.

Невозможно удалить подключение, используя файл параметров подключения.

Как упоминалось, именем файла по умолчанию является *connections.json*. Местонахождение файлов по умолчанию зависит от того, используется устройство Windows или устройство Android:

- **Windows:** `C:\Users\<User>\AppData\Local\Packages\Microsoft.Dynamics365forOperations-Warehousing_8wekyb3d8bbwe\LocalState`
- **Android:** `Android\data\com.Microsoft.Dynamics365forOperationsWarehousing\files`

Обычно пути создаются автоматически после первого запуска приложения. Однако их можно создать вручную, если необходимо перед установкой передать файл параметров подключения на устройство.

> [!NOTE]
> При удалении приложения путь по умолчанию и его содержимое удаляются.

### <a name="import-the-connection-settings"></a>Импорт параметров подключения

Выполните следующие действия, чтобы импортировать настройки подключения из файла или QR-кода.

1. Откройте приложение склада на мобильном устройстве.
1. Перейдите к **Параметры подключения**.
1. Задайте для параметра **Использовать Демонстрационный режим** значение _Нет_.

    ![Используйте параметр демонстрационного режима](media/app-connect-app-demo-mode.png "Используйте параметр демонстрационного режима")

1. В зависимости от того, как необходимо импортировать настройки, выберите **выбрать файл** или **сканировать QR-код**:

    - При импорте настроек подключения из файла приложение может уже найти файл, если при сохранении было использовано имя по умолчанию и местонахождение по умолчанию. В противном случае выберите **выбрать файл**, перейдите к файлу на локальном устройстве и выберите его. Если выбрать пользовательское местонахождение, приложение сохранит его и будет автоматически использовать в следующий раз.
    - Если параметры подключения импортируются путем сканирования QR-кода, выберите пункт **сканировать QR-код**. Приложение запрашивает разрешение на использование камеры устройства. После предоставления разрешения камера запускается, чтобы ее можно было использовать для сканирования. В зависимости от качества камеры устройства и сложности QR-кода, может оказаться затруднительным получить правильное сканирование. В этом случае попробуйте уменьшить сложность QR-кода путем создания только одного подключения по одному QR-коду. (В настоящее время для сканирования QR-кода можно использовать только камеру устройства.)

    ![Импорт параметров подключения](media/app-connect-app-select-file.png "Импорт параметров подключения")

1. После успешного завершения загрузки параметров подключения выберите кнопку **назад** (стрелка влево) в верхнем левом углу страницы.

    ![Параметры подключения загружены](media/app-connect-app-settings-loaded.png "Параметры подключения загружены")

1. Если вы используете устройство Android и используете для проверки подлинности сертификат, устройство предлагает выбрать сертификат.

    ![Выбор запроса сертификата на устройстве Android](media/app-connect-app-choose-cert.png "Выбор запроса сертификата на устройстве Android")

1. Приложение подключается к серверу Supply Chain Management и отображает страницу входа.

    ![Страница входа](media/app-connect-sign-in.png "Страница входа")

## <a name="manually-configure-the-application"></a><a name="config-manually"></a>Вручную настройте приложение

Можно вручную настроить приложение на устройстве для подключения к серверу Supply Chain Management через приложение Azure AD.

1. Откройте приложение склада на мобильном устройстве.
1. Перейдите к **Параметры подключения**.
1. Задайте для параметра **Использовать Демонстрационный режим** значение _Нет_.

    ![Демонстрационный режим отключен](media/app-connect-app-select-file.png "Демонстрационный режим отключен")

1. Коснитесь поля **Выбор подключения**, чтобы развернуть параметры, необходимые для ввода сведений о подключении вручную.

    ![Поля подключения вручную](media/app-connect-manual-connect.png "Поля подключения вручную")

1. Введите следующую информацию:

    - **Использовать секрет клиента** — установите для этого параметра значение _Да_, чтобы использовать секрет клиента для проверки подлинности в Supply Chain Management. Установите значение _нет_, чтобы использовать сертификат для проверки подлинности. (Дополнительные сведения см. в разделе [Создайте приложение веб-службы в Azure Active Directory](#create-service).)
    - **Имя подключения** — введите имя для нового подключения. Это имя будет отображаться в поле **выбрать подключение** при следующем открытии параметров подключения. Необходимо ввести уникальное имя. (Иными словами, оно должно отличаться от имен всех остальных подключений, которые хранятся на устройстве, если там имеются другие имена подключений.).
    - **Код клиента Active Directory** — введите код клиента, для которого была создана заметка во время настройки Azure AD в разделе [Создание приложения веб-службы в Azure Active Directory](#create-service).
    - **Секрет клиента Active Directory** — это поле доступно только в том случае, если параметр **использовать секрет клиента** имеет значение _Да_. Введите секрет клиента, для которого была создана заметка во время настройки Azure AD в разделе [Создание приложения веб-службы в Azure Active Directory](#create-service).
    - **Отпечаток сертификата Active Directory** — это поле доступно для устройств Windows только в том случае, если параметр **использовать секрет клиента** имеет значение _Нет_. Введите отпечаток сертификата, для которого была создана заметка во время настройки Azure AD в разделе [Создание приложения веб-службы в Azure Active Directory](#create-service).
    - **Ресурс Active Directory** — укажите корневой URL-адрес Supply Chain Management.

        > [!NOTE]
        > Не завершайте это значение символом косой черты (/).

    - **Клиент Active Directory** — введите клиент Azure AD, используемый с сервером Supply Chain Management. Это значение имеет форму `https://login.windows.net/<your-Azure-AD-tenant-ID>`. Рассмотрим пример: `https://login.windows.net/contosooperations.onmicrosoft.com`.

        > [!NOTE]
        > Не завершайте это значение символом косой черты (/).

    - **Компания** — введите юридическое лицо в Supply Chain Management, к которому должно подключаться приложение.

1. Выберите кнопку **Сохранить** в верхнем правом углу страницы.
1. Если вы используете устройство Android и используете для проверки подлинности сертификат, устройство предлагает выбрать сертификат.
1. Приложение подключается к серверу Supply Chain Management и отображает страницу входа.

## <a name="remove-access-for-a-device"></a>Удаление доступа для устройства

Если устройство было потеряно или взломано, необходимо удалить доступ к Supply Chain Management для устройства. Следующие шаги описывают рекомендуемый процесс для удаления доступа.

1. Перейдите в раздел **Администрирование системы \> Настройка \> Приложения Azure Active Directory**.
1. Удалите строку, которая соответствует устройству, для которого необходимо удалить доступ. Запишите код клиента, используемый для удаляемого устройства, поскольку это потребуется позже.

    Если зарегистрирован только один код клиента, и несколько устройств используют один и тот же код клиента, необходимо передать им новые параметры подключения к этим устройствам. В противном случае это приведет к потере доступа.

1. Выполните вход на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com/).
1. В левой области перехода выберите **Active Directory** и убедитесь, что вы находитесь в правильном каталоге.
1. В списке **Управление** выберите **Регистрации приложений**, затем выберите приложение для настройки. Появится страница **Параметры** со сведениями о конфигурации.
1. Убедитесь, что код клиента приложения совпадает с кодом клиента, для которого вы сделали заметку на шаге 2.
1. На панели инструментов нажмите кнопку **удалить**.
1. В появившемся подтверждающем сообщении выберите **Да**.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]