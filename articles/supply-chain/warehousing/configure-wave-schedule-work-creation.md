---
title: Планирование создания работы во время волны
description: В этой тепе описывается, как настроить и использовать метод обработки планирования создания работы во время волны.
author: perlynne
ms.date: 01/14/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: WHSPostMethod, WHSWavePostMethodTaskConfig, WHSWaveTemplateTable, WHSParameters, WHSWaveTableListPage, WHSWorkTableListPage, WHSWorkTable, BatchJobEnhanced, WHSPlannedWorkOrder
audience: Application User
ms.reviewer: ''
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: kamaybac
ms.search.validFrom: 2021-01-14
ms.dyn365.ops.version: 10.0.17
ms.openlocfilehash: 2918d2cfa8792cc249e48990ccfa0dcf03e9b8c96f1264b48d3efd51f30cabd0
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6777655"
---
# <a name="schedule-work-creation-during-wave"></a>Планирование создания работы во время волны

[!include [banner](../../includes/banner.md)]

Используйте функцию *Планирование содания работ* в рамках процесса волны, чтобы повысить пропускную способность обработки волны, настроив систему на создание работы с использованием параллельной обработки.

Когда функциональность активирована, запланированная работа будет автоматически создана, и система будет в конечном итоге обрабатывать для создания фактической работы. Если количество строк загрузки волны достигает заранее определенного порога, система создает фактическую работу быстрее путем применения параллельной асинхронной обработки.

## <a name="turn-on-the-scheduled-work-creation-features-in-feature-management"></a>Включение функций создания запланированных работ в управлении функциями

Для использования описанных в этом разделе функций они должны быть включены в системе. Используйте рабочую область [Управление функциями](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md), чтобы включить следующие функции в следующем порядке:

1. **Блокировка работы для всей организации** — необходимо для ручной и автоматической настройки создания запланированной работы.
1. **Планирование создания работы** — необходимо для ручной и автоматической настройки создания запланированной работы.
1. **Метод волны "Планирование создания работы" для всей организации** — необходимо для автоматической настройки создания запланированной работы. Эта функция не нужна, если будет использоваться только настройка вручную.

<a name="Auto-enable-schedule-work-creation"></a>

## <a name="automatically-configure-scheduled-work-creation"></a>Автоматическая настройка создания запланированной работы

Если включена функция *Метод волны "Планирование создания работы" для всей организации*, в системе автоматически выполняются следующие операции:

- Метод волны *Планирование создания работы* (`WHSScheduleWorkCreationWaveStepMethod`) добавляется и настраивается для параллельного выполнения по всем юридическим лицам.
- В шаблонах волн из всех юридических лиц, у которых для параметра **Тип шаблона волны** задано значение *Отгрузка*, а для параметра **Статус шаблона** задано значение *Допустимо*, метод *Создать работу* будет заменен методом *Планирование создания работы*. Однако шаблоны волн из юридических лиц, в которых метод *Создание работы* разрешен как повторяющийся, не изменяются.
- Конфигурации задач для метода *Планирование создания работ* будут созданы для всех складов из всех юридических лиц, в которых включен параметр **Использовать процессы управления складом**. Это означает, что метод *Планирование создания работы* будет выполняться параллельно по умолчанию. В существующих складах, для которых вы измените значение параметра **Использовать процессы управления складом** с *Нет* на *Да*, этот метод также будет выполняться параллельно по умолчанию.
- Все юридические лица будут обрабатывать волны в пакетах и для параметра **Ожидание блокировки (мс)** будет задано значение по умолчанию *60 000 мс*, если ранее было установлено значение *0* мс.
- Все новые шаблоны волн, которые вы создадите, будет использовать метод волны *Планирование создание работы* вместо метода *Создать работу*.

Существующие конфигурации обработки задач и волн также будут сохранены для всех юридических лиц, уже настроенных на обработку волн пакетами, и для всех складов, уже настроенных для параллельного использования метода *Планирование создания работы*.

При необходимости можно вручную отменить любые настройки, заданные автоматически при включении функции *Метод волны "Планирование создания работы" для всей организации*, выполнив следующие действия:

- Для шаблонов волны перейдите в раздел **Управление складом \> Настройка \> Волны \> Шаблоны волны**. Замените метод *Планирование создания работы* методом *Создать работу*.
- Для параметров склада перейдите в раздел **Управление складом \> Настройка \> Параметры управления складом**. На вкладке **Обработка волны** примените предпочтительные значения для параметров **Обрабатывать волны в партии** и **Ожидание блокировки (мс)**.
- Для методов волны перейдите в раздел **Управление складом \> Настройка \> Волны \> Методы обработки волн**. Выберите `WHSScheduleWorkCreationWaveStepMethod` и на панели операций выберите **Конфигурация задач**. При необходимости измените или удалите число пакетных задач и назначенную группу волн для каждого перечисленного склада.

## <a name="manually-configure-scheduled-work-creation"></a>Ручная настройка создания запланированной работы

Если вы не включили [функцию *Метод волны "Планирование создания работы" для всей организации*](#Auto-enable-schedule-work-creation), вы можете использовать процедуры, описанные в этом разделе, чтобы вручную настроить создание запланированных работ, если это необходимо.

### <a name="manually-enable-batch-processing-of-waves"></a>Ручное включение пакетной обработки волн

Чтобы воспользоваться преимуществом параллельного асинхронного метода создания складских работ, необходимо, чтобы ваш процесс волны был запущен в пакетном режиме. Чтобы это настроить:

1. Перейдите в раздел  **Управление складом \> Настройка \> Параметры управления складом**.
1. На вкладке **Общие** задайте для параметра **Обрабатывать волны в партии** значение *Да*. При желании можно также выбрать специальную **Группа партий обработки волны**, чтобы предотвратить выполнение обработки пакетной очереди в то же время, что и другие процессы.
1. Установите **Время ожидания блокировки (мс)**, которое применяется, когда система обрабатывает несколько волн в одно и то же время. Для большинства больших процессов волн рекомендуется установить значение *60000*.

### <a name="manually-enable-the-new-wave-step-method-for-existing-wave-templates"></a>Ручное включение нового метода шага волны для существующих шаблонов волн

Начните с создания нового метода шага волны и включения его для параллельной асинхронной обработки задач.

1. Перейдите в раздел  **Управление складом \> Настройка \> Волны \> Методы обработки волн**.
1. Выберите  **Восстановить метод** и обратите внимание, что *WHSScheduleWorkCreationWaveStepMethod* был добавлен в список методов обработки волны, которые можно использовать в шаблонах волны отгрузки.
1. Выберите запись, в которой **Имя метода** равно *WHSScheduleWorkCreationWaveStepMethod*, и выберите **Конфигурация задачи**.
1. Чтобы добавить новую строку в сетку, выберите **Создать** на панели действий и используйте следующие параметры:

    - **Склад** — выберите склад, который будет использоваться для планирования обработки создания работ.
    - **Максимальное число пакетных задач** — указывает максимальное число пакетных задач. В большинстве случаев это значение должно находиться в диапазоне от 8 до 16, однако рекомендуется поэкспериментировать с оптимальной настройкой на основе ваших сценариев.
    - **Группа пакетов обработки волн** — выберите специальную группу пакетов обработки волн для оптимизации обработки очереди пакетных заданий.

Теперь можно обновить существующий шаблон волны (или создать новый) для использования метода обработки волны *Планирование создания работ*.

1. Перейдите в раздел  **Управление складом \> Настройка \> Волны \> Шаблоны волны**.
1. Выберите **Правка** на панели операций.
1. В области списка выберите шаблон волны, который требуется обновить (если тестируется производится с помощью демонстрационных данных, можно использовать *Доставка 24 по умолчанию*).
1. Разверните экспресс-вкладку **Методы** и выберите строку, в которой **Имя** равно *Планирование создания работ* в сетке **Оставшиеся методы**.
1. Выберите стрелку, указывающую на столбец **Выбранные методы**, чтобы переместить выбранную строку в этот столбец. (Допускается только один выбранный метод за раз, использующий `WHSScheduleWorkCreationWaveStepMethod` или `createWork`, поэтому существующая строка, в которой **Имя метода** равно `createWork`, автоматически перемещается в сетку **Оставшиеся методы**.)

## <a name="set-wave-task-processing-threshold-data"></a>Установка пороговых значений обработки задач волны

Система создаст пороговые данные обработки задач волны по умолчанию при первом запуске процесса волны с использованием любой обработки на основе задач. Данные используются для управления тем, когда обработка волны выполняется асинхронно и должна быть основана на задачах, что позволяет ей параллельно обрабатывать и создавать работу.

Данные по умолчанию изначально будут использовать пороговое значение 15 для минимального количества строк загрузки (`MINIMUMWAVELOADLINES`). Это означает, что когда система обрабатывает волну с более чем 15 строками загрузки, она будет использовать асинхронную обработку задач. Эти данные можно вручную вставить или обновить в таблице `WHSWaveTaskProcessingThresholdParameters` в ваших тестовых средах. Если необходимо изменить этот параметр в производственной среде, необходимо обратиться в службу поддержки Майкрософт, чтобы запросить обновление.

## <a name="work-with-the-scheduled-work-creation"></a>Работа с запланированным созданием работ

Сведения о работе с запланированным созданием работ см. в разделе [Создание и обработка волн](wave-processing.md). 


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
