---
title: Отгрузка небольших посылок
description: В этой статье содержится информация о функции отгрузки небольших посылок (SPS). Эта функция позволяет Microsoft Dynamics 365 Supply Chain Management отправлять сведения о упакованном контейнере перевозчику, а затем получать этикетку отгрузки, ставку отгрузки и номер отслеживания от этого перевозчика.
author: Mirzaab
ms.date: 01/08/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: TMSRateEngine, TMSCarrier, CustTable, TMSShippingCarrierCustomerAccount, TMSSmallParcelShippingFeature
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2021-01-08
ms.dyn365.ops.version: 10.0.16
ms.openlocfilehash: 6ccc9c795e2da121acf9c0809aef99a5f9d5889e
ms.sourcegitcommit: c98d55a4a6e27239ae6b317872332f01cbe8b875
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/02/2022
ms.locfileid: "9219729"
---
# <a name="small-parcel-shipping"></a>Отгрузка небольших посылок

[!include [banner](../../includes/banner.md)]

Функция отгрузки небольших посылок (SPS) позволяет Microsoft Dynamics 365 Supply Chain Management взаимодействовать непосредственно с перевозчиками, представляя основу для связи через API-интерфейсы перевозчиков. Эта функция полезна при отгрузке отдельных заказов на продажу через коммерческих перевозчиков вместо использования отправки в контейнерах или отгрузки меньше грузоподъемности грузовика (LTL).

Функция SPS взаимодействует с перевозчиком, осуществляющим доставку, через выделенный *механизм ставок*. Ваша организация должна разработать этот механизм ставок совместно со службой перевозчика или центра перевозок. Механизм ставок позволяет Supply Chain Management отправлять сведения о упакованном контейнере вашему перевозчику, а затем получать этикетку отгрузки, ставку отгрузки и номер отслеживания от этого перевозчика.

Возвращаемая ставка отгрузки добавляется к соответствующему заказу на продажу в качестве накладных расходов. Возвращаемая этикетка отгрузки может быть затем автоматически распечатана с помощью принтера, поддерживающего язык Zebra Programming Language (ZPL), и закреплена на отгрузке. Перевозчик отсканирует эту этикетку отгрузки при получении пакетов на вашем складе.

## <a name="prepare-your-system-to-support-sps"></a>Подготовка системы к поддержке SPS

Прежде чем приступить к использованию функций SPS, необходимо включить функцию SPS в управлении функциями, добавить механизм ставок и настроить модули **Управление транспортировкой** и **Управление складом** для ее поддержки.

### <a name="turn-on-the-sps-feature"></a>Включение функции SPS

Прежде чем использовать функцию SPS, она должна быть включена в системе. Администраторы могут использовать рабочую область [управления компонентами](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) для проверки статуса этой функции и ее включения, если это требуется. В этом случае функция указана следующим образом:

- **Модуль:** *Управление транспортировкой*
- **Название компонента:** *Отгрузка небольших посылок*

### <a name="deploy-and-set-up-rate-engines"></a>Развертывание и настройка механизмов ставок

Supply Chain Management не включает какие-либо механизмы ставок. Необходимо получить или создать любые необходимые вам механизмы ставок, а затем добавить их в систему. Однако в Microsoft предусмотрен демонстрационный механизм ставок, который можно использовать для тестирования.

#### <a name="download-and-deploy-the-demo-rate-engine"></a>Загрузка и развертывание демонстрационного механизма ставок

Чтобы получить демонстрационный механизм ставок, необходимо выполнить следующие действия.

1. В GitHub загрузите [библиотеку динамической компоновки (DLL) для демонстрационного механизма ставок](https://github.com/microsoft/Dynamics-365-FastTrack-Implementation-Assets/tree/master/SCM/SPS).
1. На вашем сервере Supply Chain Management сохраните библиотеку DLL в папке **\\AOSService\\PackagesLocalDirectory\\ApplicationSuite\\bin**.

#### <a name="create-and-deploy-functional-rate-engines"></a>Создание и развертывание функциональных механизмов ставок

Сведения о создании и развертывании функциональных механизмов ставок для их использования в производственной или тестовой среде см. в следующих статьях:

- [Создание нового механизма управления транспортировкой](../transportation/create-new-transportation-management-engine.md)
- [Настройка механизмов управления транспортировкой](/dynamicsax-2012/appuser-itpro/set-up-transportation-management-engines)

Дополнительные сведения о создании механизма ставок SPS см. в следующей записи блога: [Отгрузка небольших посылок: как использовать функцию отгрузки небольших посылок в Microsoft Dynamics 365](https://hub.bhsolutions.com/creating-a-mock-parcel-engine-in-d365?submissionGuid=46a1fccf-80b0-4b70-a6a0-4bf45a8756b5).

#### <a name="set-up-a-rate-engine-in-supply-chain-management"></a>Настройка механизма ставок в Supply Chain Management

Создав и развернут механизм ставок для SPS, выполните следующие действия, чтобы настроить его.

1. Перейдите в раздел **Управление транспортировкой \> Настройка \> Механизмы \> Механизм ставок**.
1. На панели операций выберите **Создать**, чтобы добавить строку в сетку.
1. В новой строке установите следующие поля:

    - **Механизм оценки** — введите уникальное имя для механизма ставок. При использовании демонстрационного механизма ставок введите *Демонстрационный механизм ставок*.
    - **Название** — введите краткое описание механизма ставок. При использовании демонстрационного механизма ставок введите *Демонстрационный механизм ставок*.
    - **ИД метаданных оценки** — выберите основу, которая должна использоваться для расчета ставки. Например, ставка может рассчитываться на основе расстояния. Если используется демонстрационный механизм ставок, это поле можно оставить пустым.
    - **Сборка механизма** — введите имя файла развернутого пакета DLL. При использовании демонстрационного механизма ставок введите *TMSSmallParcelShippingEngine.dll*.
    - **Класс механизма** — введите имя класса, установленного для механизма ставок. При использовании демонстрационного механизма ставок введите *TMSSmallParcelShippingEngine.SmallParcelShippingRateEngine*.

## <a name="example-scenario"></a>Пример сценария

В этом примере показано, как настроить и использовать службы SPS после подготовки системы, как описано ранее в этой статье. В этом сценарии используется ранее упомянутый демонстрационный механизм ставок.

### <a name="make-demo-data-available"></a>Сделать демонстрационные данные доступными

Для работы с этим сценарием с помощью демонстрационных записей и значений, указанных здесь, необходимо использовать систему, в которой установлены стандартные [демонстрационные данные](../../fin-ops-core/fin-ops/get-started/demo-data.md). Дополнительно перед началом необходимо выбрать юридическое лицо **USMF**.

### <a name="set-up-the-scenario"></a>Настройка сценария

В данном примере сценария у вас должен быть демонстрационный перевозчик, группа перевозчиков, политика упаковки и профиль упаковки. В следующих подразделах объясняется, как подготовить записи, необходимые для сценария. В производственном сценарии процесс настройки обычно напоминает описанный здесь процесс. Однако у вас будут заданы другие значения.

#### <a name="set-up-carriers"></a>Настройка перевозчиков

Чтобы настроить перевозчика, выполните следующие шаги.

1. Перейдите в раздел **Управление транспортировкой \> Настройка \> Перевозчики \> Перевозчики, осуществляющий доставку**.
1. На панели операций выберите **Создать** для добавления перевозчика.
1. В заголовке установите следующие значения:

    - **Перевозчик, осуществляющий доставку:** *Демонстрационный перевозчик*
    - **Имя:** *Демонстрационный перевозчик*
    - **Режим:** *Земля*

1. На экспресс-вкладке **Обзор** установите следующие значения.

    - **Активировать перевозчика:** *Да*
    - **Активировать рейтинг перевозчика:** *Да*

1. На экспресс-вкладке **Службы** выберите **Создать**, чтобы добавить службу в сетку.
1. Задайте следующие значения для новой службы:

    - **Служба перевозчика:** *Демонстрационная служба перевозчика*
    - **Имя:** *Демонстрационная служба перевозчика*
    - **Способ транспортировки:** *Земля*

    Введите произвольные значения для всех остальных полей по мере необходимости. (При сохранении новой записи перевозчика отгрузки будет создан новый способ поставки, и поле **Способ поставки** будет установлено автоматически.)

1. На экспресс-вкладке **Профили оценки** выберите **Создать**, чтобы добавить профиль в сетку.
1. Задайте следующие значения для нового профиля:

    - **Профиль оценки:** *Демонстрационная служба перевозчика*
    - **Имя:** *Демонстрационная служба перевозчика*
    - **Механизм ставок:** *Демонстрационный механизм ставок*

    Введите произвольные значения для всех остальных полей по мере необходимости.

1. На панели операций выберите **Сохранить**.

Дополнительные сведения о настройке перевозчиков см. в разделе [Настройка перевозчиков](../transportation/tasks/set-up-shipping-carriers.md).

#### <a name="set-up-carrier-service-accounts"></a>Настройка учетных записей перевозчиков

Выполните следующие действия, чтобы настроить учетную запись службы перевозчика.

1. Перейдите в раздел **Управление транспортировкой \> Настройка \> Расчет ставок \> Учетная запись службы перевозчика**.
1. На панели операций выберите **Создать**, чтобы добавить учтеную запись службы перевозчика.
1. Задайте следующие значения для новой учетной записи:

    - **Перевозчик, осуществляющий доставку:** *Демонстрационный перевозчик*
    - **Служба перевозчика:** *Демонстрационная служба перевозчика*
    - **Номер счета клиента перевозчика:** номер счета клиента-перевозчика, используемый для проверки и аутентификации подключения к перевозчику, осуществляющему доставку. Это значение будет предоставлено вашим перевозчиком. Если используется демонстрационная служба, можно ввести произвольное значение.
    - **Сайт:** *6*
    - **Склад:** *62*

    > [!NOTE]
    > Часто значение **Номера счета клиента-перевозчика** является единственным значением, необходимым для проверки подлинности подключения. Однако если для перевозчика требуются дополнительные параметры проверки подлинности, ваша организация должна настроить эту страницу, чтобы добавить дополнительные поля, если необходимо.

#### <a name="set-up-a-container-packing-policy"></a>Настройка политики упаковки контейнеров

Выполните следующие действия, чтобы настроить политику упаковки контейнера.

1. Если вы еще не настроили определение принтера ZPL, настройте его с помощью приложения агента маршрутизации документов. Дополнительные сведения см. в разделе [Обзор печати документов](../../fin-ops-core/dev-itpro/analytics/print-documents.md) и связанных статьях.
1. Перейдите в раздел **Управление складом \> Настройка \> Контейнеры \> Политики упаковки контейнеров**.
1. На панели операций выберите **Создать**, чтобы добавить политику упаковки контейнеров.
1. В заголовке новой политики задайте следующие значения:

    - **Политика упаковки контейнеров:** *Демонстрационная политика упаковки*
    - **Описание:** описание политики

1. На экспресс-вкладке **Обзор** установите следующие значения.

    - **Склад:** *62*
    - **Местоположение по умолчанию для окончательной отгрузки:** *Дверь отсека*
    - **Единица измерения веса:** *КГ*
    - **Политика закрытия контейнера:** *Автоматический выпуск*
    - **Политика выпуска контейнеров:** *Сделать доступным в окончательном местоположении отгрузки*

1. На экспресс-вкладке **Манифест контейнера** установите следующие значения:

    - **Автоматический манифест при закрытии контейнера:** *Да*
    - **Требования к манифесту для контейнера:** *Управление транспортировкой*
    - **Печать содержимого контейнера:** *Нет*

1. На экспресс-вкладке **Печать этикетки перевозчика** установите следующие значения:

    - **Печатать этикету отгрузки контейнера:** *Всегда*
    - **Имя принтера:** имя принтера ZPL, который должен печатать этикетки отгрузки

#### <a name="set-up-a-packing-profile"></a>Настройка профиля упаковки

Выполните следующие действия, чтобы настроить профиль упаковки.

1. Перейдите в раздел **Управление складом \> Настройка \> Упаковка \> Профили упаковки**.
1. На панели операций выберите **Создать**, чтобы добавить профиль упаковки в сетку.
1. Задайте следующие значения для нового профиля:

    - **Код профиля упаковки:** *Демонстрационный профиль упаковки*
    - **Описание:** описание профиля
    - **Политика упаковки контейнеров:** *Демонстрационная политика упаковки*
    - **Режим кода контейнера:** *Авто*
    - **Тип контейнера:** *SmallBox*

#### <a name="set-up-a-customer-to-use-the-sps-carrier"></a>Настройка клиента для использования перевозчика SPS

Выполните следующие действия, чтобы настроить клиента так, чтобы он мог использовать созданного перевозчика.

1. Перейдите в раздел **Расчеты с клиентами \> Клиенты \> Все клиенты**.
1. В сетке найдите и выберите клиента *US-027*.
1. В области действий на вкладке **Общие** в группе **Настройка** выберите **Учетные записи клиентов-перевозчиков**.
1. На странице **Учетные записи клиентов-перевозчиков** на панели операций выберите **Создать**, чтобы добавить учетную запись в сетку.
1. Задайте следующие значения для новой учетной записи:

    - **Перевозчик, осуществляющий доставку:** *Демонстрационный перевозчик*
    - **Номер учетной записи клиента-перевозчика:** *12345* (Для этого сценария значение не имеет значения, но на него есть ссылки в следующем разделе.)

### <a name="go-through-the-example-scenario"></a>Прохождение примера сценария

После настройки всех демонстрационных примеров, как описано в предыдущем разделе, можно приступать к прохождению примера сценария.

#### <a name="create-a-sales-order-and-process-the-work"></a>Создание заказа на продажу и обработка работы

Выполните эти действия, чтобы создать заказ на продажу.

1. Перейдите в раздел **Продажи и маркетинг \> Заказы на продажу \> Все заказы на продажу**.
1. Выберите **Создать**, чтобы создать заказ на продажу.
1. В диалоговом окне **Создать заказ на продажу** задайте в поле **Счет клиента** значение *US-027*.
1. Выберите **ОК**, чтобы создать заказ на продажу и закрыть диалоговое окно.
1. Открывается новый заказ на продажу. На экспресс-вкладке **Заголовок заказа на продажу** задайте в поле **Номер учетной записи клиента-перевозчика** значение, выбранное для этого клиента ранее (*12345*).
1. В разделе **Строки заказа на продажу** добавьте строку заказа на продажу и установите для нее следующие значения:

    - **Код номенклатуры:** *A0002*
    - **Количество:** *1*
    - **Сайт:** *6*
    - **Склад:** *62*

1. Перейдите к представлению **Заголовок**.
1. На экспресс-вкладке **Доставка** установите следующие значения:

    - **Перевозчик, осуществляющий доставку:** *Демонстрационный перевозчик*
    - **Служба перевозчика:** *Демонстрационная служба перевозчика*

1. Перейдите обратно в представление **Строки**. Если будет предложено обновить способ поставки для строк продаж, выберите **Да**.
1. В разделе **Строки заказа на продажу** выберите строку заказа, которую вы настроили ранее, затем выберите **Запасы \> Резервирование**.
1. На странице **Резервирование** выберите **Резервирование лота**, чтобы зарезервировать полное количество по выбранной строке на складе.
1. Закройте страницу **Резервирование**, чтобы вернуться в заказ на продажу.
1. На панели операций на вкладке **Склад** выберите вариант **Выпустить на склад**.

    Работа создается для перемещения номенклатур из местоположения комплектации на станцию упаковки.

1. В разделе **Строки заказа на продажу** выберите **Склад \> Сведения об отгрузке**.
1. На странице **Сведения о отгрузке** запишите идентификатор отгрузки. Он потребуется при упаковке отгрузки на упаковочной станции.
1. Закройте страницу **Сведения об отгрузке**, чтобы вернуться в заказ на продажу.
1. Запишите номер заказа на продажу, затем перейдите в раздел **Управление складом \> Работа \> Вся работа**.
1. Номер заказа на продажу используется для поиска и выбора работы, которая была создана для заказа.
1. На панели операций откройте вкладку **Работа** и выберите **Завершить работу**.
1. На странице **Завершение работы** в поле **Код пользователя** выберите код пользователя. Затем на панели операций выберите **Проверить работу**.
1. Если работа прошла проверку, выберите **Завершить работу** в области действий.

    Работа помечается как завершенная для моделирования перемещения номенклатур на станцию упаковки.

#### <a name="pack-the-shipment"></a>Упаковка отгрузки

Выполните следующие действия, чтобы упаковать отгрузку.

1. Перейдите к разделу **Управление складом \> Настройка \> Работник** и убедитесь, что ваша учетная запись пользователя связана с учетной записью работника для управления складом.
1. Перейдите в раздел **Управление складом \> Комплектация и контейнеризация \> Упаковка**.
1. В диалоговом окне **Выбрать станцию упаковки** установите следующие значения:

    - **Сайт:** *6*
    - **Склад:** *62*
    - **Местонахождение:** *Упаковка*
    - **Код профиля упаковки:** *Демонстрационный профиль упаковки*

1. Нажмите **ОК**.
1. Появится страница **Упаковка**. В производственном сценарии работник отсканирует грузоместо или код отгрузки. Однако для этого сценария откройте страницу **Все отгрузки** и найдите номер отгрузки для только что созданной отгрузки. Затем введите это значение в поле **Грузоместо или отгрузка** на странице **Упаковка**. В качестве альтернативы введите код отгрузки, который вы записали ранее.
1. В области действий выберите **Создать контейнер**.
1. В появившемся диалоговом окне отображаются подробные сведения о новом контейнере. Оставьте значения по умолчанию, затем выберите **ОК**.
1. На странице **Упаковка** на экспресс-вкладке **Упаковка номенклатуры** в поле **Код** выберите *A0002*, чтобы упаковать эту номенклатуру. Номенклатура добавляется в контейнер.
1. На панели операций выберите **Контейнеры для отгрузки**.

    На появившейся странице **Контейнеры для отгрузки** имеется строка для только что созданного контейнера. Однако поле **Кода манифеста контейнера** в этой строке в настоящее время пусто, так как вы еще не получили этикетку отгрузки и номер отслеживания от перевозчика.

1. В области действий выберите **Закрыть контейнер**.
1. В диалоговом окне **Закрыть контейнер** установите для поля **Вес брутто** значение *1 кг*, затем выберите **ОК**.

    Этикетка отгрузки должна быть напечатана на принтере ZPL, который был выбран ранее. Она должна быть похожа на следующий пример.

    ![Пример этикетки отгрузки.](media/sps-label-example.png "Пример этикетки отгрузки")

1. Обратите внимание, что значения **Код манифеста контейнера** и **Итоговый фрахт** были добавлены как полученные от перевозчика.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]