---
title: Устранение неполадок операций с запасами
description: В этом разделе описывается устранение проблем, которые могут встретиться при работе с операциями с запасами.
author: sherry-zheng
ms.date: 12/03/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: chuzheng
ms.search.validFrom: 2020-12-03
ms.dyn365.ops.version: Release 10.0.16
ms.openlocfilehash: 1198bc12830afa2ae2c5eb8e77413a9d8ef70c625823f676ab1965ff250c2443
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6730401"
---
# <a name="troubleshoot-inventory-operations"></a>Устранение неполадок операций с запасами

[!include [banner](../includes/banner.md)]

В этом разделе описывается устранение проблем, которые могут встретиться при работе с операциями с запасами.

## <a name="i-cant-find-the-workflow-drop-down-dialog-box-for-inventory-journals"></a>Не удается найти раскрывающиеся диалоговое окно "Рабочий процесс" для журналов запасов.

### <a name="issue-description"></a>Описание проблемы

Вы не можете найти раскрывающееся диалоговое окно **Рабочий процесс** на странице журнала или связанные операции рабочего процесса недоступны.

Эта проблема может возникнуть по трем причинам, как описано в следующих подразделах.

### <a name="issue-resolution-1"></a>Устранение проблемы 1

Если проблема относится ко всем пользователям, это может быть связано с тем, что рабочий процесс утверждения не был назначен имени журнала. Чтобы устранить проблему, выполните следующие действия.

1. Перейдите в раздел **Управление запасами &gt; Настройка &gt; Имена журналов &gt; Запасы**.
1. В области списка выберите имя журнала, чтобы открыть его настройки.
1. На экспресс-вкладке **Общие** задайте для параметра **Рабочий процесс утверждения** значение *Да*. Если выводится запрос подтверждения изменения, выберите **Да**.
1. В поле **Рабочий процесс** выберите рабочий процесс, который необходимо использовать для выбранного имени журнала.

### <a name="issue-resolution-2"></a>Устранение проблемы 2

Если в рабочем процессе используется настраиваемый код, проблемы могут возникнуть после обновления системы. Например, в рабочем процессе журнала кнопка **Отправить** может быть недоступна, поэтому вы не сможете выбрать ее, чтобы утвердить отправку.

Если кнопка **Отправить** неактивна, возможно, ваш рабочий процесс был настроен, что означает, что метод рабочего процесса `canSubmitToWorkflow()` в `FormDataUtil` был расширен. Чтобы устранить эту проблему, измените способ, которым вы расширяете метод `canSubmitToWorkflow()` для использования структуры в следующем примере.

```xpp
[ExtensionOf(formStr(InventJournalMovement))]
public final class InventJournalMovement_extension
{
    public boolean canSubmitToWorkflow()
    {
        boolean ret = YourLogicOfCanSubmitToWorkflow();

        return ret;
    }
}
```

### <a name="issue-resolution-3"></a>Устранение проблемы 3

Если проблема относится только к нескольким определенным пользователям, у этих пользователей могут отсутствовать права доступа, необходимые для выполнения операций с рабочим процессом в журналах запасов. Убедитесь, что у каждого затронутого пользователя имеется привилегия безопасности *Ведение рабочего процесса журнала запасов*. По умолчанию эта привилегия назначается полномочиям с тем же именем, и эти полномочия применяются к ролям *Сотрудник склада* и *Менеджер склада*.

## <a name="my-inventory-journal-remains-in-system-locked-status-and-the-workflow-batch-job-doesnt-work"></a>Мой журнал запасов остается в состоянии заблокированного системой, и пакетное задание рабочего процесса не работает.

### <a name="issue-description"></a>Описание проблемы

Один из журналов запасов заблокирован какой-либо операцией и не освобождается. Например, если во время разноски (которая является операцией с системной блокировкой) произошла неизвестная ошибка, журнал может остаться в статусе заблокированного системой. В этом случае обработчик рабочего элемента рабочего процесса вызовет ошибку, когда он выполняет проверку блокировки.

### <a name="issue-resolution"></a>Устранение проблемы

Выполните вход в экземпляр SQL Server для Supply Chain Management и проверьте, установлено ли для параметра **InventJournalTable.SystemBlocked** значение *1*. Если это так, убедитесь, что журнал не должен находиться в состоянии блокировки, затем сбросьте параметр **InventJournalTable.SystemBlocked** на значение *0*.

## <a name="my-inventory-journal-workflow-is-never-completed-and-the-journal-cant-be-edited-or-posted"></a>Мой рабочий процесс журнала запасов никогда не завершается, и журнал не может редактироваться или разноситься.

### <a name="issue-description"></a>Описание проблемы

После отправки рабочего процесса утверждения журнала обработка рабочего процесса перестает отвечать, и вы не сможете редактировать или обрабатывать свои журналы.

### <a name="issue-resolution"></a>Устранение проблемы

Имеется несколько причин, по которым обработка рабочего процесса может быть не завершена. Проверьте наличие следующих проблем:

- Перейдите в раздел **Управление запасами &gt; Настройка &gt; Рабочие процессы управления запасами** и проверьте конфигурацию соответствующего рабочего процесса. Дополнительные сведения см. в разделе [Рабочие процессы утверждения журналов запасов](inventory-journal-workflow.md).
- Возможно, в рабочем процессе возникло исключение или ошибка. Проверьте историю рабочих элементов затрагиваемого рабочего процесса и проверьте, не содержит ли она ошибку приложения, которая прерывает рабочий процесс.
- Журнал запасов можно обновить или изменить только в том случае, если он утвержден. Если отзыв активен, можно попытаться отозвать журнал. Выполнение пакетного задания рабочего процесса может быть приостановлено по нескольким причинам. Некоторые из этих причин могут быть вызваны проблемой с платформой рабочих процессов.

## <a name="inventory-journal-workflow-conditions-apply-only-at-the-journal-level-not-at-the-line-level"></a>Условия рабочего процесса журнала запасов применяются только на уровне журнала, а не на уровне строки

### <a name="issue-description"></a>Описание проблемы

Эта проблема может возникнуть, например, при попытке настроить условие рабочего процесса журнала запасов для суммы затрат. Вы настраиваете условие, так что шаг 1 выполняется только в том случае, когда сумма затрат меньше 100. Вы затем настраиваете другое условие, так что шаг 2 выполняется только в том случае, когда сумма затрат больше или равна 100. Затем, после выполнения рабочего процесса, журнал рабочего процесса показывает только одну строку, а первое условие всегда оценивается как *истинное*, независимо от значения, которое было отправлено.

### <a name="issue-workaround"></a>Временное решение проблемы

В текущем выпуске условия рабочего процесса запасов применяются только на уровне журнала, а не на уровне строки. Такое поведение предусмотрено разработчиками. Рекомендуется задавать критерии условий только для атрибутов уровня журнала.

## <a name="the-filter-pane-on-the-on-hand-list-page-doesnt-filter-results-as-i-expect"></a>Панель фильтра на странице списка запасов в наличии не фильтрует результаты так, как ожидается.

### <a name="issue-description"></a>Описание проблемы

Фильтры на панель фильтра на странице **Список запасов в наличии** не фильтрует результаты так, как вы ожидаете.

### <a name="issue-resolution"></a>Устранение проблемы

Такое поведение предусмотрено разработчиками.

Страница  **Список запасов в наличии** составляется из подробной таблицы запасов в наличии, которая включает все доступные аналитики. Однако список на этой странице является сводным. Таким образом, это может быть сочетание строк из исходной таблицы путем агрегирования значений в соответствии с отображаемыми аналитиками.

Фильтры, которые настроены в области фильтров, применяются к исходной таблице, а не к сводному списку. Такое поведение может иногда привести к неожиданным результатам, как показано в [следующих примерах](inventory-on-hand-list.md#examples).

Однако,  [указанные в сетке фильтры](inventory-on-hand-list.md#grid-filters) *применяются*  к сводному списку. К этим фильтрам относятся QuickFilter в верхней части сетки и фильтр для каждого заголовка столбца.

## <a name="the-unit-and-unit-quantity-arent-working-correctly-in-the-inventory-journal"></a>Единица измерения и количество в единицах измерения неправильно работают в журнале запасов.

### <a name="issue-description"></a>Описание проблемы

При работе с единицами измерения и количествами в журнале запасов можно столкнуться с одной или несколькими из перечисленных ниже проблем:

- Вы не видите единицы измерения или количества в единицах измерения в журнале запасов, когда единица преобразования настроена для выпущенного продукта, и нельзя изменить единицу измерения в журнале запасов.
- Вы видите поля **Количество** и **Единица измерения** в журнале запасов, но не видите поле **Количество в единицах измерения**. Если изменить единицу измерения, ввести количество и разнести журнал, журнал по-прежнему отображает исходную единицу измерения для этого количества.

### <a name="issue-resolution"></a>Устранение проблемы

Чтобы устранить эту проблему, выполните следующие действия.

1. В рабочей области **Управление функциями** убедитесь, что функция *Использование единицы измерения и количества в единицах измерения в журналах запасов* включена. Эта функция добавляет поля **Единица измерения** и **Количество в единицах измерения** в журнал.
1. После включения этой функции используйте поля **Количество**, **Количество в единицах измерения** и **Единица измерения** следующим образом:

    - **Количество** — укажите количество, используя единицу измерения по умолчанию, которая определена для выпущенного продукта. Однако сама единица измерения по умолчанию здесь не отображается. Если преобразование настроено между единицей измерения по умолчанию и единицей измерения, выбранной в поле **Единица измерения**, поле **Количество** обновляется автоматически в зависимости от значений, выбранных в полях **Количество в единицах измерения** и **Единица измерения**.
    - **Количество в единицах измерения** — укажите количество, используя единицу измерения, выбранную в поле **Единица измерения**.
    - **Единица измерения** — выберите единицу измерения для применения к значению в поле **Количество в единицах измерения**.

## <a name="i-receive-the-following-error-message-maximum-number-of-decimals-for-the-stock-keeping-unit-is-0"></a>Я получаю следующее сообщение об ошибке: "Максимальное число десятичных знаков для единицы складского хранения равно 0".

### <a name="issue-description"></a>Описание проблемы

При попытке разноски складской проводки или резервирования запасов появляется следующее сообщение об ошибке: "Максимальное число десятичных знаков для единицы складского хранения равно 0".

Эта проблема возникает, когда количество складской проводки указывается в виде десятичного значения, которое меньше уровня точности, поддерживаемого данным полем. Например, количество *0,5* было определено для складской проводки, но поддерживаются только целые количества. Таким образом, значение должно быть равно *1* вместо *0,5*.

### <a name="issue-resolution"></a>Устранение проблемы

1. Выполните следующий сценарий в экземпляре SQL Server для округления количеств в складских проводках. Этот сценарий будет исправлять значения в таблице **inventTrans**.

    ```sql
    update it set it.QTY = round(it.qty, decimalPrecisionValue) from inventtrans it where it.DATAAREAID='XXXX' and it.PARTITION=XXXXXX and it.qty <> round(it.qty, decimalPrecisionValue) and exists (select 'x' from INVENTTABLEMODULE a, unitofmeasure b where  a.unitid =b.SYMBOL and a.partition=it.partition and a.PARTITION=b.PARTITION and  MODULETYPE =0 and  b.DECIMALPRECISION=decimalPrecisionValue and a.DATAAREAID='XXXX' and a.ITEMID =it.ITEMID and it.DATAAREAID=a.DATAAREAID)
    ```

1. Выполните проверку целостности запасов в наличии, когда включен параметр **исправления ошибок**. Эта проверка исправит значения в таблице **inventSum**.

> [!IMPORTANT]
> Настоятельно рекомендуется аккуратно изменять сценарий в соответствии с требованиями среды, проверять его в тестовой среде, а затем проверять полученные данные перед выполнением сценария в производственной среде.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]