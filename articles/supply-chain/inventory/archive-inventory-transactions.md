---
title: Архивирование проводок по запасам
description: В этом разделе описывается, как архивировать данные проводок по запасам для повышения производительности системы.
author: sherry-zheng
ms.date: 03/01/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: InventTransArchiveProcessForm
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: chuzheng
ms.search.validFrom: 2021-03-01
ms.dyn365.ops.version: Release 10.0.18
ms.openlocfilehash: e0bade4066cc65086f864cba29b21201965ac3ea12191240a74c0f46645a2aac
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6722423"
---
# <a name="archive-inventory-transactions"></a>Архивирование проводок по запасам

[!include [banner](../../includes/banner.md)]

Со временем таблица проводок по запасам (`InventTrans`) продолжит расти и будет потреблять больше места для базы данных. Поэтому запросы, выполняемые с таблицей, постепенно становятся медленнее. В этом разделе описывается, как использовать функцию *Архивация проводок по запасам* для архивирования данных о проводках по запасам для повышения производительности системы.

> [!NOTE]
> В выбранный закрытый период ГК можно архивировать только финансово обновленные проводки по запасам. Для архивации у финансово обновленных исходящих проводок по запасам должен быть статус отпуска *Продано*, а для входящих проводок по запасам должен быть установлен статус поступления *Куплено*.

При архивации проводок по запасам все соответствующие проводки переносятся в таблицу `InventTransArchive`. Проводки отпуска запасов и проводки поступления на склад архивируются отдельно, на основе комбинации кода номенклатуры (`itemId`) и кода складской аналитики (`inventDimId`), и они помещаются в суммарные проводки отпуска и поступления.

Если комбинация `itemId` и `inventDimId` содержит только одну проводку поступления или отпуска, проводка не будет заархивирована.

## <a name="turn-on-the-feature-in-your-system"></a>Включите функцию в системе

Если ваша система еще не содержит функций, описанных в этом разделе, перейдите в [Управление функциями](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) и включите функцию *Архивация проводок по запасам*. Обратите внимание, что эту функцию нельзя отключить после ее активации.

## <a name="things-to-consider-before-you-archive-inventory-transactions"></a>Вопросы, которые необходимо учесть перед архивацией проводок по запасам

Перед архивацией проводок по запасам необходимо учитывать следующие бизнес-сценарии, поскольку на них повлияет операция:

- При аудите проводок по запасам из соответствующих документов, таких как строки заказа на покупку, они будут показаны как архивированные. Чтобы просмотреть архивированные проводки, необходимо перейти **Управление запасами \> Периодические задачи \> Очистка \> Архивация проводок по запасам**.
- Закрытие склада не может быть отменено для архивированных периодов. Прежде чем можно будет отменить закрытие склада, необходимо сторнировать архив проводок по запасам для соответствующего периода.
- Преобразование стандартных затрат нельзя выполнить для архивированных периодов. Прежде чем можно будет выполнить преобразование стандартных затрат, необходимо сторнировать архив проводок по запасам для соответствующего периода.
- При архивации проводок по запасам отчеты по запасам, источником которых являются проводки по запасам, будут затронуты. Эти отчеты включают отчет распределения запасов по срокам и отчеты по стоимости запасов.
- Прогнозы по запасам могут быть затронуты, если они выполняются во временном горизонте архивированных периодов.

## <a name="prerequisites"></a>Необходимые условия

Проводки по запасам можно архивировать только в периоды, когда соблюдаются следующие условия:

- Период главной книги должен быть закрыт.
- Закрытие склада должно выполняться в дату окончания периода архивации или после нее.
- Период должен быть по крайней мере на один год раньше начальной даты периода архивации.
- Не должно быть каких-либо существующих перерасчетов запасов.

## <a name="archive-inventory-transactions"></a>Архивирование проводок по запасам

Чтобы архивировать проводки по запасам, выполните следующие действия.

1. Перейдите в раздел **Управление запасами** \> **Периодические задачи** \> **Очистка** \> **Архивация проводок по запасам**.

    Появится страница **Архивация проводок по запасам**, в которой отображается список архивированных записей процесса.

    ![Страница архивирования проводок по запасам.](media/archive-inventory-empty.png "Страница архивирования проводок по запасам")

1. В области действий выберите **Архивирование проводок по запасам** для создания архива проводок по запасам.
1. В диалоговом окне **Архивирование проводок по запасам** на экспресс-вкладке **Параметры** установите следующие поля:

    - **Начальная дата в закрытом периоде ГК** — выберите самую раннюю дату проводки для включения в архив.
    - **Конечная дата в закрытом периоде ГК** — выберите самую позднюю дату проводки для включения в архив.

    ![Диалоговое окно архивирования проводок по запасам.](media/archive-inventory-dates.png "Диалоговое окно архивирования проводок по запасам")

    > [!NOTE]
    > Для выбора доступны только периоды, соответствующие [предварительным требованиям](#prerequisites).

1. На экспресс-вкладке **Выполнять в фоновом режиме** настройте сведения о пакетной обработке по мере необходимости. Выполните обычные действия для пакетных заданий в Microsoft Dynamics 365 Supply Chain Management.
1. Нажмите **ОК**.
1. Появится сообщение с предложением подтвердить, что вы хотите продолжить. Внимательно прочтите сообщение и нажмите кнопку **Да**, если необходимо продолжить операцию.

    Появится сообщение о том, что задание архивирования проводок по запасам было добавлено в очередь пакетных заданий. После этого задание начнет архивировать проводки по запасам из выбранного периода.

## <a name="view-archived-inventory-transactions"></a>Просмотр архивированных складских проводок

На странице **Архивирование проводок по запасам** отображается полный журнал архивирования. В каждой строке сетки отображаются такие сведения, как дата создания архива, пользователь, создавший его, и его статус.

![Страница журнала архивирования проводок по запасам.](media/archive-inventory-full.png "Страница журнала архивирования проводок по запасам")

В раскрывающемся списке в верхней части страницы выберите одно из следующих значений для фильтрации архивов, показанных в сетке:

- **Активно** — отображаются только активные архивы, а не сторнированные архивы.
- **Все** — отображаются все архивы, активные и сторнированные.

Для каждого архива в сетке предоставляются следующие сведения:

- **Активно** — этот флажок указывает, что архив активен.
- **Начальная дата** — дата самой старой проводки, которая может быть включена в архив.
- **Конечная дата** — дата последней проводки, которая может быть включена в архив.
- **Кем запланировано** — учетная запись пользователя, создавшего архив.
- **Выполнено** — дата создания архива.
- **Сторно** — флажок указывает на то, что архива был сторнирован.
- **Остановить текущее обновление** – флажок указывает, что архивирование выполняется, но было приостановлено.
- **Состояние** — статус обработки архива. Возможные значения: *Ожидание*, *В обработке* и *Завершено*.

Панель инструментов над сеткой содержит следующие кнопки, которые можно использовать для работы с выбранным архивом:

- **Архивированные проводки** — просмотр подробных сведений о выбранном архиве. На появившейся странице **Архивированные проводки** показаны все проводки в архиве.

    ![Страница архивированных проводок.](media/archive-inventory-transactions.png "Страница архивированных проводок")

    Чтобы просмотреть дополнительные сведения о конкретной проводке на странице **Архивированные проводки**, выберите ее в сетке, а затем в области действий выберите **Сведения об архивированной проводке**. На появившейся странице **Сведения об архивированной проводке** содержатся такие сведения, как разноска ГК, связанные ссылки субкниги и финансовые аналитики.

- **Приостановить архивацию** — приостановить выбранную архивацию, обрабатываемую в данный момент. Пауза вступает в силу только после создания задачи архивирования. Поэтому может быть короткая задержка, прежде чем пауза вступит в силу. Если архивация была приостановлена, в поле **Остановить текущее обновление** появится флажок.
- **Возобновить архивацию** — возобновить обработку выбранной архивации, приостановленную в данный момент.
- **Сторно** — сторнировать выбранный архив. Сторнировать архив можно только в том случае, если в поле **Состояние** выбрано значение *Завершено*. Если архив был сторнирован, в поле **Сторно** появится флажок.
