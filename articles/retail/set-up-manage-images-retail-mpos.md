---
title: "Настройка и управление изображениями для Retail Modern POS"
description: "В этой статье описываются шаги, которые выполняются при настройке и управлении изображениями для различных объектов, которые отображаются в Retail Modern POS (MPOS)."
author: athinesh99
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-365-retail
ms.technology: 
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations, Retail
ms.custom: 52851
ms.assetid: 5c21385e-64e0-4091-98fa-6a662eb33010
ms.search.region: global
ms.search.industry: Retail
ms.author: athinesh
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0, Retail July 2017 update
ms.translationtype: HT
ms.sourcegitcommit: 7e0a5d044133b917a3eb9386773205218e5c1b40
ms.openlocfilehash: 2ec39137bcc68bd7d9b71f6798474e88fb89fd1e
ms.contentlocale: ru-ru
ms.lasthandoff: 09/29/2017

---

# <a name="set-up-and-manage-images-for-retail-modern-pos"></a>Настройка и управление изображениями для Retail Modern POS

[!include[banner](includes/banner.md)]


В этой статье описываются шаги, которые выполняются при настройке и управлении изображениями для различных объектов, которые отображаются в Retail Modern POS (MPOS).

<a name="setting-up-the-media-base-url-and-defining-media-templates-to-configure-the-format-for-image-urls"></a>Настройка базового URL-адреса мультимедиа и определение шаблонов мультимедиа для настройки формата для URL-адресов изображений
-------------------------------------------------------------------------------------------------

Изображения, которые отображаются в Retail Modern POS (MPOS), должны быть размещены за пределами Microsoft Dynamics 365 for Retail. Как правило, они размещаются в системе управления контентом, в сети доставки контента (CDN) или на сервере мультимедиа. MPOS извлекает изображения и отображает их для соответствующих объектов, таких как продукты и каталоге, путем обращения к целевому URL-адресу. Для извлечения этих размещенных во внешней системе изображений MPOS требуется правильный формат URL-адресов этих изображений. Вы можете настроить необходимый формат URL-адресов для изображений путем задания значения **Базовый URL-адрес СМИ** в профиле канала и использования функциональности **Определить шаблон СМИ** для каждого объекта. Вы можете также перезаписать стандартный формат URL для подмножества объектов с помощью функциональности **Изменить в Excel**. **Важное примечание.** В текущей версии Dynamics 365 for Retail больше нельзя настраивать формат URL-адресов путем использования XML-атрибута **Image** для MPOS в группе атрибутов **Default** для объектов. Если вы знакомы с Microsoft Dynamics AX 2012 R3, а теперь используете текущую версию Dynamics 365 for Retail, следите за тем, чтобы всегда использовать новую функциональность **Определить шаблон СМИ** для настройки изображений. Не используйте или изменяйте атрибут **Image** в группе атрибутов **Default** для каких-либо объектов, включая продукты. Изменения, вносимые непосредственно в группу атрибутов **Default** для изображений, отражаться не будут. В будущих выпусках этот вариант будет отключен. В следующих процедурах в качестве примера настраиваются изображения для объекта "Каталог". Эти процедуры позволяют гарантировать, что для всех изображений каталога, для которых используется общий путь, неявно задан правильный путь к изображениям. Например, если вы настроили внешний сервер мультимедиа или CDN и хотите, чтобы изображения отображались в MPOS для данного магазина, функциональность **Определить шаблон СМИ** поможет вам настроить путь, по которому MPOS будет искать изображения и извлекать их. **Примечание.** В данном примере с демонстрационными данными сервер мультимедиа развернут на сервере Retail Server. Тем не менее он может находиться где угодно за пределами Dynamics 365 for Retail.

### <a name="set-up-the-media-base-url-for-a-channel"></a>Настройка базового URL-адреса мультимедиа для канала

1.  Откройте портал центрального офиса Dynamics 365 for Retail.
2.  Выберите **Розничная торговля** &gt; **Настройка канала** &gt; **Профили канала**. [![профиль-канала1](./media/channel-profile1.png)](./media/channel-profile1.png)
3.  В профиле канала, который используется в вашем магазине для MPOS, введите в поле **Базовый URL-адрес СМИ** базовый URL-адрес вашего сервера мультимедиа или CDN. Базовый URL-адрес — это первая часть URL-адреса, которая является общей для всех папок изображений различных объектов.[![профиль-канала2](./media/channel-profile2.png)](./media/channel-profile2.png)

### <a name="define-the-media-template-for-an-entity"></a>Определение шаблона мультимедиа для объекта

1.  Щелкните **Розничная торговля** &gt; **Управление каталогами** &gt; **Изображения каталога**.
2.  На странице **Изображения каталога** на панели операций щелкните **Определить шаблон СМИ**. В диалоговом окне **Определить шаблон СМИ** в поле **Объект** по умолчанию должен быть выбран вариант **Каталог**.
3.  На экспресс-вкладке **Путь носителя** введите остальную часть пути к местоположению изображения. Путь к мультимедиа поддерживает в качестве переменной **LanguageID**. Например, для демонстрационных данных можно создать папку **Catalogs**, где будут находиться все изображения для каталогов, по базовому URL-адресу мультимедиа для вашего сервера мультимедиа (https://testax3ret.cloud.test.dynamics.com/RetailServer/MediaServer). Внутри нее у вас может быть папка для отдельного языка, например en-US или ru-RU, куда вы скопируете соответствующие изображения. Если у вас нет разных изображений для разных языков, вы можете опустить переменную **LanguageID** из структуры папок и указать непосредственно на папку Catalogs, где содержатся изображения для каталогов. **Примечание.** Текущая версия Dynamics 365 for Retail поддерживает токен **{LanguageId}** для объектов "Каталог", "Продукт" и "Категория". (Токен **{LanguageID}** не поддерживается для объектов "Клиент" и "Работник" в соответствии с существующим стандартом, который действует с Microsoft Dynamics AX 6.x.)
4.  Для изображений формат имени файла жестко привязан к имени каталога и не может быть изменен. Поэтому переименуете ваши изображения так, чтобы они имели соответствующие каталогу имена, — это позволит гарантировать, что MPOS будет корректно их обрабатывать.
5.  В поле **Расширение файла** выберите ожидаемое разрешение имени файла в зависимости от типа имеющихся у вас изображений. Например, в демонстрационных данных изображений каталогов имеют расширение .jpg. (Файлы изображений также переименованы так, что они имеют имена каталогов.)
6.  Нажмите кнопку **ОК**.
7.  Чтобы убедиться, что шаблон мультимедиа для изображений был сохранен корректно, на странице **Изображения каталога** щелкните **Определить шаблон СМИ** еще раз. Чтобы проверить шаблон без закрытия диалогового окна **Определить шаблон СМИ**, можно воспользоваться экспресс-вкладкой **Сформировать URL-адреса изображений для Excel**. Проверьте, как выглядит URL-адрес изображений, и убедитесь, что он соответствует описанному выше стандарту шаблона. Диалоговое окно **Определить шаблон СМИ** теперь неявно задает путь ко всем изображениям каталогов, для которых используется этот общий URL-путь. Этот URL-путь относится ко всем изображениям каталогов, если их не перезаписывать. Первая часть пути изображения берется из базового URL-адреса мультимедиа, который вы определили в профилей канала. Оставшаяся часть пути берется из пути, который вы определили в шаблоне мультимедиа. Эти две части объединяются, и образуется полный URL-адреса местоположения изображения. Например, каталог в демонстрационных данных называется Fabrikam Base Catalog. Следовательно, имя изображения должно быть Fabrikam Base Catalog.jpg, т. е. оно должно состоять из имени каталога и расширения .jpg, настроенного в шаблоне. В этом случае после объединения URL-адрес будет следующим: https://testax3ret.cloud.test.dynamics.com/RetailServer/MediaServer/Catalogs/en-US/Fabrikam Base Catalog.jpg.
8.  Запустите задания синхронизации, чтобы отправить новый шаблон в базу данных канала, после чего MPOS сможет использовать шаблон для доступа к изображениям.
9.  Чтобы обновить шаблон мультимедиа для изображений каталогов на стороне канала не забудьте запустить **Задание "Каталог" 1150** из **ИТ розничной торговли** &gt; **График распределения**.[![каталог1](./media/catalog1.png)](./media/catalog1.png)

## <a name="previewing-an-image-from-the-entity-level"></a>Предварительный просмотр изображения с уровня объекта
1.  Со страницы номенклатуры объекта в центральном офисе можно предварительно просмотреть изображение с URL-адресом изображения, образованным по шаблону мультимедиа. Для этого примера перейдите к соответствующему каталогу, а затем на панели операций выберите **Источники** &gt; **Изображения**. С помощью раскрывающегося списка выберите различные магазины, у которых могут быть разные профили каналов.
2.  Чтобы изменить или удалить неявный шаблон мультимедиа, необходимо вернуться в диалоговое окно **Определить шаблон СМИ** для страницы **Изображения каталога**.
3.  Вы можете с помощью кнопок **Добавить** и **Удалить** вручную изменить путь, основанный на неявном шаблоне и используемый для конкретного изображения. Дополнительные сведения см. в разделе "Перезапись шаблона мультимедиа для номенклатур объекта" ниже в этой статье.
4.  После того как вы просмотрели изображение и внесли все необходимые изменения, запустите экземпляр MPOS для соответствующего магазина и проверьте, отображаются ли изображения каталогов.[![каталог4](./media/catalog4.png)](./media/catalog4.png)

**Примечание.** Вы можете использовать эту же процедуру для всех пяти поддерживаемых объектов: "Работник", "Клиент", "Каталог", "Категория" и "Продукты". Для "продуктов каталога" (продуктов, заданных на уровне каталога) и "продуктов канала" (продуктов, заданных на уровне канала) используется шаблон, заданный для объекта "Продукты". Для шаблона мультимедиа "Продукты" можно выбрать количество изображений продукта, отображаемое для одного продукта. Вы можете также установить изображение по умолчанию для того или иного продукта. Так в MPOS не будет пустых изображений, и вы будете контролировать, какое изображение используется в качестве изображения по умолчанию для номенклатуры-продукта. В следующем примере у каждого продукта есть пять изображений, и первое изображение установлено в качестве изображения по умолчанию. Варианты продукта обрабатываются так же, как основные продукты. Имя файла изображения должно основываться на номере продукта. При формировании имени файла некоторые символы предваряются escape-символами. Поэтому желательно проверить имя файла с помощью раздела **Сформировать URL-адреса изображений для Excel**. [![продукты](./media/prods.png)](./media/prods.png)  

## <a name="synchronization-jobs-to-send-a-media-template-to-the-channel-side"></a>Задания синхронизации для отправки шаблона мультимедиа на сторону канала
Для всех пяти поддерживаемых объектов ( "Работник", "Клиент", "Каталог", "Категория" и "Продукты") при каждом обновлении диалогового окна **Определить шаблон СМИ** для настройки изображений обязательно запускайте задание "Каталог" (1150) из **ИТ розничной торговли** &gt; **График распределения**. Это задание позволит синхронизировать обновленный шаблон мультимедиа с каналом, после чего MPOS сможет его использовать. Запускайте задание "Каталог" (1150) после внесения каких-либо из следующих изменений:

-   Обновления шаблона мультимедиа изображений каталогов из **Изображения каталога** &gt; **Определить шаблон СМИ**.
-   Обновления шаблона мультимедиа изображений сотрудников из **Изображения сотрудников** &gt; **Определить шаблон СМИ**.
-   Обновления шаблона мультимедиа изображений клиентов из **Изображение клиента** &gt; **Определить шаблон СМИ**.
-   Обновления шаблона мультимедиа изображений продуктов из **Изображения продуктов** &gt; **Определить шаблон СМИ**.
-   Обновления шаблона мультимедиа изображений категорий из **Изображения категорий** &gt; **Определить шаблон СМИ**. Необходимо также опубликовать канал.

## <a name="overwriting-the-media-template-for-entity-items"></a>Перезапись шаблона мультимедиа для номенклатур объекта
Как вы узнали из предыдущего раздела, шаблону мультимедиа для того или иного объекта поддерживает только один общий путь. Этот путь основан на настроенном базовом URL-адресе мультимедиа и определенном пути к мультимедиа. Однако во многих случаях розничному магазину требуется использовать изображения из различных источников для подмножества номенклатур в объекте. Например, магазин использует резидентный сервер мультимедиа для одного набора изображений каталогов, а для другого — URL-адреса в CDN. Чтобы перезаписать URL-адреса изображений, основанные на шаблоне мультимедиа для изображений объекта на уровне объекта, можно использовать функциональность "Изменить в Excel" и редактирование вручную на странице **Предварительный просмотр**.

### <a name="overwrite-by-using-edit-in-excel"></a>Перезапись с помощью функциональности "Изменить в Excel"

1.  Щелкните **Розничная торговля** &gt; **Управление каталогами** &gt; **Изображения каталога**.
2.  На странице **Изображения каталога** щелкните **Определить шаблон СМИ**. В диалоговом окне **Определить шаблон СМИ** в поле **Объект** должен быть выбран вариант **Каталог**.
3.  На экспресс-вкладке **Путь носителя** обратите внимание на местоположение изображения.
4.  На экспресс-вкладке **Сформировать URL-адреса изображений для Excel** щелкните **Сформировать**. **Важно:** при внесении изменений в шаблон мультимедиа необходимо щелкнуть **Сформировать**, прежде чем можно будет использовать функциональность "Изменить в Excel". [![excel1](./media/excel1.jpg)](./media/excel1.jpg) Теперь вы видите предварительный просмотр URL-адресов изображений, сформированных на основе последнего сохраненного шаблона мультимедиа. [![excel2](./media/excel2.png)](./media/excel2.png) **Примечание.** В URL-адресах, сформированных для Excel, используется путь и соглашения шаблона мультимедиа, который для них определен. К этим соглашениям относятся соглашения в отношении имен файлов. Ожидается , что физические изображения находятся за пределами Dynamics 365 for Retail, и эти изображения можно извлечь по URL-адресам, образованным по ранее определенному шаблону мультимедиа. Эти автоматически полученные URL-адреса можно с помощью функциональности "Изменить в Excel".
5.  Щелкните **Изменить в Excel**.
6.  После открытия листа Microsoft Excel щелкните **Разрешить изменение** в появившемся запросе.
7.  В появившемся запросе щелкните **Доверять этой надстройке** в правой части и дождитесь завершения установки надстройки. [![Доверять этой надстройке](./media/excel4.jpg)](./media/excel4.jpg)
8.  Если вам будет предложено выполнить вход, введите учетные данные, которые вы использовали для входа в центральный офис. [![Приглашение для входа в систему](./media/excel5.png)](./media/excel5.png)
9.  После входа вы должны увидеть список URL-адресов изображений для различных записей каталогов.
10. Вы можете редактировать, добавлять и удалять URL-адреса изображений для различных номенклатур объектов.
11. Для всех объектов, кроме "Продукты", вы можете перезаписать URL-адреса изображений. Измените существующий URL-адрес изображения, чтобы в нем использовался новый конечный URL-адрес изображения, и замените имя файла новым именем файла изображения. Имя файла должно быть уникальным, чтобы гарантировать уникальность записи. [![Перезапись URL-адресов изображений в Excel](./media/excel6.jpg)](./media/excel6.jpg) **Примечание.** Когда вы перезаписываете URL-адреса изображений для объектов "Продукты" с помощью функциональности "Изменить в Excel" или на странице номенклатуры объекта, в MPOS всегда отображаются все URL-адреса изображений шаблона мультимедиа вместе с перезаписанными URL-адресами изображений.
12. Внеся все изменения, щелкните **Опубликовать в Excel**, чтобы создать новую явную запись ассоциации.
13. Вернитесь в центральный офис и нажмите **ОК**.
14. Запустите соответствующие задания синхронизации для объекта и проверьте предварительный просмотр на странице номенклатуры или в MPOS.

#### <a name="creating-new-records"></a>Создание новых записей

В Excel можно создавать новые записи. Следите, однако, за правильностью вводимой информации. Например, чтобы создать новую запись для каталога, убедитесь правильности кода каталога и имени каталога, а также укажите уникальное имя файла. Уникальное имя файла имеет большую важность, поскольку во время публикации проверяется уникальность записей в Excel. Сначала скопируйте сведения из каталога, для которого вы хотите создать новую запись, и скопируйте запись. Вам нужно обновить только имя файла и URL-адрес, потому что остальная информация будет такой же. Чтобы создать новые записи для номенклатур объекта "Продукт", используется та же базовая процедура. На листе Excel скопируйте существующую запись для продукта, для которого вы создаете новую запись, а затем замените URL-адрес изображения и имя файла. Убедитесь, что имя файла уникально.

#### <a name="deleting-an-existing-record"></a>Удаление существующей записи

Удалять можно только перезаписанные записи с URL-адресами изображений. После удаления изображения и выполнения синхронизации изображение больше не будет отображаться на странице **Предварительный просмотр** или в MPOS. Записи с URL-адресами изображений, образованными по шаблону мультимедиа, удалить нельзя, потому что эти записи будут всякий раз вновь образовываться по шаблону мультимедиа.

### <a name="overwrite-from-the-entity-level-preview-page"></a>Перезапись со страницы предварительного просмотра на уровне объекта

Для всех объектов, кроме "Продукты", вы можете перезаписать URL-адрес изображения для той или иной номенклатуры объекта на уровне номенклатуры объекта со страницы **Предварительный просмотр**. Для продуктов можно использовать страницу объекта "Продукты каталога". В этом примере показано, как переписать изображение каталога.

1.  Выберите **Каталоги** &gt; **Мультимедиа** &gt; **Изображения** и выберите изображение каталога, которое требуется обновить.
2.  Щелкните **Добавить** и введите URL-адрес изображения, который нужно перезаписать в URL-адресе по шаблону мультимедиа.
3.  Если вы хотите, чтобы это изображение отображалось в MPOS для каталога, вы можете установить в качестве изображения по умолчанию.
4.  Нажмите кнопку **OК**. URL-адрес изображения для изображения каталога обновляется, и открывается предварительный просмотр. [![предварительный-просмотр3](./media/preview3.png)](./media/preview3.png)
5.  Увидеть предварительный просмотр изображения для всех переписанных URL-адресов изображений можно также на странице галереи **Изображения каталога**.

**[![предварительный-просмотр-4](./media/preview-4.png)](./media/preview-4.png)Примечание.** В настоящее время в галерее нет предварительного просмотра URL-адресов изображений, образованных по шаблону мультимедиа. Для объектов "Каталог", "Работник", "Клиент" и "Категория", если пользователь явно предоставляет URL-адрес посредством этой страницы, мы рекомендуем указывать, какое из изображений является изображением по умолчанию, потому что в клиентах Retail Server отображается только по одному изображению на каталог, клиента, работника и категорию. Если пользователь не указал изображение по умолчанию, система определяет изображение по умолчанию и отправляет его вызывающей службе розничной торговли (MPOS или Ecommerce).

### <a name="overwrite-the-image-url-for-catalog-product-images-from-the-preview-page"></a>Перезапись URL-адреса изображения для изображений продуктов каталога со страницы "Предварительный просмотр"

Чтобы перезаписать URL-адреса изображения для изображений продуктов каталога, необходимо пользоваться страницей **Предварительный просмотр**. Использовать функциональность "Изменить в Excel" нельзя.

1.  Чтобы перезаписать изображения продуктов на уровне каталога, выберите каталог, а затем выберите продукт, для которого требуется перезаписать изображение.
2.  Щелкните **Атрибуты**.
3.  На следующей странице выберите **Изображение** и щелкните **Изменить**. Откроется страница **Предварительный просмотр** в виде диалогового окна с ползунком.
4.  Щелкните **Добавить** и перезапишите URL-адрес изображения новым URL-адресом.
5.  Нажмите кнопку **OК**. Теперь вы видите предварительный просмотр нового изображения и можете установить его в качестве изображения по умолчанию.

**[![кат3](./media/cat3.png)](./media/cat3.png)Примечание.** После того связывания изображения категории необходимо опубликовать канал и запустить задание "Канал", чтобы гарантировать, что изменения опубликованы в базе данных канала.

## <a name="setting-up-images-to-appear-in-offline-mode-for-mpos"></a>Настройка изображений для отображения в автономном режиме MPOS
MPOS может работать в режиме онлайн (с подключением к Retail Server) или в автономном режиме (при отсутствии связи с Retail Server или с сетью, т. е. когда транзакции сохраняются в автономной локальной базе данных). Когда MPOS работает в автономном режиме, получение изображений с внешнего сервера изображений для отображения с Retail Server невозможно из-за отсутствия связи с Retail Server. Тем не менее изображения все равно можно настроить так, чтобы они отображались при запуске MPOS в автономном режиме.

### <a name="set-up-product-images-to-appear-in-offline-mode-for-mpos"></a>Настройка изображений продуктов для отображения в автономном режиме MPOS

Изображения продуктов, которые должны использоваться в автономном режиме, можно настроить путем отправки требуемого физического изображения в базовое изображение продукта.

1.  Щелкните **Управление сведениями о продукте** &gt; **Продукты** &gt; **Продукты**.
2.  Выберите продукт, для которого требуется установить автономное изображение.
3.  Щелкните **Изменить**, а затем щелкните стрелку в правом углу, чтобы отобразить правую часть окна.
4.  На экспресс-вкладке **Изображение продукта** щелкните **Изменить изображение** и отправьте в систему физическое изображение, которое будет использоваться для выбранного продукта в автономном режиме.
5.  Сохраните изменения и закройте страницу.
6.  Пока MPOS работает в режиме онлайн, запустите в центральном офисе задание "Каталог", чтобы убедиться, что данные хотя бы один раз отправлены в автономную базу данных.
7.  Переведите MPOS в автономный режим. Вы должны увидеть изображение, которое вы отправили для данного продукта в центральном офисе. [![автономный-режим1](./media/offline1.png)](./media/offline1.png)

 

### <a name="set-up-catalog-category-employee-and-customer-images-to-appear-in-offline-mode-for-mpos"></a>Настройка изображений каталогов, категорий, сотрудников и клиентов для отображения в автономном режиме MPOS

Изображения каталогов, категорий, сотрудников и клиентов, которые требуется использовать в автономном режиме, можно настроить путем добавления ссылки на требуемое изображение в галерею и установки изображения в качестве изображения по умолчанию для выбранного объекта.

1.  Перейдите в каталог и на панели операций щелкните **Источники** &gt; **Изображения**.
2.  Следуя инструкциям в разделе "**Перезапись со страницы предварительного просмотра на уровне объекта**", добавьте внешний URL-адрес изображения.
3.  Пометьте это изображение как изображение по умолчанию для каталога, установив флажок напротив изображения в сетке.
4.  Запустите задание "Каталог". Это изображение теперь будет использоваться в качестве автономного изображения для данного каталога в MPOS.
5.  Следуйте тем же инструкциям для остальных объектов, таких как "Категория", "Сотрудник" и "Клиент".

[![автономный-режим2](./media/offline2.png)](./media/offline2.png)    




