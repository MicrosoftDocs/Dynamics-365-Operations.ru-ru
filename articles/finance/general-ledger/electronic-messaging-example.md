---
title: Настройка и выполнение обработки для вызова простого формата экспорта электронной отчетности для создания отчета в формате Excel
description: В этой теме представлен пример настройки и использования электронных сообщений.
author: liza-golub
ms.date: 07/06/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: ''
ms.custom: ''
ms.search.region: Global
ms.author: elgolu
ms.search.validFrom: 2021-06-24
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: a5fd466c98e0855f7a33929eeee42b9147d26ba19780b4ae7c8eb895ac27ea5e
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6737685"
---
# <a name="set-up-and-run-processing-to-call-a-simple-exporting-er-format-to-generate-an-excel-report"></a>Настройка и выполнение обработки для вызова простого формата экспорта электронной отчетности для создания отчета в формате Excel

[!include [banner](../includes/banner.md)]

После того как вы создали ваш формат электронной отчетности, сопоставили его с источниками данных и завершили его, его можно запустить с помощью рабочей области **Электронная отчетность**. После создания отчета его можно сохранить локально.

Чтобы контролировать следующие аспекты процесса отчетности, необходимо настроить обработку электронных сообщений:

- Регистрация сведений о том, кто создал отчет.
- Регистрация сведений о том, когда был создан отчет.
- Сохранение отчетов, которые были созданы для предыдущих периодов.

В следующем примере показано, как можно настроить обмен электронными сообщениями для создания отчета на основе формата экспорта электронной отчетности для Microsoft Excel. Если требуется выполнить этот пример, формат экспорта электронной отчетности для Excel должен быть уже создан, сопоставлен с источниками данных и завершен. Кроме того, номерная серия должна быть уже настроена для электронных сообщений.

При построении обработки полезно сначала определить действия обработки и статусы, которые будут настроены. На следующем рисунке показана обработка для этого примера.

![Схема обработки](media/processing-scheme.png)

## <a name="create-message-statuses"></a>Создание статусов сообщений

1. Откройте **Налог** \> **Настройка** \> **Электронные сообщения** \> **Статусы сообщения**.
2. Создайте следующие статусы сообщения:

    - Новое
    - Подготовлено
    - Создано

    ![Статусы сообщения](media/message-statuses.png)

3. В строке для статуса **Новый** выберите флажок **Разрешено удаление**, чтобы разрешить пользователям удалять сообщения с этим статусом.

## <a name="create-additional-fields"></a>Создать дополнительные поля

1. Откройте **Налог** \> **Настройка** \> **Электронные сообщения** \> **Дополнительные поля**.
2. Добавьте дополнительное поле и его значения.
3. Задайте для параметра **Изменение пользователя** значение **Да**, чтобы пользователи могли изменять это поле.

![Дополнительные поля](media/additional-fields.png)

## <a name="create-message-processing-actions"></a>Создание действий обработки сообщения

В этом примере будут созданы следующие действия обработки сообщений:

- **Создать сообщение**
- **Обновить до подготовленного**
- **Создать отчет**
- **Обновить до начального статуса** (необязательно)

Чтобы создать действия, выполните следующие действия.

1. Откройте **Налог** \> **Настройка** \> **Электронные сообщения** \> **Действия обработки сообщения**.
2. Создайте действие, которое называется **Создать сообщение**. На экспресс-вкладке **Общее** в поле **Тип действия** выберите **Создать сообщение**.
3. Создайте действие, которое называется **Обновить до подготовленного**, и задайте следующие поля:

    - На экспресс-вкладке **Общее** в поле **Тип действия** выберите **Пользовательская обработка на уровне сообщения**.
    - На экспресс-вкладке **Начальные статусы** в поле **Статус сообщения** выберите **Создать**.
    - На экспресс-вкладке **Полученные статусы** в поле **Статус сообщения** выберите **Подготовлено**. В поле **Тип отклика** введите **Выполнено успешно**.

4. Создайте действие, которое называется **Создать отчет**, и задайте следующие поля:

    - На экспресс-вкладке **Общее** в поле **Тип действия** выберите **Экспорт электронной отчетности**. В поле **Сопоставление формата** выберите формат экспорта электронной отчетности. Доступными вариантами являются **Excel**, **XML**, **JSON**, **Текст** и **Прочие**.
    - На экспресс-вкладке **Начальные статусы** в поле **Статус сообщения** выберите **Подготовлено**.
    - На экспресс-вкладке **Полученные статусы** в поле **Статус сообщения** выберите **Создано**. В поле **Тип отклика** введите **Выполнено успешно**.

    ![Действие "Создать отчет"](media/generate-report-action.png)

5. Необязательно: чтобы позволить пользователям повторно формировать отчет несколько раз, создайте действие с названием **Обновить до начального статуса** и задайте значения следующих полей:

    - На экспресс-вкладке **Общее** в поле **Тип действия** выберите **Пользовательская обработка на уровне сообщения**.
    - На экспресс-вкладке **Начальные статусы** в поле **Статус сообщения** выберите **Создано**.
    - На экспресс-вкладке **Статусы результатов** добавьте отдельную строку для каждого из двух статусов сообщений (**Подготовлено** и **Новое**). Для обеих строк установите в поле **Тип отклика** значение **Выполнено успешно**.

## <a name="electronic-message-processing"></a>Обработка электронного сообщения

В этом примере все действия должны быть настроены таким образом, чтобы они выполнялись отдельно. Предполагается, что пользователь будет инициализировать каждое действие.

1. Откройте **Налог** \> **Настройка** \> **Электронные сообщения** \> **Обработка электронного сообщения**.
2. Добавьте запись для обработки, и добавьте все ранее определенные действия и дополнительное поле.
3. Необязательно: на экспресс-вкладке **Роли безопасности** определите роли безопасности для обработки, чтобы ограничить доступ к определенной отчетности.
4. Откройте **Налог** \> **Запросы и отчеты** \> **Электронные сообщения** \> **Электронные сообщения**.
5. Выберите **Создать**, чтобы создать сообщение. На этом этапе можно добавить даты и описание. Можно также обновить значение дополнительного поля до требуемого.

    ![Создание электронного сообщения](media/create-electronic-message.png)

    Сетка на экспресс-вкладке **Журнал действий** автоматически заполняется с использованием журнала всех действий, выполненных для сообщения.

    Теперь можно удалить либо обновить статус сообщения. 

6. Чтобы обновить статус сообщения, выберите **Изменить статус**. В поле **Новый статус** выберите **Подготовлено**, затем выберите **OK**.

    ![Обновление статуса сообщения](media/update-status.png)

    Статус сообщения обновляется на **Подготовлено**.

7. Создайте отчет, выбрав **Создать отчет**.

    Создается отчет, и обновляются статус сообщения и журнал действий.

8. Для просмотра созданного отчета выберите кнопку **Вложение** (символ скрепки) в верхнем правом углу страницы.

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
