---
title: Финансовые аналитики по умолчанию в финансовых журналах
description: В этом разделе описываются правила, определяющие порядок настройки значений финансовых аналитик в проводках, которые вводятся через финансовые журналы. Кроме того, в нем описаны сценарии, в которых используются фиксированные аналитики.
author: kweekley
ms.date: 09/04/2021
ms.topic: index-page
ms.prod: ''
ms.technology: ''
ms.search.form: LedgerJournalTransDaily, LedgerJournalTransVendInvoice, LedgerJournalTransVendPaym, LedgerJournalTransCustPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: kweekley
ms.search.validFrom: 2020-12-14
ms.dyn365.ops.version: 10.0.17
ms.openlocfilehash: 51235b8a5dac50aad5031456760c970e50506d66
ms.sourcegitcommit: d1683d033fc74adbc4465dd26f7b0055e7639753
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2022
ms.locfileid: "8713116"
---
# <a name="default-financial-dimensions-on-financial-journals"></a>Финансовые аналитики по умолчанию в финансовых журналах

[!include [banner](../includes/banner.md)]

В этом разделе описываются правила, определяющие порядок настройки значений финансовых аналитик в проводках, которые вводятся через финансовые журналы (но не через журналы запасов и проектов). Кроме того, в нем описаны сценарии, в которых используются фиксированные аналитики.

## <a name="symptom"></a>Проблема

Значения финансовой аналитики в полях "Счет" или "Корр. счет" в финансовом журнале отличаются от ожидаемых. Вот два примера таких ситуаций:

Через общий журнал вводится ваучер. "Счет" — это счет поставщика, а "Корр. счет" — банковский счет. Для счета по умолчанию устанавливаются финансовые аналитики поставщика, но для корр. счета финансовые аналитики банка по умолчанию не устанавливаются. Вместо этого значения аналитик счета по умолчанию подставляются в корр. счет.

Для клиента назначаются значения финансовых аналитик по умолчанию, а для счета ГК выручки назначается фиксированное значение аналитики подразделения. Через общий журнал вводится ваучер.  "Счет" — это счет клиента, а "Корр. счет" — счет ГК, а именно счет выручки со значением фиксированной аналитики. Фиксированная аналитика не устанавливается в корр. счете для счета ГК выручки. Вместо этого для нее устанавливается значение аналитики подразделения из счета, связанного с клиентом.  После разноски ваучера значение фиксированной аналитики используется в разнесенной записи учета, но ваучер все равно содержит значение подразделения клиента. 

Какие правила выполняются при установке значений финансовых аналитик в ваучерах в журнале?

## <a name="resolution"></a>Решение

Для определения значений финансовых аналитик по умолчанию в строках ваучера в финансовых журналах (например, в общем журнале или журнале накладных поставщиков) используются следующие правила. 

1. **Заголовок журнала**

   - Аналитики заголовка журнала по умолчанию подставляются из аналитик наименования журнала.

2. **Счет строки журнала**

   - Аналитики счета строки журнала по умолчанию подставляются из аналитик заголовка журнала.
   - Если какие-либо финансовые аналитики пусты, их значения по умолчанию подставляются из аналитик клиента, поставщика, банка, основных средств или ГК.

     - Если счет имеет тип **ГК**, при вводе проводки фиксированная аналитика счета ГК считается аналитикой по умолчанию.
     - Если счет имеет тип **Клиент**, **Поставщик**, **Банк**, **Основные средства** или **Проект**, счет ГК пока определить невозможно. Поэтому фиксированная аналитика не будет по умолчанию подставляться для такого счета.

3. **Корр. счет строки журнала**

 - В первую очередь аналитики корр. счета строки журнала по умолчанию подставляются из аналитик счета строки журнала.

 - Если какие-либо финансовые аналитики пусты, значение по умолчанию подставляется из аналитик по умолчанию клиента, поставщика, банка, основных средств или ГК.
   1. Если корр. счет имеет тип **ГК**, при вводе проводки фиксированная аналитика счета ГК считается аналитикой по умолчанию. Если значение аналитики уже было по умолчанию подставлено из счета, значение по умолчанию из счета ГК или значение фиксированной аналитики не будет переопределять это существующее значение.
   2. Если корр. счет имеет тип **Клиент**, **Поставщик**, **Банк**, **Основные средства** или **Проект**, счет ГК еще не известен, и поэтому фиксированная аналитика по умолчанию не будет подставлена для корр. счета.

4. **Разноска**

    1. Во время разноски проверяется счет ГК для каждой строки записи учета (для счета и корр. счета), чтобы определить, имеется ли значение фиксированной аналитики. Если фиксированная аналитика определена, все существующие и пустые значения заменяются эти значением фиксированной аналитики.

        Значение фиксированной аналитики **не** отображается в строках журнала после разноски. Оно отображается в записи учета при просмотре ваучера после разноски.

    2. Никакие другие значения аналитик не подставляются по умолчанию во время разноски, включая дополнительные счета ГК, которые могли быть добавлены в процессе разноски, например счета допустимых расхождений и внутрихолдинговых расчетов. Записи аналитик по умолчанию для дополнительных счетов ГК подставляются из счета или корр. счета.

Для ввода значений аналитик по умолчанию процесс журнала по умолчанию не может определить, оставлено ли пустое значение аналитики намеренно или же запись по умолчанию отсутствует. Если значение аналитики намеренно оставлено пустым, значение все равно может быть подставлено по умолчанию с использованием описанного выше порядка. Если значение аналитики обязательно должно быть пустым, вы можете создать аналитику со значением **0** (ноль) или **Пусто**, чтобы она использовалась вместо пустой аналитики.

Ниже описаны примеры сценариев определения финансовых аналитик по умолчанию.

### <a name="scenario-1"></a>Сценарий 1

Выберите **Главная книга \> Настройка журнала \> Наименования журналов** и выберите имя **GenJrn**. Затем на экспресс-вкладке **Финансовые аналитики** определите следующие значения для финансовых аналитик по умолчанию:

- **BUSINESSUNIT:** 001
- **DEPARTMENT:** 024

[![Страница наименований журналов](./media/financial-dimension-defaulting-jrnl-names-01.png)](./media/financial-dimension-defaulting-jrnl-names-01.png)

Выберите **Главная книга \> Записи в журнале \> Общий журнал** и создайте новый общий журнал, который использует наименование **GenJrn**. Аналитики по умолчанию подставляются из наименования журнала (таблица LedgerJournalName) в заголовок журнала (таблица LedgerJournalTable), как показано на вкладке **Финансовые аналитики**.

[![Вкладка "Финансовые аналитики" на странице "Общие журналы"](./media/financial-dimension-defaulting-genrl-jrnl-02.png)](./media/financial-dimension-defaulting-genrl-jrnl-02.png)

Выберите **Строки**. В поле **Тип счета** выберите **Книга**, а затем в поле **Счет** введите **170150**. Затем нажмите клавишу **TAB**, чтобы выйти из поля. Аналитики по умолчанию подставляются из заголовка журнала. Поэтому поле **Счет** содержит значение **170150-001-024**.

[![Строки общего журнала на странице "Ваучер журнала"](./media/financial-dimension-defaulting-jrnl-vchr-03.png)](./media/financial-dimension-defaulting-jrnl-vchr-03.png)

Измените значение в поле **Счет** на **170150-001-023**. Введите сумму дебета или кредита. В поле **Тип корр. счета** выберите **Книга**, а затем в поле **Корр. счет** введите **600150**. Значения аналитик по умолчанию подставляются из счета. Поэтому поле **Корр. счет** содержит значение **600150-001-023**.

### <a name="scenario-2"></a>Сценарий 2

Используйте финансовые аналитики, которые были определены для наименования журнала в сценарии 1. Затем выберите **Расчеты с клиентами \> Клиенты \> Все клиенты** и определите значения финансовых аналитик по умолчанию для клиента US-001. Выберите клиента, чтобы открыть сведения о нем. На вкладке **Финансовые аналитики** сохраните значение по умолчанию для аналитики **BUSINESSUNIT** (**001**). Добавьте аналитику **COSTCENTER** и введите значение **007**.

Создайте новый общий журнал с наименованием **GenJrn**. На вкладке **Финансовые аналитики** измените значение **BUSINESSUNIT** с **001** на **002**.

Выберите **Строки**. В поле **Тип счета** выберите **Клиент**, а затем в поле **Счет** введите **US-001**. Для просмотра финансовых аналитик для типов счетов, не относящихся к ГК, выберите **Финансовые аналитики \> Счет**. Будут по умолчанию подставлены следующие значения финансовых аналитик:

- **BUSINESSUNIT:** 002 — значение по умолчанию из заголовка журнала. Значение **001** не подставляется по умолчанию из записи клиента US-001, так как значение по умолчанию уже подставлено.
- **COSTCENTER:** 007 — значение по умолчанию подставляется из записи клиента US-001.
- **DEPARTMENT:** 024 — значение по умолчанию из заголовка журнала.

Вернитесь к строке и в поле **Тип корр. счета** выберите **Книга**, а затем в поле **Корр. счет** введите **600150**. В строке будут по умолчанию подставлены следующие значения финансовых аналитик:

- **BUSINESSUNIT:** 002 — значение по умолчанию подставляется из финансовых аналитик счета. (Изначально оно было по умолчанию подставлено из заголовка журнала.)
- **DEPARTMENT:** 024 — значение по умолчанию подставляется из финансовых аналитик счета. (Изначально оно было по умолчанию подставлено из заголовка журнала.)
- **COSTCENTER:** 007 — значение по умолчанию подставляется из финансовых аналитик счета. (Изначально оно было по умолчанию подставлено из записи клиента.)

### <a name="scenario-3"></a>Сценарий 3

В журнал из сценария 2 добавьте новую строку. В поле **Тип счета** выберите **Книга**, а затем в поле **Счет** введите **170150**. Удалите значения аналитик по умолчанию, чтобы остался только счет ГК 170150. В поле **Тип корр. счета** выберите **Клиент**, а затем в поле **Корр. счет** введите **US-001**. Будут по умолчанию подставлены следующие значения финансовых аналитик:

- **BUSINESSUNIT:** 002 — значение по умолчанию подставляется из заголовка журнала, так как значение аналитики счета является пустым. Значение **001** не подставляется по умолчанию из записи клиента US-001, так как значение по умолчанию уже подставлено из заголовка журнала. Если значение **BUSINESSUNIT** было намеренно оставлено пустым, необходимо также удалить финансовую аналитику из корр. счета.
- **COSTCENTER:** 007 — значение по умолчанию подставляется из записи клиента US-001, так как значение аналитики счета и значение аналитики заголовка журнала пусты. Если значение **COSTCENTER** было намеренно оставлено пустым, необходимо также удалить финансовую аналитику из корр. счета.
- **DEPARTMENT:** 024 — значение по умолчанию подставляется из заголовка журнала, так как значение аналитики счета является пустым. Если значение **DEPARTMENT** было намеренно оставлено пустым, необходимо также удалить финансовую аналитику из корр. счета.

### <a name="scenario-4"></a>Сценарий 4

Используйте значения финансовых аналитик по умолчанию, которые вы определили для наименования журнала и клиента в сценариях 1 и 2. После этого определите значение фиксированной аналитики для аналитики **BUSINESSUNIT** счета ГК 170150. Перейдите в раздел **Главная книга \> План счетов \> Счета \> Счета ГК**. В поле основной **Счет ГК** выберите **170150**, а затем на вкладке **Переопределения юридического лица** нажмите **Добавить**. Выберите **USMF** в качестве юридического лица, а затем нажмите **Добавить**. Выберите эту запись, а затем выберите **Аналитики по умолчанию**. Измените аналитику **BUSINESSUNIT** на **Фиксированное значение** и введите значение **003**.

Создайте новый общий журнал с наименованием **GenJrn**. На вкладке **Финансовые аналитики** удалите все значения аналитик по умолчанию.

Выберите **Строки**. В поле **Тип счета** выберите **Книга**, а затем в поле **Счет** введите **170150**. Затем нажмите клавишу **TAB**, чтобы выйти из поля. Значения аналитик по умолчанию подставляются из параметров счета ГК для счета 170150. Поэтому поле **Счет** содержит значение **170150-003**.

Измените значение в поле **Счет** на **170150-004**. **Функция журнала не препятствует изменению значения фиксированной аналитики.** Введите сумму дебета или кредита. В поле **Тип корр. счета** выберите **Книга**, а затем в поле **Корр. счет** введите **170250**. Значение финансовой аналитики 004 будет по умолчанию подставлено из счета. Выполните разноску документа. В журнале выберите **Ваучер**. Обратите внимание, что для аналитики **BUSINESSUNIT** при разноске было возвращено значение фиксированной аналитики по умолчанию **003**.

При возвращении к ваучеру в журнале аналитика **BUSINESSUNIT** **не** соответствует значению фиксированной аналитики. Она всегда имеет значение, которое было показано перед разноской. Процесс разноски не меняет никаких значений, введенных в ваучере. В процессе разноски изменяется только запись учета.

## <a name="developer-notes"></a>Примечания для разработчиков

Если вы разработчик и хотите посмотреть код процесса выбора значений по умолчанию, обратите внимание на следующие методы:

- **LedgerJournalEngine.accountModified()** — это основная точка входа для процесса выбора значений по умолчанию для основной аналитики счета. Этот процесс является стандартным для всех журналов и переопределяется лишь для некоторых типов журналов.
- **LedgerJournalEngine.offsetAccountModified()** — это основная точка входа для процесса выбора значений по умолчанию для аналитики корр. счета.
