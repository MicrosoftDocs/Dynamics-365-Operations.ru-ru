---
title: Результаты моделей машинного обучения (предварительная версия)
description: В этой теме рассматриваются матрицы ошибок, проблемы классификации и точность в моделях машинного обучения (ML). Целью является улучшение понимания точности в результатах прогнозирования в ML.
author: ShivamPandey-msft
ms.date: 06/03/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: roschlom
ms.custom: 14151
ms.assetid: 3d43ba40-780c-459a-a66f-9a01d556e674
ms.search.region: Global
ms.author: shpandey
ms.search.validFrom: 2020-07-14
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: fe652c32df9417f0f716242a24a26eabd1a16f65
ms.sourcegitcommit: 74e47075eab2b0b28f82b0d57f439719847ecb01
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/07/2021
ms.locfileid: "6193548"
---
# <a name="results-of-machine-learning-models-preview"></a><span data-ttu-id="acb3c-104">Результаты моделей машинного обучения (предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="acb3c-104">Results of machine learning models (preview)</span></span>

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="acb3c-105">В этой теме рассматриваются матрицы ошибок, проблемы классификации и точность в моделях машинного обучения (ML).</span><span class="sxs-lookup"><span data-stu-id="acb3c-105">This topic discusses confusion matrices, classification problems, and accuracy in machine learning (ML) models.</span></span> <span data-ttu-id="acb3c-106">Целью является улучшение понимания точности в результатах прогнозирования в ML.</span><span class="sxs-lookup"><span data-stu-id="acb3c-106">The purpose is to enhance your understanding of accuracy in ML prediction results.</span></span> <span data-ttu-id="acb3c-107">Целевые аудитории включают инженеров, аналитиков и руководителей, желающих расширить свои знания и навыки в области обработки и анализа данных.</span><span class="sxs-lookup"><span data-stu-id="acb3c-107">The target audience includes engineers, analysts, and managers who want to build their knowledge and skills in data science.</span></span>

## <a name="confusion-matrix"></a><span data-ttu-id="acb3c-108">Матрица ошибок</span><span class="sxs-lookup"><span data-stu-id="acb3c-108">Confusion matrix</span></span>
<span data-ttu-id="acb3c-109">После того, как контролируемая система ML обучена по набору исторических данных, она тестируется с использованием данных, которые можно исключить из процесса обучения.</span><span class="sxs-lookup"><span data-stu-id="acb3c-109">After a supervised ML problem is trained on a set of historical data, it's tested by using data that is withheld from the training process.</span></span> <span data-ttu-id="acb3c-110">Таким образом можно сравнить прогнозы из обученной модели с фактическими значениями.</span><span class="sxs-lookup"><span data-stu-id="acb3c-110">In this way, you can compare the predictions from the trained model with the actual values.</span></span> <span data-ttu-id="acb3c-111">Матрица ошибок предоставляет средство оценки успешности решения задачи классификации и мест возникновения ошибок (то есть, когда она "путается").</span><span class="sxs-lookup"><span data-stu-id="acb3c-111">The confusion matrix provides a means of evaluating how successful a classification problem is and where it makes mistakes (that is, where it becomes "confused").</span></span>

<span data-ttu-id="acb3c-112">Например, ваша цель — предсказать, является ли домашнее животное собакой или кошкой, на основе некоторых физических и поведенческих атрибутов.</span><span class="sxs-lookup"><span data-stu-id="acb3c-112">For example, your objective is to predict whether a pet is a dog or a cat, based on some physical and behavioral attributes.</span></span> <span data-ttu-id="acb3c-113">Если имеется тестовый набор данных, содержащий 30 собак и 20 кошек, то матрица ошибок может быть похожа на следующую иллюстрацию.</span><span class="sxs-lookup"><span data-stu-id="acb3c-113">If you have a test dataset that contains 30 dogs and 20 cats, the confusion matrix might resemble the following illustration.</span></span>

![Пример предсказания вида](media/species-prediction-matrix.png)

<span data-ttu-id="acb3c-115">Числа в зеленых ячейках представляют собой правильные прогнозы.</span><span class="sxs-lookup"><span data-stu-id="acb3c-115">The numbers in the green cells represent correct predictions.</span></span> <span data-ttu-id="acb3c-116">Как можно видеть, модель правильно прогнозируется более высокий процент фактических кошек.</span><span class="sxs-lookup"><span data-stu-id="acb3c-116">As you can see, the model predicted a higher percentage of the actual cats correctly.</span></span> <span data-ttu-id="acb3c-117">Общую точность модели легко рассчитать.</span><span class="sxs-lookup"><span data-stu-id="acb3c-117">The overall accuracy of the model is easy to calculate.</span></span> <span data-ttu-id="acb3c-118">В данном случае это 42 ÷ 50 или 0,84.</span><span class="sxs-lookup"><span data-stu-id="acb3c-118">In this case, it's 42 ÷ 50, or 0.84.</span></span>

### <a name="multi-class-classifiers-in-a-confusion-matrix"></a><span data-ttu-id="acb3c-119">Классификаторы по нескольким классам в матрице ошибок</span><span class="sxs-lookup"><span data-stu-id="acb3c-119">Multi-class classifiers in a confusion matrix</span></span>

<span data-ttu-id="acb3c-120">Большинство дискуссий о матрице ошибок сосредоточено на двоичных классификаторах, как в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="acb3c-120">Most discussions about the confusion matrix are focused on binary classifiers, as in the preceding example.</span></span> <span data-ttu-id="acb3c-121">Этот случай представляет собой особый случай, когда могут учитываться другие показатели, такие как чувствительность и отзыв.</span><span class="sxs-lookup"><span data-stu-id="acb3c-121">This case is a special case where other metrics can be considered, such as sensitivity and recall.</span></span>

<span data-ttu-id="acb3c-122">Далее будет рассмотрена проблема классификации для финансового сценария, имеющая три состояния.</span><span class="sxs-lookup"><span data-stu-id="acb3c-122">Next, we will consider a classification problem for a finance scenario that has three states.</span></span> <span data-ttu-id="acb3c-123">Модель прогнозирует, будет ли накладная клиента оплачена вовремя, поздно или очень поздно.</span><span class="sxs-lookup"><span data-stu-id="acb3c-123">The model predicts whether a customer invoice will be paid on time, late, or very late.</span></span> <span data-ttu-id="acb3c-124">Например, из 100 тестовых накладных, 50 оплачиваются вовремя, 35 — с опозданием, а 15 — с очень большим опозданием.</span><span class="sxs-lookup"><span data-stu-id="acb3c-124">For example, out of 100 test invoices, 50 are paid on time, 35 are paid late, and 15 are paid very late.</span></span> <span data-ttu-id="acb3c-125">В этом случае модель может создать матрицу ошибок, которая напоминает следующий рисунок.</span><span class="sxs-lookup"><span data-stu-id="acb3c-125">In this case, a model might produce a confusion matrix that resembles the following illustration.</span></span>

![Модель 1](media/payment-prediction-matrix.png)<span data-ttu-id="acb3c-127">]</span><span class="sxs-lookup"><span data-stu-id="acb3c-127">]</span></span>

<span data-ttu-id="acb3c-128">Матрица ошибок предоставляет значительно больше информации, чем простая метрика точности.</span><span class="sxs-lookup"><span data-stu-id="acb3c-128">A confusion matrix provides significantly more information than a simple accuracy metric.</span></span> <span data-ttu-id="acb3c-129">Однако ее по-прежнему довольно легко понять.</span><span class="sxs-lookup"><span data-stu-id="acb3c-129">However, it's still relatively easy to understand.</span></span> <span data-ttu-id="acb3c-130">Матрица ошибок сообщает, имеется ли сбалансированный набор данных, в котором выходные классы имеют похожее количество.</span><span class="sxs-lookup"><span data-stu-id="acb3c-130">A confusion matrix tells you whether you have a balanced dataset where the output classes have similar counts.</span></span> <span data-ttu-id="acb3c-131">В случае с несколькими классами она показывает, насколько может ошибаться прогнозирование, когда выходные классы являются порядковыми, как в предыдущем примере о платежах клиентов.</span><span class="sxs-lookup"><span data-stu-id="acb3c-131">For the multi-class scenario, it tells you how far off a prediction might be when the output classes are ordinal, as in the preceding example about customer payments.</span></span>

## <a name="model-accuracy"></a><span data-ttu-id="acb3c-132">Точность модели</span><span class="sxs-lookup"><span data-stu-id="acb3c-132">Model accuracy</span></span> 
<span data-ttu-id="acb3c-133">У различных показателей точности имеется преимущество измерения качества модели.</span><span class="sxs-lookup"><span data-stu-id="acb3c-133">Different accuracy metrics have the advantage of quantifying the model quality.</span></span> 

<span data-ttu-id="acb3c-134">Так как точность является простой метрикой для понимания, она является хорошей отправной точкой для объяснения модели другим людям, особенно пользователем модели, не являющихся специалистами в области обработки данных.</span><span class="sxs-lookup"><span data-stu-id="acb3c-134">Because accuracy is an easy metric to understand, it's a good starting point for explaining a model to other people, especially to users of the model who aren't data scientists.</span></span> <span data-ttu-id="acb3c-135">Понимание статистики не требуется, чтобы понять точность модели.</span><span class="sxs-lookup"><span data-stu-id="acb3c-135">No understanding of statistics is required to understand the model's accuracy.</span></span> <span data-ttu-id="acb3c-136">При наличии матрицы ошибок она предоставляет дальнейшее понимание эффективности модели.</span><span class="sxs-lookup"><span data-stu-id="acb3c-136">When a confusion matrix is available, it provides further insight into the model's performance.</span></span>

<span data-ttu-id="acb3c-137">Однако для более глубокого понимания необходимо отметить несколько проблем, связанных с точностью.</span><span class="sxs-lookup"><span data-stu-id="acb3c-137">However, for a more thorough understanding, several challenges that are associated with accuracy should be noted.</span></span> <span data-ttu-id="acb3c-138">Полезность метрики зависит от контекста проблемы.</span><span class="sxs-lookup"><span data-stu-id="acb3c-138">The usefulness of the metric depends on the context of the problem.</span></span> <span data-ttu-id="acb3c-139">Вопрос, который часто возникает в связи с эффективностью модели, — "Насколько хорошо модель?"</span><span class="sxs-lookup"><span data-stu-id="acb3c-139">A question that often arises in relation to model performance is, "How good is the model?"</span></span> <span data-ttu-id="acb3c-140">Однако ответ на этот вопрос необязательно прост.</span><span class="sxs-lookup"><span data-stu-id="acb3c-140">However, the answer to this question isn't necessarily straightforward.</span></span> <span data-ttu-id="acb3c-141">Рассмотрим следующую матрицу ошибок (модель 2).</span><span class="sxs-lookup"><span data-stu-id="acb3c-141">Consider the following confusion matrix (model 2).</span></span>

![Пример прогноза платежей с большим образцом](media/payment-prediction-matrix-2.png)

<span data-ttu-id="acb3c-143">Быстрый расчет показывает, что точность этой модели составляет (70 + 10 + 3) ÷ 100 или 0,83.</span><span class="sxs-lookup"><span data-stu-id="acb3c-143">A quick calculation shows that this model's accuracy is (70 + 10 + 3) ÷ 100, or 0.83.</span></span> <span data-ttu-id="acb3c-144">На поверхности этот результат кажется более подходящим, чем результат для предыдущей модели с несколькими классами (модель 1), имеющей точность 0,73.</span><span class="sxs-lookup"><span data-stu-id="acb3c-144">On the surface, this result seems better than result for the previous multi-class model (model 1), which has an accuracy of 0.73.</span></span> <span data-ttu-id="acb3c-145">Но лучше ли это?</span><span class="sxs-lookup"><span data-stu-id="acb3c-145">But is it better?</span></span>

<span data-ttu-id="acb3c-146">Чтобы начать рассмотрение этого вопроса, необходимо оценить точность наивного предположения.</span><span class="sxs-lookup"><span data-stu-id="acb3c-146">To begin to address this question, consider the accuracy of a naïve guess.</span></span> <span data-ttu-id="acb3c-147">При проблемы классификации простая догадка всегда будет спрогнозировать самый распространенный класс.</span><span class="sxs-lookup"><span data-stu-id="acb3c-147">For a classification problem, a simple guess will always predict the most common class.</span></span> <span data-ttu-id="acb3c-148">Для модели 1 эта догадка будет иметь значение "вовремя", и это приведет к точности 0,50.</span><span class="sxs-lookup"><span data-stu-id="acb3c-148">For model 1, that guess will be "on time," and it will produce an accuracy of 0.50.</span></span> <span data-ttu-id="acb3c-149">Догадка для модели 2 также будет "вовремя", и это приведет к точности 0,80.</span><span class="sxs-lookup"><span data-stu-id="acb3c-149">The guess for model 2 will also be "on time," and it will produce an accuracy of 0.80.</span></span> <span data-ttu-id="acb3c-150">Поскольку модель 1 улучшает наивную догадку на 0,73 – 0,50 = 0,23, в то время как модель 2 улучшает наивную догадку на 0,83 – 0,80 = 0,03, модель 1 является лучшей моделью, даже если она имеет меньшую точность.</span><span class="sxs-lookup"><span data-stu-id="acb3c-150">Because model 1 improves on the naïve guess by 0.73 – 0.50 = 0.23, whereas model 2 improves on the naïve guess by 0.83 – 0.80 = 0.03, model 1 is a better model, even though it has lower accuracy.</span></span> <span data-ttu-id="acb3c-151">Расчет показывает, что эффективная оценка качества модели требует большего количества контекста, чем значение точности.</span><span class="sxs-lookup"><span data-stu-id="acb3c-151">The calculation reveals that effective assessment of a model's quality requires more context than the accuracy value.</span></span>

<span data-ttu-id="acb3c-152">Стоит отметить еще один аспект.</span><span class="sxs-lookup"><span data-stu-id="acb3c-152">Another aspect is worth noting.</span></span> <span data-ttu-id="acb3c-153">Рассмотрим ситуацию, в которой медицинские тесты используются для обнаружения болезни у пациентов.</span><span class="sxs-lookup"><span data-stu-id="acb3c-153">Consider a scenario where a medical test is used to detect a disease in a patient.</span></span> <span data-ttu-id="acb3c-154">Эта проблема является проблемой двоичной классификации, когда положительный результат указывает на то, что пациент болен.</span><span class="sxs-lookup"><span data-stu-id="acb3c-154">This problem is a binary classification problem where a positive result indicates that the patient has the disease.</span></span> <span data-ttu-id="acb3c-155">В этом случае необходимо подумать о влиянии следующих ошибок:</span><span class="sxs-lookup"><span data-stu-id="acb3c-155">In this scenario, you must think about the impact of the following errors:</span></span>

- <span data-ttu-id="acb3c-156">Ложный положительный результат, когда тест говорит о том, что пациент болен, но на самом деле пациент здоров.</span><span class="sxs-lookup"><span data-stu-id="acb3c-156">False positives, where the test says that a patient has the disease, but the patient doesn't really have it.</span></span>
- <span data-ttu-id="acb3c-157">Ложный отрицательный результат, когда тест говорит о том, что пациент здоров, но на самом деле пациент болен.</span><span class="sxs-lookup"><span data-stu-id="acb3c-157">False negatives, where the test says that a patient doesn't have the disease, but the patient really does have it.</span></span>

<span data-ttu-id="acb3c-158">Очевидно, что эти типы ошибок нежелательны, но что хуже?</span><span class="sxs-lookup"><span data-stu-id="acb3c-158">Obviously, both types of error are undesirable, but which is worse?</span></span> <span data-ttu-id="acb3c-159">Опять, это зависит от ситуации.</span><span class="sxs-lookup"><span data-stu-id="acb3c-159">Again, it depends.</span></span> <span data-ttu-id="acb3c-160">В случае опасной для жизни болезни, требующей быстрого лечения, приоритет имеет минимизация ложных отрицательных результатов (за которыми желательно следуют дополнительные тесты).</span><span class="sxs-lookup"><span data-stu-id="acb3c-160">In the case of a life-threatening disease that requires fast treatment, minimization of false negatives (hopefully followed by additional tests) takes priority.</span></span> <span data-ttu-id="acb3c-161">В других, менее критических случаях, создатели моделей могут минимизировать ложные положительные результаты.</span><span class="sxs-lookup"><span data-stu-id="acb3c-161">In other, less critical situations, the model creators might minimize false positives instead.</span></span> <span data-ttu-id="acb3c-162">В любом случае разумным заключением является то, что для эффективного определения качества модели необходимо иметь большее количество сведений, чем дает метрика точности.</span><span class="sxs-lookup"><span data-stu-id="acb3c-162">At any rate, a reasonable conclusion is that to effectively determine a model's quality, you must have more information than an accuracy metric provides.</span></span>

### <a name="recommendations"></a><span data-ttu-id="acb3c-163">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="acb3c-163">Recommendations</span></span>

<span data-ttu-id="acb3c-164">Точность — важное средство для общения со специалистами в экспертной области, знакомых со статистикой.</span><span class="sxs-lookup"><span data-stu-id="acb3c-164">Accuracy is an important tool for communicating with domain experts who aren't familiar with statistics.</span></span> <span data-ttu-id="acb3c-165">Однако, чтобы сделать информацию полезной, очень важно, чтобы дополнительный контекст был одновременно представлен со значением точности.</span><span class="sxs-lookup"><span data-stu-id="acb3c-165">However, to make the information useful, it's critical that additional context be provided together with the accuracy value.</span></span>

<span data-ttu-id="acb3c-166">Для сценария прогнозирования платежей можно настроить цель для модели ML, которая включает факторы в различном поведении платежей.</span><span class="sxs-lookup"><span data-stu-id="acb3c-166">For the payment prediction scenario, you can set a target for the ML model that includes factors in different payment behaviors.</span></span> <span data-ttu-id="acb3c-167">Цель состоит в том, что модель должна быть улучшена относительно наивной догадки путем уменьшения количества неправильных ответов не менее чем на 50 процентов.</span><span class="sxs-lookup"><span data-stu-id="acb3c-167">The target is that the model should improve upon a naïve guess by reducing the number of incorrect answers by at least 50 percent.</span></span> <span data-ttu-id="acb3c-168">Другими словами, требуется целевая точность, которая находится между точностью наивной догадки и 100 процентами.</span><span class="sxs-lookup"><span data-stu-id="acb3c-168">In other words, you want a target accuracy that splits the different between the accuracy of a naïve guess and 100 percent.</span></span>

<span data-ttu-id="acb3c-169">В следующей таблице приводится сводка этого принципа для матриц ошибок в этой теме.</span><span class="sxs-lookup"><span data-stu-id="acb3c-169">The following table summarizes this principle for the confusion matrices in this topic.</span></span>

| <span data-ttu-id="acb3c-170">Модель</span><span class="sxs-lookup"><span data-stu-id="acb3c-170">Model</span></span>   | <span data-ttu-id="acb3c-171">Наивное предположение</span><span class="sxs-lookup"><span data-stu-id="acb3c-171">Naïve guess</span></span> | <span data-ttu-id="acb3c-172">Цель</span><span class="sxs-lookup"><span data-stu-id="acb3c-172">Target</span></span> | <span data-ttu-id="acb3c-173">Точность модели</span><span class="sxs-lookup"><span data-stu-id="acb3c-173">Model accuracy</span></span> | <span data-ttu-id="acb3c-174">Цель достигнута?</span><span class="sxs-lookup"><span data-stu-id="acb3c-174">Is the goal met?</span></span>                                          |
|---------|-------------|--------|----------------|-----------------------------------------------------------|
| <span data-ttu-id="acb3c-175">Модель 1</span><span class="sxs-lookup"><span data-stu-id="acb3c-175">Model 1</span></span> | <span data-ttu-id="acb3c-176">0.50</span><span class="sxs-lookup"><span data-stu-id="acb3c-176">0.50</span></span>        | <span data-ttu-id="acb3c-177">0.75</span><span class="sxs-lookup"><span data-stu-id="acb3c-177">0.75</span></span>   | <span data-ttu-id="acb3c-178">0.73</span><span class="sxs-lookup"><span data-stu-id="acb3c-178">0.73</span></span>           | <span data-ttu-id="acb3c-179">Почти.</span><span class="sxs-lookup"><span data-stu-id="acb3c-179">Almost.</span></span> <span data-ttu-id="acb3c-180">Эта модель значительно лучше догадки.</span><span class="sxs-lookup"><span data-stu-id="acb3c-180">This model significantly improves upon the guess.</span></span> |
| <span data-ttu-id="acb3c-181">Модель 2</span><span class="sxs-lookup"><span data-stu-id="acb3c-181">Model 2</span></span> | <span data-ttu-id="acb3c-182">0.80</span><span class="sxs-lookup"><span data-stu-id="acb3c-182">0.80</span></span>        | <span data-ttu-id="acb3c-183">0.90</span><span class="sxs-lookup"><span data-stu-id="acb3c-183">0.90</span></span>   | <span data-ttu-id="acb3c-184">0.83</span><span class="sxs-lookup"><span data-stu-id="acb3c-184">0.83</span></span>           | <span data-ttu-id="acb3c-185">Нет.</span><span class="sxs-lookup"><span data-stu-id="acb3c-185">No.</span></span> <span data-ttu-id="acb3c-186">Необходимо улучшить.</span><span class="sxs-lookup"><span data-stu-id="acb3c-186">Improvement is required.</span></span>                              |

## <a name="classification-f1-accuracy"></a><span data-ttu-id="acb3c-187">Точность F1классификации</span><span class="sxs-lookup"><span data-stu-id="acb3c-187">Classification F1 accuracy</span></span>

<span data-ttu-id="acb3c-188">Последнее рассмотрение этой темы — это более сложная мера производительности ML-процесса классификации, которая называется точностью F1.</span><span class="sxs-lookup"><span data-stu-id="acb3c-188">The final consideration in this topic is a more advanced measure of classification ML performance that is known as F1 accuracy.</span></span>

<span data-ttu-id="acb3c-189">Прежде чем можно будет определить точность F1, должны быть введены две дополнительные метрики: точность и отзыв.</span><span class="sxs-lookup"><span data-stu-id="acb3c-189">Before F1 accuracy can be defined, two additional metrics must be introduced: precision and recall.</span></span> <span data-ttu-id="acb3c-190">Точность показывает, сколько общего количества прогнозов, указанных как положительные, правильно назначено.</span><span class="sxs-lookup"><span data-stu-id="acb3c-190">Precision indicates how many of the total number of predictions that are specified as positive are correctly assigned.</span></span> <span data-ttu-id="acb3c-191">Эта метрика также называется положительным прогнозируемым значением.</span><span class="sxs-lookup"><span data-stu-id="acb3c-191">This metric is also known as the positive predictive value.</span></span> <span data-ttu-id="acb3c-192">Отзыв — это общее число фактических положительных случаев, которые были спрогнозированы правильно.</span><span class="sxs-lookup"><span data-stu-id="acb3c-192">Recall is the total number of the actual positive cases that were predicted correctly.</span></span> <span data-ttu-id="acb3c-193">Эта метрика также известна как чувствительность.</span><span class="sxs-lookup"><span data-stu-id="acb3c-193">This metric is also known as sensitivity.</span></span>

<span data-ttu-id="acb3c-194">[![Истинные результаты и ложные результаты](./media/tn-fn.png)](./media/tn-fn.png)</span><span class="sxs-lookup"><span data-stu-id="acb3c-194">[![True results vs. false results](./media/tn-fn.png)](./media/tn-fn.png)</span></span>

<span data-ttu-id="acb3c-195">В матрице ошибок на предыдущем рисунке эти показатели рассчитываются следующим образом:</span><span class="sxs-lookup"><span data-stu-id="acb3c-195">In the confusion matrix in the preceding illustration, these metrics are calculated in the following way:</span></span>

- <span data-ttu-id="acb3c-196">Точность = TP ÷ (TP + FP)</span><span class="sxs-lookup"><span data-stu-id="acb3c-196">Precision = TP ÷ (TP + FP)</span></span>
- <span data-ttu-id="acb3c-197">Отзыв = TP ÷ (TP + FN)</span><span class="sxs-lookup"><span data-stu-id="acb3c-197">Recall = TP ÷ (TP + FN)</span></span>

<span data-ttu-id="acb3c-198">Мера F1 сочетает точность и отзыв.</span><span class="sxs-lookup"><span data-stu-id="acb3c-198">The F1 measure combines precision and recall.</span></span> <span data-ttu-id="acb3c-199">Результатом является среднее гармоническое двух значений.</span><span class="sxs-lookup"><span data-stu-id="acb3c-199">The result is the harmonic mean of the two values.</span></span> <span data-ttu-id="acb3c-200">Она вычисляется следующим образом:</span><span class="sxs-lookup"><span data-stu-id="acb3c-200">It's calculated in the following way:</span></span>

- <span data-ttu-id="acb3c-201">F1 = 2 × (Точность × Отзыв) ÷ (Точность + Отзыв)</span><span class="sxs-lookup"><span data-stu-id="acb3c-201">F1 = 2 × (Precision × Recall) ÷ (Precision + Recall)</span></span>

<span data-ttu-id="acb3c-202">Рассмотрим конкретный пример.</span><span class="sxs-lookup"><span data-stu-id="acb3c-202">Let's look at a concrete example.</span></span> <span data-ttu-id="acb3c-203">Ранее в этой теме был показан пример модели, которая прогнозирует, было ли животное собакой или кошкой.</span><span class="sxs-lookup"><span data-stu-id="acb3c-203">Earlier in this topic, there was an example of a model that predicted whether an animal was a dog or a cat.</span></span> <span data-ttu-id="acb3c-204">Здесь повторяется это изображение.</span><span class="sxs-lookup"><span data-stu-id="acb3c-204">The illustration is repeated here.</span></span>

<span data-ttu-id="acb3c-205">[![Пример предсказания вида (повторный)](./media/species-prediction-matrix.png)](./media/species-prediction-matrix.png)</span><span class="sxs-lookup"><span data-stu-id="acb3c-205">[![Species prediction example (repeated)](./media/species-prediction-matrix.png)](./media/species-prediction-matrix.png)</span></span>

<span data-ttu-id="acb3c-206">Здесь приведены результаты, если "Собака" используется как положительный ответ.</span><span class="sxs-lookup"><span data-stu-id="acb3c-206">Here are the results if "Dog" is used as the positive answer.</span></span>

- <span data-ttu-id="acb3c-207">Точность = 24 ÷ (24 + 2) = 0,9231</span><span class="sxs-lookup"><span data-stu-id="acb3c-207">Precision = 24 ÷ (24 + 2) = 0.9231</span></span>
- <span data-ttu-id="acb3c-208">Отзыв = 24 ÷ (24 + 6) = 0,8</span><span class="sxs-lookup"><span data-stu-id="acb3c-208">Recall = 24 ÷ (24 + 6) = 0.8</span></span>
- <span data-ttu-id="acb3c-209">F1 = 2 × (0,9231 × 0,8) ÷ (0,9231 + 0,8) = 0,8572</span><span class="sxs-lookup"><span data-stu-id="acb3c-209">F1 = 2 × (0.9231 × 0.8) ÷ (0.9231 + 0.8) = 0.8572</span></span>

<span data-ttu-id="acb3c-210">Как можно видеть, значение F1 находится между значениями точности и отзыва.</span><span class="sxs-lookup"><span data-stu-id="acb3c-210">As you can see, the F1 value is between the values for precision and recall.</span></span>

<span data-ttu-id="acb3c-211">Хотя точность F1 не так проста в понимании, она добавляет нюансы к базовому числу точности.</span><span class="sxs-lookup"><span data-stu-id="acb3c-211">Although F1 accuracy isn't as easy to understand, it adds nuance to the basic accuracy number.</span></span> <span data-ttu-id="acb3c-212">Она также может помочь в несбалансированном наборе данных, так как будет показано в следующем обсуждении.</span><span class="sxs-lookup"><span data-stu-id="acb3c-212">It can also help with unbalanced datasets, as the following discussion will show.</span></span>

<span data-ttu-id="acb3c-213">Раздел [Точность модели](#model-accuracy) данной темы сравнивает следующие две матрицы ошибок.</span><span class="sxs-lookup"><span data-stu-id="acb3c-213">The [Model accuracy](#model-accuracy) section of this topic compared the following two confusion matrices.</span></span> <span data-ttu-id="acb3c-214">Даже несмотря на то, что первая модель имела меньшую точность, она была признана более полезной моделью, поскольку она показала более значительное улучшение по сравнению с предположением по умолчанию для времени оплаты.</span><span class="sxs-lookup"><span data-stu-id="acb3c-214">Even though the first model had lower accuracy, it was deemed a more useful model because it showed more improvement than the default guess of an on-time payment.</span></span>

![Пример прогнозирования платежей и фактических данных](media/payment-prediction-matrix.png)

![Пример прогноза платежей с большим образцом (повторный)](media/payment-prediction-matrix-2.png)

<span data-ttu-id="acb3c-217">Давайте посмотрим, как эти две модели сравниваются при использовании оценки F1.</span><span class="sxs-lookup"><span data-stu-id="acb3c-217">Let's see how these two models compare when the F1 score is used.</span></span> <span data-ttu-id="acb3c-218">Оценка F1 учитывает точность и отзыв для каждого состояния, а вычисление макроса F1 затем усредняет оценку F1 по всем состояниям для определения общего показателя F1.</span><span class="sxs-lookup"><span data-stu-id="acb3c-218">The F1 score factors in precision and recall for each state, and the F1 macro calculation then averages the F1 score across the states to determine an overall F1 score.</span></span> <span data-ttu-id="acb3c-219">Имеются другие варианты F1, но очень важно рассмотреть версию макроса с учетом того, что все три состояния учитываются одинаково.</span><span class="sxs-lookup"><span data-stu-id="acb3c-219">There are other F1 variants, but it's of greater interest to consider the macro version, given the equal consideration that is given to all three states.</span></span>

<span data-ttu-id="acb3c-220">Для упрощения вычислений образцы массивов создавались в соответствии с фактическими и прогнозируемыми значениями.</span><span class="sxs-lookup"><span data-stu-id="acb3c-220">To simplify the calculations, sample arrays were built to match the actual and predicted values.</span></span> <span data-ttu-id="acb3c-221">Эти массивы использовали библиотеку показателей sklearn в Python для расчета значений.</span><span class="sxs-lookup"><span data-stu-id="acb3c-221">These arrays used sklearn's metrics library in Python to calculate the values.</span></span> <span data-ttu-id="acb3c-222">Вот результат.</span><span class="sxs-lookup"><span data-stu-id="acb3c-222">Here is the result.</span></span>

| <span data-ttu-id="acb3c-223">Модель</span><span class="sxs-lookup"><span data-stu-id="acb3c-223">Model</span></span>   | <span data-ttu-id="acb3c-224">Наивное предположение</span><span class="sxs-lookup"><span data-stu-id="acb3c-224">Naive guess</span></span> | <span data-ttu-id="acb3c-225">Точность</span><span class="sxs-lookup"><span data-stu-id="acb3c-225">Accuracy</span></span> | <span data-ttu-id="acb3c-226">Макрос F1</span><span class="sxs-lookup"><span data-stu-id="acb3c-226">F1 macro</span></span> |
|---------|-------------|----------|----------|
| <span data-ttu-id="acb3c-227">Модель 1</span><span class="sxs-lookup"><span data-stu-id="acb3c-227">Model 1</span></span> | <span data-ttu-id="acb3c-228">0.5</span><span class="sxs-lookup"><span data-stu-id="acb3c-228">0.5</span></span>         | <span data-ttu-id="acb3c-229">0.73</span><span class="sxs-lookup"><span data-stu-id="acb3c-229">0.73</span></span>     | <span data-ttu-id="acb3c-230">0.67</span><span class="sxs-lookup"><span data-stu-id="acb3c-230">0.67</span></span>     |
| <span data-ttu-id="acb3c-231">Модель 2</span><span class="sxs-lookup"><span data-stu-id="acb3c-231">Model 2</span></span> | <span data-ttu-id="acb3c-232">0.80</span><span class="sxs-lookup"><span data-stu-id="acb3c-232">0.80</span></span>        | <span data-ttu-id="acb3c-233">0.83</span><span class="sxs-lookup"><span data-stu-id="acb3c-233">0.83</span></span>     | <span data-ttu-id="acb3c-234">0.66</span><span class="sxs-lookup"><span data-stu-id="acb3c-234">0.66</span></span>     |

<span data-ttu-id="acb3c-235">Для получения более подробной информации о том, как выполняется этот расчет, здесь приведен отчет о классификации sklearn.metrics для модели 1.</span><span class="sxs-lookup"><span data-stu-id="acb3c-235">For more detail about how this calculation works, here is the sklearn.metrics classification report for model 1.</span></span> <span data-ttu-id="acb3c-236">Три состояния, "Вовремя", "Поздно" и "Очень поздно", представлены строками, которые имеют метку 1, 2 и 3 соответственно.</span><span class="sxs-lookup"><span data-stu-id="acb3c-236">The three states, "On time," "Late," and "Very late," are represented by the rows that are labeled 1, 2, and 3, respectively.</span></span> <span data-ttu-id="acb3c-237">Среднее макроса — это просто среднее значение столбца "оценка-f1".</span><span class="sxs-lookup"><span data-stu-id="acb3c-237">The macro average is just the average of the "f1-score" column.</span></span>

| &nbsp;    | <span data-ttu-id="acb3c-238">точность</span><span class="sxs-lookup"><span data-stu-id="acb3c-238">precision</span></span> | <span data-ttu-id="acb3c-239">отзыв</span><span class="sxs-lookup"><span data-stu-id="acb3c-239">recall</span></span>   | <span data-ttu-id="acb3c-240">оценка-f1</span><span class="sxs-lookup"><span data-stu-id="acb3c-240">f1-score</span></span> |
|-----------|-----------|----------|----------|
| <span data-ttu-id="acb3c-241">**1**</span><span class="sxs-lookup"><span data-stu-id="acb3c-241">**1**</span></span>     | <span data-ttu-id="acb3c-242">0.83</span><span class="sxs-lookup"><span data-stu-id="acb3c-242">0.83</span></span>      | <span data-ttu-id="acb3c-243">0.80</span><span class="sxs-lookup"><span data-stu-id="acb3c-243">0.80</span></span>     | <span data-ttu-id="acb3c-244">0.82</span><span class="sxs-lookup"><span data-stu-id="acb3c-244">0.82</span></span>     |
| <span data-ttu-id="acb3c-245">**2**</span><span class="sxs-lookup"><span data-stu-id="acb3c-245">**2**</span></span>     | <span data-ttu-id="acb3c-246">0.68</span><span class="sxs-lookup"><span data-stu-id="acb3c-246">0.68</span></span>      | <span data-ttu-id="acb3c-247">0.71</span><span class="sxs-lookup"><span data-stu-id="acb3c-247">0.71</span></span>     | <span data-ttu-id="acb3c-248">0.69</span><span class="sxs-lookup"><span data-stu-id="acb3c-248">0.69</span></span>     |
| <span data-ttu-id="acb3c-249">**3**</span><span class="sxs-lookup"><span data-stu-id="acb3c-249">**3**</span></span>     | <span data-ttu-id="acb3c-250">0.50</span><span class="sxs-lookup"><span data-stu-id="acb3c-250">0.50</span></span>      | <span data-ttu-id="acb3c-251">0.50</span><span class="sxs-lookup"><span data-stu-id="acb3c-251">0.50</span></span>     | <span data-ttu-id="acb3c-252">0.50</span><span class="sxs-lookup"><span data-stu-id="acb3c-252">0.50</span></span>     |

<span data-ttu-id="acb3c-253">Как показывают эти результаты, две модели имеют почти одинаковые результаты точности макросов F1.</span><span class="sxs-lookup"><span data-stu-id="acb3c-253">As these results show, the two models have nearly identical F1 macro accuracy scores.</span></span> <span data-ttu-id="acb3c-254">В этом и многих других случаях точность F1 обеспечивает лучший индикатор возможности модели.</span><span class="sxs-lookup"><span data-stu-id="acb3c-254">In this and many other cases, F1 accuracy provides a better indicator of a model's capability.</span></span> <span data-ttu-id="acb3c-255">Для точности, интерпретация результатов требует понимания того, что наиболее важно для учета в модели.</span><span class="sxs-lookup"><span data-stu-id="acb3c-255">As for accuracy, interpretation of the results requires that you understand what is most important to consider in the model.</span></span>

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
