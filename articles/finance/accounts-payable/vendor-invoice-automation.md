---
title: Автоматизация накладных для отсканированных документов
description: В этой статье поясняются функции, предусмотренные для сквозной автоматизации обработки накладных поставщиков, в том числе накладных, которые включают вложения.
author: abruer
ms.date: 03/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: VendEditInvoiceHeaderStagingListPage
audience: Application User
ms.reviewer: twheeloc
ms.search.region: Global
ms.author: shpandey
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 0449a13989bad45cf0456a2678e5724036d2af3d
ms.sourcegitcommit: 28a726b3b0726ecac7620b5736f5457bc75a5f84
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2022
ms.locfileid: "9070705"
---
# <a name="invoice-automation-for-scanned-documents"></a>Автоматизация накладных для отсканированных документов

[!include [banner](../includes/banner.md)]

В этой статье описаны информационные объекты, предусмотренные для сквозной автоматизации обработки накладных поставщиков, включая накладные с вложениями.

Организации, желающие рационализировать свои процессы расчетов с поставщиками, часто называют обработку накладных в качестве одного из основных процессов, эффективность которых требуется повысить. Во многих случаях такие организации передают обработку бумажных счетов стороннему поставщику услуг оптического распознавания текста (OCR). Обратно они получают машинночитаемые метаданные накладных вместе с отсканированным изображением каждой накладной. Для облегчения автоматизации затем разрабатывается решение "последней мили", обеспечивающее потребление этих артефактов в системе обработки накладных. Теперь такая автоматизация "последней мили" предусмотрена в стандартной конфигурации в виде решения автоматизации обработки накладных.

## <a name="solution-context"></a>Контекст решения

Решение автоматизации обработки накладных позволяет получить стандартный интерфейс, способный получать метаданные накладных для заголовка накладной и строк накладной, а также вложения, которые применимы к накладной. Любая внешняя система, способная генерировать совместимые с этим интерфейсом артефакты, сможет отправлять поток данных для автоматической обработки накладных и вложений.

На следующем рисунке показана пример сценария интеграции, где компания Contoso привлекла поставщика услуг OCR для обработки накладных поставщиков. Поставщики Contoso отправляют накладные поставщику услуг по электронной почте. Посредством распознавания текста поставщик услуг генерирует метаданные накладных (заголовок и/или строки) и отсканированное изображение накладной. Уровень интеграции затем преобразует эти артефакты так, что их можно было потреблять.

![Пример сценария интеграции.](media/vendor_invoice_automation_01.png)

Возможно несколько вариаций описанного выше сценария, если требуется интеграция накладных. Еще одна ситуация, в которой можно использовать этот интерфейс для создания накладных и вложений, — это миграция данных.

### <a name="solution-components"></a>Компоненты решения

В объем решения входят следующие компоненты:

+ Информационные объекты для заголовка накладной, строк накладной и вложений накладной
+ Обработка исключений для накладных
+ Средство параллельного просмотра вложений в накладных

В остальной части этой статьи приводятся подробные описания этих компонентов решения.

## <a name="data-entities"></a>Информационные объекты

Информационный пакет — это единица работы, которая должна быть отправлена, чтобы можно было создать заголовки накладных, строки накладных и вложения накладных. Для артефактов, из которых состоит информационный пакет, используются следующие информационные объекты:

+ Заголовок накладной поставщика
+ Строка накладной поставщика
+ Вложение документа накладной поставщика

Вложение документа накладной поставщика — это новый информационный объект, появившийся вместе с этой функциональностью. Объект "Заголовок накладной поставщика" модифицирован так, что теперь он поддерживает вложения. В объект "Строка накладной поставщика" никакие изменения для этой функциональности не вносились.

Дополнительные сведения о пакетах данных см. в разделе [Обзор управления данными](../../fin-ops-core/dev-itpro/data-entities/data-entities-data-packages.md). Сведения о создании пакетов данных с помощью рабочей области управления данными см. в разделе [Обработка и потребление пакетов данных в решении "Приложения для управления финансами и операциями Dynamics 365"](../../fin-ops-core/dev-itpro/lcs-solutions/process-data-packages-lcs-solutions.md).

Чтобы быстро создать тестовые данные, включающие накладные и вложения, выполните следующие действия.

1. Выполните вход в свой экземпляр.
1. Выберите **Расчеты с поставщиками** > **Накладные** > **Накладные поставщиков, ожидающие обработки**.
1. Создайте накладные, имеющие строки и вложения.

    > [!NOTE]
    > Вложения должны представлять собой вложения заголовков. В настоящее время объект "Вложение документа накладной поставщика" не поддерживает вложения строк.

1. Откройте рабочую область **Управление данными**.
1. Создайте задание экспорта, которое включает в себя информационные объекты "Заголовок накладной поставщика", "Строка накладной поставщика" и "Вложение документа накладной поставщика".
1. Экспортируйте данные.
1. Загрузите экспортированные данные в виде пакета. После этого пакет можно использовать для импорта данных в целевые экземпляры для тестирования.

### <a name="determining-the-legal-entity-for-an-invoice"></a>Определение юридического лица для накладной

Накладные, импортированные через информационные пакеты, можно связать с юридическим лицом, к которому они относятся, двумя способами:

+ Задание импорта, которое обрабатывает накладную, импортирует его в ту же компанию, в которой задание было запланировано в рабочей области **управление данными**. Иными словами, компания задания определяет компанию, к которой относится накладная.
+ При отправке содержащего накладные информационного пакета в Finance вызывающий объект (т. е. приложение интеграции, работающее за пределами Finance) может явным образом упомянуть код компании в HTTP-запросе. В этом случае контекст компании, в котором задание обработки выполняется в Finance, переопределяется, и накладные импортируются в компанию, переданную через HTTP-запрос.

> [!NOTE]
> Такое поведение представляет собой стандартное поведение управления данными. Здесь, в контексте накладных, оно поясняется исключительно ради полноты сведений.

## <a name="exception-processing"></a>Обработка исключений

В сценариях, где накладные поставщиков поступают в приложения для управления финансами и операциями через интеграцию, необходимо дать специалисту по расчетам с поставщиками возможность легко обрабатывать исключения или нераспознанные накладные, а также создавать ожидающие обработки накладные из нераспознанных накладных. Теперь механизм такой обработки накладных поставщиков входит в состав приложений для управления финансами и операциями.

### <a name="vendor-invoices-that-failed-to-import-list-page"></a>Накладные поставщика, для которых не удалось импортировать страницу списка

Новую страницу списка для накладных-исключений можно открыть, выбрав **Расчеты с поставщиками** > **Накладные** > **Ошибки импорта** > **Накладные поставщиков, которые не удалось импортировать**. На этой странице отображаются все записи заголовков накладных поставщиков из промежуточной таблицы информационного объекта "Заголовок накладной поставщика". Обратите внимание, что можно просмотреть те же записи из рабочей области **Управление данными**. Можно выполнить те же действия, что и в механизме обработки исключений, из рабочей области **Управление данными**. Функция обработки исключений оптимизирована для функционального пользователя, что упрощает ее использование.

![Страница списка исключений.](media/vendor_invoice_automation_02.png)

На этой странице списка находятся следующие поля, поступающие через поток данных:

+ **Компания** — компания, к которой относится накладная
+ **Сообщение об ошибке** — сообщение об ошибке, выданное структурой управления данными для объяснения причины, по которой не удалось создать накладную
+ **Номер** — номер накладной
+ **Счет накладной**
+ **Имя** — наименование поставщика
+ **Счет поставщика**
+ **Заказ на покупку** — номер заказа на покупку, соответствующего накладной
+ **Дата разноски**
+ **Дата накладной**
+ **Описание накладной**
+ **Валюта**
+ **Журнал**
+ **Ссылка на строку** — идентификатор, который поступает из внешней системы

    > [!NOTE]
    > Ссылка на строку — это не идентификатор накладной.

На этой странице списка также есть область предварительного просмотра, которую можно использовать следующим образом:

+ Для просмотра всего сообщения об ошибке, не увеличивая ширину столбца **Сообщение об ошибке** в таблице.

Страница списка поддерживает следующие действия:

+ **Редактирование** — открытие записи исключения в режиме редактирования для устранения проблем.
+ **Параметры** — доступ к стандартным параметрам, предусмотренным на страницах списков. Можно использовать параметр **Добавить в рабочую область** для закрепления страницы со списком исключений в рабочей области в качества списка или плитки.

### <a name="vendor-invoices-that-failed-to-import-details-page"></a>Накладные поставщика, для которых не удалось импортировать страницу сведений

При запуске режима редактирования открывается страница **Накладные поставщика, для которых не удалось импортировать страницу сведений** для накладной, для которой имеются проблемы. При наличии проблем с накладной, имеющей вложение, вложение не отображается. Вложение должно быть повторно присоединено к накладной.

Страница **Накладные поставщика, для которых не удалось импортировать сведения** позволяет создать ожидающую накладную. После устранения проблем в накладной в рамках обработки исключения выберите кнопку **Создать ожидающую накладную**, чтобы создать накладную, ожидающую обработки. В фоновом режиме будет создана ожидающая накладная. 

### <a name="shared-service-vs-organization-based-exception-processing"></a>Обработка исключений силами общих служб и отдельных организаций

Страница списка исключений поддерживает стандартные структуры безопасности, поддерживаемые рабочей областью **Управление данными** применительно к обработке промежуточных записей. Обеспечить безопасность задания импорта накладных можно следующими способами:

+ По роли пользователя
+ По пользователю
+ По юридическому лицу

![Задание импорта, безопасность которого обеспечена по роли пользователя и юридическому лицу.](media/vendor_invoice_automation_04.png)

Если для задания импорта накладных настроены параметры безопасности, на странице списка накладных учитываются эти параметры. Пользователи будут видеть только те записи накладных-исключений, которые такая настройка разрешает им видеть.

Например, компания Contoso приняла решение обрабатывать накладные-исключения по юридическому лицу. Соответственно, параметры безопасности в отношении задания импорта накладных настроены так, что пользователь в юридическом лице А может видеть только накладные-исключения в юридическом лице А, тогда как пользователь в юридическом лице Б может видеть только накладные-исключения в юридическом лице Б. Такая настройка обеспечивает разделение обязанностей по обработке накладных-исключений.

Contoso также может принять решение не накладывать никаких ограничений, чтобы одни и те же пользователи могли обрабатывать накладные-исключения для всех юридических лиц. Такая настройка позволяет реализовать сценарий общих служб для управления накладными-исключениями.

## <a name="side-by-side-attachment-viewer"></a>Средство параллельного просмотра вложений

Для удобства просмотра вложений в накладных поставщиков на следующих страницах, используемых в процессе обработки накладных, теперь предусмотрено средство просмотра вложений:

+ **Обработка исключений**
+ Страница **Накладные поставщиков, ожидающие обработки** (также доступна в процессе просмотра накладных)
+ Страница запроса **Журнал накладных** (для разнесенных накладных)

Основные функциональные возможности средства просмотра вложений следующие:

+ Просмотр всех типов вложений, поддерживаемых управлением документами (файлов, изображений, URL-адресов и заметок).
+ Просмотр многостраничных файлов TIFF.
+ Выполнение следующих действий над файлами изображений:
  + Выделение частей изображений.
  + Блокирование частей изображений.
  + Добавление заметок на изображение.
  + Увеличение и уменьшение масштаба изображения.
  + Панорамирование изображения.
  + Отмена и повтор действий.
  + Подгонка изображения по размеру.

> [!NOTE]
> Эти действия доступны только для файлов изображений (JPEG, TIFF, PNG и т. д.). Все изменения, вносимые в изображение с помощью этих действий, сохраняются в файле изображения. В настоящее время в средстве просмотра вложений не предусмотрены возможности управления версиями или аудита.

### <a name="default-attachment"></a>Вложение по умолчанию

Если в накладной поставщика несколько вложений, можно установить один из документов в качестве вложения по умолчанию на странице **Вложения**. Параметр **Является вложением по умолчанию** — это новый параметр, добавленный в связи со средством просмотра вложений. Этот параметр также предоставляется в информационном объекте "Вложение документа накладной поставщика". Следовательно, вложение по умолчанию может задаваться посредством интеграций.

Установить в качестве вложения по умолчанию можно только один документ. После установки документа в качестве вложения по умолчанию он автоматически отображается в средстве просмотра вложений при открытии накладной. Если не установить никакой документ в качестве вложения по умолчанию, при открытии накладной вложение в средстве просмотра автоматически отображаться не будет.

### <a name="showhide-invoice-attachments"></a>Отображение/скрытие вложений накладной

На страницах запроса **Обработка исключений**, **Ожидающая накладная** и **Журнал накладных** предусмотрена новая кнопка, которая позволяет отобразить или скрыть средство просмотра вложений.

## <a name="security"></a>Контроль доступа

Следующими действиями в средстве просмотра вложений можно управлять посредством безопасности на основе ролей:

+ Выделение
+ Заблокировать
+ Добавление заметок

### <a name="pending-vendor-invoices-page"></a>Страница "Накладные поставщиков, ожидающие обработки"

Следующие привилегии обеспечивают доступ только на чтение или на чтение/запись к средству просмотра вложений для действий выделения, блокирования и добавления заметок:

+ **Ведение изображения накладной поставщика** — эта привилегия обеспечивает доступ на чтение/запись.
+ **Просмотр изображения накладной поставщика** — эта привилегия обеспечивает доступ только на чтение.

Следующие обязанности обеспечивают доступ только на чтение или на чтение/запись к средству просмотра вложений для этих действий:

+ **Ведение накладных поставщиков** — этой обязанности назначена привилегия "Ведение изображения накладной поставщика".
+ **Запрос статуса накладных поставщика** — этой обязанности назначена привилегия "Просмотр изображения накладной поставщика".

Следующие роли обеспечивают доступ только на чтение или на чтение/запись к средству просмотра вложений для этих действий:

+ **Сотрудник отдела расчетов с поставщиками** и **Менеджер по расчету с поставщиками** — этим ролям назначена обязанность "Ведение накладных поставщиков".
+ **Сотрудник отдела расчетов с поставщиками**, **Менеджер по расчету с поставщиками**, **Сотрудник, обрабатывающий централизованные платежи по расчетам с поставщиками** и **Сотрудник, обрабатывающий платежи по расчетам с поставщиками** — этим ролям назначена обязанность "Запрос статуса накладных поставщика".

### <a name="vendor-invoice-attachment"></a>Вложение накладной поставщика

Следующие привилегии обеспечивают доступ только на чтение или на чтение/запись к средству просмотра вложений для действий выделения, блокирования и добавления заметок.

> [!NOTE]
> В стандартной конфигурации роли, упомянутые в этой теме, обеспечивают доступ только на чтение к изображениям накладных в средстве просмотра вложений. Если роль также должна иметь доступ на запись к изображению, можно предоставить этой роли доступ на запись, используя описанную здесь привилегию и обязанность.

+ **Ведение изображения объекта заголовка накладной поставщика** — эта привилегия обеспечивает доступ на чтение/запись к изображениям накладных в средстве просмотра вложений.
+ **Просмотр изображения объекта заголовка накладной поставщика** — эта привилегия обеспечивает доступ только на чтение к изображению накладной в средстве просмотра вложений.

Следующие обязанности обеспечивают доступ только на чтение к средству просмотра вложений для этих действий:

+ **Ведение накладных поставщиков** — этой обязанности назначена привилегия "Ведение изображения объекта заголовка накладной поставщика".

Следующие роли обеспечивают доступ только на чтение к средству просмотра вложений для этих действий:

+ **Сотрудник отдела расчетов с поставщиками** и **Менеджер по расчету с поставщиками** — этим ролям назначена обязанность "Ведение накладных поставщиков".

По умолчанию, если роль пользователя предусматривает права на изменение на какой-либо странице, у пользователя также будут права на изменение в средстве просмотра вложений (действия выделения, блокирования и добавления заметок). Однако если существуют сценарии, когда у конкретной роли должны быть права на изменение в отношении страницы, но не в отношении средства просмотра вложений, для реализации таких сценариев можно использовать соответствующие привилегии из приведенного выше списка.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]

