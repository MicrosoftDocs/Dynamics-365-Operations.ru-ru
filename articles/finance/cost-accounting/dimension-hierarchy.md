---
title: Иерархия аналитик
description: В этом разделе представлены сведения об иерархиях аналитик. Иерархии аналитик используются для определения структуры отчетов, политик затрат и настройки безопасности в учете затрат.
author: AndersGirke
manager: AnnBe
ms.date: 06/16/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: CAMDimensionHierarchy,
audience: Application User
ms.reviewer: roschlom
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: Manufacturing
ms.author: roschlom
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 7fde19ad1a58616672de72fb5e5cbeea39138b46
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "4995198"
---
# <a name="dimension-hierarchy"></a>Иерархия аналитик

[!include [banner](../includes/banner.md)]

В этом разделе представлены сведения об иерархиях аналитик. Иерархии аналитик используются для определения структуры отчетов, политик затрат и настройки безопасности в учете затрат.  

## <a name="overview"></a>Обзор

Иерархии аналитик используются в различных местах в учете затрат. Иерархия измерения позволяет определить следующую информацию:

-  Структура отчетности, подходящая под требования организации
-  Политики затрат
-  Настройка безопасности

Ниже приведен пример иерархии аналитик.

![Пример иерархии аналитик](./media/dimension-hierarchy.png)

Иерархии аналитик могут создаваться для следующих типов аналитик:

-  Аналитики элемента затрат
-  Аналитики объекта затрат
-  Статистические аналитики

> [!NOTE]
> - Можно создать несколько иерархий аналитик для одной аналитики, если требуются разные перспективы.
> - Иерархию аналитики можно связать только с одной аналитикой.
> - Иерархия аналитики может иметь неограниченное число уровней в своей структуре. Все уровни будут доступны в рабочей области **Управление затратами**. При использовании Microsoft Excel или Microsoft Power BI для целей отчетности экспортируются только первые 15 уровней иерархии аналитики. Это ограничение существует, так как Excel и Power BI требуют фиксированной схемы.
> - Иерархия аналитик чувствительна к дате. Таким образом, любое изменение иерархии аналитик немедленно сохраняется в записи, и невозможно сравнить дату до и дату после.

## <a name="dimension-hierarchy-type"></a>Тип иерархии аналитик

При создании новой иерархии аналитик следует выбрать тип иерархии. Последовательно выберите **Учет затрат** > **Аналитики** > **Иерархии аналитик**. Щелкните **Создать** и выберите тип иерархии аналитик. Можно выбрать **Иерархия категоризации аналитик** или **Иерархия классификации аналитик**.

### <a name="dimension-categorization-hierarchy"></a>Иерархия категоризации аналитик

Тип **Иерархия категоризации аналитик** используется для целей отчетности. Он поддерживает только аналитики элементов затрат. При выборе этого типа применяются следующие правила:

-  Элемент аналитики может быть связан несколько раз в структуре иерархии.
-  Можно поместить элемент аналитики элемента затрат в различных узлах, назначая поведение затрат для листового узла.

### <a name="dimension-classification-hierarchy"></a>Иерархия классификации аналитик

Тип **Иерархия классификации аналитик** используется для определения правил и целей отчетности. Он поддерживает все аналитики, например объекты затрат, элементы затрат и статистические аналитики. При выборе этого типа элемент аналитики может быть связан только один раз в структуре иерархии.

## <a name="create-and-maintain-a-dimension-hierarchy"></a>Создание и поддержание иерархии аналитик

Иерархии аналитик создаются как древовидная структура с узлом и связями листового узла.

-  У узла может быть 1:_n_ дочерних узлов.
-  Узлу не могут быть назначены подузлы и листовые узлы.
-  Листовой узел может быть назначен только на нижнем уровне в иерархии.

### <a name="example"></a>Пример

Небольшая компания имеет следующую структуру организации, где финансы и управление персоналом — это подразделения в группе администрирования, сборка и упаковка — подразделения в группе производства.

![Пример структуры организации](./media/dimension-hierarchy-org.png)

Аналитика объекта затрат представляет все места возникновения затрат в рамках организации.

- Аналитика объекта затрат
    - Места возникновения затрат

Аналитика объекта затрат, представляющая все места возникновения затрат, может быть настроена, как показано ниже.

| Места возникновения затрат | описание |
|--------------|-------------|
| CC001        | Отдел кадров          |
| CC002        | Финансы     |
| CC003        | По коду налога         |
| CC007        | AR/AP       |
| CC005        | Сборка    |
| CC006        | Упаковка   |

Аналитика элемента затрат представляет все элементы затрат в рамках организации.

- Аналитика элемента затрат
    - Элементы затрат

Аналитика элемента затрат, представляющая все элементы затрат, может быть настроена, как показано ниже.

| Элементы затрат | описание |
|---------------|-------------|
| 10001         | Электричество |
| 10010         | Уборка    |
| 10011         | Отопление     |
| 40001         | Себестоимость проданных товаров        |

Иерархия аналитики, соответствующая требованиям к отчетности в организации, может настраиваться, как показано ниже.

**Сведения об иерархии аналитик**

| Имя иерархии аналитик | Аналитика    | Имя типа иерархии аналитик      | Иерархия списков доступа |
|--------------------------|--------------|------------------------------------|-----------------------|
| Cтруктурное подразделение             | Места возникновения затрат | Иерархия классификации аналитик | Нет                    |

Иерархию аналитик для отчетности можно настроить, как показано ниже.

|                   | Диапазоны элементов аналитики   |                         |
|-------------------|---------------------------|-------------------------|
| **Узлы**         | **Из элемента аналитики** | **В элемент аналитики** |
| Cтруктурное подразделение      |                           |                         |
| &nbsp;&nbsp;Администрирование         |                           |                         |
|&nbsp;&nbsp;&nbsp;&nbsp;Финансы   | CC002                     | CC003                   |
|                   | CC007                     | CC007                   |
| &nbsp;&nbsp;&nbsp;&nbsp;Отдел кадров        | CC001                     | CC001                   |
| &nbsp;&nbsp;Производство    |                           |                         |
| &nbsp;&nbsp;&nbsp;&nbsp;Упаковка | CC005                     | CC005                   |
| &nbsp;&nbsp;&nbsp;&nbsp;Сборка  | CC006                     | CC006                   |

Иерархия аналитики, соответствующая требованиям к политике, может настраиваться, как показано ниже.

**Сведения об иерархии аналитик**

| Имя иерархии аналитик | Аналитика     | Имя типа иерархии аналитик      |
|--------------------------|---------------|------------------------------------|
| Поведение затрат            | Элементы затрат | Иерархия классификации аналитик |

Иерархию аналитик для политики можно настроить, как показано ниже.

|                   | Диапазоны элементов аналитики   |                         |
|-------------------|---------------------------|-------------------------|
| **Узлы**         | **Из элемента аналитики** | **В элемент аналитики** |
| Поведение затрат     |                           |                         |
| &nbsp;&nbsp;Постоянные затраты    | 10001                     | 10011                   |
|&nbsp;&nbsp;Переменные затраты | 40001                     | 40010                   |

> [!NOTE]
> Под **Диапазоны элементов аналитики** узел может содержать 1:_n_ диапазонов элементов аналитики. Можно вставить коды элементов аналитики, которые еще не существуют в качестве элементов аналитики. Этот способ обеспечивает устойчивость иерархии в будущем.  

### <a name="copy-a-hierarchy"></a>Копирование иерархии

Можно скопировать текущую иерархию аналитик в качестве отправной точки для новой иерархии аналитик. Этот подход может оказаться полезным в том случае, если вы хотите сравнить предыдущую иерархию аналитик с новой иерархией аналитик.

### <a name="rearrange-nodes-in-a-hierarchy"></a>Изменения порядка узлов в иерархии

Можно переместить узел вверх или вниз в пределах его текущего уровня в структуре. Таким образом, можно изменить порядок узлов для отчетности в рабочей области **Управление затратами**.

Переместить узел на новое местоположение в иерархии можно, выбрав целевой узел. Существует два способа перемещения узла:

- **Переместить под** — переместить выбранный узел из текущего положения в иерархии и вставить его **под** выбранным целевым узлом.
- **Переместить после** — переместить выбранный узел из текущего положения в иерархии и вставить его **после** выбранного целевого узла на его уровне иерархии.

> [!NOTE] 
> Порядок узлов не сохраняется при экспорте данных в Excel или Power BI, поскольку эти средства используют алфавитно-цифровой порядок сортировки по умолчанию. Следует вручную изменить порядок.

## <a name="define-dimension-hierarchies-for-reporting"></a>Определение иерархий аналитики для отчетности

Иерархии аналитики важны для отчетности. Они позволяют определить нужную структуру, подходящую для конкретной организации. Агрегирования, которые выполняются на уровне узла иерархии аналитики, позволяют заинтересованным лицам на любом уровне организации видеть данные на любом уровне.

Иерархии аналитик доступны в следующих средствах отчетности. Такой подход гарантирует согласованность в структуре отчетности.

- Рабочая область **Управление затратами** (клиент):

    - Управляется конфигурацией.

- Рабочая область **Управление затратами** (мобильное приложение)

    - Управляется конфигурацией.

- Excel

    - Позволяет выбрать определенные иерархии аналитики для определения экспорта:

        - Она иерархия аналитики элементов затрат (обязательно)
        - Одна иерархия аналитик объектов затрат (необязательно)
        - Одна иерархия статистических аналитик (необязательно)

- Power BI:

    - Доступны все иерархии аналитики.
    
При создании отчетов с помощью Excel или Power BI экспортируются только первые 15 уровней иерархии аналитики. Это ограничение существует, так как Excel и Power BI требуют фиксированной схемы. Если в иерархии более 15 уровней, дополнительные уровни не будут экспортироваться. Нормализованная таблица содержит запись для каждого элемента аналитики в иерархии. Таким образом, возникает автоматическое агрегирование. Это поведение гарантирует, что сальдо на любом из 15 доступных уровней в иерархии будут правильным.

Следующий пример показывает, как может выглядеть иерархия аналитик в структуре отчетности.

| Иерархия аналитик объектов затрат — уровень 1 | Иерархия аналитик объектов затрат — уровень 2 | Иерархия аналитик объектов затрат — уровень 3 | Иерархия аналитик объектов затрат — уровень 4 | Иерархия аналитик объектов затрат — уровень 15 |
|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|--------------------------------------------|
| Cтруктурное подразделение                              | Администрирование                                     | Финансы                                   | CC002                                     |                                            |
| Cтруктурное подразделение                              | Администрирование                                     | Финансы                                   | CC003                                     |                                            |
| Cтруктурное подразделение                              | Администрирование                                     | Финансы                                   | CC007                                     |                                            |
| Cтруктурное подразделение                              | Администрирование                                     | Отдел кадров                                        | CC001                                     |                                            |
| Cтруктурное подразделение                              | Производство                                | Упаковка                                 | CC005                                     |                                            |
| Cтруктурное подразделение                              | Производство                                | Сборка                                  | CC006                                     |                                            |

### <a name="update-the-dimension-hierarchies-that-are-used-for-reporting"></a>Обновление иерархий аналитик, которые используются для отчетности 

Со временем иерархии аналитики, используемые в указанных выше средствах отчетности, потребуют обновления. Иерархии аналитик можно обновить путем обновления клиента.

- Рабочая область **Управление затратами** (клиент)
- Рабочая область **Управление затратами** (мобильное приложение)

Обновления иерархий аналитик комплектуются каждые 24 часа с помощью задания предварительного кэширования. После обновления экспортированных данных обновленные иерархии аналитик доступны в следующих средствах:

- Excel
- Power BI

> [!NOTE] 
> Чтобы выполнить обновление кэша иерархии аналитик вручную, можно создать новый экспорт в Excel для иерархии аналитик или иерархий, которые должны быть обновлены.

## <a name="define-dimension-hierarchies-for-cost-policies"></a>Определение иерархий аналитик для политик затрат

Учет затрат состоит из нескольких политик, где указаны подробные правила. Необходимо определить одну или несколько иерархий для следующих политик:

- Поведение затрат
- Распределение затрат
- Распределение затрат
- Свертка затрат

Иерархии аналитик упрощают создание правил. Чтобы избежать необходимости создавать правила для каждого элемента аналитики, можно воспользоваться преимуществами агрегирования элементов аналитик, которые предоставляются уровнями иерархии аналитик. При наличии нескольких перекрывающихся правил необходимо определить особые правила, которые система будет учитывать при этом расчете накладных расходов.

### <a name="example-define-a-cost-behavior-policy"></a>Пример: определение политики поведения затрат

Создается новая политика поведения затрат, и соответствующие иерархии аналитики назначаются для политики, как показано ниже.

**Политика поведения затрат**

| Имя политики   | Иерархия аналитик элементов затрат | Иерархия аналитик объектов затрат | Валюта учета |
|---------------|----------------------------------|---------------------------------|---------------------|
| Поведение затрат | Поведение затрат                    | Cтруктурное подразделение                    | американский доллар                 |

**Правила**

| Узел иерархии аналитик элементов затрат | Узел иерархии аналитик объектов затрат | Фиксированный процент | Фиксированная сумма | Действительно с | Действительно до |
|---------------------------------------|--------------------------------------|------------------|--------------|------------|----------|
| Постоянные затраты                            | Cтруктурное подразделение                         | 100,00           | 0,00         | 1.1.2017   | Никогда    |
| 10001                                 | Cтруктурное подразделение                         | 0,00             | 150,00       | 1.1.2017   | Никогда    |
| 10001 (\*)                             | Финансы                              |                  | 50,00        | 1.1.2017   | Никогда    |
| Поведение затрат или переменные затраты (\*\*)   | Cтруктурное подразделение                         | 0,00             | 0,00         | 1.1.2017   | Никогда    |

\* Узел переменных затрат не обязателен. Если затраты не классифицируется как фиксированные затраты, они должны быть переменными.

\*\* Подробное правило создается для комбинации элемента затрат 10001 и всех элементов затрат, агрегированных по уровню иерархии "Финансы" (CC002, CC003, CC007).

Предыдущие правила показывают гибкие возможности, которые предоставляют иерархии аналитик. Определяя правила высокого уровня, можно минимизировать обслуживание. Затем можно определить подробные правила для соответствия конкретной бизнес-задаче.

Если иерархии, используемые в правилах, обновляются, система автоматически ставит обновления вперед.

Если уровень детализации в правилах больше не требуется, правило может стать просроченным.

Например, определенное правило поведения затрат для узла иерархии аналитик объекта затрат "Финансы" больше не требуется. В этом случае щелкните **Завершить строк действия правила**.

| Узел иерархии аналитик элементов затрат | Узел иерархии аналитик объектов затрат | Фиксированный процент | Фиксированная сумма | Действительно с | Действительно до  |
|---------------------------------------|--------------------------------------|------------------|--------------|------------|-----------|
| Постоянные затраты                            | Cтруктурное подразделение                         | 100,00           | 0.00         | 1.1.2017   | Никогда     |
| 10001                                 | Cтруктурное подразделение                         | 0.00             | 150,00       | 1.1.2017   | Никогда     |
| 10001                                 | Финансы                              |                  | 50,00        | 1.1.2017   | 20.1.2017 |
| Поведение затрат или переменные затраты        | Cтруктурное подразделение                         | 0.00             | 0.00         | 1.1.2017   | Никогда     |

Любые расчет накладных расходов, который запускается после 20 января 2017 г., не учитывает это правило.

> [!NOTE] 
> Поля **Действительно с** и **Действительно до** чувствительны к дате и времени. Правило можно просрочить и выполнить новый расчет накладных расходов в тот же день.

## <a name="define-dimension-hierarchies-for-security-setup"></a>Определение иерархий аналитик для настройки безопасности

Данные учета затрат должны быть доступны для всех менеджеров, ответственных за единицу отчетности. В терминах учета затрат единица отчетности представляется как объект затрат или группа объектов затрат.

Потенциально, все менеджеры могут получить доступ к весьма важным бизнес-данным, таким как доходы и маржа. Таким образом, важно обеспечить настройку безопасности, чтобы менеджеры могли видеть только данные, относящиеся к ним. Чтобы обеспечить безопасность управления данными, определяются иерархии.

- Использование иерархий аналитик применяется только в том случае, если значение аналитики, выбранное в ссылке иерархии аналитики, является аналитикой объекта затрат.
- Можно включить только одну иерархию аналитики для аналитики объекта затрат в иерархии списков доступа.

**Сведения об иерархии аналитик**

| Имя иерархии аналитик | Аналитика    | Имя типа иерархии аналитик      | Иерархия списков доступа |
|--------------------------|--------------|------------------------------------|-----------------------|
| Cтруктурное подразделение             | Места возникновения затрат | Иерархия классификации аналитик | **Да**               |

Новая экспресс-вкладка **Пользователи** доступна в конструкторе иерархий. Здесь можно добавить один или несколько кодов пользователей в каждый узел в иерархии.

|                 | Пользователи            | Диапазоны элементов аналитики   |                         |
|-----------------|------------------|---------------------------|-------------------------|
| **Узлы**       | **Код пользователя**      | **Из элемента аналитики** | **В элемент аналитики** |
| Cтруктурное подразделение    | Бенджамин, Клер |                           |                         |
| &nbsp;&nbsp;Администрирование         | апреля            |                           |                         |
| &nbsp;&nbsp;&nbsp;&nbsp;Финансы   | Алиша           | CC002                     | CC003                   |
|                 |                  | CC007                     | CC007                   |
| &nbsp;&nbsp;&nbsp;&nbsp;Отдел кадров        | Арни            | CC001                     | CC001                   |
| &nbsp;&nbsp;Производство    | Дэвид            |                           |                         |
| &nbsp;&nbsp;&nbsp;&nbsp;Упаковка | Эллен            | CC005                     | CC005                   |
| &nbsp;&nbsp;&nbsp;&nbsp;Сборка  | Крис            | CC006                     | CC006                   |

> [!NOTE] 
> Бухгалтеры затрат должны быть назначены на верхнем уровне иерархии, чтобы они моги видеть все записи в учете затрат.

Чтобы включить иерархию списков доступа и параметры безопасности, перейдите **Учет затрат** > **Настройка** > **Параметры** > **Общие**. Выберите параметр **Включить доступ на просмотр по элементам аналитик объектов затрат**.

Настройки иерархии списков доступа используются для управления данными, которые отображаются в следующих областях:

- Рабочая область **Управление затратами** (клиент):

    - Данные в формах, которые используются для детализации сценариев

- Рабочая область **Управление затратами** (мобильное приложение)

    - Сальдо в карточках

- Power BI:

    - Данные, показанные в визуализации Power BI
    - Визуализация данных Power BI, которые встроены в клиент Dynamics 365 Finance

> [!NOTE] 
> - Прежде чем иерархия списков доступа может повлиять на данные в Power BI, необходимо подсоединить иерархию списка доступа и безопасность на уровне строк в Power BI. Дополнительные сведения см. в разделе [Настройка защиты пакета содержимого учета затрат](../../dev-itpro/analytics/setup-security-cost-accounting-content-pack.md).
> - Иерархия списков доступа не позволяет защитить экспорт данных в Excel. Таким образом, средства отчетности должны использоваться только бухгалтерами и менеджерами, которые должны иметь полный доступ для просмотра данных.
