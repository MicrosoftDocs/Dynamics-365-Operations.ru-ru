---
title: Настройка процесса расширенного импорта банковских выверок
description: Функция расширенной банковской выверки позволяет импортировать электронные банковские выписки и автоматически выверять их с банковскими проводками в Microsoft Dynamics 365 Finance. В этой статье объясняется, как настроить функцию импорта для банковских выписок.
author: panolte
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: BankStatementFormat
audience: Application User
ms.reviewer: roschlom
ms.custom: 106853
ms.assetid: 45dae275-ea45-4c7e-b38f-89297c7b5352
ms.search.region: Global
ms.author: panolte
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 2ca0001adfb73ab178a50e4346922273f0812c92
ms.sourcegitcommit: 4835acc3edacf8277937723d3f85a7875bd8de83
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2021
ms.locfileid: "5580949"
---
# <a name="set-up-the-advanced-bank-reconciliation-import-process"></a>Настройка процесса расширенного импорта банковских выверок

[!include [banner](../includes/banner.md)]

Функция расширенной банковской выверки позволяет импортировать электронные банковские выписки и автоматически выверять их с банковскими проводками в Dynamics 365 Finance. В этой статье объясняется, как настроить функцию импорта для банковских выписок. 

Настройка импорта банковской выписки зависит от формата электронной банковской выписки. Finance поддерживает три готовых формата банковской выписки: ISO20022, MT940 и BAI2.

## <a name="set-time-zone-preference"></a>Задание предпочтительного часового пояса
При настройке параметров импорта банковских выписок может быть важно учитывать часовой пояс данных даты и времени в файлах банковских выписок, которые будут импортированы. По умолчанию предполагается, что все значения даты и времени уже заданы в формате UTC, поэтому при импорте данных не будет применяться преобразование часового пояса. 

Нет доступного варианта для указания часового пояса, используемого для импорта данных. Этот параметр доступен в поле **Предпочтительный часовой пояс** на каждой странице **Сведения о формате исходных данных** (экспресс-вкладка **Рабочая область управления данными > Настройка источника данных > Выберите формат данных > Язык и стандарты**). Введенный здесь предпочтительный часовой пояс будет применяться ко всем операциям импорта, которые используют этот формат исходных данных. Можно создать столько форматов источника данных, сколько необходимо для импорта данных из нескольких часовых поясов.  

Этот часовой пояс может отличаться от часового пояса пользователя или компании, поэтому необходимо уточнить, какой часовой пояс используется данными даты и времени. При настройке предпочтительного часового пояса рекомендуется учитывать следующие моменты. 

 - Предпочтительный часовой пояс будет применяться ко всем операциям импорта с использованием этого формата исходных данных. Можно создать столько форматов источника данных, сколько необходимо для обработки импорта данных из нескольких часовых поясов. 
 
 - Предпочтительный часовой пояс должно быть локальным часовым поясом данных даты и времени в файле импорта. 
 
 - Часовой пояс для данных даты и времени может отличаться от часового пояса пользователя или компании.
 
 - Пользователи могут настроить собственный часовой пояс, используя **Параметры пользователя**.

Обратите внимание, что перечисленные ниже действия помогут минимизировать возможные потенциальные конфликты даты и времени при импорте банковских выписок. 

 - Не изменяйте предпочтительный часовой пояс для любых банковских счетов, для которых уже были импортированы выписки. Изменение предпочтительного часового пояса может повлиять на порядок новых выписок относительно существующих выписок из-за корректировки часового пояса. 
 
 - Просмотрите все операции импорта, использующие выбранный формат источника данных. Предпочтительный часовой пояс, указанный для формата, будет применяться ко всем проектам импорта, использующим этот формат. Убедитесь, что предпочтительный часовой пояс подходит для всех проектов импорта, использующих этот формат.

## <a name="sample-files"></a>Образцы файлов
Для всех трех форматов вы должны иметь файлы, которые преобразуют электронную банковскую выписку из исходного формата в формат, который можно использовать в Finance. Требуемые исходные файлы находятся в узле **Ресурсы** в обозревателе приложений в Microsoft Visual Studio. После обнаружения файлов скопируйте их в одно известное расположение, чтобы их было легче отправить во время настройки.

| Имя ресурса                                           | Имя файла                            |
|---------------------------------------------------------|--------------------------------------|
| BankStmtImport\_BAI2CSV\_to\_BAI2XML\_xslt              | BAI2CSV-to-BAI2XML.xslt              |
| BankStmtImport\_BAI2XML\_to\_Reconciliation\_xslt       | BAI2XML-to-Reconciliation.xslt       |
| BankStmtImport\_BankReconciliation\_to\_Composite\_xslt | BankReconciliation-to-Composite.xslt |
| BankStmtImport\_ISO20022XML\_to\_Reconciliation\_xslt   | ISO20022XML-to-Reconciliation.xslt   |
| BankStmtImport\_MT940TXT\_to\_MT940XML\_xslt            | MT940TXT-to-MT940XML.xslt            |
| BankStmtImport\_MT940XML\_to\_Reconciliation\_xslt      | MT940XML-to-Reconciliation.xslt      |
| BankStmtImport\_SampleBankCompositeEntity\_xml          | SampleBankCompositeEntity.xml        |

## <a name="examples-of-bank-statement-formats-and-technical-layouts"></a>Примеры форматов банковской выписки и технических макетов
Ниже приводятся примеры определений технических макетов для расширенных файлов импорта банковской выписки и трех связанных примеров файлов банковской выписки: [Примеры файлов импорта](//download.microsoft.com/download/8/e/c/8ec8d2d0-eb8c-41fb-ad8c-f01a4d670a44/Dynamics365FinanceAdvancedBankStatementLayouts.xlsx)  

| Определение технического макета                             | Пример файла банковской выписки          |
|---------------------------------------------------------|--------------------------------------|
| DynamicsAXMT940Layout                                   | [MT940StatementExample](//download.microsoft.com/download/2/d/c/2dcc4e55-ddc8-4a74-b79c-250fae201c3c/mt940StatementExample.txt)                |
| DynamicsAXISO20022Layout                                | [ISO20022StatementExample](https://dmsstager3tx7y9x22.blob.core.windows.net/155d84ed-c250-48f3-b0b1-c5a431e7855b/iso20022-multiplestatements.xml?sv=2019-02-02&sr=b&sig=1bDx0f9SONFouCcwLNPhmFHNdxDOkaibNf5%2Btoj0f0A%3D&se=2021-03-11T01%3A05%3A41Z&sp=r)             |
| DynamicsAXBAI2Layout                                    | [BAI2StatementExample](//download.microsoft.com/download/1/1/6/11693f57-bfc1-4993-a274-5fb978be70fa/BAI2StatementExample.txt)                 |



## <a name="set-up-the-import-of-iso20022-bank-statements"></a>Настройка импорта банковских выписок ISO20022
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок ISO20022 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **ISO20022**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **ISO20022XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!-- For details about the expected format for ISO20022, see [Dynamics AX ISO20022 Layout](./media/dynamicsaxiso20022layout1.xlsx).-->
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
13. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок ISO20022.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **ISO20022**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **ISO20022**.
6.  Установите флажок **XML-файл**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  Выберите в поле **Формат выписки** формат, созданный ранее, например **ISO20022**.

## <a name="set-up-the-import-of-mt940-bank-statements"></a>Настройка импорта банковских выписок MT940
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок MT940 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **MT940**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **MT940TXT-to-MT940XML.xslt**, сохраненный ранее.
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **MT940XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!--- For details about the expected format for MT940, see [Dynamics AX MT940 Layout](./media/dynamicsaxmt940layout1.xlsx)-->
13. Нажмите **Создать**.
14. Для порядкового номера 3 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
15. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок MT940.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **MT940**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **MT940**.
6.  Задайте в поле **Тип файла** значение **TXT**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  При появлении запроса на подтверждение выбора и включение расширенной банковской выверки нажмите кнопку **OK**.
5.  Выберите в поле **Формат выписки** формат, созданный ранее, например **MT940**.

## <a name="set-up-the-import-of-bai2-bank-statements"></a>Настройка импорта банковских выписок BAI2
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок BAI2 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **BAI2**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **BAI2CSV-to-BAI2XML.xslt**, сохраненный ранее.
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **BAI2XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!--- For details about the expected format for BAI2, see [Dynamics AX BAI2 Layout](./media/dynamicsaxbai2layout1.xlsx).-->
13. Нажмите **Создать**.
14. Для порядкового номера 3 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
15. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок BAI2.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **BAI2**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **BAI2**.
6.  Задайте в поле **Тип файла** значение **TXT**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  При появлении запроса на подтверждение выбора и включение расширенной банковской выверки нажмите кнопку **OK**.
5.  Выберите в поле **Формат выписки** формат, созданный ранее, например **BAI2**.

## <a name="test-the-bank-statement-import"></a>Проверка импорта банковской выписки
Последним шагом является проверка импорта банковской выписки.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет, для которого включена расширенная банковская выверка.
3.  На вкладке **Выверять** щелкните **Банковские выписки**.
4.  На странице **Банковская выписка** щелкните **Импортировать выписку**.
5.  В поле **Банковский счет** выберите банковский счет. Сведения в поле **Формат выписки** будут введены автоматически на основании параметров в банковском счете.
6.  Нажмите кнопку **Обзор** и выберите файл электронной банковской выписки.
7.  Щелкните **Загрузить**.
8.  Нажмите кнопку **OК**.

Если импорт прошел успешно, вы получите сообщение о том, что выписка была импортирована. Если импорт завершился ошибкой, в рабочей области **Управление данными** в разделе **Журнал заданий** найти задание. Щелкните **Сведения о выполнении** для задания, чтобы открыть страницу **Сводка по выполнению**, и щелкните **Просмотр журнала выполнения**, чтобы просмотреть ошибки импорта.





[!INCLUDE[footer-include](../../includes/footer-banner.md)]
