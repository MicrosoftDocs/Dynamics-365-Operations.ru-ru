---
title: Создание учетной записи хранилища в Azure и хранилища ключей
description: В этом разделе объясняется, как создать учетную запись хранилища Azure и хранилище ключей.
author: gionoder
manager: AnnBe
ms.date: 09/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: b8e39539f767cc2944a9a7fdda09121921c64763
ms.sourcegitcommit: 025561f6a21fe8705493daa290f3f6bfb9f1b962
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2020
ms.locfileid: "3836026"
---
# <a name="create-an-azure-storage-account-and-a-key-vault"></a><span data-ttu-id="bcd68-103">Создание учетной записи хранилища в Azure и хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="bcd68-103">Create an Azure storage account and a key vault</span></span>

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]


<span data-ttu-id="bcd68-104">Дополнительная служба электронных накладных несет ответственность за хранение всех ваших деловых данных в ресурсах Microsoft Azure, принадлежащих вашей компании.</span><span class="sxs-lookup"><span data-stu-id="bcd68-104">The Electronic invoicing add-on service takes responsibility for storing all your business data in the Microsoft Azure resources that are owned by your company.</span></span> <span data-ttu-id="bcd68-105">Для обеспечения правильной работы службы и того, что все деловые данные, необходимые для дополнения электронных накладных и создаваемые этим дополнением, доступны только для этого дополнения, необходимо создать два основных ресурса Azure:</span><span class="sxs-lookup"><span data-stu-id="bcd68-105">To ensure that the service works correctly, and that all the business data that is needed for and generated by the Electronic invoicing add-on is accessed only by the add-on, you must create two main Azure resources:</span></span>

- <span data-ttu-id="bcd68-106">Учетная запись хранилища Azure (хранилище BLOB-объектов) для хранения электронных накладных</span><span class="sxs-lookup"><span data-stu-id="bcd68-106">An Azure storage account (Blob storage) to store electronic invoices</span></span>
- <span data-ttu-id="bcd68-107">Хранилище ключей Azure для хранения сертификатов и универсального кода ресурса (URI) учетной записи хранилища</span><span class="sxs-lookup"><span data-stu-id="bcd68-107">An Azure key vault to store certificates and the Uniform Resource Identifier (URI) of the storage account</span></span>

> [!NOTE]
> <span data-ttu-id="bcd68-108">Выделенный ресурсы хранилища ключей и хранилища BLOB-объектов клиента должны быть выделены специально для использования с дополнением электронных накладных.</span><span class="sxs-lookup"><span data-stu-id="bcd68-108">A dedicated key vault resource and customer Blob storage must be allocated specifically for use with the Electronic invoicing add-on.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="bcd68-109">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="bcd68-109">Prerequisites</span></span>

<span data-ttu-id="bcd68-110">Перед выполнением шагов из данного раздела необходимо убедиться, что были выполнены следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="bcd68-110">Before you can complete the steps in this topic, you must make sure that the following tasks have been completed:</span></span>

- <span data-ttu-id="bcd68-111">Создайте ресурс хранилища ключей в Azure.</span><span class="sxs-lookup"><span data-stu-id="bcd68-111">Create a key vault resource in Azure.</span></span> <span data-ttu-id="bcd68-112">Дополнительные сведения см. в разделе [Об Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span><span class="sxs-lookup"><span data-stu-id="bcd68-112">For more information, see [About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span></span>
- <span data-ttu-id="bcd68-113">Создайте учетную запись хранилища Azure (хранилище BLOB-объектов).</span><span class="sxs-lookup"><span data-stu-id="bcd68-113">Create an Azure storage account (Blob storage).</span></span> <span data-ttu-id="bcd68-114">Дополнительные сведения см. в разделе [Управление учетной записью хранилища Azure](https://docs.microsoft.com/azure/storage/blobs/).</span><span class="sxs-lookup"><span data-stu-id="bcd68-114">For more information, see [Maintaining Azure Storage Account](https://docs.microsoft.com/azure/storage/blobs/).</span></span>

## <a name="overview"></a><span data-ttu-id="bcd68-115">Обзор</span><span class="sxs-lookup"><span data-stu-id="bcd68-115">Overview</span></span>

<span data-ttu-id="bcd68-116">В этом разделе выполняются два основных шага:</span><span class="sxs-lookup"><span data-stu-id="bcd68-116">In this topic, you will complete two main steps:</span></span>

- <span data-ttu-id="bcd68-117">Настройте учетную запись хранилища Azure, чтобы получить URI учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="bcd68-117">Set up the Azure storage account to get the storage account URI.</span></span>
- <span data-ttu-id="bcd68-118">Настройте хранилище ключей для хранения URI учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="bcd68-118">Set up the key vault to store the storage account URI.</span></span>

## <a name="set-up-the-azure-storage-account-to-get-the-storage-account-uri"></a><span data-ttu-id="bcd68-119">Настройка учетной записи хранилища Azure для получения URI учетной записи хранилища</span><span class="sxs-lookup"><span data-stu-id="bcd68-119">Set up the Azure storage account to get the storage account URI</span></span>

1. <span data-ttu-id="bcd68-120">Открывает учетную запись хранения, которую планируется использовать в дополнении электронных накладных.</span><span class="sxs-lookup"><span data-stu-id="bcd68-120">Open the storage account that you plan to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bcd68-121">Перейдите в раздел **Служб BLOB-объектов** \> **Контейнеры** и создайте новый контейнер.</span><span class="sxs-lookup"><span data-stu-id="bcd68-121">Go to **Blob service** \> **Containers**, and create a new container.</span></span>
3. <span data-ttu-id="bcd68-122">Введите имя контейнера и задайте для поля **Уровень открытого доступа** значение **Частный (нет анонимного доступа)**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-122">Enter a name for the container, and set the **Public access level** field to **Private (no anonymous access)**.</span></span>
4. <span data-ttu-id="bcd68-123">Откройте контейнер и перейдите в раздел **Параметры \> Политика доступа**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-123">Open the container, and go to **Settings \> Access policy**.</span></span>
5. <span data-ttu-id="bcd68-124">Выберите **Добавить политику**, чтобы добавить сохраненную политику доступа.</span><span class="sxs-lookup"><span data-stu-id="bcd68-124">Select **Add policy** to add a stored access policy.</span></span>
6. <span data-ttu-id="bcd68-125">Задайте требуемые значения в полях **Идентификатор** и **Разрешения**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-125">Set the **Identifier** and **Permissions** fields as appropriate.</span></span> <span data-ttu-id="bcd68-126">В поле **Разрешения** следует выбрать все разрешения.</span><span class="sxs-lookup"><span data-stu-id="bcd68-126">In the **Permissions** field, you should select all permissions.</span></span>

    ![Предоставление разрешения для хранилища BLOB-объектов](media/e-Invoicing-services-create-azure-resources-grant-blob-permissions.png)

7. <span data-ttu-id="bcd68-128">Введите даты начала и окончания срока действия.</span><span class="sxs-lookup"><span data-stu-id="bcd68-128">Enter the start and expiry dates.</span></span> <span data-ttu-id="bcd68-129">Дата истечения срока действия должна быть в будущем.</span><span class="sxs-lookup"><span data-stu-id="bcd68-129">The expiry date should be in future.</span></span>
8. <span data-ttu-id="bcd68-130">Выберите **ОК**, чтобы сохранить политику, затем сохраните изменения в контейнере.</span><span class="sxs-lookup"><span data-stu-id="bcd68-130">Select **OK** to save the policy, and then save your changes to the container.</span></span>
9. <span data-ttu-id="bcd68-131">Вернитесь к учетной записи хранения и откройте **Обозреватель службы хранилища (предварительная версия)**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-131">Return to the storage account, and open **Storage Explorer (preview)**.</span></span>
10. <span data-ttu-id="bcd68-132">Щелкните контейнер правой кнопкой мыши и выберите **Получить подписанный URL-адрес**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-132">Right-click the container, and then select **Get Shared Access Signature**.</span></span>
11. <span data-ttu-id="bcd68-133">В диалоговом окне **Подписанный URL-адрес** скопируйте и сохраните значение в поле **URI**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-133">In the **Shared Access Signature** dialog box, copy and store the value in the **URI** field.</span></span> <span data-ttu-id="bcd68-134">Это значение будет использоваться в следующей процедуре и будет называться *URI подписанного URL-адреса*.</span><span class="sxs-lookup"><span data-stu-id="bcd68-134">This value will be used in the next procedure and will be referred to as the *shared access signature URI*.</span></span>

    ![Выбор и копирование значения URI](media/e-Invoicing-services-create-azure-resources-select-and-copy-uri.png)

## <a name="set-up-the-key-vault-to-store-the-storage-account-uri"></a><span data-ttu-id="bcd68-136">Настройка хранилища ключей для хранения URI учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="bcd68-136">Set up the key vault to store the storage account URI</span></span>

1. <span data-ttu-id="bcd68-137">Откройте хранилище ключей, которое планируется использовать в дополнении электронных накладных.</span><span class="sxs-lookup"><span data-stu-id="bcd68-137">Open the key vault that you intend to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bcd68-138">Перейдите в раздел **Параметры** \> **Секреты** и выберите **Создать/импортировать**, чтобы создать новый секрет.</span><span class="sxs-lookup"><span data-stu-id="bcd68-138">Go to **Settings** \> **Secrets**, and then select **Generate/Import** to create a new secret.</span></span>
3. <span data-ttu-id="bcd68-139">На странице **Создание секрета** в поле **Параметры отправки** выберите **Вручную**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-139">On the **Create a secret** page, in the **Upload options** field, select **Manual**.</span></span>
4. <span data-ttu-id="bcd68-140">Введите имя секрета.</span><span class="sxs-lookup"><span data-stu-id="bcd68-140">Enter the name of the secret.</span></span> <span data-ttu-id="bcd68-141">Это имя будет использоваться во время настройки службы в Regulatory Configuration Service (RCS) и будет называться *имя секрета хранилища ключей*.</span><span class="sxs-lookup"><span data-stu-id="bcd68-141">This name will be used during setup of the service in Regulatory Configuration Service (RCS) and will be referred to as the *key vault secret name*.</span></span>
5. <span data-ttu-id="bcd68-142">В поле **Значение** выберите **URI подписанного URL-адреса**, затем выберите **Создать**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-142">In the **Value** field, select **Shared Access Signature URI**, and then select **Create**.</span></span>
6. <span data-ttu-id="bcd68-143">Настройте политику доступа, чтобы предоставить дополнению электронных накладных уровень безопасного доступа для созданного вами секрета.</span><span class="sxs-lookup"><span data-stu-id="bcd68-143">Set up the access policy to grant the Electronic invoicing add-on the correct level of secure access to the secret you created.</span></span> <span data-ttu-id="bcd68-144">Перейдите в раздел **Параметры \> Политика доступа** и выберите команду **Добавить политику доступа**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-144">Go to **Settings \> Access policy**, and select **Add Access Policy**.</span></span>
7. <span data-ttu-id="bcd68-145">Задайте разрешения секрета для операций **Получить** и **Список**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-145">Set the secret permissions for the **Get** and **List** operations.</span></span>

    ![Предоставление доступа к службе](media/e-Invoicing-services-create-azure-resources-grant-service-access.png)

8. <span data-ttu-id="bcd68-147">Задайте разрешения сертификата для операций **Получить** и **Список**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-147">Set the certificate permissions for **Get** and **List** operations.</span></span>

    ![Предоставление разрешения сертификата](media/e-Invoicing-services-create-azure-resources-grant-certificate-permission.png)

9. <span data-ttu-id="bcd68-149">В диалоговом окне **Субъект** выберите субъект, добавив **Дополнение электронных накладных**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-149">In the **Principal** dialog box, select the principal by adding **Electronic invoicing add-on**.</span></span>
10. <span data-ttu-id="bcd68-150">Выберите **Добавить**, затем выберите **Сохранить изменения Key Vault**.</span><span class="sxs-lookup"><span data-stu-id="bcd68-150">Select **Add**, and then select **Save Key Vault changes**.</span></span>
11. <span data-ttu-id="bcd68-151">На странице **Обзор** скопируйте значение **Имя DNS** для хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="bcd68-151">On the **Overview** page, copy the **DNS name** value for the key vault.</span></span> <span data-ttu-id="bcd68-152">Это значение будет использоваться во время настройки службы в RCS и будет называться *URI хранилища ключей*.</span><span class="sxs-lookup"><span data-stu-id="bcd68-152">This value will be used during setup of the service in RCS and will be referred as the *key vault URI*.</span></span>
