---
title: Среды службы
description: В этой статье предоставляются сведения о средах служб для электронного выставления накладных и объясняется, как их настраивать.
author: dkalyuzh
ms.date: 02/28/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: dkalyuzh
ms.search.validFrom: ''
ms.dyn365.ops.version: ''
ms.openlocfilehash: 8c743c5b2fbc7dcc3ae04fa4d7ca0e65de6c2507
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2022
ms.locfileid: "8901257"
---
# <a name="service-environments"></a>Среды службы

[!include [banner](../includes/banner.md)]

Среды службы — это логические разделы, создаваемые для поддержки функций глобализации и соответствующих документов, обработанных в службе электронного выставления накладных. Секреты безопасности и цифровые сертификаты, а также разрешения доступа (руководство) должны быть настроены на уровне среды службы.

Вы можете создать столько сред служб, сколько требуется. Все среды службы, которые вы создаете, независимы друг от друга. Рекомендуется создать хотя бы две среды службы:

- Одна среда для основных целей разработки и проверки. Эта среда обычно является средой приемочного тестирования пользователем (UAT).
- Одна среда для производственных целей. Эта среда обычно является производственной средой.

Этот тип разделения помогает гарантировать, что процессы электронной накладной проверяются и настраиваются в "песочнице" до того, как они переходят в производство.

Среды служб должны создаваться и поддерживаться в службе Regulatory Configuration Service (RCS). Затем, когда они готовы, они должны быть опубликованы в службе электронного выставления накладных. Процесс публикации посылает параметры среды службы из экземпляра RCS в службу электронного выставления накладных.

Если после создания новой среды службы или корректировки существующей среды службы (например, добавления или удаления пользователей или секретов Microsoft Azure Key Vault) процесс публикации не завершен, изменения не вступят в силу. Dynamics 365 Finance или Dynamics 365 Supply Chain Management может получить доступ только к опубликованным средам.

## <a name="service-environment-statuses"></a>Состояния среды службы

Управление средами служб осуществляется через их состояние. Состояние среды можно просмотреть на странице **Среды служб**. Предусмотрены следующие статусы:

- **Не опубликовано** — среда создана, но еще не была опубликована.
- **Опубликовано** — среда была опубликована в службе электронного выставления накладных.
- **Изменено** — атрибуты опубликованной среды были изменены, но изменения еще не были опубликованы.

## <a name="users"></a>Пользователи

В каждой среде службы должны быть перечислены пользователи, которые могут подключаться к электронному выставлению накладных из Finance или Supply Chain Management.

## <a name="applications"></a>Приложения

В некоторых случаях приложениям, отличным от Finance или Supply Chain Management., может потребоваться подключение к службе электронного выставления накладных для отправки электронных документов для дальнейшей обработки или получения такой информации, как статус отправки документа. В этих сценариях приложение должно быть определено в списке приложений. Таким образом, оно будет иметь доступ к службе электронного выставления накладных. Приложение также должно быть зарегистрировано в виде приложения в Azure Active Directory (Azure AD), а код объекта должен использоваться для его идентификации. 

Поскольку корпорация Майкрософт требует высокого уровня контроля над приложениями, которые могут подключаться к службе электронного выставления накладных, необходимо обратиться в корпорацию Майкрософт по адресу <DGXRegulatoryservicesengineering@service.microsoft.com> и предоставить следующие сведения о приложении:

- Код арендатора Azure AD
- Идентификатор среды Microsoft Dynamics Lifecycle Services (LCS)
- ИД приложения (ИД клиента)
- Код объекта
- Выравнивание и описание высокого уровня приложения

Корпорация Майкрософт выполнит оценку запроса и зарегистрирует приложение в реестре безопасности, чтобы убедиться в том, что оно может работать с электронным выставлением накладных.

## <a name="number-sequences"></a>Номерные серии

Если сценарии требуют номерных серий (например, в именах файлов), можно использовать номерные серии, которые определены для конкретной среды, но могут использоваться либо в функциях глобализации, либо для определенной функции глобализации. После того как номерная серия определена, ее можно использовать в переменных и конвейерах обработки. Чтобы отследить ее использование, на странице **Номерные серии** проверьте значение **Текущее** для параметра **Используется**.

### <a name="working-with-number-sequences"></a>Работа с номерными сериями
На странице **Номерные серии**: 

- Выберите **Создать** для создания номерной серии. Введите имя и описание. 
- Выберите **Удалить**, чтобы удалить номерную серию, если она больше не используется.
- Нет необходимости выбирать **Опубликовать** на панели операций для публикации изменений в номерной серии. Обновление выполняется автоматически.

## <a name="create-a-key-vault-reference"></a>Создание ссылки Key Vault

1. Войдите в учетную запись RCS.
2. В рабочей области **Функция глобализации** в разделе **Среда** выберите плитку **Электронное выставление накладных**.
3. На странице **Настройка среды** на панели действий выберите **Среды служб**.
4. На странице **Среды служб** на панели действий выберите **Параметры Key Vault**.
5. На странице **Параметры Key Vault**, выберите **Создать**, чтобы создать ссылку на Key Vault.
6. В поле **Имя** введите имя ссылки Key Vault.
7. В поле **Описание** введите описание.
8. В поле **URI Key Vault** вставьте URI Key Vault из хранилища ключей (`https://<your key vault>.vault.azure.net/`). Дополнительные сведения см. в разделе [Создание Azure Key Vault на портале Azure](e-invoicing-create-azure-key-vault-azure-portal.md).
9. Нажмите **Сохранить**.
    
## <a name="create-a-secret-for-the-storage-account-secret-token"></a>Создание секрета для токена секрета учетной записи хранения

1. На странице **Параметры Key Vault** выберите ссылку на Key Vault, созданную в предыдущей процедуре, затем в разделе **Сертификаты** выберите **Добавить**.
2. В поле **Имя** введите имя секрета учетной записи хранения. Это имя должно совпадать с именем секрета Key Vault, который содержит маркер подписанного URL-адреса (SAS). Дополнительные сведения см. в разделе [Создание учетной записи хранения Azure на портале Azure](e-invoicing-create-azure-storage-account-azure-portal.md). 
3. В поле **Описание** введите описание.
4. В поле **Тип** выберите **Секрет**.
5. Нажмите **Сохранить**.
    
## <a name="create-a-service-environment"></a>Создание среды службы

1. На странице **Среды служб** выберите **Создать**, чтобы создать среду службы.
2. В поле **Имя** введите имя среды электронного выставления накладных.
3. В поле **Описание** введите описание.
4. В поле **Секрет маркера SAS хранилища** выберите имя секрета учетной записи хранения, который должен использоваться для проверки подлинности доступа к учетной записи хранения.
5. В разделе **Пользователи** выберите **Добавить**, чтобы добавить пользователя, которому разрешено отправлять электронные накладные через среду, и подключиться к учетной записи хранения.
6. В поле **Код пользователя** введите псевдоним пользователя. 
7. В поле **Электронная почта** введите адрес электронной почты пользователя.
8. Нажмите **Сохранить**.
9. На панели операций выберите **Опубликовать** для публикации среды в службе электронного выставления накладных. Проверьте, что значение в поле **Статус** изменяется на **Опубликовано**.
