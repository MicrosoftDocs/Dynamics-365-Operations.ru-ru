---
title: Копирование экземпляра
description: Можно использовать Microsoft Dynamics Lifecycle Services (LCS) для копирования базы данных Microsoft Dynamics 365 Human Resources в среду в песочнице.
author: andreabichsel
ms.date: 07/22/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: SystemAdministrationWorkspaceForm
audience: Application User
ms.search.scope: Human Resources
ms.custom: 7521
ms.assetid: ''
ms.search.region: Global
ms.author: anbichse
ms.search.validFrom: 2020-02-03
ms.dyn365.ops.version: Human Resources
ms.openlocfilehash: 48fef68dc3e5935f0032ca006840202b53d577e06e5376ead0b66eca2a9c36bb
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6740847"
---
# <a name="copy-an-instance"></a>Копирование экземпляра

[!include [Applies to Human Resources](../includes/applies-to-hr.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

Можно использовать Microsoft Dynamics Lifecycle Services (LCS) для копирования базы данных Microsoft Dynamics 365 Human Resources в среду в песочнице. При наличии другой среды-песочницы можно также скопировать базу данных из этой среды в целевую среду-песочницу.

Чтобы скопировать экземпляр, необходимо помнить о следующих советах:

- Экземпляр Human Resources, который требуется перезаписывать, должен быть средой песочницы.

- Среды, из которых выполняется копирование, должны быть в одном регионе. Нельзя копировать по регионам.

- Вы должны быть администратором в целевой среде, чтобы можно было войти в систему после копирования экземпляра.

- При копировании базы данных Human Resources не копируются элементы (приложения или данные), содержащиеся в среде Microsoft Power Apps. Сведения о способе копирования элементов в среде Power Apps см. в разделе [Копирование среды](/power-platform/admin/copy-environment). Среда Power Apps, которую требуется перезаписывать, должна быть средой песочницы. Чтобы изменить производственную среду Power Apps на среду песочницы, необходимо быть глобальным администратором клиента. Дополнительные сведения об изменении среды Power Apps см. в разделе [Переключение экземпляра](/dynamics365/admin/switch-instance).

- Если экземпляр копируется в среду "песочницы" и требуется интегрировать среду "песочницы" с Dataverse, необходимо повторно применить настраиваемые поля к таблицам Dataverse. См. раздел [Применение настраиваемых полей к Dataverse](hr-admin-setup-copy-instance.md?apply-custom-fields-to-common-data-service).

## <a name="effects-of-copying-a-human-resources-database"></a>Результаты копирования базы данных Human Resources

При копировании базы данных Human Resources происходят следующие события:

- Процесс копирования стирает существующую базу данных в целевой среде. После завершения процесса копирования восстановить существующую базу данных невозможно.

- Целевая среда будет недоступна до завершения процесса копирования.

- Документы в хранилище BLOB-объектов Microsoft Azure не копируются из одной среды в другую. В результате все документы и шаблоны, которые прикрепляются, не будут скопированы и останутся в исходной среде.

- Все пользователи, кроме тех, у кого есть роль безопасности "системный администратор", и другие учетные записи пользователей внутренних служб, будут недоступны. Пользователь с правами администратора может удалять или заменять данные до того, как другие пользователи смогут вернуться в систему.

- Пользователь с ролью безопасности "системный администратор" должен выполнить необходимые изменения конфигурации, такие как повторное подключение конечных точек интеграции к отдельным службам или URL-адресам.

## <a name="copy-the-human-resources-database"></a>Копирование базы данных Human Resources

Чтобы выполнить эту задачу, необходимо сначала скопировать экземпляр, а затем войти в центр администрирования Microsoft Power Platform, чтобы скопировать среду Power Apps.

> [!WARNING]
> При копировании экземпляра база данных удаляется из целевого экземпляра. Целевой экземпляр недоступен в ходе этого процесса.

1. Выполните вход LCS и выберите проект LCS, содержащий экземпляр, который необходимо скопировать.

2. В проекте LCS выберите плитку **Управление приложением Human Resources**.

3. Выберите экземпляр для копирования, а затем выберите **Копировать**.

4. В области задач **Копирование экземпляра** выберите экземпляр, который требуется перезаписать, и нажмите кнопку **Копировать**. Дождитесь обновления значения поля **Статус копирования** до **Завершено**.

   ![[Выберите экземпляр для перезаписи.](./media/copy-instance-select-target-instance.png)](./media/copy-instance-select-target-instance.png)

5. Выберите **Power Platform** и выполните вход в центр администрирования Microsoft Power Platform.

   ![[Выберите Power Platform.](./media/copy-instance-select-power-platform.png)](./media/copy-instance-select-power-platform.png)

6. Выберите среду Power Apps для копирования, а затем выберите **Копировать**.

7. После завершения процесса копирования выполните вход в целевой экземпляр и включите интеграцию Dataverse. Для получения дополнительных сведений и инструкций см. раздел [Настройка интеграции Dataverse](./hr-admin-integration-common-data-service.md).

## <a name="data-elements-and-statuses"></a>Элементы данных и статусы

Следующие элементы данных не копируются при копировании экземпляра Human Resources:

- Адреса электронной почты в таблице **LogisticsElectronicAddress**

- Журнал пакетных заданий в **BatchJobHistory**, **BatchHistory** и **BatchConstraintHistory**

- Пароль SMTP в таблице **SysEmailSMTPPassword**

- Сервер ретрансляции SMTP в таблице **SysEmailParameters**

- Параметры управления печатью в таблицах **PrintMgmtSettings** и **PrintMgmtDocInstance**

- Записи, специфические для данной среды в таблицах **SysServerConfig**, **SysServerSessions**, **SysCorpNetPrinters**, **SysClientSessions**, **BatchServerConfig** и **BatchServerGroup**

- Вложения документов в таблице DocuValue. К этим вложениям относятся все шаблоны Microsoft Office, которые были перезаписаны в исходной среде

- Строка доступа в таблице **PersonnelIntegrationConfiguration**

Некоторые из этих элементов не копируются, поскольку они связаны с определенной средой. Примерами являются записи **BatchServerConfig** и **SysCorpNetPrinters**. Другие элементы не копируются из-за объема запросов технической поддержки. Пример:

- Повторяющиеся сообщения электронной почты могут быть отправлены, поскольку протокол SMTP все еще включен в среде приемочного тестирования пользователем (песочнице).

- Недопустимые сообщения интеграции могут быть отправлены, так как все еще включены пакетные задания.

- Пользователи могут быть включены, прежде чем администраторы смогут выполнять действия по очистке после обновления.

Также при копировании экземпляра изменяются следующие статусы:

- Все пользователи, кроме тех, у кого есть роль безопасности "системный администратор", **отключены**.

- Все пакетные задания, за исключением некоторых системных заданий, устанавливаются в значение **Удержание**.

## <a name="environment-admin"></a>Администратор среды

Все пользователи в целевой среде песочницы, включая администраторов, заменяются пользователями исходной среды. Перед копированием экземпляра убедитесь, что вы являетесь администратором в исходной среде. Если это не так, после завершения копирования вы не сможете войти в целевую среду песочницы.

Все пользователи, не являющиеся администраторами в целевой среде песочницы, отключены для защиты от нежелательного входа в среду песочницы. Администраторы могут повторно включить пользователей, если это необходимо.

## <a name="apply-custom-fields-to-dataverse"></a>Применение настраиваемых полей к Dataverse

Если экземпляр копируется в среду "песочницы" и требуется интегрировать среду "песочницы" с Dataverse, необходимо повторно применить настраиваемые поля к таблицам Dataverse.

Для каждого настраиваемого поля, доступного для таблиц Dataverse, выполните следующие шаги:

1. Перейдите в настраиваемое поле и выберите **Правка**.

2. Отмените выбор поля **Включено** для каждой сущности cdm_*, для которой включено настраиваемое поле.

3. Выберите **Применить изменения**.

4. Снова выберите **Правка**.

5. Выберите поле **Включено** для каждой сущности cdm_*, для которой включено настраиваемое поле.

6. Снова выберите **Применить изменения**.

Процесс отмены выбора, применения изменений, повторного выбора и повторного применения изменений приводит к изменению схемы в Dataverse, чтобы включить в нее настраиваемые поля.

Дополнительные сведения о настраиваемых полях см. в разделе [Создание настраиваемых полей и работа с ними](../fin-ops-core/fin-ops/get-started/user-defined-fields.md).

## <a name="see-also"></a>См. также

[Обеспечение Human Resources](hr-admin-setup-provision.md)</br>
[Удаление экземпляра](hr-admin-setup-remove-instance.md)</br>
[Процесс обновления](hr-admin-setup-update-process.md)



[!INCLUDE[footer-include](../includes/footer-banner.md)]
