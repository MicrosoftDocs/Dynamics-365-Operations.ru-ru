---
title: Источники данных из разных компаний в электронной отчетности (ER)
description: В этом разделе объясняется использование источников данных из разных компаний в электронной отчетности (ER).
author: NickSelin
manager: AnnBe
ms.date: 05/25/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 3ff94c49eed378d92e995782e73d76d669b44292
ms.sourcegitcommit: 2ebea3cbddfa0a5ef0e0fd13d3693da6152bc288
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2019
ms.locfileid: "351984"
---
# <a name="cross-company-data-sources-in-electronic-reporting-er"></a><span data-ttu-id="47692-103">Источники данных из разных компаний в электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="47692-103">Cross-company data sources in Electronic reporting (ER)</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="47692-104">Можно разработать форматы электронной отчетности (ER) для создания исходящих документов в различных форматах.</span><span class="sxs-lookup"><span data-stu-id="47692-104">You can design Electronic reporting (ER) formats to generate outgoing documents in various formats.</span></span> <span data-ttu-id="47692-105">Когда создается документ, формат электронной отчетности обращается к источникам данных, которые были настроены в соответствующем соответствии моделей электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="47692-105">When a document is generated, an ER format calls data sources that were configured in a corresponding ER model mapping.</span></span> <span data-ttu-id="47692-106">Чтобы настроить доступ к таблицам приложения для извлечения записей можно использовать источники данных электронной отчетности типа **Записи таблицы**.</span><span class="sxs-lookup"><span data-stu-id="47692-106">To configure access to application tables for record retrieval, you can use ER data sources of the **Table records** type.</span></span> <span data-ttu-id="47692-107">Если таблица доступа представляет собой общую таблицу (то есть это таблица, где сохраняются данные без идентификатора компании), этот источник данных возвращает все записи.</span><span class="sxs-lookup"><span data-stu-id="47692-107">When the accessing table is a shared table (that is, a table where data is saved without a company identifier), this data source returns all records.</span></span> <span data-ttu-id="47692-108">Когда таблица доступа является таблицей, зависящей от компании (то есть таблицей, где данные сохраняются для каждой компании), этот источник данных возвращает только записи, которые были сохранены для текущей компании (то есть контекст компании, который соответствует формату электронной отчетности).</span><span class="sxs-lookup"><span data-stu-id="47692-108">When the accessing table is a company-dependent table (that is, a table where data is saved per company), this data source returns only the records that have been saved for the current company (that is, the company context that the ER format is running under).</span></span>

<span data-ttu-id="47692-109">Каждый источник данных типа **Записи таблицы** в соответствии модели может быть теперь помечен как источник данных разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-109">Every data source of the **Table records** type in a model mapping can be now marked as a cross-company data source.</span></span> <span data-ttu-id="47692-110">Таким образом, можно использовать источники данных типа **Записи таблицы** для доступа к данным разных компаний в таблицах приложений.</span><span class="sxs-lookup"><span data-stu-id="47692-110">Therefore, you can use data sources of the **Table records** type to access cross-company data in application tables.</span></span>

<span data-ttu-id="47692-111">Если отметить источник данных как источник данных разных компаний, происходит следующее:</span><span class="sxs-lookup"><span data-stu-id="47692-111">If you mark a data source as cross-company, the following behavior occurs:</span></span>

- <span data-ttu-id="47692-112">Для источника данных, который относится к любой общей таблице, кроме CompanyInfo, источник данных возвращает все записи, которые существуют в используемой таблице.</span><span class="sxs-lookup"><span data-stu-id="47692-112">For a data source that refers to any shared table except CompanyInfo, the data source returns all records that exist in the referenced table.</span></span> 
- <span data-ttu-id="47692-113">Для источника данных, который ссылается на таблицу CompanyInfo, хотя CompanyInfo является общей таблицей, источник данных возвращает записи, содержащие идентификатор компании из определенной области.</span><span class="sxs-lookup"><span data-stu-id="47692-113">For a data source that refers to the CompanyInfo table, even though CompanyInfo is a shared table, the data source returns the records that contain the identifier of a company from the defined scope.</span></span>
- <span data-ttu-id="47692-114">Для любой зависящей от компании таблицы источник данных возвращает записи используемой таблицы, которые содержат идентификатор компании из определенной области.</span><span class="sxs-lookup"><span data-stu-id="47692-114">For any company-dependent table, the data source returns the records of the referenced table that contain the identifier of a company from the defined scope.</span></span>

<span data-ttu-id="47692-115">В диалоговом окне системного запроса при включении параметра **Запросить запрос** для любого источника данных, который помечен как данные разных компаний, можно вручную выбрать одну или несколько компаний, которые должны быть включены на вкладке **Диапазон компаний**.</span><span class="sxs-lookup"><span data-stu-id="47692-115">In the system query dialog box, when the **Ask for query** option is turned on for any data source that is marked as cross-company, you can manually select one or more companies to include on the **Company range** tab.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="47692-116">Как и другие фильтры, фильтр компании сохраняется как последнее используемое значение для запросов при запуске формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="47692-116">Like other filters, the company filter is persisted as a last-used value for queries when you run an ER format.</span></span> <span data-ttu-id="47692-117">Фильтр не изменяется автоматически при изменении значения разных компаний для источника данных.</span><span class="sxs-lookup"><span data-stu-id="47692-117">The filter isn't automatically changed if you change the cross-company value for a data source.</span></span> <span data-ttu-id="47692-118">Чтобы использовать другое значение разных компаний для другого источника данных, удалите соответствующей выбор конкретного пользователя.</span><span class="sxs-lookup"><span data-stu-id="47692-118">To use a different cross-company value for another data source, delete the corresponding user-specific selection.</span></span>

<span data-ttu-id="47692-119">Для каждого источника данных, который помечен как источник данных разных компаний, можно выбрать необходимые записи с помощью функций **ФИЛЬТР** и **ГДЕ** в выражениях электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="47692-119">For every data source that is marked as cross-company, you can select the records that you want by using the **FILTER** and **WHERE** functions in ER expressions.</span></span> <span data-ttu-id="47692-120">Поле **dataAreaID** также может использоваться как идентификатор компании.</span><span class="sxs-lookup"><span data-stu-id="47692-120">The **dataAreaID** field can also be used as a company identifier.</span></span> <span data-ttu-id="47692-121">В настоящее время поле **dataAreaID** ограничено следующие типы условий при использовании функции **ФИЛЬТР**:</span><span class="sxs-lookup"><span data-stu-id="47692-121">Currently, the **dataAreaID** field is limited to the following types of conditions when the **FILTER** function is used:</span></span>

- <span data-ttu-id="47692-122">Только те условия, которые имеют одно сравнение поля **dataAreaID** поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="47692-122">Only conditions that have a single **dataAreaID** field comparison are supported.</span></span>
- <span data-ttu-id="47692-123">Допускаются только сравнения, имеющие выражения, которые не зависят от элементов списка записей.</span><span class="sxs-lookup"><span data-stu-id="47692-123">Only comparisons that have expressions that don't depend on records list items are allowed.</span></span>

<span data-ttu-id="47692-124">Таким образом следующее выражение является допустимым.</span><span class="sxs-lookup"><span data-stu-id="47692-124">Therefore, the following expression is valid.</span></span>

```
FILTER (MyTable, MyTable.dataAreaID = $StringUserInputParameter)
While shown below expressions will not pass the validation:
FILTER (MyTable, MyTable.dataAreaID = MyTable2RecordsList.MyField)
FILTER (MyTable, 
    OR(
        MyTable.dataAreaID = $StringUserInputParameter1,
        MyTable.dataAreaID = $StringUserInputParameter2
    )
)
```

<span data-ttu-id="47692-125">По умолчанию область включает все компании текущего приложения.</span><span class="sxs-lookup"><span data-stu-id="47692-125">By default, the scope includes all companies of the current application.</span></span> <span data-ttu-id="47692-126">Тем не менее, это можно ограничить.</span><span class="sxs-lookup"><span data-stu-id="47692-126">However, it can be restricted.</span></span> <span data-ttu-id="47692-127">Для ограничения доступа к данным разных компаний для одного формата электронной отчетности назначьте формату определенную организационную иерархию.</span><span class="sxs-lookup"><span data-stu-id="47692-127">To restrict the scope of cross-company data access for a single ER format, assign a specific organization hierarchy to the format.</span></span> <span data-ttu-id="47692-128">Когда иерархия определена для формата электронной отчетности, возвращаются только записи для юридических лиц, которые представлены в назначенной иерархии, даже если формат обращается к источникам данных разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-128">When a hierarchy is defined for an ER format, only records for legal entities that are presented in the assigned hierarchy are returned, even though the format calls cross-company data sources.</span></span> <span data-ttu-id="47692-129">При ссылке на иерархию, которая больше не существует для формата электронной отчетности, применяется область по умолчанию, и формат обращается к источникам данных разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-129">When a reference to a hierarchy that no longer exists is defined for an ER format, the default scope is applied, and the format calls cross-company data sources.</span></span> <span data-ttu-id="47692-130">В этом случае возвращаются записи для всех компаний с приложением.</span><span class="sxs-lookup"><span data-stu-id="47692-130">In this situation, records for all application companies are returned.</span></span>

<span data-ttu-id="47692-131">Обратите внимание, что при включении параметра **Использовать черновик** для организационной иерархии назначенной одному формату электронной отчетности, юридические лица из черновика версии этой иерархии будут использоваться для определения области для источников данных разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-131">Note that when the **Use draft** option is turned on for the assigned to a single ER format organization hierarchy, the legal entities from the draft version of this hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="47692-132">Если черновика версии не существует, юридические лица из последней опубликованной версии этой организационной иерархии будут использоваться для этого.</span><span class="sxs-lookup"><span data-stu-id="47692-132">If the draft version does not exist, the legal entities from the last published version of this organization hierarchy will be used for this.</span></span>

<span data-ttu-id="47692-133">Обратите внимание, что при включении параметра **Использовать черновик** для организационной иерархии назначенной одному формату электронной отчетности, юридические лица из последней опубликованной версии этой организационной иерархии будут использоваться для определения области для источников данных разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-133">Note that when the **Use draft** option is turned off for the assigned to a single ER format organization hierarchy, the legal entities from the last published version of this organization hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="47692-134">Эффективность данных организационных иерархий пока не поддерживается в рамках электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="47692-134">Date effectiveness of organization hierarchies is not supported yet in the ER framework.</span></span>

<span data-ttu-id="47692-135">Иерархию можно назначить определенному формату на отдельной странице, к которой можно получить доступ из рабочего пространства электронной отчетности или с помощью пункта меню **Управление организацией \> Электронная отчетность \> Фильтр по юридическому лицу для форматов**.</span><span class="sxs-lookup"><span data-stu-id="47692-135">The hierarchy can be assigned to a format in a specific page that can be accessed from the ER workspace or by using the **Organization administration \> Electronic reporting \> Legal entity filter for formats** menu item.</span></span> <span data-ttu-id="47692-136">Чтобы получить доступ к странице, пользователю должен быть предоставлен доступ к привелегии **Поддерживать фильтры юридического лица для формата** (ERMaintainFormatMappingLegalEntityFilters).</span><span class="sxs-lookup"><span data-stu-id="47692-136">To access the page, the **Maintain legal entity filters for format** privilege (ERMaintainFormatMappingLegalEntityFilters) must be granted to a user.</span></span> <span data-ttu-id="47692-137">Ограничение объема юридических лиц на основе иерархии для формата применяется в дополнение к ограничению, которое пользователь может указать в диалоговом окне системного запроса.</span><span class="sxs-lookup"><span data-stu-id="47692-137">The scope restriction of hierarchy-based legal entities for the format is applied in addition to the restriction that the user can manually specify in the system query dialog box.</span></span> <span data-ttu-id="47692-138">Пересечение этих ограничений используется при выполнении формата.</span><span class="sxs-lookup"><span data-stu-id="47692-138">The intersection of these restrictions is used when the format is run.</span></span>

<span data-ttu-id="47692-139">Для получения дополнительных сведений о данном компоненте запустите проводник по задаче, **Записи доступа электронной отчетности к зависимым от компании таблицам в режиме разных компаний**, которое входит в 7.5.4.3 Бизнес-процесс приобретения/разработки компонентов ИТ-услуг и решений (10677) и может быть загружено из [Центра загрузки Майкрософт](https://go.microsoft.com/fwlink/?linkid=874684).</span><span class="sxs-lookup"><span data-stu-id="47692-139">To learn more about this feature, play the task guide, **ER Access records of company dependent tables in cross-company mode**, which is part of the 7.5.4.3 Acquire/Develop IT service/solution components (10677) business process, and can be downloaded from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=874684).</span></span> <span data-ttu-id="47692-140">В этом проводнике по задаче описывается процесс конфигурирования соответствия модели электронной отчетности и формата электронной отчетности для доступа к таблицам приложений в режиме разных компаний.</span><span class="sxs-lookup"><span data-stu-id="47692-140">This task guide walks you through the process of configuring an ER model mapping and ER format to access application tables in cross-company mode.</span></span>

<span data-ttu-id="47692-141">Загрузите следующие файлы для завершения проводника по задаче:</span><span class="sxs-lookup"><span data-stu-id="47692-141">Download the following files to complete the task guide:</span></span>

- [<span data-ttu-id="47692-142">Конфигурация модели электронной отчетности — CrossCompanyDataAccessModel.xml</span><span class="sxs-lookup"><span data-stu-id="47692-142">ER model configuration - CrossCompanyDataAccessModel.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
- [<span data-ttu-id="47692-143">Конфигурация формата электронной отчетности — CrossCompanyDataAccessFormat.xml</span><span class="sxs-lookup"><span data-stu-id="47692-143">ER format configuration - CrossCompanyDataAccessFormat.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
