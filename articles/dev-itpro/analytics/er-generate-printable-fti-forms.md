---
title: Создание печатаемых форм FTI
description: В этом разделе объясняется, как использовать инфраструктуру электронной отчетности (ER) для создания печатной формы накладной с произвольным текстом (FTI) в виде документов Microsoft Office.
author: NickSelin
manager: AnnBe
ms.date: 07/24/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: d27a11a0d925b0f1164578f9c04e6abd4736b2b2
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "1554031"
---
# <a name="generate-printable-fti-forms"></a>Создание печатных форм FTI

[!include[banner](../includes/banner.md)]

Инфраструктура электронной отчетности (ER) позволяет создавать печатные формы накладной с произвольным текстом (FTI) в виде документов Microsoft Office. В этом разделе представлена информация о создании собственных конфигураций, а также сведения о доступных шаблонах конфигурации.

## <a name="overview"></a>Обзор

В дополнение к существующей возможности создания печатных форм FTI с помощью Microsoft SQL Server Reporting Services (SSRS), теперь можно использовать инфраструктуру ER. Вы можете управлять печатными формами FTI в Microsoft Office Excel и Word. Можно также изменить макет, поток данных и форматирование в соответствии с конкретными требованиями без внесения изменений в код.

> [!NOTE]
> Если требуется начать с обзора существующих конфигураций электронной отчетности для данного примера решения печатных форм FTI, можно перейти непосредственно к пункту **Загрузка образцов конфигурации электронной отчетности для создания печатных форм FTI** далее в этом разделе.

## <a name="create-customized-configurations-for-fti-printable-forms"></a>Создание настраиваемых конфигураций для печатных форм FTI
В рамках настраиваемого решения для печатных форм FTI необходимо создать набор конфигураций электронной отчетности.

### <a name="configure-the-er-data-model"></a>Настройка модели данных электронной отчетности
Ваше приложение должно включать конфигурацию модели данных электронной отчетности, содержащую модель данных, которая описывает бизнес-среду выставления накладной клиента. Имеется требование, что имя модели данных должно быть **CustomersInvoicing**. Сведения о разработке моделей данных электронной отчетности см. в разделе [Разработка модели данных для конкретного домена для электронной отчетности (ER)](tasks/er-design-domain-specific-data-model-2016-11.md).

### <a name="configure-the-er-model-mapping"></a>Настройка сопоставления модели электронной отчетности
Приложение должно включать сопоставления модели электронной отчетности для модели данных CustomersInvoicing. Сопоставление модели может быть в конфигурацию модели данных электронной отчетности, или в конфигурацию сопоставления модели электронной отчетности. Однако корневой дескриптор сопоставления модели должен называться **FreeTextInvoice**.

Сопоставление должно содержать следующие источники данных:

- Тип источника данных: **Записи таблицы**

    - Этот источник данных должен иметь имя **CustInvoiceJour**.
    - Он должен ссылаться на таблицу приложения CustInvoiceJour.
    - Он используется во время выполнения для передачи из приложения в сопоставление модели электронной отчетности списка накладных, которые были выбраны для печати.

- Тип источника данных: **Объект**

    - Этот источник данных должен иметь имя **PrintMgmtPrintSettingDetail**.
    - Он должен ссылаться на класс приложения **PrintMgmtPrintSettingDetail**.
    - Он используется во время выполнения для передачи из приложения в сопоставление модели электронной отчетности сведений о параметрах управления печатью для формата электронной отчетности, который выполняется.

Сведения о интеграции приложения с помощью платформы электронной отчетности можно найти в классе **ERPrintMgmtReportFormatSubscriber** (модель интеграции пакета приложений электронной отчетности) в исходном коде приложения.

Дополнительные сведения о разработке сопоставлений моделей электронной отчетности см. в разделе [Определение сопоставления модели и выбор источника данных для электронной отчетности (ER)](tasks/er-define-model-mapping-select-data-sources-2016-11.md).

### <a name="configure-the-er-format"></a>Настройка формата электронной отчетности
В вашем экземпляре приложения должна иметься конфигурация формата электронной отчетности, который будет использоваться для создания форм FTI. 

> [!NOTE]
> Данная конфигурация формата должна быть создана для модели данных CustomersInvoicing, и она должна использовать сопоставление модели с корневым дескриптором **FreeTextInvoice**.

Сведения о настройке форматов электронной отчетности см. в разделе [Создание конфигурации формата для электронной отчетности (ER)](tasks/er-format-configuration-2016-11.md). Сведения о разработке форматов электронной отчетности для создания отчетов в формате OpenXML см. в разделе [Разработка конфигурации для создания отчетов в формате OpenXML для электронной отчетности (ER)](tasks/er-design-reports-openxml-2016-11.md).

## <a name="configure-print-management"></a>Настройка управления печатью
Для создания форм FTI с помощью платформы электронной отчетности можно назначить форматы электронной отчетности таким же образом, как при назначении отчетов SSRS. Чтобы связать формат электронной отчетности со всеми накладными FTI модуля расчетов с клиентами, выберите **Расчеты с клиентами** \> **Настройка** \> **Формы** \> **Настройка форм** \> **Общее** \> **Управление печатью** \> **Накладная с произвольным текстом** \> **Оригинал**. Чтобы связать формат электронной отчетности с определенным клиентом или накладной, выполните следующие действия.

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. Выберите накладную с произвольным текстом, которую требуется связать с форматом электронной отчетности, и откройте страницу **Настройка управления печатью**.
3. Выберите уровень документа, чтобы задать область для обработки накладных.
4. Выберите формат электронной отчетности для указанного уровня документов.

![Печать настройки управления](media/FTIbyGER-PMSetting.png)

> [!NOTE]
> Только форматы,электронной отчетности, которые используют корневой дескриптор **FreeTextInvoice** модели данных **CustomersInvoicing**, отображаются в поле **Подстановка формата отчета** для выбранного формата.

## <a name="generate-fti-forms"></a>Создание форм FTI
Формы FTI формируются в платформе электронной отчетности таким же образом, как формируются отчеты SSRS.

Чтобы создать формы FTI, можно выбрать накладные по диапазону или путем выделения. 

![Выбор накладной](media/FTIbyGER-InvoiceSelection.png)

![Предварительный просмотр накладных](media/FTIbyGER-InvoiceExcelPreview.png)

При использовании форматов электронной отчетности для печати форм FTI таким образом используется файлы назначения электронной отчетности по умолчанию. Место назначения изменить невозможно. Дополнительные сведения о настройке мест назначения электронной отчетности для форматов электронной отчетности см. в разделе [Места назначения электронной отчетности](electronic-reporting-destinations.md).

Можно также создавать формы FTI при разноске FTI, включив параметр **Печать накладной** и выключив параметр **Использовать назначение управления печатью**.

> [!NOTE]
> При использовании форматов электронной отчетности для печати форм FTI таким образом используется файлы назначения электронной отчетности по умолчанию. Место назначения по умолчанию во время выполнения можно изменить, если место назначения уже настроено. Чтобы изменить место назначения, необходимо иметь следующие привилегии безопасности:
>
> - **Имя:** ERFormatDestinationRuntimeMaintain
> - **Метка:** Ведение места назначения форматов электронной отчетности во время выполнения

![Место назначения электронной отчетности](media/FTIbyGER-ERFileDestinationSetting.png)

![Место назначения форматов электронной отчетности](media/FTIbyGER-ERFileDestinationUsage.png)

Платформа электронной отчетности в настоящее время поддерживает следующие места назначения для созданных документов:

- **Загруженный файл** — создаваемые формы предлагаются как файлы для загрузки, которые можно сохранить с помощью обозревателя.
- **Экран** — Microsoft Office 365 Excel используется для предварительного просмотра созданных форм FTI в формате Excel.
- **Папка SharePoint** — создаваемые формы хранятся на основе параметров структуры управления документами.
- **Архив приложений** — создаваемые формы хранятся как вложения записей журнала выполнения в хранилище Microsoft Azure.
- **Электронная почта** — создаваемые формы отправляются в виде вложений электронной почты.

> [!NOTE]
> Невозможно отправить создаваемые формы FTI непосредственно на принтер, поскольку прямая печать, использующая агент маршрутизации принтера Dynamics, не поддерживается в настоящее время.

## <a name="download-sample-er-configurations-to-generate-printable-fti-forms"></a>Загрузка образца конфигураций электронной отчетности для создания печатных форм FTI
Можно загрузить образец конфигураций электронной отчетности для использования в качестве шаблона для решения FTI. Конфигурации хранятся в библиотеке общих ресурсов в Microsoft Dynamics Lifecycle Services (LCS). Включены следующие конфигурации:

- Конфигурация **Модель выставления накладных клиенту** содержит необходимую модуль данных и сопоставление модели.
- Конфигурация **Отчет FTI клиента (Немецкий)** содержит образец формата.

> [!NOTE]
> Эти конфигурации были созданы как образцы, чтобы помочь прояснить возможные сценарии. Будущее эти конфигурации зависит от результатов их оценки и полученных отзывов.

### <a name="features-that-are-implemented-in-the-sample-er-format"></a>Функции, реализованные в образце формата электронной отчетности
В примере конфигурации формата электронной отчетности файл Excel используется как шаблон для создания форм FTI.

![Конструктор форматов](media/FTIbyGER-ERFormat.png)

В настоящее время этот образец формата электронной отчетности поддерживает следующие функции для создания форм FTI:

- Формы FTI-создаются как из исходных накладных, которые были разнесены, так и из исходных накладных, которые еще не были разнесены. Скорректированные накладные и кредит-ноты не поддерживаются.
- Формы FTI создаются на языке накладной. Формат значений и дат в созданных формах основан на настройках языкового стандарта клиента пользователя.
- Созданные накладные показывают уведомления о недоступности данных в том случае, если отсутствуют строки в накладных, которые обработаны.
- Заголовки созданных накладных основаны на формате бумаги, который был выбран для формы FTI на странице **Параметры модуля расчетов с клиентами**. Сведения о компании отображаются в заголовке созданной формы накладной только в том случае, если формат бумаги пуст.
- На созданных формах накладных отображается коды налогового освобождения компании и клиента, когда был выбран соответствующий параметр для формы FTI на странице **Параметры модуля расчетов с клиентами**.
- Разделы созданных строк накладной и итоговых сумм накладной показывают денежные подробные сведения накладной по умолчанию в валюте регистрации накладной.
- В разделе итогов созданной накладной могут отображаться денежные сведения в евро и в валюте регистрации накладной, если параметр **Печатать сумму в валюте, соответствующей евро** включен на странице **Параметры модуля расчетов с клиентами**.
- Созданные формы накладных, показывают все заметки обработки накладной, которые доступны, на основе параметров на странице **Параметры модуля расчетов с клиентами**. Примечания включаются как для всей накладной, так и для каждой строки накладной.
- Созданные формы накладной включают примечаний для формы FTI клиента и язык обработки накладной, когда они были настроены в списке примечаний формы расчетов с клиентами.
- В зависимости от параметров управления печатью созданные накладные включают настраиваемый текст нижнего колонтитула, когда он был настроен для языка накладной, формат электронной отчетности и область документа FTI.
- Раздел итоговых сумм созданных форм накладных включает всю информация о скидках по оплате, которые доступны.
- Раздел графика оплаты созданных форм накладных включает в себя все сведения о графиках оплаты, которые доступны.
- Раздел разметки созданных форм накладных включает в себя все проводки расходов, которые доступны.
- Созданные формы накладных содержат подробные сведения о налогах на основе параметра **Спецификация налога** на странице **Параметры модуля расчетов с клиентами**. В этом разделе можно показать налоговые данные только в валюте регистрации накладной или в валюте регистрации накладной и валюте учета компании в одно и то же время.
- Созданные формы накладных показывают подробные сведения об уведомлениях прямого дебетования. Например, они показывают, когда был выбран метод оплаты, который имеет идентификатор предписания обязательного прямого дебетования для накладной, когда обработка накладной была зарегистрирована в евро, и когда был определен идентификатор предписания прямого дебетования для накладной.
- Созданные накладные показывают все сведения о предоплате, доступные для учтенных накладных.
- Создание формы накладных могут быть отправлены клиенту накладной как вложение электронной почты. Следует настроить соответствующей место назначения файла электронной отчетности для формата электронной отчетности, который использовался.

### <a name="countryregion-specific-features"></a>Функции для страны/региона 
Следующие функции, специфичные для стран/регионов, включены в образец формата электронной отчетности для демонстрации, как особые требования могут быть обработаны в конфигурациях электронной отчетности.

#### <a name="norway"></a>Норвегия
Термин "регистр предприятий" помещается в заголовок созданной формы накладной при обработке накладной для юридического лица, который настроен следующим образом:

- Используется контекст страны/региона для Норвегии.
- Параметр **Печать Foretaksregisteret** активен в документах продажи.

#### <a name="spain"></a>Испания
Термин **Специальный режим для учета кассы** помещается в заголовок созданной формы накладной при обработке накладной для юридического лица, который настроен следующим образом:

- Используется контекст страны/региона для Испании.
- Специальный режим для метода учета кассы включен на дату обработки накладной.

Когда данные скидки по оплате, например, сумма скидки по оплате и чистая сумма строки накладной, доступны, они представляются в разделе итогов по накладной созданной формы накладной при его обработке для юридического лица, настроенного следующим образом:

- Используется контекст страны/региона для Испании.
- Параметр **В накладной применена скидка по оплате** включен в параметре накладной (**Параметры главной книги** \> **Раздел налогов**).

#### <a name="italy"></a>Италия
Знак скидки на товары включается в строки накладной созданной накладной при ее обработке для юридического лица, настроенного с использованием контекста страны/региона для Италии.

#### <a name="finland"></a>Финляндия
В дополнение к созданной форме накладной квитанции перевода денег с жиросчета могут создаваться следующим образом:

- Для юридического лица, который использует контекст страны/региона для Финляндии и имеет хотя бы один банковский счет, который помечен как **Жиросчет** и **Банковский штрихкод**. 
- Для накладной, которая отмечена **Финляндия** как требуется для вложение со связанным платежом.

![Квитанция жиросчета](media/FTIbyGER-GiroSlip.PNG)

> [!NOTE]
> Пример формата электронной отчетности был настроен для формирования при необходимости квитанций перевода денег с жиросчета на отдельном листе.

> [!NOTE]
> Необходимо сначала установить шрифт, который используется для создания штрихкода на локальном компьютере, где созданная форма накладной в формате Microsoft Excel будет просматриваться.

### <a name="use-the-sample-er-format-to-configure-email-destinations"></a>Использование примера формата электронной отчетности для настройки адресов электронной почты
Используйте следующие элементы примера формата электронной отчетности для настройки адресов электронной почты:

- Адрес электронной почты контактного лица клиента можно получить с помощью следующего выражения электронной отчетности: **model.InvoiceBase.Contact.ElectronicMail**.
- Текст темы сообщения электронной почты можно получить с помощью следующего выражения электронной почты: **Emailing.TxtToUse.Subject**.
- Основной текст сообщения электронной почты можно получить с помощью следующего выражения электронной почты: **Emailing.TxtToUse.Body**.

![Параметры места назначения](media/FTIbyGER-ERFileDestinationSettingEmail.png)

Текст по умолчанию темы и основного текста сообщения электронной почты определяется в примере формата электронной отчетности. Язык определяется подписями формата. Этот текст по умолчанию будет использоваться для сообщений электронной почты, если настраиваемый шаблон электронной почты организации, имеющий предварительно определенный идентификатор **ERFTITMP**, не был добавлен.

> [!NOTE]
> Идентификатор шаблона электронной почты **ERFTITMP** был определен в примере формата электронной почты. Он может быть изменен при необходимости в новом формате электронной отчетности, созданном на основе этого образца формата.

Если шаблон электронной почты организации, который имеет предварительно определенный код **ERFTITMP**, был добавлен для юридического лица, для которого обрабатывается накладная, шаблон для текст темы и основного текста сообщения электронной почты будет использоваться для создания сообщения электронной почты. 

![Шаблоны сообщений электронной почты организации](media/FTIbyGER-EmailTemplate.png)

![Отправка шаблона сообщения электронной почты](media/FTIbyGER-EmailTemplateBody.png)

Выражение электронной отчетности **Emailing.TxtToUse.Subject** образца формата электронной отчетности настроен для замены всех вхождений заполнителя %1 идентификатором обработки накладной.

Выражение **Emailing.TxtToUse.Body** образца формата настроено на следующие подстановки для местозаполнителей:

- "%1" заменяется именем контактного лица клиента.
- "%2" заменяется названием компании.
- "%3" заменяется именем клиента.
- "%4" заменяется именем контактного лица компании.
- "%5" заменяется должностью контактного лица компании.
- "%6" заменяется адресом электронной почты контактного лица компании.

![Эл. почта](media/FTIbyGER-Email.PNG)

## <a name="additional-resources"></a>Дополнительные ресурсы
[Обзор электронной отчетности](general-electronic-reporting.md)
