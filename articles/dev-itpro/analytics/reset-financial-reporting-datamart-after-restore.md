---
title: "Сброс киоска данных финансовой отчетности после восстановления базы данных"
description: "В этом разделе описывается, как сбросить киоск данных финансовой отчетности после восстановления базы данных Microsoft Dynamics 365 for Finance and Operations."
author: ShylaThompson
manager: AnnBe
ms.date: 08/15/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, IT Pro
ms.reviewer: shylaw
ms.search.scope: Core, Operations, UnifiedOperations
ms.custom: 261824
ms.search.region: Global
ms.author: kweekley
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.translationtype: HT
ms.sourcegitcommit: 47e70cb1291e390b42b7feff844b2aca141f09b7
ms.openlocfilehash: 200b1a03a0ea95ec2d75850f9a8aebda966e38d6
ms.contentlocale: ru-ru
ms.lasthandoff: 09/29/2017

---

# <a name="reset-the-financial-reporting-data-mart-after-restoring-a-database"></a>Сброс киоска данных финансовой отчетности после восстановления базы данных

[!include[banner](../includes/banner.md)]


В этом разделе описывается, как сбросить киоск данных финансовой отчетности после восстановления базы данных Microsoft Dynamics 365 for Finance and Operations.

Если вам когда-либо придется восстанавливать свою базу данных Finance and Operations из резервной копии или копировать базу данных из другой среды, необходимо выполнить действия, описанные в этой теме, чтобы гарантировать использование киоском данных финансовой отчетности восстановленной базы данных Finance and Operations. 
> [!Note] 
> Шаги в этом процессе поддерживаются для Dynamics 365 for Operations выпуска за май 2016 г. (сборка приложения 7.0.1265.23014 и сборка финансовой отчетности 7.0.10000.4) и более новых версий. Если у вас более ранняя версия Finance and Operations, обратитесь к специалисту службы поддержки за помощью.

## <a name="export-report-definitions"></a>Экспорт определений отчетов
Сначала экспортируйте макеты отчетов, расположенные в конструкторе отчетов, выполнив следующие действия:

1.  В конструкторе отчетов откройте **Компания** &gt; **Группы строительных блоков**.
2.  Выберите группу строительных блоков, которую требуется экспортировать, и нажмите кнопку **Экспорт**. 

    > [!Note] 
    > Для Finance and Operations поддерживается только одна группа строительных блоков, **По умолчанию**.
    
3.  Выберите определения отчета для экспорта:
    -   Для того, чтобы экспортировать все ваши определения отчета и связанные строительные блоки, щелкните **Выбрать все**.
    -   Чтобы экспортировать определенные отчеты, строки, столбцы, деревья или наборы аналитик, щелкните соответствующую вкладку и выберите элементы для экспорта. Нажмите и удерживайте клавишу CTRL, чтобы выбрать несколько элементов на вкладке. При выборе отчетов для экспорта выбираются соответствующие строки, столбцы, структуры и наборы аналитик.

4.  Щелкните **Экспорт**.
5.  Введите имя файла и выберите безопасное место, где требуется сохранить экспортированные определения отчетов.
6.  Нажмите кнопку **Сохранить**.

Файл можно скопировать или отправить в безопасное место, что позволяет импортировать его в другую среду в другое время. Сведения об использовании учетной записи хранилища Microsoft Azure можно найти в разделе [Перенос данных с помощью служебной программы командной строки AzCopy](/azure/storage/storage-use-azcopy). 
> [!NOTE]
> Корпорация Майкрософт не предоставляет учетную запись хранилища в составе договора на Finance and Operations. Необходимо либо приобрести учетную запись хранилища, либо использовать учетную запись хранилища из отдельной подписки Azure. 
> [!WARNING]
> Помните о поведении диска D в виртуальных машинах Azure. Не следует постоянно хранить на нем свои экспортированные группы строительных блоков. Дополнительные сведения о временных дисках см. в разделе [Понимание временного диска на виртуальных машинах Windows Azure](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).

## <a name="stop-services"></a>Остановка служб
С помощью удаленного рабочего стола подключитесь ко всем компьютерам в среде и остановите следующие службы Windows с помощью services.msc:

-   Служба веб-публикаций (на всех компьютерах AOS)
-   Microsoft Dynamics 365 for Finance and Operations Batch Management Service (только на компьютерах с AOS, не являющихся частными)
-   Management Reporter 2012 Process Service (только на компьютерах BI)

Эти службы будут иметь открытые подключения к базе данных Finance and Operations.

## <a name="reset"></a>Сбросить
### <a name="locate-and-download-the-latest-minorversiondataupgradezip-package"></a>Поиск и загрузка последней версии пакета MinorVersionDataUpgrade.zip

Найдите последний пакет MinorVersionDataUpgrade.zip с помощью инструкций из раздела [Загрузка последнего готового к развертыванию пакета обновления данных](..\migration-upgrade\upgrade-data-to-latest-update.md#download-the-latest-data-upgrade-deployable-packages). В этих инструкциях поясняется, как найти и загрузить правильную версию пакета обновления данных. Для загрузки пакета MinorVersionDataUpgrade.zip не требуется обновление. Необходим просто выполнить действия, описанные в разделе "Загрузка последнего готового к развертыванию пакета обновления данных" без выполнения каких-либо других шагов в статье, чтобы получить копию пакета MinorVersionDataUpgrade.zip.

### <a name="execute-scripts-against-finance-and-operations-database"></a>Выполнение сценариев для базы данных Finance and Operations

Запустите следующие сценарии для базы данных Finance and Operations (не для базы данных финансовых отчетов).

-   DataUpgrade.zip\\AosService\\Scripts\\ConfigureAxReportingIntegration.sql
-   DataUpgrade.zip\\AosService\\Scripts\\GrantAzViewChangeTracking.sql

Эти сценарии обеспечивают правильность пользователей, ролей и параметров изменения отслеживания.

### <a name="execute-powershell-command-to-reset-database"></a>Выполнение команды PowerShell для сброса базы данных

На компьютере с сервером AOS выполните следующие команды в PowerShell от имени администратора, чтобы сбросить интеграцию между Finance and Operations и финансовой отчетностью:

```
F:
cd F:\MRApplicationService\MRInstallDirectory
Import-Module .\Server\MRDeploy\MRDeploy.psd1
Reset-DatamartIntegration -Reason OTHER -ReasonDetail “<my reason for resetting>”

```
> [!NOTE]
> После выполнения команд вам будет предложено ввести "Y" для подтверждения.

Объяснение параметров:

-   Допустимые значения для параметра -Reason: SERVICING, BADDATA, OTHER.
-   Параметр -ReasonDetail является произвольным текстом.
-   Значения параметров reason и reasonDetail записываются в данных телеметрии/мониторинга среды.

## <a name="start-services"></a>Запуск служб
Используйте services.msc, чтобы перезапустить службы, остановленные ранее:

-   Служба веб-публикаций (на всех компьютерах AOS)
-   Microsoft Dynamics 365 for Finance and Operations Batch Management Service (только на компьютерах с AOS, не являющихся частными)
-   Management Reporter 2012 Process Service (только на компьютерах BI)

## <a name="import-report-definitions"></a>Импорт определений отчетов
Импортируйте макеты отчетов из конструктора отчетов, используя файл, созданный во время экспорта:

1.  В конструкторе отчетов откройте **Компания** &gt; **Группы строительных блоков**.
2.  Выберите группу строительных блоков, которую требуется экспортировать, и нажмите кнопку **Экспорт**. 

    > [!NOTE]
    > Для Finance and Operations поддерживается только одна группа строительных блоков, **По умолчанию**.
    
3.  Выберите строительный блок **По умолчанию** и нажмите **Импорт**.
4.  Выберите файл, содержащий экспортированные определения отчетов, и нажмите кнопку **Открыть**.
5.  В диалоговом окнеИмпорт, выберите определения отчета для того, чтобы импортировать:
    -   Чтобы импортировать все определения отчетов и поддерживающие строительные блоки, щелкните **Выбрать все**.
    -   Для того, чтобы импортировать специфические отчеты, строки, столбцы, деревья, или Наборы аналитик, выбирают отчеты, строки, столбцы, деревья, или Наборы аналитик, которые импортировать.

6.  Нажмите кнопку **Импорт**.





