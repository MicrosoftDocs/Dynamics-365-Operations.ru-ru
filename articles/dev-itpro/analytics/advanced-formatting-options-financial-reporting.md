---
title: Расширенные параметры форматирования в финансовой отчетности
description: При создании отчета в финансовой отчетности доступны дополнительные функции форматирования, включая фильтры для аналитик, ограничения для столбцов и единиц отчетности, строки не для печати и операторы IF/THEN/ELSE в расчетах.
author: ryansandness
manager: AnnBe
ms.date: 04/26/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: FinancialReports
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 106571
ms.assetid: 895b5127-01d6-4495-b127-343387b743aa
ms.search.region: Global
ms.author: aolson
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 70f69fdad3d9186886190c62fba08af06d2a24d6
ms.sourcegitcommit: 2b890cd7a801055ab0ca24398efc8e4e777d4d8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2019
ms.locfileid: "1502573"
---
# <a name="advanced-formatting-options-in-financial-reporting"></a>Расширенные параметры форматирования в финансовой отчетности

[!include [banner](../includes/banner.md)]

При создании отчета в финансовой отчетности доступны дополнительные функции форматирования, включая фильтры для аналитик, ограничения для столбцов и единиц отчетности, строки не для печати и операторы IF/THEN/ELSE в расчетах. 

Следующая таблица объясняет расширенные параметры форматирования, которые доступны когда вы конструируете отчеты.

| Функция                   | Описание |
|----------------------------|-------------|
| Фильтр аналитик           | Для того, чтобы получить доступ к определенным наборам данных, вы можете использовать аналитики в определении строки и определении столбца. Многие отчеты используют только естественный сегмент в формате строки. Однако строки можно изменить так, что они включают значения аналитик. Фильтры аналитик в определении столбца используются для того, чтобы получить доступ к специфическим значениям аналитик. |
| Ограничение единицы отчетности | Вы можете настроить строку отчета так, что она покажет только информацию, которая связана с определенной единицей отчетности. |
| Строки не для печати (NP)     | Строки не для печати полезны в многих отчетах. Если необходимы несколько расчетов, чтобы получить значение, эти вычисления можно спрятать на напечатанном отчете. Строки не для печати также полезны для разработки отчета об устранении неполадок и для расширенного размещения ячеек. |
| Ограничение столбца         | Ограничение столбца в определении строки полезно, чтобы прятать значения, которые уместны только на некоторых строках отчета. Когда вычисления процентов выполнены на строке, ограничение столбца предотвращает печать полных столбцов или другие столбцы от быть напечатанным когда те номера не применяются. |
| Разрыв столбца               | Вы можете добавить разрывы столбца в определение строки, чтобы показать рядом информацию отчета. Вы можете добавить множественные разрывы столбца в одном определении строки, и заголовки столбца повторяются вверху каждого столбца после разрыва столбца. Комментарии для отчета показаны между разрывами столбца. |
| Оператор IF/THEN/ELSE     | Вы можете изменить расчеты в определении строки или определении столбца. |
| Для значений аналитик используйте одинарные кавычки ('') и амперсанд (&) | Можно использовать значения аналитик, включая символ амперсанда, для дизайна отчета. |

## <a name="advanced-cell-placement"></a>Расширенное размещение ячейки
Расширенное размещение ячейки или *принуждение*, включает размещение специфических значений в определенные ячейки. Например, принуждение часто используется для того, чтобы сдвинуть правильный баланс в отчете по исходящей наличности. Можно использовать принуждение для следующих целей:

- Перемещение данных из Microsoft Excel в определенные ячейки.
- Закодировать специфические значения в отчет.
- Измените знаки путем копирования значения из предыдущей ячейки и умножая это значение на -1.

> [!NOTE]
> : Во многих случаях вы должны сконфигурировать свое определение отчета так, чтобы вычисления в столбцах делались перед вычислениями в строках. Чтобы завершить эту конфигурацию, выполните следующие действия.
> 
> 1. В конструкторе отчетов, раскройте определение отчета.
> 2. На вкладке **Настройки** под **Приоритет вычисления**, выберите **Сначала выполнить расчет в столбце, затем в строке**.

## <a name="designing-the-report"></a>Разработка отчета
Когда вы конструируете отчет, вы должны создать все строки деталей сперва, для того, чтобы убедиться что значения будут получены как ожидалось. После этого добавьте перекрытия формата **NP** (не печатать), чтобы подавить деталь, которая включает окончательные значения.

> [!IMPORTANT]
> При использовании в определении строки кода формата **CAL** невозможно выполнить детализацию до сведений о проводке.

В принудительном режиме формулы используют следующий формат: &lt;столбец назначения&gt;=&lt;исходный столбец&gt;.&lt;код строки&gt; Разделяйте дополнительные размещения для строки запятой и пробелом. Вот пример: D=C.190, E=C.100

## <a name="examples-of-advanced-formatting-options"></a>Примеры расширенных параметров форматирования
Следующие примеры показывают, как форматировать определение строки и определение столбца, чтобы принудить базовый отчет по движению денежных средств (пример 1) и статистический отчет (пример 2).

### <a name="example-1-basic-forcing"></a>Пример 1: базовое принуждение

Следующая таблица показывает пример определения строки, которое использует базовое принуждение.

| Код строки |           описание            | Код формата | Связанные формулы/строки/блоки |        Модификатор строк        | Связь с финансовой аналитикой |
|----------|----------------------------------|-------------|-----------------------------|----------------------------|------------------------------|
| 100      | Наличные деньги на начало периода (NP) |             |                             | Модификатор счета = \[/BB\] | +Segment2 = \[1100\]         |
| 130      | Денежные средства в начале периода      | CAL         | C=C.100,F=D.100             |                            |                              |
| 160      |                                  |             |                             |                            |                              |
| 190      |                                  |             |                             |                            |                              |

> [!NOTE] 
> Из предыдущей таблицы для наглядности были удалены пустые столбцы "Переопределение формата", "Обычное сальдо", "Управление печатью" и "Ограничение столбца".

Следующая таблица показывает пример определения строки, которое использует базовое принуждение в строке.

|                              | О   | Байт    | К        | Г      | Д      | Е    |
|------------------------------|-----|------|----------|--------|--------|------|
| Заголовок 1                     |     |      |          |        |        |      |
| Заголовок 2                     | О   | Байт    | К        | Г      | Д      | Е    |
| Заголовок 3                     |     |      |          |        |        |      |
| Тип столбца                  | ROW | DESC | FD       | FD     | FD     | CALC |
| Код книги/категория атрибута |     |      | ФАКТИЧЕСКИЙ   | ФАКТИЧЕСКИЙ | ФАКТИЧЕСКИЙ |      |
| Финансовый год                  |     |      | BASE     | BASE   | BASE   |      |
| Период                       |     |      | BASE     | BASE   | BASE   |      |
| Охватываемые периоды              |     |      | PERIODIC | YTD/BB | YTD    |      |
| Формула                      |     |      |          |        |        | E-D  |
| Ширина столбца                 | 5   | 30   | 14       | 14     | 14     | 14   |

### <a name="example-2-statistical-reports"></a>Пример 2: Статистические отчеты

Следующая таблица показывает пример определения строки, которое использует принуждение для статистического отчета.

| Код строки | Описание               | Код формата | Связанные формулы/строки/блоки     | Переопределение формата      | Обычное сальдо | Связь с финансовой аналитикой               |
|----------|---------------------------|-------------|---------------------------------|----------------------|----------------|--------------------------------------------|
| 50       | Статистическая информация   | REM         |                                 |                      |                |                                            |
| 100      | Число работающих — США            | CAL         | 4                               | \#\#\#0.;($\#\#\#0.) |                |                                            |
| 115      | Число работающих — международное | CAL         | 11                              | \#\#\#0.;($\#\#\#0.) |                |                                            |
| 130      |                           |             |                                 |                      |                |                                            |
| 190      | Продажи в США                  |             |                                 |                      | К              | +Segment2 = \[41\*\], Segment3 = \[00\]    |
| 220      | Международные продажи       |             |                                 |                      | К              | +Segment2 = \[41\*\], Segment3 = \[01:99\] |
| 250      |                           |             |                                 |                      |                |                                            |
| 280      |                           |             |                                 |                      |                |                                            |
| 310      | Продажи в США                  | CAL         | D=C.190,E=C.100,F=(C.100/C.190) |                      |                |                                            |
| 340      | Международные продажи       | CAL         | D=C.220,E=C115,F=(C.220/C.115)  |                      |                |                                            |

> [!NOTE] 
> Из предыдущей таблицы для наглядности были удалены пустые столбцы "Управление печатью", "Ограничение столбца" и "Модификатор строк".

Следующая таблица показывает пример определения столбца, которое использует принуждение для статистического отчета.

|                              | А   | млрд    | К      | Д            | Д     | П            |
|------------------------------|-----|------|--------|--------------|-------|--------------|
| Заголовок 1                     | А   | млрд    | К      | Д            | Д     | П            |
| Заголовок 2                     | -   | -    | С начала года    | Годовые продажи | Персонал | $ на человека |
| Заголовок 3                     |     |      |        |              |       |              |
| Тип столбца                  | ROW | DESC | FD     | CALC         | CALC  | CALC         |
| Код книги/категория атрибута |     |      | ФАКТИЧЕСКИЕ ДАННЫЕ |              |       |              |
| Финансовый год                  |     |      | BASE   |              |       |              |
| Период                       |     |      | BASE   |              |       |              |
| Покрытые периоды              |     |      | YTD    |              |       |              |
| Формула                      |     |      |        |              |       | E-D          |
| Ширина столбца                 | 5   | 30   | 14     | 14           | 14    | 14           |

## <a name="restricting-a-row-to-a-specific-reporting-unit"></a>Ограничивайте строку определенной единицей отчетности
Когда строка отчета ограничена определенной единицей отчетности, эта строка показывает связанные данные только для названной единицы отчетности и игнорирует данные для других единиц отчетности в дереве отчетности. Например, вы можете создать строку, которая обеспечивает детали для итоговых операционных расходов для специфического Подразделения. Ваш отчет может содержать двойные данные, если отчет содержит и дерево отчетности, и определение строки, который имеет больше чем просто естественный счет. Например, вы имеете дерево отчетности, которое перечисляет шесть подразделений в вашей организации, и вы также имеете определение строки, которое перечисляет специфическое сочетание счета и подразделения в строке. Когда вы производите отчет, специфическое сочетание из счета и Подразделения напечатано на каждом уровне дерева отчетности, даже если то Подразделение может не соответствовать тому, что в дереве. Это поведение происходит, потому что строка перекрывает то, что типично отфильтруется определением отчета. Один способ, которым вы можете избежать дублирования данных — ограничивать строку определенной единицей отчетности.

> [!NOTE]
> Если строка включает аналитики и вы ограничиваете эту строку дочерней единицей отчетности, сумма строки включается и для этой дочерней единицы, и для ее родительских единиц, однако дублирования не происходит.

### <a name="restrict-a-row-to-a-reporting-unit"></a>Ограничьте строку единицей отчетности

1. В конструкторе отчетов щелкните **Определения строк**, и после этого выберите определение строки, которое надо изменить.
2. Дважды щелкните соответствующую ячейку **Связанные формулы/строки/блоки**.
3. В диалоговом окне **Выбор элемента аналитической структуры** в поле **Аналитическая структура** выберите структуру, назначенную определению отчета.
4. Выберите единицу отчетности, и после этого щелкните **ОК**. Ограничение появляется в ячейке определения строки.
5. Выполните двойной клик ячейки в столбце **Ссылка на финансовые аналитики** ограниченной строки, и после этого ссылку на систему финансовых данных.

## <a name="selecting-print-control-in-a-row-definition"></a>Выбор управления печатью в определении строки
Вы можете определить коды управления печатью для каждого столбца путем использования ячейки **Управление печатью**.

### <a name="add-print-control-codes-to-a-report-row"></a>Добавьте коды управления печатью к строке отчета

1. В конструкторе отчетов выберите редактируемое определение строки.
2. Дважды щелкните ячейку **Управление печатью**.
3. В диалоговом окне **Управление печатью**, выберите код управления печатью, или нажмите и придержите клавишу Ctrl для того, чтобы выбрать множественные коды. Вы можете также ввести коды управления печатью прямо в ячейку **Управление печатью**. Разделяйте многочисленные коды управления печатью запятыми.
4. Выберите все условные варианты печати.
5. Нажмите кнопку **OК**.

### <a name="regular-print-control-codes"></a>Регулярные коды управления печатью

Следующая таблица описывает регулярные коды управления печатью для определения строки.

| Код управления печатью | Толкование кода управления печатью         | Описание |
|--------------------|--------------------------------------------------|-------------|
| NP                 | Строка не для печати                                 | Предотвращает печать сумм в строке в отчете, и исключает суммы из вычислений. Для того, чтобы включить столбец "не печатать" в вычисление, ссылайтесь на столбец прямо в формуле вычисления. Например, строка "не печатать" 240 включена в следующий расчет: **230+240+250**. Однако, строка "не печатать" 240 не включена в следующий расчет: **230:250**. |
| CS                 | Символ валюты; используйте формат валюты в этой строке | Включите символ валюты в все суммы, кроме процентов. Значения процента никогда не получают символ валюты. |
| XD                 | Подавить строку в подробном отчете счета            | Подавить отображение счетов в подробных отчетах счета и подробных отчетах проводки. Это управление печати полезно, когда строка включает много счетов, который не должны быть перечислены в подробном отчете счета или подробном отчете проводки. |
| X0                 | Подавите строку, если все нули                        | Исключите строку из отчета, если все ячейки в этой строке пустые или содержат нули. Это управление печати имеет смысл, только когда параметр, чтобы подавить нулевое сальдо, не выбран в определении отчета. |
| B0                 | Оставить нулевые столбцы пустыми                         | Оставьте столбцы пустым в строке, которые содержат нулевые количества. |
| XR                 | Подавите свертку                                  | Подавите свертку. Если отчет использует дерево отчетности, суммы в этой строке не сворачивается в последующие родительские узлы. |
| SR                 | Подавить округление                                | Предотвратите округление сумм в этой строке. |
| XT                 | Подавить строку в подробном отчете проводки        | Подавите отображение проводок в подробных отчетах проводки. Это управление печати полезно, когда строка включает много счетов, который не должны быть перечислены в подробном отчете проводки. |

### <a name="conditional-print-control-codes"></a>Условные коды управления печатью

Следующая таблица описывает условные коды управления печатью для определения строки.

| Код управления печатью | Описание                                  |
|--------------------|----------------------------------------------|
| (нет)             | Очистить выбор условной печати.       |
| УС                 | Напечатайте только Дебетовые сальдо для этой строки.  |
| CR                 | Напечатайте только кредитовые сальдо для этой строки. |

## <a name="column-restriction-cell-in-a-row-definition"></a>Ячейка Ограничение столбца в определении строки
Ячейка **Определение столбца** в определении строки имеет множественные цели. В зависимости от типа строки, вы можете использовать ячейку **Ограничение столбца** для того, чтобы определить одну из следующих функций:

- Ячейка может ограничивать печать сумм в строке специфическим столбцом. Эта функция полезна, если вы создаете табличный балансовый отчет.
- Ячейка может определить столбец сумм для сортировки.

## <a name="using-a-calculation-formula-in-a-row-definition"></a>Использование формулы вычисления в определении строки
Формула вычисления в определении строки может включить операторы **+**, **-**, **\*** и **/**, а также операторы **IF/THEN/ELSE**. Дополнительно, вычисление может включить индивидуальные ячейки и абсолютные суммы (фактические числа, которые включены в формулу). Формула может содержать до 1024 символов. Вычисления нельзя приложить к строкам, которые содержат ячейки типа **Ссылка на финансовые аналитики** (FD). Однако вы можете включить вычисления в последовательных строках, подавить печатание этих строк, и после этого подытожить строки вычисления.

### <a name="operators-in-a-calculation-formula"></a>Операторы в формуле вычисления

Формула вычисления использует более сложные операторы, чем формула итогов строки. Однако вы можете использовать операторы **\*** и **/** вместе с дополнительными операторами для того, чтобы умножить (\*) и разделить (/) суммы. Для использования диапазона или суммы в формуле вычисления, вы должны использовать знак at (@) перед любым кодом строки, если вы используете столбец в определении строки. Например, для того, чтобы добавить сумму в строке 100 к сумме в строке 330, вы можете использовать формулу итога строки **100+330** или формулу вычисления **@100+@330**.

> [!NOTE]
> Необходимо ставить знак at (@) перед каждым кодом строки, используемым в формуле вычисления. В противном случае номер прочитается как абсолютное количество. Например, формула **@100+330** добавляет 330 долларов США к сумме в строке 100. При ссылке на столбец в формуле расчета знак "собаки" (@) не требуется.

### <a name="create-a-calculation-formula"></a>Создание формулы расчета

1. В конструкторе отчетов щелкните **Определения строк**, и после этого раскройте определение строки, которое надо изменить.
2. Выполните двойной клик ячейки **Код формата**, и после этого выберите **CAL**.
3. В ячейке **Связанные формулы/строки/единицы** введите формулу расчета.

### <a name="example-of-a-calculation-formula-for-specific-rows"></a>Пример формулы расчета для конкретных строк

В этом примере формула расчета **@100+@330** означает, что сумма в строке 100 добавляется к сумме в строке 330. Формула итога по строкам **340+370** добавляет сумму из строки 340 к сумме из строки 370. (Сумма из строки 370 представляет собой сумму по формуле расчета.)

| Код строки | Описание                 | Код формата | Связанные формулы/строки/единица | Управление печатью | Модификатор строк | Ссылка на финансовые аналитики |
|----------|-----------------------------|-------------|----------------------------|---------------|--------------|------------------------------|
| 340      | Денежные средства в начале периода |             |                            | Чистая прибыль            | BB           | +Счет=\[1100:1110\]       |
| 370      | Денежные средства в начале года   | CAL         | @100+@330                  | Чистая прибыль            |              |                              |
| 400      | Денежные средства в начале периода | TOT         | 340+370                    |               |              |                              |

Когда строка в определении строки имеет код формата **CAL**, и вы вписываете математическое вычисление в ячейке **Связанные формулы/строки/единицы**, вы должны также вписать букву связанного столбца и строки в отчет. Например, введите **A.120** для представления столбца A, строки 120. Можно также использовать знак (@), чтобы указать все столбцы. Например, введите **@120** для представления всех столбцов в строке 120. Любое математическое вычисление, не имеющее буквы столбца или символа (@), рассматривается как действительное число.

> [!NOTE]
> Если вы используете метку кода строки, чтобы сослаться на строку, вы должны использовать точку (.) в качестве разделителя между буквой столбца и меткой (например, **A.GROSS\_MARGIN/A.SALES**). Если вы используете знак at (@), то разделитель не требуется (например, **@GROSS\_MARGIN/@SALES**).

### <a name="example-of-a-calculation-formula-for-a-specific-column"></a>Пример формулы вычисления для специфического столбца

В этом примере формула расчета **E=C.340** означает, что расчет в ячейке в столбце С, строке 340, выполняется только в столбце E.

> [!NOTE]
> При ссылке на столбец в формуле расчета знак "собаки" (@) не требуется.

| Код строки | Описание                 | Код формата | Связанные формулы/строки/единица | Управление печатью | Модификатор строк | Ссылка на финансовые аналитики |
|----------|-----------------------------|-------------|----------------------------|---------------|--------------|------------------------------|
| 340      | Наличные деньги на начало периода |             |                            | NP            | BB           | +Счет=\[1100:1110\]       |
| 370      | Наличные деньги на начало года   | CAL         | E=C.340                    | NP            |              |                              |
| 400      | Наличные деньги на начало периода | TOT         | 340+370                    |               |              |                              |

### <a name="modifying-a-number-in-selected-columns"></a>Изменение числа в выбранных столбцах

Когда вы изменяете число или вычисление в одном столбце определенной строки, но не хотите повлиять на другие столбцы в отчете, вы можете указать **CAL** (вычисление) в столбце **Код формата** определения строки.

- Для того, чтобы выполнить вычисление на всех столбцах отчета (**FD**), не вводите назначение столбца.
- Для того, чтобы ограничить формулу специфическими столбцами, впишите букву столбца, знак равенства (**=**), и после этого формулу.
- Вы можете определить множественные столбцы. Когда вы используете знак at (@) с специфическим размещением столбцов, знак at (@) относится к строке.
- Вы можете вписать множественные формулы столбца в одну строку. Формулы должны быть разделены запятыми.

### <a name="calculation-examples"></a>Пример расчета

| Расчет            | Действие, которое создано                                                                                                   |
|------------------------|--------------------------------------------------------------------------------------------------------------------------|
| @130\*,75              | Для каждого столбца значение в строке 130 умножено 0,75. Результат после этого положен в текущую строку каждого столбца. |
| B=@130\*,75            | Такое же вычисление выполнено только на столбце B.                                                                      |
| A,B,C=(@100/@130)\*,75 | A=(A.100/A.130)\*0,75 B=(B.100/B.130)\*0,75 C=(C.100/C.130)\*0,75                                                           |

### <a name="ifthenelse-statements-in-a-row-definition"></a>Операторы IF/THEN/ELSE в определении строки

Операторы **IF/THEN/ELSE** можно добавить к любому действительному вычислению и использовать с форматом **CAL**. Вы вводите формулы вычисления **IF/THEN/ELSE** в ячейке в столбец **Связанные формулы/строки/единицы**. Формулы вычисления **IF/THEN/ELSE** используют следующий формат: IF &lt;выражение истина/ложь&gt; THEN &lt;формула&gt; ELSE &lt;формула&gt; Часть выражения **ELSE &lt;формула&gt;** можно опустить.

#### <a name="if-statements"></a>Выражения IF

Выражение, которое следует на оператором **IF**, может быть любым выражение, которое можно оценить как истина или ложь. Выражение, которое следовать за оператором **IF**, может включить простую оценку, или может быть сложным выражением, которое может содержать множественные выражения. Далее приводятся некоторые примеры.

- **IF A.200&gt;0** (простая оценка)
- **IF A.200&gt;0 AND A.200&lt;10 000** (сложное выражение)
- **IF A.200&gt;10000 OR ((A.340/B.1200)\*2 &lt;1200)** (сложное выражение, содержащее несколько выражений)

Термин **Periods** в выражении **IF** относится к количеству периодов для отчета. Этот термин типично используется для того, чтобы высчитать среднее с начала года. Например, когда вы выполняете отчет для периода 7 YTD, выражение **B.150/Periods** значит, что значение в строке 150 столбца B разделено на 7.

#### <a name="then-and-else-formulas"></a>Формулы THEN и ELSE

Формулы **THEN** и **ELSE** могут являться любым действительным расчетом, от очень простых назначений значений до сложных формул. Например, выражение **IF A.200&gt;0 THEN A=B.200** означает «если значение в ячейке в столбце A строки 200 больше чем 0 (нуль), то положить значение из ячейки в столбце B строки 200 в ячейку в столбце A текущей строки». Предшествующее выражение **IF/THEN** помещает значение в один столбец текущей строки. Однако вы можете также использовать знак at (@) в оценках истина/ложь или формуле, чтобы представлять все столбцы. Вот некоторые другие примеры, которые описаны в следующих разделах:

- **IF A.200 &gt;0 THEN B.200**: Если значение в ячейке A.200 положительно, то значение из ячейки B.200 помещается в каждый столбец настоящей строки.
- **IF A.200 &gt;0 THEN @200**: Если значение в ячейке A.200 положительно, то значение из каждого столбца строки 200 помещается в соответствующий столбец настоящей строки.
- **IF @200 &gt;0 THEN @200**: Если значение в строке 200 настоящего столбца положительное, то значение из строки 200 положено в такой же столбец в настоящей строке.

### <a name="restricting-a-calculation-to-a-reporting-unit-in-a-row-definition"></a>Ограничить вычисление единицей отчетности в определении строки

Для того, чтобы ограничить вычисление одной единицей отчетности в дереве отчетности, чтобы итоговое количество не сворачивалось до единицы более высокого уровня, вы можете использовать код **@Unit** в ячейке **Связанные формулы/строки/единицы** в определении строки. Код **@Unit** перечислен в столбце B дерева отчетности, **Имя единицы**. Когда вы используете код **@Unit**, значения не сворачиваются, но вычисление оценивается на каждом уровне дерева отчетности.

> [!NOTE]
> Для использования этой функции аналитическая структура должна быть связана с определением строки.

Строка вычисления может сослаться к строку вычисления или на строку финансовых данных. Вычисление записано в ячейке **Связанные формулы/строки/единицы** определения строки и ограничения типа финансовых данных. Вычисление должно использовать условное вычисление, которое начинается с конструкции **IF @Unit**. Вот пример: IF @Unit(SALES) THEN @100 ELSE 0 Это вычисление включает сумму из строки 100 во все столбцы отчета, но только для единицы SALES. Если множественные единицы названы SALES, то сумма появляется в каждом из тех единиц. Дополнительно, строка 100 может быть строкой финансовых данных и может быть определена как не печатать. В этом случае, сумма предотвращается от появления во все блоках в дереве. Вы можете также ограничивать сумму одним столбцом отчета, например столбец H, путем использование ограничения столбца для того, чтобы напечатать значение только в этом столбце отчета. Вы можете включить комбинации **OR** в выражение **IF**. Вот пример: IF @Unit(SALES) OR @Unit(SALESWEST) THEN 5 ELSE @100 Вы можете определить единицу в ограничении типа вычисления одним следующих способов:

- Введите имя единицы, чтобы включить единицы, которые соответствуют. Например, **IF @Unit(SALES)** включает вычисление для любой единицы, которая назван SALES, даже если есть несколько единиц SALES в дереве отчетности.
- Впишите имя компании и единицы для того, чтобы ограничить вычисление специфическими единицами в специфической компании. Например, введите **IF @Unit(ACME:SALES**), чтобы ограничить вычисление единицами SALES в компании ACME.
- Введите полный код иерархии из дерева отчетности, чтобы ограничить вычисление определенной единицей. Например, введите **IF @Unit(SUMMARY^ACME^WEST COAST^SALES)**.

> [!NOTE]
> Чтобы найти код иерархии, щелкните правой кнопкой мыши в определении аналитической структуры и выберите **Копировать идентификатор блока отчета (H-код)**.

#### <a name="restrict-a-calculation-to-a-reporting-unit"></a>Ограничение вычисления элементом аналитической структуры

1. В конструкторе отчетов нажмите кнопку **Определения строк** и откройте изменяемое определение строки.
2. Выполните двойной клик ячейки **Код формата**, и после этого выберите **CAL**.
3. Щелкните ячейку **Связанные формулы/строки/единицы**, и после этого введите условное вычисление, которое начинается с конструкции **IF @Unit**.

### <a name="ifthenelse-statements-in-a-column-definition"></a>Операторы IF/THEN/ELSE в определении столбца

Оператор **IF/THEN/ELSE** позволяет любому вычислению зависеть от результатов из любого другого столбца. Вы можете сослаться к другие столбцы, но вы не можете сослаться на ячейку отчета в выражении **IF**. Любое вычисление необходимо применить к всему столбцу. Например, выражение **IF B&gt;100 THEN B ELSE C\*1,25** значит «если количество в столбце B больше чем 100, то положить значение из столбца B в столбец **CALC**. Если количество в столбце B не больше чем 100, то умножить значение в столбце C на 1,25, и положить результат в столбец **CALC**.» Всегда ставьте за выражением **IF** логическое выражение, которое можно оценить как истина или ложь. Формулы, которые вы используете и для выражения **THEN**, и для **ELSE** могут содержать ссылки на любое число столбцов, и эти формулы могут быть так сложны, как вам надо.

> [!NOTE]
> Поместить результаты вычисления в какой-либо другой столбец нельзя. Результаты должны находиться в столбце, который содержит формулу.

#### <a name="use-single-quotes-and-an-ampersand-for-dimension-values-in-a-row-column-or-tree"></a>Для значений аналитик в строках, столбцах или дереве используйте одинарные кавычки и амперсанд

Можно разработать отчеты, используя значения аналитик, содержащие амперсанд (&). 

В любом поле **Связь с финансовой аналитикой** можно ввести значение, например **'P&L'**. Включение одинарных кавычек (' ') на обеих сторонах значения аналитики указывает на то, что используется литеральное значение, например, включение знака амперсанда (&). 
