---
title: "Настройка электронной отчетности для переноса данных в Power BI"
description: "В этом разделе описывается, как можно использовать конфигурацию электронной отчетности (ER), чтобы настроить перенос данных из вашего экземпляра Finance and Operations в службы Power BI. В качестве примера в этом разделе используются проводки Интрастат как бизнес-данные, которые необходимо перенести. Визуализация карты Power BI использует эти данные о проводках Интрастат для представления анализа мероприятий импорта или экспорта компании в отчете Power BI."
author: NickSelin
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.translationtype: HT
ms.sourcegitcommit: 7e0a5d044133b917a3eb9386773205218e5c1b40
ms.openlocfilehash: 6be91dfc02b728ffdf0f9d3baf1d41d3d2c10fea
ms.contentlocale: ru-ru
ms.lasthandoff: 09/29/2017

---

# <a name="configure-electronic-reporting-to-pull-data-into-power-bi"></a>Настройка электронной отчетности для переноса данных в Power BI

[!include[banner](../includes/banner.md)]


В этом разделе описывается, как можно использовать конфигурацию электронной отчетности (ER), чтобы настроить перенос данных из вашего экземпляра Finance and Operations в службы Power BI. В качестве примера в этом разделе используются проводки Интрастат как бизнес-данные, которые необходимо перенести. Визуализация карты Power BI использует эти данные о проводках Интрастат для представления анализа мероприятий импорта или экспорта компании в отчете Power BI.

<a name="overview"></a>Обзор
--------

Microsoft Power BI представляет собой набор программных служб, приложений и соединителей, работающих вместе для превращения внешних источников данных в когерентные интерактивные знания с визуальным эффектом присутствия. Электронная отчетность (ER) позволяет пользователям Microsoft Dynamics 365 for Finance and Operations легко настраивать источники данных и организовывать перенос данных из Dynamics 365 for Finance and Operations в Power BI. Данные переносятся как файлы в формате листа OpenXML (файл книги Microsoft Excel). Перенесенные файлы хранятся на сервере Microsoft SharePoint Server, заданного для этой цели. Сохраненные файлов используются в Power BI для создания отчетов, которые включают визуализации (таблицы, диаграммы, карты и т. д.). Отчеты Power BI совместно используются пользователями Power BI, а доступ к ним возможен с панелей мониторинга Power BI и со страниц Finance and Operations. В этом раздел рассматриваются следующие задачи:

-   Настройка Finance and Operations.
-   Подготовка конфигурации формата ER для получения данных из Finance and Operations.
-   Настройка среды ER для переноса данных в Power BI.
-   Использование перенесенных данных для создания отчета Power BI.
-   Обеспечение доступа к отчету Power BI из Finance and Operations.

## <a name="prerequisites"></a>Необходимые условия
Для выполнения примера из этого раздела необходимы следующие возможности доступа:

-   Доступ к Finance and Operations для одной из следующих ролей:
    -   Разработчик электронной отчетности
    -   Консультант по функциональным возможностям электронной отчетности
    -   Системный администратор
-   Доступ к SharePoint Server, который настроен для использования с Finance and Operations
-   Доступ к платформе Power BI

## <a name="configure-document-management-parameters"></a>Настройка параметров управления документооборотом
1.  На странице **Параметры управления документами** настройте доступ к SharePoint Server, который будет использоваться в компании, в которую вы выполнили вход (компания DEMF в этом примере).
2.  Протестируйте подключение к SharePoint Server, чтобы убедиться, что вы получили доступ. [![Страница параметров управления документами](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)
3.  Откройте настроенный сайт SharePoint. Создайте новую папку, в которой ER будет хранить файлы Excel с бизнес-данными, которые требуются отчетам Power BI как наборы данных Power BI.
4.  В Finance and Operations на странице **Типы документов** создайте новый тип документа, который будет использоваться для получения доступа к папке SharePoint, только что созданной. Введите **Файл** в поле **Группа** и **SharePoint** в поле **Местоположение**, затем введите адрес папки SharePoint. [![Страница типов документов](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)

## <a name="configure-er-parameters"></a>Настройка параметров ER
1.  В рабочей области **Электронная отчетность** нажмите ссылку **Параметры электронной отчетности**.
2.  На вкладке **Вложения** выберите тип документа **Файл** для всех полей.
3.  В рабочей области **Электронная отчетность** сделайте необходимого поставщика активным, нажав **Установить как активное**. Для получения дополнительных сведений просмотрите руководство по задаче **ER Выбор поставщика услуг**.

## <a name="use-an-er-data-model-as-the-source-of-data"></a>Использование модели данных ER в качестве источника данных
Необходимо иметь модель данных ER в качестве источника бизнес-данных, которые будут использоваться в отчетах Power BI. Эта модель данных загружается из репозитория конфигураций ER. Дополнительные сведения см. в разделе [Загрузка конфигураций электронной отчетности из Lifecycle Services](download-electronic-reporting-configuration-lcs.md) или просмотрите руководство по задаче **ER Импорт конфигурации из Lifecycle Services** . Выбор **Интрастат** как модель данных, которая будет загружена из выбранного репозитория конфигураций ER. (В этом примере используется версия 1 модели.) Затем можно получить доступ к конфигурации модели ER **Интрастат** на странице **Конфигурации**. [![Страница конфигураций](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)

## <a name="design-an-er-format-configuration"></a>Создание конфигурации формата ER
Необходимо создать новую конфигурацию формата ER, которая использует модель данных **Интрастат** в качестве источника бизнес-данных. Эта конфигурация формата должна создавать выходные результаты в виде электронных документов в формате OpenXML (файл Excel). Для получения дополнительных сведений просмотрите руководство по задаче **ER Создание конфигурации для отчетов в формате OPENXML**. Назовите новую конфигурацию **Мероприятия импорта или экспорта**, как показано на следующем рисунке. Используйте Excel-файл [Данные ER — сведения импорта и экспорта](https://go.microsoft.com/fwlink/?linkid=845208) в качестве шаблона при проектировании формат ER. (Сведения о том, как импортировать шаблон формата, см. в руководстве по задаче.) [![Конфигурация мероприятий импорта и экспорта](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png) Для изменения конфигурации формата **Мероприятия импорта или экспорта** выполните следующие действия.

1.  Выберите **Конструктор**.
2.  На вкладке **Формат** задайте имя элемента файла для данного формата **Выходной файл Excel**. [![Элемент выходного файла Excel](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)
3.  На вкладке **Сопоставление** укажите имя файла Excel, который будет создавать каждый раз при выполнении этого формата. Настройте связанное выражение для возврата значения **Данные импорта и экспорта** (расширения имени файла XLSX будет добавлено автоматически). [![Конструктор форматов](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)
4.  Добавьте новый элемент источника данных для данного формата. (Это перечисление необходимо для дальнейшего связывания данных.)
    1.  Назовите этот источник данных **direction\_enum**.
    2.  Выберите **Перечисление модели данных** как тип источника данных.
    3.  Задайте ссылку на перечисление модели данных **Направление**.

    [![direction\_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)
5.  Завершите привязку элементов модели данных **Интрастат** и элементов созданного формата, как показано на следующем рисунке. [![Завершение привязки](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)

После выполнения формат ER создает выходной результат в формате Excel. Он отправляет сведения проводок Интрастат в выходной результат и делит их как проводки, которые описывают мероприятия импорта или мероприятия экспорта. Нажмите **Выполнить**, чтобы проверить новый формат ER для списка проводок Интрастат на странице **Интрастат** (**Налог** &gt; **Декларации** &gt; **Внешняя торговля** &gt; **Интрастат**). [![Страница Интрастат](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png) Создается следующий выходной результат. Файла называется **Сведения об импорте и экспорте.xlsx**, как указано в настройках формата. [![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)

## <a name="configure-the-er-destination"></a>Настройка места назначения ER
Необходимо настроить платформу ER для отправки выходного результата новой конфигурации формата ER особенным способом.

-   Выходной результат необходимо отправить в папку выбранного SharePoint Server.
-   Каждое выполнение конфигурации формата должно создавать новую версию того же файла Excel.

На странице **Электронная отчетность** (**Управление организацией** &gt; **Электронная отчетность**), нажмите пункт **Место назначения электронной отчетности** и добавьте новое местоположение. В поле **Ссылка** выберите конфигурацию формата **Мероприятия импорта или экспорта**, созданную ранее. Выполните следующие шаги для добавления записи назначения нового файла для ссылки.

1.  В поле **Имя** введите заголовок места назначения файла.
2.  В поле **Имя файла** выберите имя **Выходной файл Excel** для компонента формата файла Excel.

Нажмите кнопку **Настройки** для новой записи назначения. Затем в диалоговом окне **Параметры места назначения** выполните следующие действия.

1.  На вкладке **Power BI** задайте для параметра **Включено** значение **Да**.
2.  В поле **SharePoint** выберите тип документов **Общие**, созданный ранее.

## <a name="schedule-execution-of-the-configured-er-format"></a>Планирование выполнения настроенного формата ER
На странице **Конфигурации** (**Управление организацией** &gt; **Электронная отчетность** &gt; **Конфигурации**) в дереве конфигураций выберите конфигурацию **Мероприятия импорта или экспорта**, созданную ранее. Измените статус версии 1.1 с **Черновик** на **Завершено**, чтобы этот формат стал доступным для использования. [![Страница "Конфигурации"](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png) Выберите завершенную версию конфигурации **Мероприятия импорта или экспорта**, затем нажмите **Выполнить**. Обратите внимание, что настроенное место назначения применяется к выходному результату, создаваемому в формате Excel. Задайте для параметра **Пакетная обработка** значение **Да**, чтобы выполнить этот отчет в режиме, не требующем участия пользователя. Нажмите **Повторение** для планирования необходимого повторения этого пакетного выполнения. Повторение определяет, как часто обновленные данные будут перемещаться из Finance and Operations в Power BI. [![Диалоговое окно "Параметры электронного отчета"](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png) После настройки задание выполнения отчета ER можно найти на странице **Пакетные задания** (**Администрирование системы &gt; Запросы &gt; Пакетные задания**). [![Страница "Пакетные задания"](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png) Когда это задание запускается впервые, место назначения создает новый файл Excel с настроенным именем в выбранной папке SharePoint. При каждом последующем выполнении этой задачи место назначения создает новую версию этого файла Excel. [![Новая версия файла Excel](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)

## <a name="create-a-power-bi-dataset-by-using-the-output-result-of-the-er-format"></a>Создание набора данных Power BI с помощью выходного результата формата ER
Выполните вход в Power BI и откройте существующую группу Power BI (рабочую область) или создайте новую группу. Нажмите **Добавить** под полем **Файлы** в разделе **Импорт или подключение с данными** или нажмите значок "плюс" (**+**) рядом с **Наборы данных** в левой области. [![Создание набора данных](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png) Выберите параметр **SharePoint — сайты рабочих групп**, затем введите путь SharePoint Server, используемый вами (**https://ax7partner.litware.com** в нашем примере). Затем перейдите к папке **/Shared Documents/GER data/PowerBI** и выберите файл Excel, созданный в качестве источника данных для нового набора данных Power BI. [![Выбор файла Excel](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png) Щелкните **Подключить**, затем щелкните **Импорт**. Новый набор данных создается, основанный на выбранном файле Excel. Набор данных можно также добавить автоматически к вновь созданной панели мониторинга. [![Набор данных на панели мониторинга](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png) Настройте график обновления для данного набора данных, чтобы использовать принудительное периодическое обновление. Периодические обновления обеспечивает потребление новых бизнес-данных, поступающих из Finance and Operations, путем периодического выполнения отчета с новыми версиями файла Excel, созданных в SharePoint Server.

## <a name="create-a-power-bi-report-by-using-the-new-dataset"></a>Создание отчета Power BI. используя новый набор данных
Для создания нового отчета Power BI нажмите созданный вами набор данных Power BI **Сведения об импорте и экспорте**. Затем настройте визуализацию. Например, выберите визуализацию **Картограмма** и настройте ее следующим образом:

-   Назначьте поле **CountryOrigin** набора данных полю **Местоположение** визуализации карты.
-   Назначьте поле **Amount** набора данных полю **Насыщенность цвета** визуализации карты.
-   Добавьте поля **Мероприятие** и **Год** набора данных в коллекцию полей **Фильтры** визуализации карты.

Сохраните отчет Power BI как **Отчет со сведениями об импорте и экспорте**. [![Отчет со сведениями об импорте и экспорте](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png) Обратите внимание, что карта показывает страны или регионы, упоминаемые в файле Excel (Австрия и Швейцария в этом примере). Эти страны или регионы покрашены, чтобы показать пропорции сумм по накладным для каждого. Обновите список проводок Интрастат. Проводки экспорта из Италии добавляются. [![Список проводок Интрастат](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png) Подождите следующего запланированного выполнения отчета ER и следующего запланированного обновления набора данных Power BI. Затем просмотрите отчет Power BI (выберите отображение только проводок импорта). На обновленной карте теперь отображается Италия. [![Обновленная карта](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)

## <a name="access-power-bi-report-in-finance-and-operations"></a>Доступ к отчету Power BI из Finance and Operations
Настройте интеграцию между Finance and Operations и Power BI. Для получения дополнительных сведений см. раздел [Настройка интеграции Power BI для рабочих областей](configure-power-bi-integration.md). На странице рабочей области **Электронная отчетность**, которая поддерживает интеграцию Power BI (**Управление организацией** &gt; **Рабочие области** &gt; **Рабочая область электронной отчетности**) щелкните **Параметры** &gt; **Открытие каталога отчетов**. Выберите созданный вами отчет Power BI **Сведения об импорте и экспорте**, чтобы показать этот отчет как пункт действий на выбранной странице. Нажмите на пункт действия, чтобы открыть страницу Finance and Operations, на которой отображается отчет, созданный в Power BI. [![Отчет со сведениями об импорте и экспорте](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)

<a name="see-also"></a>См. также
--------

[Места назначения электронной отчетности](electronic-reporting-destinations.md)

[Обзор электронной отчетности](general-electronic-reporting.md)




