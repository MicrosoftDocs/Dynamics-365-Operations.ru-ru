---
title: "Использование надстройки Excel"
description: "В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Office для Excel."
author: ChrisGarty
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 7e0a5d044133b917a3eb9386773205218e5c1b40
ms.openlocfilehash: 06fc9f8dda83fddea9ae331bb82c8874b15d76b9
ms.contentlocale: ru-ru
ms.lasthandoff: 09/29/2017

---

# <a name="use-the-excel-add-in"></a>Использование надстройки Excel

[!include[banner](../includes/banner.md)]


В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Office для Excel. Чтобы открыть данные объекта, можно начать из Excel или из Microsoft Dynamics 365 for Finance and Operations, Enterprise edition.

Открыв данные объекта в Microsoft Excel, можно быстро и легко просматривать и изменять эти данные с помощью надстройки Microsoft Dynamics Office для Excel. Для этой надстройки требуется Microsoft Excel 2016. **Примечание.** Если ваш владелец Microsoft Azure Active Directory (Azure AD) настроен на использование служб федерации Active Directory (ADFS), необходимо убедиться, что применено обновления за май 2016 г., чтобы надстройка Excel можно правильно выполнить вход.

## <a name="open-entity-data-in-excel-when-you-start-from-dynamics-365-for-finance-and-operations"></a>Открытие данных объекта в Excel при запуске из Dynamics 365 for Finance and Operations
1.  На странице в Microsoft Dynamics 365 for Finance and Operations щелкните **Открыть в Microsoft Office**. Если корневой источнику данных (таблица) для страницы совпадает с корневым источником данных для любых объектов, для этой страницы создаются параметры по умолчанию **Открыть в Excel**. Параметры **Открыть в Excel** можно найти на часто используемые страницах, таких как **Все поставщики** и **Все клиенты**.
2.  Щелкните параметр **Открыть в Excel** и откройте созданную книгу. Эта книга содержит сведения о привязке для объекта, указатель на вашу среду и указатель на надстройку Excel.
3.  В Excel щелкните **Разрешить редактирование**, чтобы разрешить работу надстройки Excel. Надстройка Excel выполняется в области в правой части окна Excel.
4.  Если вы используете надстройку Excel в первый раз, нажмите кнопку **Доверять этой надстройке**.
5.  Если появится запрос на вход, нажмите кнопку **Войти** и войдите в систему, используя те же учетные данные, которые используются для входа в систему Dynamics 365 for Finance and Operations. Надстройка Excel будет использовать предыдущий контекст входа из браузера Internet Explorer и автоматически выполнит вход, если это возможно. Поэтому проверьте имя пользователя в правом верхнем углу надстройки Excel.

Надстройка Excel автоматически считывает данные для выбранного вами объекта. Обратите внимание, что в книге не будет никаких данных, пока надстройка Excel не считает их.

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>Открытие данных объекта в Excel при запуске из Excel
1.  В Excel на вкладке **Вставка** в группе **Надстройки** щелкните **Магазин**, чтобы открыть Магазин Office.
2.  В Магазине Office выполните поиск по ключевому слову "Dynamics" и нажмите кнопку **Добавить** рядом с пунктом **Microsoft Dynamics Office Add-in** (надстройка Excel).
3.  Если вы используете надстройку Excel в первый раз, нажмите кнопку **Доверять этой надстройке**, чтобы разрешить запуск этой надстройки Excel. Надстройка Excel выполняется в области в правой части окна Excel.
4.  Щелкните **Добавить сведения о сервере** чтобы открыть панель **Параметры**.
5.  Скопируйте URL-адрес браузера из целевого экземпляра Dynamics 365 for Finance and Operations, вставьте его в поле **URL-адрес сервера**, затем удалить все элементы после имени узла. Полученный URL-адрес должен содержать только имя узла.
Например, если URL-адрес имеет вид https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage, удалите все, кроме **https://xxx.dynamics.com**.
6.  Щелкните **ОК**, затем нажмите кнопку **Да**, чтобы подтвердить изменение. Надстройка Excel перезагружается и загружает метаданные. Теперь доступна кнопка **Дизайн**. Если в надстройке Excel имеется кнопка **Загрузить приложения**, возможно, что выполнен вход с неправильным пользователем. Дополнительные сведения см. в пункте "Отображается кнопка загрузки приложения" в разделе "Устранение неполадок" в этом разделе.
7.  Щелкните **Дизайн**. Надстройка Excel извлекает метаданные объекта.
8.  Щелкните **Добавить таблицу**. Отображается список объектов. Объекты перечислены в формате «Имя — Метка».
9.  Выберите объект в списке, например **Клиент - клиенты** и нажмите кнопку **Далее**.
10. Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, щелкните это поле и нажмите кнопку **Добавить**. Можно также дважды щелкнуть это поле.
11. После завершения добавления полей в список **Выбранные поля** убедитесь в том, что курсор находится в нужном месте на листе (например, в ячейке A1), затем нажмите **Готово**. Затем для закрытия конструктора щелкните **Готово**.
12. Щелкните **Обновить** для извлечения набора данных.

## <a name="view-and-update-entity-data-in-excel"></a>Просмотр и обновление данных объекта в Excel
После того как надстройка Excel считает данные объекта в книгу, можно обновить данные в любое время, щелкнув **Обновить** в надстройке Excel.

## <a name="edit-entity-data-in-excel"></a>Изменение данных объекта в Excel
Можно внести требуемые изменения в данные объекта ,и затем опубликовать их обратно, нажав кнопку **Опубликовать** в надстройке Excel. Чтобы изменить запись, выберите ячейку на листе, затем измените значение ячейки. Чтобы добавить новую запись, выполните одно из следующих действий:

-   Щелкните в любом месте таблице источников данных, затем нажмите кнопку **Создать** в надстройке Excel.
-   Щелкните в последней строке таблицы источников данных, затем нажимайте клавишу Tab, пока курсор не выйдет за последний столбец этой строки и не будет создана новая строка.
-   Щелкните в строке сразу под таблицей источников данных и начните вводить данные в ячейку. Когда пользователь перемещает фокус из этой ячейки, таблица расширяется для включения новой строки.
-   Для привязки поля заголовка записей выберите одно из полей и нажмите кнопку **Создать** в надстройке Excel.

Обратите внимание, что новые записи могут быть созданы только в том случае, если все ключевые и обязательные поля привязаны на листе или если значения по умолчанию были заполнены с помощью условия фильтра.
Чтобы удалить запись, выполните одно из следующих действий:

-   Щелкните правой кнопкой мыши номер строки рядом с удаляемой строкой листа и нажмите кнопку **Удалить**.
-   Щелкните правой кнопкой мыши в удаляемой строке листа, затем щелкните **Удалить** &gt; **Строки таблицы**.
Если источники данных были добавлены как связанные, заголовок публикуется перед строками. При наличии зависимостей между другими источниками данных может потребоваться изменить используемый по умолчанию порядок публикации. Чтобы изменить порядок публикации, в надстройке Excel нажмите кнопку **Параметры** (символ шестеренки). Затем на экспресс-вкладке **Соединитель данных** щелкните **Настройка порядка публикации**.

## <a name="add-or-remove-columns"></a>Добавить или удалить столбцы
Конструктор можно использовать для настройки столбцов, которые автоматически добавляются на лист.

1.  Запустите конструктор источника данных надстройки Excel, нажав кнопку **Параметры** (символ шестеренки), затем установив флажок **Включить разработку**.
2.  Щелкните **Дизайн** в надстройке Excel. Перечисляются все источники данных.
3.  Рядом с источником данных, нажмите кнопку **Изменить** (символ карандаша).
4.  Настройте требуемым образом список в списке **Выбранные поля**:
    -   Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, щелкните это поле и нажмите кнопку **Добавить**. Можно также дважды щелкнуть это поле.
    -   Чтобы удалить поле из списка **Выбранные поля**, щелкните это поле, затем щелкните **Удалить**. Можно также дважды щелкнуть это поле.
    -   Чтобы изменить порядок полей, щелкните поле в списке **Выбранные поля**, щелкните поле, затем щелкайте кнопку **Вверх** или **Вниз**.

5. Чтобы применить изменения к источнику данных, щелкните **Обновить**. Затем для закрытия конструктора щелкните **Готово**. 
6. Если было добавлено поле (столбец), нажмите кнопку **Обновить**, чтобы извлечь обновленный набор данных.

## <a name="troubleshooting"></a>Устранение неполадок
Существует несколько проблем, которые можно разрешить некоторыми простыми действиями.

-   **Отображается кнопка загрузки приложений.** Если после входа в надстройке Excel имеется кнопка **Загрузить приложения**, возможно, что выполнен вход с неправильным пользователем. Чтобы устранить эту проблему, поверьте, правильное ли имя пользователя отображается в правом верхнем углу надстройки Excel. Если отображаются неправильное имя, щелкните его, выполните выход, затем выполните вход.
-   **Вы получаете сообщение "Запрещено".** Если появляется сообщение "Запрещено", когда надстройка Excel загружает метаданные, учетная запись, с который выполнен вход в надстройку Excel, не имеет разрешения на использование целевой службы, экземпляра или базы данных. Чтобы устранить эту проблему, поверьте, правильное ли имя пользователя отображается в правом верхнем углу надстройки Excel. Если отображаются неправильное имя, щелкните его, выполните выход, затем выполните вход.
-   **Пустая веб-страница отображается над Excel.** Если в процессе входа открывается пустая веб-страница, для учетной записи требуются службы AD FS, но версии Excel, в которой выполняется надстройка, слишком старая для загрузки диалогового окна входа. Чтобы решить эту проблему, обновите версию Excel, которую вы используете. Чтобы обновить версию Excel, находясь в предприятии, которое находится в отложенном канале, используйте [Средство развертывания Office](https://technet.microsoft.com/library/jj219422.aspx) для [перехода из отложенного канала в текущий канал](https://technet.microsoft.com/library/mt455210.aspx).





