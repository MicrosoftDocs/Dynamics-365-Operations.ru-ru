---
title: Учебник по использованию средства Regression Suite Automation Tool
description: В этом разделе показано, как использовать средство Regression Suite Automation Tool (RSAT). В нем описываются различные функции и приводятся примеры использования расширенного сценария.
author: kfend
manager: AnnBe
ms.date: 06/09/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 21761
ms.search.region: Global
ms.author: kfend
ms.search.validFrom: 2017-06-30
ms.dyn365.ops.version: AX 7.0.0, Operations
ms.openlocfilehash: 02933c1649960a4fb58953798799422528d6731d
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/02/2019
ms.locfileid: "1850835"
---
# <a name="use-the-regression-suite-automation-tool-tutorial"></a>Учебник по использованию средства Regression Suite Automation Tool

[!include [banner](../includes/banner.md)]

> [!NOTE]
> Загрузите и сохраните эту страницу в формате PDF с помощью средств веб-браузера. 

В этом учебнике представлено несколько дополнительных функций средства Regression Suite Automation Tool (RSAT), включается демонстрационное назначение, а также описываются стратегия и ключевые моменты обучения.

## <a name="features-of-rsattask-recorder"></a>Функции RSAT/регистратора задач

### <a name="validate-a-field-value"></a>Проверка значения поля

Дополнительные сведения об этой функции см. в разделе [Создание новой записи задачи с функцией проверки](./hol-set-up-regression-suite-automation-tool.md#create-a-new-task-recording-that-has-a-validate-function).

### <a name="saved-variable"></a>Сохраненная переменная

Дополнительные сведения об этой функции см. в разделе [Изменение существующей записи задачи для создания сохраненной переменной](./hol-set-up-regression-suite-automation-tool.md#modify-an-existing-task-recording-to-create-a-saved-variable).

### <a name="derived-test-case"></a>Производный тестовый случай

1. Откройте средство Regression Suite Automation Tool (RSAT) и выберите оба тестовых случая, созданных в разделе [Настройка и установка средства Regression Suite Automation Tool](./hol-set-up-regression-suite-automation-tool.md).
2. Выберите **Создать \> Создать производный тестовый случай**.

    ![Команда создания производного тестового случая в меню создания](./media/use_rsa_tool_01.png)

3. Появится сообщение о том, что для каждого выбранного тестового случая в текущем наборе тестов будет создан производный тестовый случай, и что каждый производный тестовый случай будет иметь собственную копию файла параметров Excel. Нажмите **ОК**.

    > [!NOTE]
    > При выполнении производного тестового случая он использует запись задачи своего родительского тестового случая и собственную копию файла параметров Excel. Таким образом можно выполнить один и тот же тест с другими параметрами без необходимости поддержки более одной записи задачи. Производный тестовый случай не обязательно должен входить в тот же набор тестов, что и его родительский тестовый случай.

    ![Окно сообщения](./media/use_rsa_tool_02.png)

    Создаются два дополнительных производных тестовых случая, и для них установлен флажок **Производный?**.

    ![Созданные производные тестовые случаи](./media/use_rsa_tool_03.png)

    Производный тестовый случай создается автоматически в Azure DevOps. Он является дочерним элементом тестового случая **Создание нового продукта** и помечается с помощью специального ключевого слова: **RSAT:DerivedTestSteps**. Эти тестовые случаи также автоматически добавляются в план испытаний в Azure DevOps.

    ![Ключевое слово RSAT:DerivedTestSteps](./media/use_rsa_tool_04.png)

    > [!NOTE]
    > Если по какой-либо причине производные тестовые случаи, которые были созданы, не находятся в нужном порядке, перейдите в Azure DevOps и измените порядок тестовых случаев в наборе тестов, чтобы RSAT мог выполнять их в нужном порядке.

4. Выберите производные тестовые случаи, затем выберите **Правка**, чтобы открыть соответствующие файлы параметров Excel.
5. Отредактируйте файлы параметров Excel так же, как и в случае редактирования родительских файлов. Иными словами, убедитесь, что код продукта настроен таким образом, чтобы он был создан автоматически. Кроме того, убедитесь, что сохраненная переменная скопирована в соответствующие поля.
6. На вкладке **Общие** в обоих файлах параметров Excel обновите значение поля **Компания** на **USSI**, чтобы производные тестовые случаи запускались для другого юридического лица, отличного от родительского тестового случая. Для выполнения тестовых случаев для конкретного пользователя (или роли, связанной с конкретным пользователем) можно обновить значение в поле **Тестовый пользователь**.
7. Выберите **Выполнить**и убедитесь, что продукт создан как в юридическом лице USMF, так и в юридическом лице USSI.

### <a name="validate-notifications"></a>Проверка уведомлений

Эта функция может использоваться для проверки, произошло ли действие. Например, когда производственный заказ создается, оценивается, а затем запускается, отображается сообщение Microsoft Dynamics 365 for Finance and Operations "Производство — начало", уведомляющее о запуске производственного заказа.

![Уведомление "Производство — начало"](./media/use_rsa_tool_05.png)

Вы можете проверить это сообщение через RSAT, вводя текст сообщения на вкладке **MessageValidation** файла параметров Excel для соответствующей записи.

![Вкладка проверки сообщения](./media/use_rsa_tool_06.png)

После запуска тестового случая сообщение в файле параметров Excel сравнивается с сообщением, отображаемым в Finance and Operations. Если сообщения не совпадают, тестовый случай будет неудачным.

> [!NOTE]
> На вкладке **MessageValidation** в файле параметров Excel можно ввести более одного сообщения. Сообщения также могут быть сообщениями об ошибках или предупреждениями, а не информационными сообщениями.

### <a name="validate-values-by-using-operators"></a>Проверка значений с помощью операторов

В предыдущих версиях RSAT можно было проверять значения только в том случае, если значение элемента управления равно ожидаемому значению. Новая функция позволяет проверять, что переменная не равна, меньше или больше, чем заданное значение.

- Для использования этой функции откройте файл **Microsoft.Dynamics.RegressionSuite.WindowsApp.exe.config** в папке установки RSAT (например, **C:\\Program Files (x86)\\Regression Suite Automation Tool**) и измените значение в следующем элементе с **false** на **true**.

    ```
    <add key="AddOperatorFieldsToExcelValidation" value="false" />
    ```

    В файле параметров Excel появится новое поле **Оператор**.

    > [!NOTE]
    > Если использовалась старая версия RSAT, необходимо создать новые файлы параметров Excel.

    ![Поле оператора](./media/use_rsa_tool_07.png)

В следующем примере показано, как можно использовать эту функцию для проверки того, что запасы в наличии больше 0 (нуля).

1. В демонстрационных данных компании **USMF** создайте запись задачи, которая имеет следующие шаги:

    1. Выберите **Управление сведениями о продукте \> Продукты \> Выпущенные продукты**.
    2. Используйте экспресс-фильтр для поиска записей. Например, отфильтруйте по значению **1000** поле **Номер номенклатуры**.
    3. Выберите **Запасы в наличии**.
    4. Используйте экспресс-фильтр для поиска записей. Например, отфильтруйте поле **Сайт** по значению **1**.
    5. В списке пометьте выбранную строку.
    6. Убедитесь, что значение поля **Доступное общее количество** равно **411,0000000000000000**.

2. Сохраните запись задачи в библиотеке BMP в службах LCS и синхронизируйте ее с Azure DevOps.
3. Добавьте тестовый случай в план испытаний и загрузите тестовый случай в RSAT.
4. Откройте файл параметров Excel. На вкладке **InventOnhandItem** будет показан раздел **Проверить InventOnhandItem**, содержащий поле **Оператор**.

    ![Поле оператора](./media/use_rsa_tool_08.png)

5. Чтобы убедиться, что запасы в наличии всегда будут больше 0, измените значение в поле **Значение** с **411** на **0** и значение поля **Оператор** со знака равенства (**=**) на знак больше (**\>**).

    ![Изменены значения полей "Значение" и "Оператор"](./media/use_rsa_tool_09.png)

6. Сохраните и закройте файл параметров Excel.
7. Выберите **Отправить**, чтобы сохранить изменения, внесенные в файл параметров Excel, в Azure DevOps.

Теперь если в поле **Доступное общее количество** для указанной номенклатуры в складских запасах значение больше 0 (нуля), тест проходит успешно, независимо от фактического значения запасов в наличии.

### <a name="generator-logs"></a>Журналы генератора

Эта функция создает папку, содержащую журналы тестовых случаев, которые были запущены.

- Для использования этой функции откройте файл **Microsoft.Dynamics.RegressionSuite.WindowsApp.exe.config** в папке установки RSAT (например, **C:\\Program Files (x86)\\Regression Suite Automation Tool**) и измените значение в следующем элементе с **false** на **true**.

    ```
    <add key="LogGeneration" value="false" />
    ```

После запуска тестовых случаев можно найти файлы журнала в папке **C:\\Users\\\<Username\>\\AppData\\Roaming\\regressionTool\\generatorLogs**.

![Папка GeneratorLogs](./media/use_rsa_tool_10.png)

> [!NOTE]
> Если перед изменением значения в файле. config были существующие тестовые случаи, журналы для этих тестовых случаев не создаются до тех пор, пока не будут созданы новые файлы выполнения тестов.
> 
> ![Команда создания только файлов выполнения тестов в меню создания](./media/use_rsa_tool_11.png)

### <a name="snapshot"></a>Моментальный снимок

Эта функция делает снимки экрана шагов, которые были выполнены во время записи задачи.

- Для использования этой функции откройте файл **Microsoft.Dynamics.RegressionSuite.WindowsApp.exe.config** в папке установки RSAT (например, **C:\\Program Files (x86)\\Regression Suite Automation Tool**) и измените значение следующего элемента с **false** на **true**.

    ```
    <add key="VerboseSnapshotsEnabled" value="false" />
    ```

В папке **C:\\Users\\\<Имя_пользователя\>\\AppData\\Roaming\\regressionTool\\playback** для каждого выполняемого тестового случая создается отдельная папка.

![Папка моментальных снимков для тестового случая](./media/use_rsa_tool_12.png)

В каждой из этих папок можно найти снимки шагов, которые были выполнены во время выполнения тестовых случаев.

![Файлы моментальных снимков](./media/use_rsa_tool_13.png)

## <a name="assignment"></a>Назначение

### <a name="scenario"></a>Сценарий

1. Конструктор продуктов создает новый выпущенный продукт.
2. Менеджер производства запускает производственный заказ, чтобы восстановить уровень запасов в две единицы.
3. Производство начинается и завершает производственный заказ, и проверяет, что количество в наличии равно двум единицам.
4. Группа продавцов получает заказ на четыре единицы нового продукта. Поэтому группа продаж обновляет чистые потребности с помощью динамического плана. Поскольку дополнительные мощности отсутствуют, для политики заказа по умолчанию устанавливается значение "купить вместо создания". Поэтому создается спланированный заказ на покупку.
5. Покупатель добавляет поставщика, подтверждает запланированный заказ на покупку, затем утверждает заказ на покупку.
6. Когда купленные товары поступают в магазин, оператор магазина выполняет поиск товаров соответствующих заказов на покупку и получает товары. Так как заказ готов, товары могут комплектоваться и упаковываться по заказу на продажу.
7. Финансовый отдел выполняет разноску накладной по покупке и накладной по продаже.

На следующем рисунке показана последовательность операций для этого сценария.

![Последовательность операций для демонстрационного сценария](./media/use_rsa_tool_14.png)

На следующем рисунке показаны бизнес-процессы для этого сценария в RSAT.

![Бизнес-процессы для демонстрационного сценария](./media/use_rsa_tool_15.png)

## <a name="strategy--key-learning"></a>Стратегия — ключевое обучение

### <a name="data"></a>Данные

- Убедитесь в том, что имеются репрезентативные объемы данных (копия производственных/золотых данных конфигурации и перенесенные данные).
- При создании новых данных с помощью регистратора задач создайте имена тестов, которые не будут конфликтовать с существующими именами (например, используйте префикс, такой как **RSATxxx**).
- Для повторного выполнения тестов в средах без уровней 1 используйте функцию восстановление на момент времени Azure.
- Хотя можно использовать функции Excel **RANDOM** и **NOW** для создания уникальной комбинации, усилия весьма высоки. Рассмотрим пример:

    ```
    product = "AT" &TEXT(NOW(),"yyymmddhhmm")
    ```

### <a name="task-recorder"></a>Регистратор задач

- Прежде чем начать запись, определите сценарии. Хорошо управляемый проект имеет предопределенные сценарии тестирования. Чтобы создать тестовый случай, необходимо оценить, насколько предсказуемым являются результаты этих сценариев тестирования.
- Разделите записи, если они выполняются другими ролями, или если имеется время ожидания или внешнее событие до следующего шага.
- Не следует выбирать значения в списках. Вместо этого используйте текстовые форматы, такие как **FIFO**, **AudioRM** и **SiteWH**. При выборе в списке записывается позиция значения в списке, а не само значение. Если в этот список добавлены элементы, положение значения может измениться Поэтому запись будет использовать другой параметр, и остальная часть сценария может быть изменена.
- Подумайте о поведении нескольких пользователей. Например, не следует предполагать, что вновь созданный заказ на продажу всегда будет выбран автоматически. Вместо этого для поиска правильного заказа обязательно следует использовать фильтр.
- Используйте функцию копирования в регистраторе задач для сохранения имени вновь созданного продукта, чтобы его можно было использовать в связанных тестовых случаях.
- Используйте функцию проверки в регистраторе задач для установки контрольных точек, которые проверяют правильность выполнения шагов.

### <a name="rsat"></a>RSAT

- Чтобы выполнить тест в другой компании, можно изменить эту компанию на вкладке **Общие** файла параметров Excel. Убедитесь, что параметры и данные доступны в новой выбранной компании.
- Тестового пользователя можно изменить на вкладке **Общие** файла параметров Excel. Укажите код электронной почты пользователя, который будет выполнять тестовый случай. Таким образом, тестовый случай может быть выполнен с помощью разрешений безопасности указанного пользователя.
- Чтобы подождать, пока начнется тест, можно определить паузу на вкладке **Общие** файла параметров Excel. Эта пауза может использоваться в пакетном задании (например, если рабочий процесс должен выполняться до того, как будет выполнен следующий шаг).

## <a name="advanced-scripting"></a>Дополнительные сценарии

### <a name="command-line"></a>Командная строка

RSAT можно вызывать из окна **Командная строка**.

> [!NOTE]
> Убедитесь, что для переменной среды **TestRoot** установлен путь установки RSAT. (В Microsoft Windows откройте **Панель управления**, выберите пункт **Система и безопасность \> Система \> Дополнительные параметры системы**, затем выберите **Переменные среды**.)

1. Откройте окно **Командная строка** от имени администратора.
2. Запустите средство из каталога установки.

    ```
    cd "c:\Program Files (x86)\Regression Suite Automation Tool\"
    ```

3. Выведите список всех команд.

    ```
    C:\Program Files (x86)\Regression Suite Automation Tool>Microsoft.Dynamics.RegressionSuite.ConsoleApp.exe help

    Usage:
        Microsoft.Dynamics.RegressionSuite.ConsoleApp.exe command
        or
        Microsoft.Dynamics.RegressionSuite.ConsoleApp.exe /settings "C:\Path to\file.settings" command

    Available commands:
        list
        listtestsuite suite_name
        download test_case_id output_dir
        generate test_case_id output_dir
        generatederived parent_test_case_id test_plan_id test_suite_id
        generatetestonly test_case_id output_dir
        edit excel_file
        playback excel_file
        playbackmany excel_file1 [excel_file2 [.. excel_fileN]]
        playbackbyid test_case_id1 [test_case_id2 [.. test_case_idN]]
        playbacksuite suite_name
        clear
        help
        about
        quit
    ```

### <a name="windows-powershell-examples"></a>Примеры Windows PowerShell

#### <a name="run-a-test-case-in-a-loop"></a>Выполнение тестового случая в цикле

Имеется тестовый сценарий, создающий нового клиента. С помощью сценариев этот тестовый случай можно выполнить в цикле путем случайного выбора следующих данных перед выполнением каждой итерации:

- Код клиента
- Наименование Клиента
- Адрес клиента

Код клиента будет иметь формат *ATCUS\<номер\>*, где \<номер\> представляет собой значение в диапазоне от **000000001** до **999999999**.

В следующем примере для определения первого используемого номера используется один параметр, **start**. Второй параметр **nr** служит для определения числа клиентов, которые должны быть созданы. Для каждой итерации параметры в файле параметров Excel изменяются с помощью функции UpdateCustomer. После этого командная строка RSAT вызывается в функции RunTestCase.

Откройте интегрированную среду сценариев Microsoft Windows PowerShell (ISE) в режиме администратора и вставьте следующий код в окно с именем **Untitled1.ps1**.

```
param ( [int]$start = 1, [int]$nr = 1 )
function UpdateCustomer
{
    param ([string]$paramFilename, [string]$sheetName, [string]$CustId)
    $xl = New-Object -COM "Excel.Application"
    $xl.Visible = $false
    $wb = $xl.Workbooks.Open($paramFilename)
    $ws = $wb.Sheets.Item($sheetName)
    $ws.Cells.Item(3, 2).Value = "ATCUS" + $CustId
    $ws.Cells.Item(4, 2).Value = "Automated Test Customer " + $CustId
    $ws.Cells.Item(8, 2).Value = "Automated Test Street " + $CustId
    $wb.Save()
    $wb.Close()
    $xl.Quit()
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($xl)
}
function RunTestCase
{
    param ( [string]$filename )
    $cmd = "cd c:\Program Files (x86)\Regression Suite Automation Tool\ &&  "
    $cmd = $cmd + "Microsoft.Dynamics.RegressionSuite.ConsoleApp.exe playback "
    $cmd = $cmd + $filename
    cmd /c $cmd
}
$excelFilename = "full path to excel file parameter file"
l$sheetName = "DirPartyQuickCreateForm"
for ($i = $start; $i -lt $start + $nr; $i++ )
{
    $CustomerId = $i.ToString("000000000")
    Write-Host "customer : " $CustomerId
    UpdateCustomer $excelFilename $sheetName $CustomerId
    RunTestCase $excelFilename
```

#### <a name="run-a-script-that-depends-on-data-in-microsoft-dynamics-365"></a>Выполнение сценария, который зависит от данных в Microsoft Dynamics 365

В следующем примере для поиска статуса заказа на покупку используется вызов по протоколу OData (Open Data Protocol). Если статус не равен **выставлена накладная**, можно, например, вызвать тестовый случай RSAT, который разносит накладную.

```
function Odata_Get
{
    Param ( [string] $environment, [string] $cmd )
    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
    $tenant = "your tenant"
    $creds = @{
        grant_type = "client_credentials"
        client_id = "your client application Id"
        client_secret = "your client secret"
        resource = $environment
    }
    $headers = $null
    $bearer = Invoke-RestMethod https://login.microsoftonline.com/$tenant/oauth2/token -Method Post -Body $creds -Headers $headers;
    $headers = @{
        Authorization = "Bearer " + $bearer.access_token
    }
    $Odata_cmd = $environment + '/data/' + $cmd
    return (Invoke-RestMethod -Uri $Odata_cmd -Method Get -Headers $headers -ContentType application/json )
}
function PurchaseOrderStatus
{
    Param ( [string] $environment, [string] $purchaseOrderNumber )
    $cmd = 'PurchaseOrderHeaders?$filter=PurchaseOrderNumber eq '
    $cmd = $cmd + "'" + $purchaseOrderNumber + "'"
    $response = Odata_Get -environment $environment -cmd $cmd
    return $response.value.PurchaseOrderStatus
}
$environment = "https://your environment"
$orderStatus = PurchaseOrderStatus -environment $environment -purchaseOrderNumber '000003'
if ($orderStatus -eq $null) {   write-host 'doesn''t exist'}
elseif ($orderStatus -ne 'invoiced') { RunTestCase "PostInvoice" }
```
