---
title: Учебник по настройке и установке средства Regression Suite Automation Tool
description: В этом разделе представлен учебник, в котором показано, как настроить и установить средство Regression Suite Automation Tool (RSAT).
author: kfend
manager: AnnBe
ms.date: 06/24/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 21761
ms.search.region: Global
ms.author: kfend
ms.search.validFrom: 2019-05-30
ms.dyn365.ops.version: AX 7.0.0, Operations
ms.openlocfilehash: e2287cb0281e920de219cb88d41cd69264911f93
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/02/2019
ms.locfileid: "1850877"
---
# <a name="set-up-and-install-regression-suite-automation-tool-tutorial"></a>Учебник по настройке и установке средства Regression Suite Automation Tool
Этот раздел представляет собой учебник, который поможет вам настроить и начать работу с RSAT и средствами, связанными с использованием RSAT. 

[!include [banner](../includes/banner.md)]

> [!NOTE]
> Загрузите и сохраните эту страницу в формате PDF с помощью средств веб-браузера. 

## <a name="key-concepts"></a>Ключевые понятия

- Изучите порядок установки и необходимые условия для настройки, необходимые для различных приложений, которые поддерживают средство Regression Suite Automation Tool (RSAT).
- Узнайте, как функция регистратора задач в Microsoft Dynamics 365 for Finance and Operations в сочетании со службами Microsoft Dynamics Lifecycle Services (LCS) и Microsoft Azure DevOps позволяют создавать, настраивать, выполнять и исследовать тестовые случаи, а также подготавливать отчеты по ним.
- Предоставьте функциональным пользователям возможность записи деловых задач с помощью регистратора задач в Finance and Operations, а затем преобразуйте записи задач в набор автоматических тестов без написания исходного кода.

## <a name="before-you-begin"></a>Перед началом

### <a name="prerequisites"></a>Необходимые условия

- Среда Finance and Operations, в которой выполняется Microsoft Dynamics 365 for Finance and Operations версии10.0 (апрель 2019) или более поздняя, необходима для работы с этим учебником. Для клиентов, использующих Microsoft Dynamics 365 for Finance and Operations Enterprise Edition 7.3, также поддерживается обновление платформы Platform update 20 (PU20) или более поздняя версия.
- Пользователь должен иметь права администратора в среде Finance and Operations.
- Необходимо иметь доступ к службам LCS арендатора клиента и к Azure DevOps (ранее известной как Microsoft Visual Studio Team Services \[VSTS\]).
- Пользователь, который создает наборы тестов и управляет ими, должен иметь лицензию Azure DevOps Test Plans (планы испытаний) или Test Manager (менеджер испытаний). Следующие лицензии также дают доступ к планам испытаний:
    - Лицензия Visual Studio Enterprise
    - Лицензия Visual Studio Test Professional
    - Лицензия подписчика на платформы MSDN
- RSAT должен иметь доступ к тестовой среде через веб-браузер.
- Для создания и изменения параметров тестирования необходимо установить Microsoft Excel.

## <a name="configure-azure-devops"></a>Настроить Azure DevOps

### <a name="user-eligibility"></a>Приемлемость пользователей

Убедитесь, что пользователь создан в Azure DevOps и имеет уровень подписки, обеспечивающий доступ к планам испытаний Azure Test Plans. Лицензия Azure DevOps Test Plans требуется только в том случае, если пользователь создает тестовые случаи и управляет ими (то есть, не все пользователи RSAT нуждаются в этой лицензии). Сведения о требованиях к лицензии см. в разделе [Требования к лицензии](https://docs.microsoft.com/azure/devops/test/manual-test-permissions#license-requirements).

### <a name="create-a-new-azure-devops-project"></a>Создание нового проекта Azure DevOps
RSAT использует Azure DevOps для управления тестовыми случаями и наборами тестов, создания отчетов и изучения результатов тестов. 

> [!NOTE]
> Можно использовать существующий проект Azure DevOps. Однако если существующий проект Azure DevOps настроен таким образом, что он имеет пользовательский шаблон, то при синхронизации тестовых случаев из средства моделирования бизнес-процессов (BPM) с Azure DevOps будет выдаваться сообщение об ошибке "Ошибка синхронизации VSTS" (см. раздел [Тест синхронизации из BPM в Azure DevOps](#test-the-synchronization-from-bpm-to-azure-devops)). Если выполнены следующие рекомендации для пользовательского шаблона, можно будет синхронизировать тестовые случаи с Azure DevOps. (Рекомендации приведены в сообщении об ошибке.)

- Не удалять типы рабочих элементов или готовые поля.
- Не удалять состояния типа рабочего элемента.
- Не добавлять обязательные поля в тип рабочего элемента.

![Сообщение об ошибке со списком рекомендаций](./media/setup_rsa_tool_02.png)

В противном случае в этом учебнике рекомендуется создать новый проект Azure DevOps. Дополнительные сведения см. в разделе [Вопросы, связанные с синхронизацией с BPM с помощью специального шаблона процесса Azure DevOps (VSTS)](https://blogs.msdn.microsoft.com/lcs/2018/11/28/issues-when-syncing-to-bpm-using-a-custom-azure-devops-vsts-process-template/).

1. Откройте URL-адрес Azure DevOps (`https://dev.azure.com/<Azure DevOps Name>`).
2. Выберите **Создать проект** в верхнем правом углу страницы Azure DevOps.

    ![Кнопка создания проекта](./media/setup_rsa_tool_03.png)

3. Заполните следующие поля, затем выберите **Создать**:

    - **Наименование проекта**
    - **Управление версиями** — выберите **Управление версиями Team Foundation**. Обратите внимание, что параметр по умолчанию **Git** не поддерживается.
    - **Процесс рабочего элемента**

    ![Диалоговое окно создания нового проекта](./media/setup_rsa_tool_04.png)

### <a name="create-a-personal-access-token"></a>Создание личного маркера доступа

В этом учебнике будет использоваться средство моделирования бизнес-процессов (BPM) LCS, чтобы создать библиотеку тестовых случаев и синхронизировать тестовые случаи с Azure DevOps. Вам понадобится личный маркер доступа для синхронизации BPM с Azure DevOps.

1. Выберите значок профиля в верхнем правом углу страницы для своего проекта Azure DevOps, затем выберите **Безопасность**.

    ![Команда безопасности](./media/setup_rsa_tool_05.png)

2. В левой области в разделе **Безопасность** выберите **Личные маркеры доступа**. Затем выберите **Создать маркер**.

    ![Кнопка "Создать маркер" на вкладке "Личные маркеры доступа" в разделе "Параметры пользователя"](./media/setup_rsa_tool_06.png)

3. Заполните следующие поля, затем выберите **Создать**:

    - **Название**
    - **Окончание срока действия (UTC)** — выберите **Определяемый пользователем**, затем с помощью средства выбора даты выберите последнюю доступную дату.
    - **Области** — выберите параметр **Полный доступ**.

    ![Диалоговое окно создания нового личного маркера доступа](./media/setup_rsa_tool_07.png)

    > [!NOTE]
    > Запишите созданный личный маркер доступа. Он потребуется позже при настройке конфигурации RSAT.

    ![Личный маркер доступа](./media/setup_rsa_tool_08.png)

## <a name="configure-the-lcs-project"></a>Настройка проекта LCS

Для основной библиотеки тестов необходим проект Lifecycle Services (LCS). Средство моделирования бизнес-процессов (BPM) LCS используется в качестве основной библиотеки для тестовых случаев. BPM используется для управления и распространения библиотек тестирования в проектах LCS. Например, партнер Майкрософт или независимый поставщик программных продуктов (ISV), создающие библиотеки тестов, выпускают тестовые случаи в форме библиотек BPM. В BPM тестовые случаи организованы по бизнес-процессам. BPM не определяет порядок выполнения или частоту проходов теста. Эти сведения контролируются в Azure DevOps, как описано ниже в этом разделе.  

Для проекта LCS можно использовать существующую пользовательскую реализацию или проект партнера.

### <a name="update-the-lcs-language"></a>Обновление языка LCS

> [!NOTE]
> Для правильного отображения бизнес-процессов в пользовательском интерфейсе должен быть установлен предпочитаемый язык LCS **Английский (США)**.

1. Перейдите в проект реализации LCS.
2. Выберите кнопку **Параметры** (символ шестеренки) в верхнем правом углу, затем выберите **Предпочитаемый язык**.

    ![Команды меню настройки](./media/setup_rsa_tool_09.png)

3. В поле **Предпочтительный язык** выберите **Английский (США)**, затем выберите **Сохранить**.

    ![Вкладка "Предпочитаемый язык" в параметрах пользователя](./media/setup_rsa_tool_10.png)

### <a name="configure-lcs-to-connect-to-the-azure-devops-project"></a>Настройка LCS для подключения к проекту Azure DevOps

Если ранее был создан новый проект Azure DevOps, настройте проект LCS для подключения к нему. В противном случае, если проект LCS уже подключен к проекту Azure DevOps, можно перейти к следующему разделу.

1. Перейдите в проект реализации LCS.
2. Выберите кнопку **Меню**, затем выберите **Параметры проекта**.

    ![Команда "Параметры проекта"](./media/setup_rsa_tool_11.png)

3. В левой области выберите **Visual Studio Team Services**, затем выберите пункт **Настройка Visual Studio Team Services**.

    ![Вкладка Visual Studio Team Services в параметрах проекта](./media/setup_rsa_tool_12.png)

4. В поле **URL-адрес сайта Azure DevOps** введите URL-адрес сайта Azure DevOps. В поле **Личный маркер доступа** введите личный маркер доступа, созданный ранее.

    > [!NOTE]
    > Несмотря на то, что VSTS не известен как Azure DevOps, для подключения LCS к проекту Azure DevOps используется старый URL-адрес. Например, URL-адрес Azure DevOps, используемый в этом учебнике, — это `https://dev.azure.com/D365FOFastTrack/`. Однако на следующем рисунке он вводится как `https://D365FOFastTrack.visualstudio.com/`.

    ![Шаг 1 в настройке Visual Studio Team Services](./media/setup_rsa_tool_13.png)

5. Выберите **Продолжить**.
6. В поле **Проект Visual Studio Team Services** выберите проект VSTS на выбранном сайте, чтобы связать с проектом LCS. По умолчанию для поля **Шаблон процесса** установлено значение **Гибкость**. Для пользовательского шаблона следует ознакомиться с практическим руководством в разделе [Создание нового проекта Azure DevOps](#create-a-new-azure-devops-project). Затем выберите **Продолжить**.

    ![Шаг 2 в настройке Visual Studio Team Services](./media/setup_rsa_tool_14.png)

7. Проверьте настройки, затем выберите **Сохранить**.

    ![Шаг 3 в настройке Visual Studio Team Services](./media/setup_rsa_tool_15.png)

8. Выберите **Авторизовать** для авторизации LCS для доступа к настроенному сайту Azure DevOps от вашего имени и включения функций, которые интегрируются с VSTS.

    ![Кнопка "Авторизовать"](./media/setup_rsa_tool_16.png)

9. Открывается окно с сообщением "Вы будете перенаправлены на внешний сайт для авторизации LCS на подключение к Visual Studio Team Services от вашего имени. Продолжить?" Выберите **Да**.

    ![Окно сообщения](./media/setup_rsa_tool_17.png)

10. Выберите **Принять**.

    ![Авторизация доступа](./media/setup_rsa_tool_18.png)

11. Если вы уполномочены как пользователь, пользовательский интерфейс должен вернуться на страницу параметров проекта LCS.

    ![Авторизованный пользователь](./media/setup_rsa_tool_19.png)

### <a name="create-a-new-bpm-library"></a>Создание новой библиотеки BPM

1. Перейдите в проект реализации LCS.
2. Выберите кнопку **Меню**, затем выберите **Средство моделирования бизнес-процессов**.

    ![Команда средства моделирования бизнес-процессов](./media/setup_rsa_tool_20.png)

3. Выберите **Создать библиотеку**.

    ![Кнопка "Создать библиотеку"](./media/setup_rsa_tool_21.png)

4. В поле **Имя библиотеки** введите имя, затем выберите **Создать**. Для данного учебника назовите библиотеку BPM **RSAT**.

    ![Диалоговое окно создания новой библиотеки](./media/setup_rsa_tool_22.png)

5. Откройте новую библиотеку BPM **RSAT**.
6. Выберите процесс **Образец основного бизнес-процесса**, затем в правой части выберите **Режим редактирования**.

    ![Кнопка "Режим редактирования"](./media/setup_rsa_tool_23.png)

7. Измените значение обоих полей **Имя** и **Описание** на **Создать продукт**. Затем выберите **Сохранить**.

    ![Поля имени и описания](./media/setup_rsa_tool_24.png)

## <a name="finance-and-operations-environment"></a>Среда Finance and Operations

### <a name="version-requirement"></a>Требования к версии

Требуется тестовая среда или среда песочницы Finance and Operations, в которой работает версия 10. Для клиентов, использующих версию 7.3, также поддерживается обновление платформы Platform update 20 или более поздняя версия.

> [!NOTE]
> RSAT должен иметь доступ к тестовой среде Finance and Operations через веб-браузер.

### <a name="user-criteria"></a>Критерии пользователя

Пользователь должен иметь права администратора для этой среды.

### <a name="set-up-help-settings-to-connect-with-lcs"></a>Настройка параметров справки для подключения к LCS

Этот шаг требуется для подключения к LCS, чтобы записи задач можно было сохранить в соответствующую библиотеку BPM в LCS через клиент Finance and Operations.

1. Откройте клиент Finance and Operations.
2. Перейдите в раздел **Администрирование системы \> Настройка \> Параметры системы**.
3. На вкладке **Справка** в поле **Настройка справки Lifecycle Services** выберите соответствующий проект LCS (**RSAT** для этого учебника).

    ![Поле настройки справки Lifecycle Services на вкладке "Справка"](./media/setup_rsa_tool_25.png)

    Библиотеки BPM заполняются в соответствующем проекте LCS.

4. Нажмите **Сохранить**.
5. Возможно потребуется обновить браузер, чтобы увидеть обновленное содержимое справки.

    ![Уведомление об обновлении браузера](./media/setup_rsa_tool_26.png)

## <a name="task-recordings"></a>Запись задач

> [!NOTE]
> Убедитесь, что все записи задач начинаются с главной панели мониторинга Finance and Operations. Старайтесь, чтобы отдельные записи были короткими, и сосредоточьтесь на деловой задаче, например на создании заказа на продажу.

### <a name="create-a-task-recording-and-save-it-to-the-bpm-library"></a>Создание записи задачи и сохранение ее в библиотеке BPM

Создайте соответствующую запись задачи, которую можно приложить к простому бизнес-процессу, созданному в новой библиотеке BPM.

1. Откройте клиент Finance and Operations.
2. На главной панели мониторинга выберите кнопку **Настройки** (символ шестеренки), затем выберите **Регистратор задач**.

    ![Команды меню настройки](./media/setup_rsa_tool_27.png)

3. Выберите **Создать запись**.

    ![Кнопка "Создать запись"](./media/setup_rsa_tool_28.png)

4. Заполните поля **Имя записи** и **Описание записи**, затем выберите **Начать**.

    ![Поля "Имя записи" и "Описание записи"](./media/setup_rsa_tool_29.png)

5. Запишите шаги по созданию продукта. По завершении нажмите кнопку **Остановить**, чтобы остановить запись.

    ![Шаги для создания продукта](./media/setup_rsa_tool_30.png)

6. Выберите **Сохраните файл в Lifecycle Services**.

    ![Параметры сохранения](./media/setup_rsa_tool_31.png)

    Сведения о библиотеке загружаются из LCS.

    ![Индикатор хода выполнения](./media/setup_rsa_tool_32.png)

7. Выберите библиотеку BPM, с которой требуется связать запись задачи. В данном учебнике выберите библиотеку BPM **RSAT**, созданную ранее, и бизнес -процесс **Создание продукта** в ней. Затем выберите **OK**.

    ![Связывание записи задачи с библиотекой BPM и бизнес-процессом](./media/setup_rsa_tool_33.png)

    Появляется сообщение "Сохранение в Lifecycle Services выполнено успешно".

    ![Сообщение об успешном сохранении в LCS](./media/setup_rsa_tool_34.png)

8. Если требуется сохранить запись задачи локально, а затем отправить ее в BPM через LCS, выполните следующие действия:

    1. После завершения записи выберите **Сохранить на этом компьютере**.

        ![Параметры сохранения](./media/setup_rsa_tool_35.png)

    2. В панели уведомлений браузера выберите **Сохранить** или **Сохранить как**, чтобы сохранить файл на локальном компьютере.

        ![Панель уведомлений](./media/setup_rsa_tool_36.png)

    3. Перейдите в библиотеку BPM **RSAT** и выберите бизнес-процесс, для которого необходимо сохранить запись задачи.
    4. На вкладке **Обзор** выберите **Отправить**.

        ![Кнопка отправки](./media/setup_rsa_tool_37.png)

    5. Выберите **Обзор** и выберите сохраненный ранее файл .axtr. Затем выберите **Отправить**.

        ![Выбор файла .axtr для отправки](./media/setup_rsa_tool_38.png)

### <a name="test-the-synchronization-from-bpm-to-azure-devops"></a>Проверка синхронизации из BPM в Azure DevOps

Теперь, когда запись задачи связана с бизнес-процессом, необходимо проверить, что бизнес-процесс и связанная с ним запись задачи могут быть синхронизированы Azure DevOps в качестве функции и тестового случая (соответственно) с помощью функции синхронизации VSTS в LCS.

> [!NOTE]
> Соответствующий тип рабочего элемента, созданный в Azure DevOps, будет изменяться в зависимости от шаблона процесса, выбранного при настройке проекта LCS с помощью Azure DevOps, как описано в разделе [Создание нового проекта Azure DevOps](#create-a-new-azure-devops-project).

1. Перейдите к библиотеке BPM и откройте созданную ранее библиотеку **RSAT**.
2. Нажмите кнопку с многоточием (**...**) и выберите **Синхронизация VSTS**.

    ![Команда синхронизации VSTS в меню с многоточием](./media/setup_rsa_tool_39.png)

    После завершения синхронизации VSTS в левой части отображается вкладка **Требования**, содержащая соответствующий рабочий элемент Azure DevOps.

    > [!NOTE]
    > Созданный в Azure DevOps рабочий элемент будет иметь имя "Библиотека BPM" в качестве префикса заголовка.

    ![Вкладка требований](./media/setup_rsa_tool_40.png)

3. Обновите страницу.
4. Выберите кнопку с многоточием (**...**). Будет отображен дополнительный параметр **Синхронизировать тестовые случаи**. Выберите этот параметр.

    ![Команда синхронизации тестовых случаев в меню с многоточием](./media/setup_rsa_tool_41.png)

    > [!NOTE]
    > Если параметр **Синхронизировать тестовые случаи** недоступен после обновления страницы, перейдите на главную страницу для BPM и выберите **Синхронизировать тестовые случаи** для всей библиотеки. Таким образом можно эффективно принудительно выполнить синхронизацию для всей библиотеки.
    > 
    > ![Выбор синхронизации тестовых случаев для всей библиотеки](./media/setup_rsa_tool_42.png)

    После завершения синхронизации тестовых случаев создается новый тестовый случай на вкладке **Требования**.

    ![Новый тестовый случай на вкладке "Требования"](./media/setup_rsa_tool_43.png)

5. Перейдите к проекту Azure DevOps и выберите **Панели \> Рабочие элементы**.

    ![Команда рабочих элементов в разделе панелей](./media/setup_rsa_tool_44.png)

6. Убедитесь, что рабочий элемент и тестовый случай, созданный с помощью синхронизации BPM, существует.

    ![Рабочий элемент и тестовый случай](./media/setup_rsa_tool_45.png)

## <a name="install-and-configure-rsat"></a>Установка и настройка RSAT

RSAT можно установить на любой компьютер, на котором работает Windows 10, и который может подключаться к среде Finance and Operations с помощью веб-браузера (Internet Explorer или Google Chrome).

> [!NOTE]
> Перед установкой новой версии средства рекомендуется удалить предыдущую версию.

### <a name="install-an-authentication-certificate"></a>Установка сертификата проверки подлинности

Чтобы включить проверку подлинности, необходимо создать и установить сертификат на том же компьютере, на котором запущено приложение RSAT.

#### <a name="generate-a-certificate"></a>Создание сертификата

1. Чтобы создать файл сертификата, откройте окно Microsoft Windows PowerShell в качестве администратора и выполните следующую команду:

    ```
    $certificate = New-SelfSignedCertificate -dnsname 127.0.0.1 -CertStoreLocation cert:\LocalMachine\My -FriendlyName "D365 Automated testing certificate" -Provider "Microsoft Strong Cryptographic Provider"
    ```

2. Откройте диспетчер сертификатов, введя **certlm.msc** в диалоговом окне **Выполнить** и убедитесь, что сертификат **Сертификат автоматического тестирования D365** был создан в разделе **Личные \> Сертификаты**.

    > [!NOTE]
    > Убедитесь, что введено **certlm.msc**, а не **certmgr.msc**, так как сертификаты хранятся на локальном компьютере.

    ![Сертификат автоматического тестирования D365](./media/setup_rsa_tool_46.png)

3. Щелкните сертификат правой кнопкой мыши, затем выберите **Копировать**.
4. Перейдите в раздел **Доверенные корневые центры сертификации \> Сертификаты**.

    ![Папка "Сертификаты" в папке "Доверенные корневые центры сертификации"](./media/setup_rsa_tool_47.png)

5. В меню **Действие** выберите команду **Вставить**, чтобы скопировать сертификат в расположение **Доверенные корневые центры сертификации**.

    ![Команда вставки в меню действий](./media/setup_rsa_tool_48.png)

6. Чтобы получить отпечаток установленного сертификата, но без пробелов и специальных символов, откройте окно Windows PowerShell в качестве администратора и выполните следующие команды.

    ```
    cd Cert:\LocalMachine\My

    Get-ChildItem | Where-Object { $_.Subject -like "CN=127.0.0.1" }
    ```

    > [!NOTE]
    > Сохраните отпечаток, так как он потребуется позже при обновлении файлов .wif для сервера Application Object Server (AOS) и настройки конфигурации RSAT.

#### <a name="configure-the-aos-computer-to-trust-the-connection"></a>Настройка компьютера AOS, чтобы он доверял данному подключению

> [!NOTE]
> Если среда Finance and Operations является средой уровня 2+, отпечаток сертификата необходимо обновить в файле wif.config для **всех** компьютеров AOS в среде.

1. Создайте подключение по протоколу удаленного рабочего стола (RDP) на компьютере с сервером AOS. Сведения о входе доступны на странице сведений о среде в LCS.
2. Откройте службы Microsoft Internet Information Services (IIS) и найдите **AOSService** в списке сайтов.

    ![AOSService в списке сайтов](./media/setup_rsa_tool_49.png)

3. Щелкните правой кнопкой мыши **Проводник** ,чтобы открыть папку **\<Диск\>: \\AosService\\WebRoot** Найдите файл **wif.config**.

    ![Файл Wif.config в папке WebRoot](./media/setup_rsa_tool_50.png)

4. Обновите файл **wif.config**, добавив новую запись центра для имени сертификата и центра, как показано в следующем примере.

    ```
    <issuerNameRegistry type="Microsoft.Dynamics.AX.Security.SharedUtility.AxIssuerNameRegistry,Microsoft.Dynamics.AX.Security.SharedUtility">
        <authority name="CN=127.0.0.1">
            <keys>
                <add thumbprint="xxxxxxxxxxxxxxxxxxxx" />
                <add thumbprint="xxxxxxxxxxxxxxxxxxxx" />
            </keys>
            <validIssuers>
                <add name="CN=127.0.0.1" />
            </validIssuers>
        </authority>
    ```

    > [!NOTE]
    > Если несколько пользователей используют одно и то же приложение Finance and Operations, каждый пользователь должен создать отдельные отпечатки, а каждый из этих отпечаток должен быть добавлен в раздел **\<ключи\>**.

5. Если имеется более одного компьютера AOS, повторите шаги с 3 по 4 для каждого дополнительного компьютера.

    > [!NOTE]
    > В отличие от старых сред уровня 2, новые среды уровня 2 развертываются с двумя экземплярами AOS.

6. Выполните команду **iisreset** на всех компьютерах AOS.

    > [!NOTE]
    > Если у вас нет прав администратора для запуска **iisreset** на компьютере уровня 1, на странице сведений о среде в LCS выберите параметр "Поддержка > Перезапуск служб".

#### <a name="tier-2-environment"></a>Среда уровня 2+

Если используются среда Finance and Operations уровня 2 + (песочница "стандартный приемочный тест" или выше), проверьте или установите следующий параметр реестра на компьютере, на котором установлен RSAT. Этот шаг является обязательным, поскольку он позволяет избежать ошибок проверке подлинности или подключения RSAT.

```
if ((Test-Path HKLM:\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\v4.0.30319))
{
    Set-ItemProperty HKLM:\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\v4.0.30319 -Name SchUseStrongCrypto -Value 1 -Type dword -Force -Confirm:$false
}
```

### <a name="install-rsat"></a>Установка RSAT

1. Перейдите к пункту <https://www.microsoft.com/download/details.aspx?id=57357> и выберите **Загрузить**.
2. Выберите все файлы, затем выберите **Далее**.

    ![Выбор всех файлов](./media/setup_rsa_tool_51.png)

3. Дважды щелкните пакет .msi, чтобы запустить установщик. Затем, после завершения установки, выберите **Готово**.

    ![Файл установщика RSAT](./media/setup_rsa_tool_52.png)

### <a name="install-selenium-and-browser-drivers"></a>Установка драйверов Selenium и драйверов браузера

В предыдущих версиях RSAT необходимо установить драйверы Selenium и драйверы браузера. Больше не нужно устанавливать эти драйверы, поскольку они автоматически устанавливаются.

1. При первом открытии программы RSAT появится запрос на автоматическую загрузку и установку Selenium. Дополнительные сведения см. в разделе [Настройка RSAT](#configure-rsat).
2. Прежде чем можно будет выполнить тестовый случай, вам будет предложено автоматически загрузить и установить драйвер браузера, соответствующий браузеру по умолчанию, выбранному в конфигурации RSAT. Дополнительные сведения см. в разделе [Загрузка и выполнение тестовых случаев](#load-and-run-test-cases).

## <a name="get-started-with-rsat"></a>Начало работы с RSAT

### <a name="create-a-test-plan-and-test-suites"></a>Создание плана тестирования и наборов тестов

1. Перейдите к проекту Azure DevOps и выберите **Планы испытаний**.

    ![Команда "Планы испытаний"](./media/setup_rsa_tool_53.png)

2. Выберите **Создать план испытаний**.

    ![Кнопка создания плана испытаний](./media/setup_rsa_tool_54.png)

3. Заполните поле **Имя**, затем выберите **Создать**. В данном учебнике назовите план испытаний **План испытаний RSAT**.

    ![Диалоговое окно создания плана испытаний](./media/setup_rsa_tool_55.png)

4. Выберите знак "плюс" (**+**), затем выберите **Статический набор**, чтобы создать статический набор в новом плане тестирования. Назовите новый набор тестов **T01 – От производства до склада**.

    > [!NOTE]
    > Кроме того, можно создать набор на основе запросов, если необходимо автоматически перенести новые тестовые случаи из BPM в набор тестов RSAT.

    ![Создание статического набора](./media/setup_rsa_tool_56.png)

### <a name="attach-test-cases-to-test-suites"></a>Подключение тестовых случаев к наборам тестов

1. Выберите **Добавить существующее** в правой части, чтобы добавить существующие тестовые случаи в набор тестов.

    ![Кнопка добавления существующих](./media/setup_rsa_tool_57.png)

2. На странице **Добавление тестовых случаев в набор** выберите **Выполнить запрос**, затем выберите тестовый случай, который требуется добавить в набор тестов. Для этого учебника выберите тестовый случай **Создание нового продукта**. Затем выберите **Добавить тестовые случаи** в нижнем правом углу страницы (эта кнопка не отображается на следующем рисунке).

    ![Кнопка запуска запроса](./media/setup_rsa_tool_58.png)

    Тестовый случай добавляется к набору тестов **T01 — От производства до склада**.

    ![Тестовый случай, добавленный в набор тестов](./media/setup_rsa_tool_59.png)

### <a name="configure-rsat"></a>Настройка RSAT

1. Откройте RSAT.

    ![Значок RSAT](./media/setup_rsa_tool_60.png)

2. Вы получите предупреждающее сообщение с текстом "Для Regression Suite Automation Tool требуется Selenium, хотите загрузить и установить его автоматически?" Выберите **Да**.

    ![Предупреждающее сообщение](./media/setup_rsa_tool_61.png)

3. Нажмите кнопку **Настройки** (символ шестеренки) в верхнем правом углу, затем в появившемся диалоговом окне заполните следующие поля:

    - **URL-адрес Azure DevOps** — введите URL-адрес проекта Azure DevOps, например `https://yourAzureDevOpsUrlHere.visualStudio.com`.
    - **Маркер доступа** — введите маркер доступа, который позволяет средству подключиться к Azure DevOps. Используйте личный маркер доступа, созданный ранее в этом учебнике. Дополнительные сведения см. в разделе [Проверка подлинности с использованием личных маркеров доступа](https://www.visualstudio.com/docs/setup-admin/team-services/use-personal-access-tokens-to-authenticate).
    - **Название проекта** — выберите имя своего проекта Azure DevOps.
    - **План испытаний** — выберите план тестирования Azure DevOps, содержащий тестовые случаи. Дополнительные сведения см. в разделе [Создание планов испытаний и наборов тестов](https://www.visualstudio.com/docs/test/manual-exploratory-testing/getting-started/create-a-test-plan). После выбора плана тестирования выберите **Проверить подключение**, чтобы проверить подключение к Azure DevOps.
    - **Имя узла** — введите имя узла для среды испытаний Finance and Operations, например **\<myaos\>.cloudax.dynamics.com**. Не включайте префикс **https://** или **http://**.
    - **Имя узла SOAP** — введите имя узла SOAP для среды испытаний Finance and Operations. Обычно имя узла SOAP совпадает с именем хоста, но имеет суффикс **soap**. Например: **\<myaos\>soap.cloudax.dynamics.com**. Не включайте префикс **https://** или **http://**.

        > [!NOTE]
        > Чтобы найти имя узла и имя узла SOAP, откройте диспетчер служб IIS, щелкните правой кнопкой мыши **Сайты \> AOSService** и выберите команду **Изменить привязки**. Значения в столбце **Имя узла** дают имя узла и имя узла SOAP (имя узла SOAP содержит суффикс **soap** в URL-адресе).

        ![Имя узла и имя узла SOAP в столбце имени узла](./media/setup_rsa_tool_63.png)

    - **Имя пользователя администратора** — введите адрес электронной почты пользователя администратора в среде тестирования Finance and Operations.
    - **Отпечаток** — введите отпечаток сертификата проверки подлинности, как описано ранее в этом учебнике.
    - **Рабочий каталог** — укажите местоположение папки для хранения файлов автоматизации тестирования, таких как файлы данных тестирования Excel. Например, введите или выберите **C:\\Temp\\RegressionTool**.

        > [!NOTE]
        > Если имя папки содержит пробелы, выполнение будет неудачным, так как папка будет не найдена. Эта проблема известна и должна быть исправлена в последней версии средства.

    - **Браузер по умолчанию** — выберите **Internet Explorer** или **Google Chrome**. Убедитесь, что установлены соответствующие драйверы браузера.
    - **Время ожидания тестового запуска** — укажите период ожидания в минутах для тестовых запусков. По истечении времени ожидания все активные окна закрываются, а ожидающие тестовые случаи заканчиваются сбоем.
    - **Время ожидания действия проверки** — это поле определяет период ожидания в минутах для запросов сервера среды Finance and Operations. Обычно должно быть достаточно значения по умолчанию (2 минуты). Однако для более медленных сред может возникнуть необходимость увеличить значение, если происходят ошибки, связанные со временем ожидания.
    - **Название компании** — введите название компании, которое будет использоваться в качестве компании Finance and Operations по умолчанию при создании файлов параметров Excel. Позднее можно изменить компанию, отредактировав файл параметров Excel.

    ![Диалоговое окно настроек](./media/setup_rsa_tool_62.png)

4. Выберите **Применить** для применения и сохранения настроек.

    Для сохранения текущих настроек в файл конфигурации на компьютере выберите **Сохранить как**. Для восстановления настроек из файла конфигурации на компьютер выберите **Открыть**.

5. Выберите **Закрыть**, чтобы закрыть диалоговое окно.

### <a name="load-and-run-test-cases"></a>Загрузка и выполнение тестовых случаев

1. Выберите **Загрузить**, чтобы загрузить план испытаний **План испытаний RSAT** из проекта Azure DevOps.

    ![Кнопка загрузки](./media/setup_rsa_tool_64.png)

2. Выберите тестовый случай **Создание нового продукта** из набора тестов, затем выберите **Создать \> Создание выполнения теста и файлов параметров**.

    ![Команда создания выполнения тестов и файлов параметров в меню создания](./media/setup_rsa_tool_65.png)

    Файл параметров Excel создается в локальной папке, указанной в конфигурации RSAT (например, **C:\\Temp\\RegressionTool**).

    ![Создан файл параметров Excel](./media/setup_rsa_tool_66.png)

3. Если требуется сохранить файлы параметров, выберите **Отправить**. Файлы автоматизации тестирования для всех выбранных тестовых случаев отправляются в Azure DevOps для использования в будущем. (Эти файлы включают файлы параметров тестирования Excel.)

    Таким образом, можно выбрать команду **Загрузка** для загрузки файлов параметров (и файлов автоматизации) непосредственно из тестового случая в Azure DevOps. Нет необходимости повторно формировать файлы параметров. Этот подход будет важен в дальнейшем, когда необходимо сохранить изменения в файле параметров и не нужно перезаписывать их.

4. Чтобы убедиться, что файлы автоматизации и файлы параметров сохранены в Azure DevOps, перейдите в проект Azure DevOps, выберите **Панели \> Рабочие элементы** и выберите тестовый случай **Создание нового продукта**. На вкладке **Вложения** должны быть видны четыре файла:

    - **.cs** — файл автоматизации C\#
    - **.dll** — скомпилированный файл автоматизации в виде сборки
    - **.xlsx** — файл параметров Excel
    - **.xml** — файл записи

    ![Файлы на вкладке "Вложения"](./media/setup_rsa_tool_67.png)

5. Выберите тестовый случай, который необходимо выполнить, затем выберите **Выполнить**.

    > [!NOTE]
    > Перед запуском тестовых случаев, если используется браузер Internet Explorer, убедитесь, что для разрешения рабочего стола установлено значение **100%** в поле **Настройка дисплея Windows \> Масштаб и формат**. Если вы не можете изменить этот параметр на виртуальной машине (ВМ), измените его на клиенте (ноутбуке), с которого вы пытаетесь получить доступ к ВМ. Затем параметры разрешения наследуются настройками дисплея виртуальной машины.

    ![Разрешение рабочего стола установлено на 100%](./media/setup_rsa_tool_68.png)

6. Если драйверы браузера не установлены в системе, выводится предупреждающее сообщение "Для этой операции требуется драйвер \<название браузера\>. Вы хотите загрузить и установить его автоматически?" Выберите **Да**.

    ![Предупреждающее сообщение для Internet Explorer](./media/setup_rsa_tool_69.png)

    ![Предупреждающее сообщение для Chrome](./media/setup_rsa_tool_70.png)

    > [!NOTE]
    > Если в качестве браузера используется Chrome и получено сообщение об ошибке, в котором говорится, что сеанс не был создан из-за неправильной версии Chrome, загрузите последний драйвер Chrome с сайта <http://chromedriver.chromium.org/downloads> в папку **C:\\Program Files (x86)\\Regression Suite Automation Tool\\Common\\External\\Selenium**.

    ![Сообщение об ошибке для Chrome](./media/setup_rsa_tool_71.png)

    Выполняется тестовый случай, и поле **Результат** обновляется.

    ![Индикатор хода выполнения](./media/setup_rsa_tool_72.png)

    Если вы буквально следовали данному учебнику, то тестовый случай **Создание нового продукта** будет неудачным, поскольку запись задачи для создания продукта сохранит название продукта в виде жестко запрограммированного значения. При повторном запуске того же тестового случая должно быть получено сообщение об ошибке, поскольку продукт уже существует.

    ![В поле результата задано значение "Не пройден"](./media/setup_rsa_tool_72.png)

### <a name="view-the-test-results"></a>Просмотр результатов теста

1. Дважды щелкните неудачный тестовый случай.

    Вы получаете сообщение об ошибке.

    ![Сообщение об ошибке](./media/setup_rsa_tool_73.png)

2. Выберите **Сведения** для просмотра сообщения об ошибке целиком.

    ![Все сообщение об ошибке](./media/setup_rsa_tool_74.png)

3. Чтобы просмотреть подробную версию сообщения об ошибке в Azure DevOps, выберите **Открыть в Azure DevOps**. В Azure DevOps можно просмотреть статус тестового случая и подробное сообщение об ошибке.

    ![Подробное сообщение об ошибке в Azure DevOps](./media/setup_rsa_tool_75.png)

4. Чтобы просмотреть результаты тестирования непосредственно в проекте Azure DevOps, перейдите в раздел **Планы испытаний \> Планы испытаний \> Выполнения**. Дважды щелкните выполнение теста, для которого необходимо просмотреть дополнительные сведения.

    ![Список тестовых запусков в Azure DevOps](./media/setup_rsa_tool_76.png)

5. Вкладка **Сводка выполнения** указывает, что тестовый случай завершился ошибкой, но не предоставляет фактическое сообщение об ошибке. Чтобы просмотреть подробное сообщение об ошибке, перейдите на вкладку **Результаты проверки**.

    ![Вкладка "Результаты проверки"](./media/setup_rsa_tool_77.png)

    На вкладке **Результаты проверки** выводятся сведения о тестовом случае вместе с результатом и сообщением об ошибке.

    ![Вкладка результатов проверки](./media/setup_rsa_tool_78.png)

6. Дважды щелкните соответствующую запись, чтобы просмотреть подробное сообщение об ошибке.

    ![Подробное сообщение об ошибке](./media/setup_rsa_tool_79.png)

    > [!NOTE]
    > Все сообщения об ошибках также доступны локально в файле **C:\\Users\\\$YourUserName\\AppData\\Roaming\\regressionTool\\errormsg-.txt**.

7. Можно также экспортировать результаты выполнения теста из уровня плана тестирования, выбрав **Экспорт**.

    ![Экспорт плана испытаний](./media/setup_rsa_tool_80.png)

### <a name="modify-the-excel-parameter-file"></a>Изменение файла параметров Excel

1. Откройте RSAT.
2. Выберите тестовый случай, затем выберите **Правка**, чтобы открыть файл параметров Excel.

    На листе **EcoResProductCreate** обратите внимание, что значение поля **Код продукта** является жестко закодированным. Перед повторным запуском тестового случая необходимо обновить это поле до нового номера продукта.

3. Чтобы создать уникальный номер продукта для каждого запуска без повторного открытия файла параметров Excel и ручного обновления номера продукта каждый раз, используйте следующую формулу Excel.

    ```
    ="RSAT_"&TEXT(NOW(),"yyymmddhhmm")
    ```

    > [!NOTE]
    > В дополнение к вкладке **Общие**, файл параметров Excel содержит вкладку данных для каждой страницы формы Finance and Operations, которую посещает тестовый случай.

    ![Поле номера продукта](./media/setup_rsa_tool_81.png)

4. Выберите **Сохранить** и закройте книгу Excel.
5. Выберите **Отправить**, чтобы сохранить файл параметров Excel в Azure DevOps.

    ![Сообщение об успешной отправке](./media/setup_rsa_tool_82.png)

    > [!NOTE]
    > Чтобы выполнить тестовые случаи в конкретном контексте пользователя, введите код электронной почты пользователя в поле **Тестовый пользователь** на вкладке **Общие** в файле параметров Excel. В последней версии средства RSAT макет полей в файле параметров Excel был обновлен, но концепция остается одинаковой.
    >
    > ![Поле тестового пользователя](./media/setup_rsa_tool_83.png)

### <a name="validate-the-results"></a>Проверка результатов

- Выберите **Выполнить**, чтобы повторно запустить тестовый случай, и проверьте, что тестовый случай пройден. Результаты испытаний можно просмотреть, как описано в разделе [Просмотр результатов испытаний](#view-the-test-results).

    ![В поле результата задано значение "Выполнено"](./media/setup_rsa_tool_84.png)

### <a name="chaining-of-test-cases"></a>Объединение тестовых случаев

Одной из важнейших функций RSAT является связывание тестовых случаев (то есть, возможность передачи значений из одного испытания в другие испытания). Тестовые случаи выполняются в соответствии с определенным порядком в плане тестирования Azure DevOps. (Этот порядок также можно обновить в самом средстве тестирования.) Таким образом, если необходимо передать переменные из одного тестового случая в другой, очень важно, чтобы испытания выполнялись в нужном порядке.

В этом разделе создается сохраненная переменная в первом тестовом случае, создается второй тестовый случай и передается сохраненная переменная из первого тестового случая во второй тестовый случай. Затем тестовые случаи выполняются как связанный тестовый случай в средстве RSAT.

#### <a name="modify-an-existing-task-recording-to-create-a-saved-variable"></a>Изменение существующей записи задачи для создания сохраненной переменной

1. Откройте клиент Finance and Operations.
2. Выберите кнопку **Настройки** (символ шестеренки), затем выберите **Регистратор задач**.
3. Выберите **Редактировать запись**.

    ![Кнопка "Редактировать запись"](./media/setup_rsa_tool_85.png)

4. Выберите **Открыть из Lifecycle Services**.

    ![Кнопка "Открыть из Lifecycle Services"](./media/setup_rsa_tool_86.png)

5. Выберите **Выберите библиотеку Lifecycle Services**.

    ![Кнопка "Выберите библиотеку Lifecycle Services."](./media/setup_rsa_tool_87.png)

    Библиотеки BPM загружаются из LCS.

    ![Индикатор хода выполнения](./media/setup_rsa_tool_88.png)

6. После загрузки библиотек BPM из LCS выберите библиотеку BPM **RSAT** и бизнес-процесс **Создание нового продукта**, с которым была связана запись задачи. Затем выберите **OK**.

    ![Выбор библиотеки BPM и бизнес-процесса](./media/setup_rsa_tool_89.png)

7. Имя соответствующей записи задачи вводится в поле **Имя записи**. Выберите **Пуск**.

    ![Имя записи задачи в поле "Имя записи"](./media/setup_rsa_tool_90.png)

8. Перейдите в пункт **Управление сведениями о продукте \> Продукты**, затем выберите **Создать**, чтобы открыть страницу, в которой была записана исходная запись задачи **Создание продукта**.
9. Выберите пункт **Вставить шаг**.

    > [!NOTE]
    > Новый шаг добавляется **после** шага, выбранного в области.

    ![Кнопка "Вставить шаг"](./media/setup_rsa_tool_91.png)

10. Щелкните правой кнопкой мыши поле **Номер продукта**, затем выберите **Регистратор задач \> Копировать**.

    ![Команда копирования](./media/setup_rsa_tool_92.png)

11. В области добавляется новый шаг. Запишите значение в поле **Номер продукта**, поскольку оно потребуется позже.

    ![Добавлен новый шаг](./media/setup_rsa_tool_93.png)

12. Выберите **Редактирование завершено**.
13. Выберите **Сохраните файл в Lifecycle Services** и свяжите новую запись задачи с той же библиотекой BPM и бизнес-процессом, с которыми была связана оригинальная запись задачи. Для получения дополнительных сведений см. раздел [Создание записи задачи и сохранение ее в библиотеке BPM](#create-a-task-recording-and-save-it-to-the-bpm-library).
14. Перейдите к библиотеке BPM и выберите **Синхронизировать тестовые случаи**, чтобы перезаписать запись задачи, прикрепленную к тестовому случаю в Azure DevOps, как описано в разделе [Проверка синхронизации из BPM в Azure DevOps](#test-the-synchronization-from-bpm-to-azure-devops).
15. Откройте RSAT и выберите пункт **Загрузить**, чтобы перезагрузить все тестовые случаи в наборе тестов. Необходимо повторно создать автоматизацию и файлы параметров для соответствующего тестового случая путем выбора тестового случая и выбора **Создать \> Создание выполнения теста и файлов параметров**, как описано в разделе [Загрузка и выполнение тестовых случаев](#load-and-run-test-cases).

    > [!NOTE]
    > Если файл параметров Excel был оставлен открытым, при повторном создании произойдет ошибка. Поэтому перед созданием нового файла параметров Excel убедитесь, что файл параметров Excel для тестового случая закрыт.

16. Выберите **Правка**, чтобы открыть новый файл параметров Excel. Будет отображена новая запись **Сохраненная переменная** в строке 9. Эта переменная, **{{EcoResProductCreate\_Identification\_ProductNumber\_Copy}}**, сохраняется в XML-файле записи задачи и может использоваться в последующих испытаниях.

    ![Запись сохраненной переменной](./media/setup_rsa_tool_94.png)

#### <a name="create-a-new-test-case"></a>Создание нового тестового случая

1. Перейти в библиотеку BPM **RSAT**.
2. Выберите процесс **Образец вспомогательного бизнес-процесса**, затем в правой части выберите **Режим редактирования**.
3. Измените значение обоих полей **Имя** и **Описание** на **Выпуск продукта**. Затем выберите **Сохранить**.

    ![Имя и описание изменены на "Выпуск продукта"](./media/setup_rsa_tool_95.png)

#### <a name="create-a-new-task-recording-that-has-a-validate-function"></a>Создание новой записи задачи с функцией проверки

- Создайте запись задачи для выпуска продукта, который был создан ранее, в юридическом лице USRT. Для получения дополнительных сведений см. раздел [Создание записи задачи и сохранение ее в библиотеке BPM](#create-a-task-recording-and-save-it-to-the-bpm-library).

    > [!NOTE]
    > Для связанных тестовых случаев всегда рекомендуется найти или отфильтровать запись, которая требуется, *вручную введя значение поля*. Таким образом, средство может определить запись, с которой действие должно быть выполнено, в последующем тестовом случае.

    ![Новая запись задачи с функцией проверки](./media/setup_rsa_tool_96.png)

    Как показано на предыдущем рисунке, после того, как продукт найден с помощью экспресс-фильтра, но до выбора **Выпуск продуктов**, можно проверить значение поля **Номер продукта**, чтобы убедиться, что код продукта — это код продукта, который был создан ранее. Для проверки значения щелкните правой кнопкой мыши поле **Номер продукта**, затем выберите **Регистратор задач \> Проверить \> Текущее значение**.

    ![Проверка текущего значения](./media/setup_rsa_tool_97.png)

#### <a name="save-the-task-recording-to-bpm"></a>Сохранение записи задачи в BPM

1. После завершения записи задачи выберите **Сохранить в Lifecycle Services**.

    ![Параметры сохранения](./media/setup_rsa_tool_98.png)

2. Сведения о библиотеке загружаются из LCS.

    ![Индикатор хода выполнения](./media/setup_rsa_tool_99.png)

3. Выберите библиотеку BPM, с которой требуется связать запись задачи. В данном учебнике выберите библиотеку BPM **RSAT**, созданную ранее, и бизнес -процесс **Выпуск продукта** в ней. Затем выберите **OK**.

#### <a name="sync-bpm-to-azure-devops"></a>Синхронизация BPM с Azure DevOps

1. Перейдите в библиотеку BPM и откройте библиотеку **RSAT**.
2. Выберите **Синхронизация VSTS**, затем **Синхронизировать тестовые случаи**. Дополнительные сведения см. в разделе [Проверка синхронизации из BPM в Azure DevOps](#test-the-synchronization-from-bpm-to-azure-devops).

    После завершения синхронизации новый рабочий элемент и соответствующий ему тестовый случай для бизнес-процесса **Выпуск продукта** отображаются в Azure DevOps в разделе **Панели \> Рабочие элементы**.

#### <a name="add-the-new-test-case-to-the-existing-test-suite"></a>Добавление нового тестового случая в существующий набор тестов

1. Перейдите в раздел **Планы испытаний \> Планы испытаний** и выберите область **План испытаний RSAT**.
2. Выберите **Добавить существующий**.
3. На странице **Добавление тестовых случаев в набор** выберите **Выполнить запрос**.
4. Выберите новый тестовый случай, который был создан для процесса **Выпуск продукта**, затем выберите **Добавить тестовые случаи** в нижнем правом углу страницы (эта кнопка не отображается на следующем рисунке).

    ![Страница добавления тестовых случаев в набор](./media/setup_rsa_tool_100.png)

    Теперь набор тестов включает два тестовых случая.

    ![Два тестовых случая в наборе тестов.](./media/setup_rsa_tool_101.png)

#### <a name="load-test-cases-into-rsat"></a>Загрузка тестовых случаев в RSAT

1. Откройте RSAT и выберите команду **Загрузить**.
2. После загрузки тестовых случаев выводится предупреждение "Это действие приведет к перезаписи файлов тестовых данных Excel, локальные изменения будут потеряны. Продолжить?" Выберите **Да** для обновления файлов параметров Excel в локальной системе, но не файлов параметров Excel, которые были отправлены в Azure DevOps.

    ![Предупреждающее сообщение](./media/setup_rsa_tool_102.png)

    Загружаются оба тестовых случая вместе с файлом параметров Excel для первого тестового случая. Поскольку при последнем выполнении было выбрано значение **Отправить**, файлы параметров извлекаются из Azure DevOps.

    ![Загруженные тестовые случаи](./media/setup_rsa_tool_103.png)

3. Выберите только второй тестовый случай, затем выберите **Создать \> Создание выполнения теста и файлов параметров**.

#### <a name="edit-the-excel-parameter-file"></a>Правка файла параметров Excel

1. Выберите только второй тестовый случай, затем выберите **Правка**, чтобы открыть соответствующий файл параметров Excel.
2. Скопируйте сохраненную переменную **{{EcoResProductCreate\_Identification\_ProductNumber\_Copy}}** (см. раздел [Изменение существующей записи задачи для создания сохраненной переменной](#modify-an-existing-task-recording-to-create-a-saved-variable)) из первого тестового случая во все поля, в которых используется номер продукта. В этом случае переменная копируется в поля **Номер продукта** и **Проверьте номер продукта** на листе **EcoResProductListPage**.

    ![Поля "Номер продукта" и "Проверьте номер продукта"](./media/setup_rsa_tool_104.png)

    > [!NOTE]
    > Переменные могут передаваться между проверками только в ходе одного тестового запуска. Имена переменных должны точно совпадать.

3. Выберите **Сохранить** и закройте книгу Excel.
4. Выберите **Отправить**, чтобы сохранить изменения, внесенные в файл параметров Excel.

#### <a name="run-the-chained-test-cases"></a>Выполнение связанных тестовых случаев

1. Выберите оба тестовых случая, затем выберите **Выполнить**.
2. Убедитесь, что оба тестовых случая прошли успешно.

    ![Поле "Результат" со значением успешного прохождения для обоих тестовых случаев](./media/setup_rsa_tool_105.png)
