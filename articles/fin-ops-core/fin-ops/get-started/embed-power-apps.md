---
title: Внедрение приложений на основе холста из Power Apps
description: В этом разделе описывается, как внедрить приложения на основе холста из Microsoft Power Apps в клиент для расширения функциональных возможностей продукта.
author: jasongre
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: FormRunConfigurationAddPAControl, FormRunConfigurationEditPAControl
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2018-02-28
ms.dyn365.ops.version: Platform update 14
ms.openlocfilehash: 4031be484c13136369803ad1c502c4998496143985d84835168a887bd474db0e
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6767683"
---
# <a name="embed-canvas-apps-from-power-apps"></a>Внедрение приложений на основе холста из Power Apps

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]

Microsoft Power Apps — это служба, которая позволяет разработчикам и обычным пользователям создавать пользовательские бизнес-приложения для мобильных устройств, планшетов и Интернета без необходимости написания кода. Приложения Finance and Operations поддерживают интеграцию с Power Apps. Приложения на основе холста, разработанные вами, вашей организации или более широкой экосистемой, можно внедрить в приложения Finance and Operations для расширения функциональности продукта. Например, можно создать приложение на основе холста из Power Apps, которое дополняет приложение Finance and Operations информацией, извлеченной из другой системы.

Для получения дополнительных сведений о внедрении приложений на основе холста посмотрите короткое видео [Как внедрить приложения на основе холста](https://www.youtube.com/watch?v=x3qyA1bH-NY).

## <a name="adding-an-embedded-canvas-app-from-power-apps-to-a-page"></a>Добавление внедренного приложения на основе холста из Power Apps на страницу

### <a name="overview"></a>Обзор

Перед внедрением приложения на основе холста из Power Apps в клиент необходимо найти или построить приложение с требуемыми визуальными элементами или функциональными возможностями. В этом разделе не содержится подробное описание процесса создания приложений. Если вы не знакомы с Power Apps, см. [документацию Power Apps](/powerapps/).

Существует два способа доступа к конкретному приложению на основе холста на странице, когда все готово к внедрению приложения. Можно выбрать любой из подходов, которые лучше всего подходят для вашего сценария. В первом подходе используется кнопка **Power Apps**, которая была добавлена в стандартной области действий. Приложения, которые добавляются при помощи этого подхода, отображаются как элементы в кнопке меню **Power Apps**. При выборе одного из этих пунктов открывает боковую область, содержащую внедренное приложение. Можно также внедрять приложения непосредственно на странице в виде новой вкладки, экспресс-вкладки или колонки либо в виде нового раздела в рабочей области.

При настройке вашего внедренного приложения на основе холста можно выбрать одно поле, которое необходимо отправить в качестве контекста в приложение. Этот шаг позволяет приложению реагировать на основе данных, просматриваемых в данный момент.

> [!NOTE]
> В настоящее время этот механизм нельзя использовать для внедрения приложений на основе модели.  

### <a name="details"></a>Подробности

В следующей процедуре показано, как внедрить в веб-клиент приложение на основе холста из Power Apps.

1. Перейдите на страницу, на которой вы хотите внедрить приложение на основе холста. Это будет та же страница, которая содержит данные, который должны быть переданы в приложение в качестве входных данных.
2. Откройте область **Добавить приложение из Power Apps**:

    - Щелкните **Параметры**, затем выберите **Персонализировать эту страницу**. В меню **Вставить** выберите **Power Apps**. Наконец, выберите область, в которой вы хотите добавить приложение. Если требуется внедрить приложение в меню кнопки Power Apps, выберите область действий. Если требуется внедрить приложение непосредственно на страницу, выберите соответствующую вкладку, экспресс-вкладку, колонку или раздела (если вы находитесь в рабочей области).
    - Если доступ к приложению будет осуществляться с помощью меню кнопки Power Apps, можно также щелкнуть кнопку меню **Power Apps** на стандартной панели действий, а затем выбрать **Добавить приложение**.

3. Настройка внедренного приложения:

    - Поле **Имя** показывает текст, отображаемый для кнопки или вкладки, которая будет содержать внедренное приложение. Часто требуется повторить имя приложения в этом поле.
    - В поле **Код приложения** указывается глобальный уникальный код (GUID) приложения на основе холста, которое требуется внедрить. Чтобы получить это значение, найдите приложение на сайте [make.powerapps.com](https://make.powerapps.com), затем ищите в поле **Код приложения** в разделе **Сведения**.
    - Для **Входные данные для приложения** можно при необходимости выбрать поле, которое содержит данные, которые необходимо передать приложению в качестве входных данных. Для получения сведений о том, как приложение может получить доступ к данным, отправленным из приложений Finance and Operations см. раздел далее в этой теме с названием [Создание приложения, использующего данные, отправляемые из приложений Finance and Operations](#building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps). 
        - Начиная с версии 10.0.19 текущее юридическое лицо также будет передано приложению на основе холста в качестве контекста с помощью параметра URL **cmp**. Это не повлияет на целевое приложение на основе холста, пока это приложение не будет использовать эту информацию. 
    - Выберите **Размер приложения**, соответствующий типу внедряемого приложения. Выберите **Узкий** для приложений, созданного для мобильных устройств, и **Широкий** для приложений, созданных для планшетов. Это гарантирует, что достаточное количество места будет выделено для внедренного приложения.
    - Экспресс-вкладка **Юридические лица** предоставляет возможность выбора, для какого юридического лица доступно приложение. По умолчанию приложение отображается во всех юридических лицах. Этот параметр доступен только в том случае, если функция [Сохраненные представления](saved-views.md) отключена. 

4. После подтверждения, что настройка выполнена верно, нажмите кнопку **Вставить** для внедрения приложения Power App на страницу. Будет предложено обновить браузер, чтобы появилось внедренное приложение.

## <a name="sharing-an-embedded-app"></a>Совместное использование внедренного приложения

После внедрения приложения на основе холста на страницу и проверки правильности его работы с любым контекстом данных, которые передаются с этой страницы, можно предоставить доступ к этому приложению другим пользователям в системе. Чтобы поделиться внедренным приложением на основе холста, выполните следующие действия.

1. [Предоставьте совместный доступ к приложению на основе холста](/powerapps/maker/canvas-apps/share-app) соответствующим пользователям, чтобы они могли получить доступ к приложению в Power Apps. 

2. Убедитесь, что целевые пользователи имеют соответствующие настройки, так что при просмотре страницы этими пользователями отображалось внедренное приложение. Можно использовать один из следующих подходов:

    - Рекомендуется: используйте функцию [сохраненных представлений](saved-views.md) для создания и публикации представления, которое включает в себя внедренное приложение. Этот подход гарантирует, что все пользователи, имеющие роли безопасности, которые предназначены для опубликованного представления, увидят приложение в приложениях Finance and Operations. 
    - Если у вас функция сохраненных представлений не включена, попросите администратора системы отправить персонализацию, которая включает внедренное приложение, всем пользователям или подмножеству пользователей. Кроме того, можно экспортировать персонализации вашей страницы и отправить их одному или нескольким пользователям. Каждый из этих пользователей затем может импортировать персонализации. Панель инструментов персонализации содержит действия, которые позволяют экспортировать и импортировать персонализации. 
    
> [!NOTE]
> Если доступ к приложению на основе холста был предоставлен внешним пользователям, эти пользователи не могут использовать внедренное приложение внутри приложений Finance and Operations. Однако они имеют доступ к приложению непосредственно внутри Power Apps. Внешние пользователи включают гостей и пользователей, не принадлежащих к каталогу Microsoft 365 Azure Directory, в котором развернуто приложение Finance and Operations.

См. раздел [Персонализация работы пользователя](personalize-user-experience.md), в котором приведены более подробных сведения о возможностях персонализации в продукте и порядке их использования.

## <a name="building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps"></a>Создание приложения на основе холста, в котором используются данные, отправленные из приложений Finance and Operations

При создании приложения на основе холста, которое будет внедрено в приложение Finance and Operations, одна важная часть процесса — это использование входных данных из этого приложения Finance and Operations. Из процесса разработки Power Apps доступ к входным данным, которые передаются из приложения Finance and Operations, возможен с помощью переменной **Param("EntityId")**. Кроме того, с версии 10.0.19 текущее юридическое лицо также будет передано приложению на основе холста через переменную **Param("cmp")**. 

Например, в функции OnStart приложения можно задать входные данные из приложений Finance and Operations для переменной следующим образом:

``` Power Apps
If(!IsBlank(Param("EntityId")), Set(FinOpsInput, Param("EntityId")), Set(FinOpsInput, ""));

If(!IsBlank(Param("cmp")), Set(FinOpsLegalEntity, Param("cmp")), Set(FinOpsLegalEntity, ""));
```

## <a name="viewing-a-canvas-app"></a>Просмотр приложения на основе холста

Для просмотра внедренного приложения на основе холста на странице в приложениях Finance and Operations просто перейдите на страницу, на которой находится внедренное приложение. Помните, что доступ к приложениям можно получить, нажав кнопку **Power Apps** на стандартной панели действий. Они могут также отображаться непосредственно на странице в виде новой вкладки, экспресс-вкладки или колонки либо в виде нового раздела в рабочей области. При первой попытке загрузить приложение на странице пользователю будет предложено выполнить вход в систему. Этот шаг гарантирует, что у пользователей имеются соответствующие разрешения на использование приложения.

## <a name="editing-an-embedded-app"></a>Изменение внедренного приложения

После того как приложение внедрено на страницу, может потребоваться внести изменения в конфигурацию этого приложения. Например, может потребоваться изменить метку, связанную с внедренным приложением, или была создана новая версии приложения и необходимо обновить идентификатор приложения для указания в последней версии приложения.

Выполните следующие действия, чтобы изменить конфигурацию внедренного приложения.

1. Перейдите в область **Редактировать приложение**.

    - Если доступ к внедренному приложению осуществляется с помощью кнопки меню Power Apps, щелкните правой кнопкой мыши кнопку меню Power Apps и выберите **Персонализация**. Выберите приложение, которое требуется настроить, в раскрывающемся меню **Выбрать приложение**.
    - Если внедренное приложение отображается непосредственно на странице, выберите **Параметры**, затем выберите **Персонализировать эту страницу**. С помощью инструмента **Выбрать** щелкните внедренное приложение.

2. Внесите необходимые изменения в конфигурацию приложения, затем щелкните **Сохранить**.

## <a name="removing-an-app"></a>Удаление приложения

После того как приложение было внедрено на страницу, существует два способа удаления его при необходимости:

- Перейдите в область **Редактировать приложение**, используя инструкции из пункта [Изменение внедренного приложения](#editing-an-embedded-app) ранее в этом разделе. Убедитесь, что в области отображается информация для внедренного приложения, которое вы хотите удалить, затем нажмите кнопку **Удалить**.
- Поскольку внедренное приложение сохраняется как данные персонализации, очистка персонализации страницы также приведет к удалению всех внедренных приложений на этой странице. Обратите внимание, что очистка персонализации страницы является необратимой и не может быть отменена. Чтобы удалить вашу персонализацию на странице, выберите **Параметры**, затем щелкните **Персонализировать эту страницу**, затем **Очистить**. После обновления браузера все предыдущие персонализации для этой страницы будут удалены. Дополнительные сведения об оптимизации страниц с помощью персонализации см. в разделе [Персонализация работы пользователя](personalize-user-experience.md).

## <a name="appendix"></a>Приложение

### <a name="developer-modeling-a-canvas-app-on-a-form"></a>[Разработчик] Моделирование приложения на основе холста в форме

Хотя в этом разделе основное внимание уделяется внедрению приложений на основе холста с помощью персонализации, разработчики также имеют возможность добавить приложение на основе холста в форму с помощью среды разработки Visual Studio. Чтобы сделать это, просто добавьте PowerAppsHostControl в форму. Свойства метаданных, доступные в элементе управления, обеспечивают те же возможности, что и персонализация.


### <a name="developer-specifying-where-an-app-can-be-embedded"></a>[Разработчик] Указание, где возможно внедрение приложения

По умолчанию пользователи могут внедрять приложения на любой странице, как в кнопку меню Power Apps, так и непосредственно на страницу в виде вкладки, экспресс-вкладки, колонки или нового раздела в рабочей области. Тем не менее при необходимости разработчики также могут настроить эту возможность, чтобы разрешить только внедрение приложений на некоторых страницах путем реализации следующих методов:

- **isPowerAppPersonalizationEnabled** — если этот метод возвращает значение false для конкретной страницы, то кнопка меню Power Apps не будет отображаться и пользователи не смогут внедрять приложения ни в каком месте на этой странице, в том числе в виде вкладки.
- **isPowerAppTabPersonalizationEnabled** — если этот метод возвращает значение false для конкретной страницы, то пользователи не смогут внедрять приложения непосредственно на странице в качестве вкладки, экспресс-вкладки или раздела панорамы. Пользователи по-прежнему будут иметь возможность внедрять приложения через кнопку меню Power Apps, если внедрение разрешено на странице.

Следующий пример показывает новый класс с двумя методами, необходимый для настройки того, где могут быть внедрены приложения.

```powerapps
[ExtensionOf(classStr(FormRunConfigurationPowerAppsConfiguration))]

public final class ClassTest_Extension
{
    public static boolean isPowerAppPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppPersonalizationEnabled(pageName);
        return result;
    }
    
    public static boolean isPowerAppTabPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppTabPersonalizationEnabled(pageName);
        return result;
    }
}
```


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
