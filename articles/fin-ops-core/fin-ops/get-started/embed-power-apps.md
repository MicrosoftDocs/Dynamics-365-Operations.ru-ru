---
title: Внедрение приложений на основе холста из Power Apps
description: В этом разделе описывается, как внедрить приложения на основе холста из Microsoft Power Apps в клиент для расширения функциональных возможностей продукта.
author: jasongre
ms.date: 09/13/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: FormRunConfigurationAddPAControl, FormRunConfigurationEditPAControl
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2018-02-28
ms.dyn365.ops.version: Platform update 14
ms.openlocfilehash: 32bf477bb42657b06f22f7677dcb580b38f0a55c
ms.sourcegitcommit: 7a2001e4d01b252f5231d94b50945fd31562b2bc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2021
ms.locfileid: "7488062"
---
# <a name="embed-canvas-apps-from-power-apps"></a>Внедрение приложений на основе холста из Power Apps

[!include [banner](../includes/banner.md)]

Microsoft Power Apps — это служба, которая позволяет разработчикам и обычным пользователям создавать пользовательские бизнес-приложения для мобильных устройств, планшетов и Интернета без необходимости написания кода. Приложения Finance and Operations поддерживают интеграцию с Power Apps. Приложения на основе холста, разработанные вами, вашей организации или более широкой экосистемой, можно внедрить в приложения Finance and Operations для расширения функциональности продукта. Например, можно создать приложение на основе холста из Power Apps, которое дополняет приложение Finance and Operations информацией, извлеченной из другой системы.

Для получения дополнительных сведений о внедрении приложений на основе холста посмотрите короткое видео [Как внедрить приложения на основе холста](https://www.youtube.com/watch?v=x3qyA1bH-NY).

## <a name="adding-an-embedded-canvas-app-from-power-apps-to-a-page"></a>Добавление внедренного приложения на основе холста из Power Apps на страницу

Перед внедрением приложения на основе холста из Power Apps в клиент необходимо найти или построить приложение с требуемыми визуальными элементами или функциональными возможностями. В этом разделе не содержится подробное описание процесса создания приложений. Если вы не знакомы с Power Apps, см. [документацию Power Apps](/powerapps/).

Существует три способа внедрения приложения на основе холста в приложение Finance and Operations. Можно использовать подход, который наилучшим образом подходит для вашего сценария. 

- Внедрите приложение на основе холста в кнопку **Power Apps** на стандартной панели операций страницы. Приложения, добавляемые таким образом, отображаются как элементы в кнопке меню **Power Apps**, и приложения открываются в боковых областях. 
- Внедрите приложение на основе холста сразу на существующую страницу как новую страницу вкладки (сводная вкладка, экспресс-вкладка, колонка или рабочая область).
- Создайте новое взаимодействие на полную страницу для приложения на основе холста с панели мониторинга.

При настройке вашего внедренного приложения на основе холста можно выбрать одно поле, которое необходимо отправить в качестве контекста в приложение. Этот шаг позволяет приложению реагировать на основе данных, просматриваемых в данный момент.

> [!NOTE]
> Этот механизм нельзя использовать для внедрения приложений на основе модели.

### <a name="embedding-a-canvas-app-on-an-existing-page"></a>Внедрение приложения на основе холста на существующую страницу

В следующей процедуре показано, как внедрить приложение на основе холста на существующую страницу из Power Apps.

1. Перейдите на страницу, на которой вы хотите внедрить приложение на основе холста. Эта страница будет содержать данные, которые должны быть переданы в приложение в качестве входных данных.
2. Откройте область **Добавить приложение из Power Apps**:

    - Если приложение будет внедрено непосредственно на странице, выберите **Параметры** \> **Персонализировать эту страницу** \> **Еще**, а затем выполните одно из следующих действий:

        - Если включена функция **Приложения полной страницы**, выберите **Добавить страницу**, а затем выберите регион, в который необходимо добавить приложение. Чтобы внедрить приложение в кнопку меню **Power Apps**, выберите панель операций. Чтобы внедрить приложение непосредственно на страницу, выберите соответствующую вкладку, экспресс-вкладку, колонку или раздела (если вы находитесь в рабочей области). Затем в области **Добавление приложения** выберите **Power Apps**.
        - Если функция **Приложения полной страницы** выключена, выберите **Добавить приложение из Power Apps**, а затем выберите регион, в который необходимо добавить приложение. Чтобы внедрить приложение в кнопку меню **Power Apps**, выберите панель операций. Чтобы внедрить приложение непосредственно на страницу, выберите соответствующую вкладку, экспресс-вкладку, колонку или раздела (если вы находитесь в рабочей области).

    - Если доступ к приложению будет осуществляться с помощью кнопки меню **Power Apps**, можно выбрать кнопку меню **Power Apps** на стандартной панели действий, а затем выбрать **Добавить приложение**.

3. Настройка внедренного приложения. Дополнительные сведения см. в разделе [Настройка приложения на основе холста](#configuring-a-canvas-app) далее в этой теме.
4. После подтверждения правильности настройки выберите **Вставить**.

    - Если функция **Сохраненные представления** отключена, вам будет предложено обновить браузер, чтобы увидеть внедренное приложение.
    - Если включена функция **Сохраненные представления**, необходимо сохранить представление для сохранения изменений.

### <a name="embedding-a-canvas-app-as-a-full-page-experience-from-the-dashboard"></a>Внедрение приложения на основе холста в качестве полностраничного взаимодействия с панели мониторинга

Возможно, потребуется внедрить приложение на основе холста с панели мониторинга, если приложение не связано с существующей страницей или если требуется только реализовать приложение как полностраничное внутри приложения Finance and Operations.

> [!NOTE]
> Чтобы сделать доступными эти возможности, необходимо включить функцию **Приложения полной страницы** в модуле "Управление функциями". 

1. Откройте панель мониторинга.
2. Выберите и удерживайте (или щелкните правой кнопкой мыши) страницу, выберите **Персонализация**, затем выберите **Добавить страницу**.
3. В области **Добавить страницу** выберите **Power Apps**.
4. Настройка внедренного приложения. Дополнительные сведения см. в разделе [Настройка приложения на основе холста](#configuring-a-canvas-app) далее в этой теме.
5. Выберите **Сохранить**, чтобы добавить приложение на панель мониторинга как новую плитку.
6. Выберите новую плитку на панели мониторинга и убедитесь, что приложение на основе холста выглядит так, как ожидалось.

### <a name="configuring-a-canvas-app"></a>Настройка приложения на основе холста

При внедрении приложения на основе холста необходимо задать следующие параметры:

- **Имя** — введите текст, который должен отображаться для кнопки или вкладки, содержащей встраиваемое приложение. Часто может потребовать повторить имя приложения в этом поле.
- **Код приложения** — указывается глобальный уникальный код (GUID) приложения на основе холста, которое требуется внедрить. Чтобы получить это значение, найдите приложение на сайте [make.powerapps.com](https://make.powerapps.com), затем ищите в поле **Код приложения** в разделе **Сведения**.
- **Входные данные для приложения** — можно при необходимости выбрать поле, которое содержит данные, которые необходимо передать приложению в качестве входных данных. Для получения сведений о том, как приложение может получить доступ к данным, отправленным из приложений Finance and Operations см. [Создание приложения, использующего данные, отправляемые из приложений Finance and Operations](#building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps) далее в этой теме.

    С версии 10.0.19 текущее юридическое лицо также будет передано приложению на основе холста в качестве контекста с помощью параметра URL **cmp**. Это поведение не повлияет на целевое приложение на основе холста, пока приложение не будет использовать эту информацию.

- **Размер приложения** — тип внедряемого приложения. Выберите **Узкий** для приложений, созданных для мобильных устройств, или **Широкий** для приложений, созданных для планшетов. Этот параметр гарантирует, что достаточное количество места будет выделено для внедренного приложения.
- **Юридические лица** — можно выбрать юридические лица, для которых должно быть доступно приложение. По умолчанию приложение доступно для всех юридических лиц. Этот параметр доступен только в том случае, если внедрение осуществляется непосредственно на существующую страницу, но функция **[Сохраненные представления](saved-views.md)** отключена.

## <a name="sharing-an-embedded-app"></a>Совместное использование внедренного приложения

После внедрения приложения на основе холста на страницу и проверки правильности его работы можно предоставить доступ к этому приложению другим пользователям в системе. Чтобы поделиться внедренным приложением на основе холста, выполните следующие действия.

1. [Предоставьте совместный доступ к приложению на основе холста в Power Apps](/powerapps/maker/canvas-apps/share-app) соответствующим пользователям, чтобы они могли получить доступ к приложению прямо в Power Apps.
2. Совместно используйте личные настройки, связанные с внедренным приложением с нужными пользователями. Можно использовать один из следующих подходов:

    - **Опубликовать представление (рекомендуется):** Если функция **[Сохраненные представления](saved-views.md)** включена, рекомендуемый и предпочтительный подход состоит в создании представления, которое включает в себя приложение на основе холста, а затем публикует это представление для нужных пользователей. Этот подход гарантирует, что все пользователи, имеющие роли безопасности, которые предназначены для опубликованного представления, увидят приложение на основе холста на странице.

        Можно также опубликовать приложение на основе холста, встроенное в качестве полноэкранного из панели мониторинга. На панели мониторинга выберите и удерживайте (или щелкните правой кнопкой мыши) плитку, связанную с приложением, выберите **Персонализация** и выберите **Опубликовать страницу**. Отображается интерфейс, аналогичный *Публикация представлений*, и можно выбрать роли безопасности для публикации. В обновлении 10.0.21 или более поздней версии, если функция **Усовершенствованная поддержка юридических лиц для сохраненных представлений** включена, можно также опубликовать приложение в нужных юридических лицах.

    - Если функция **Сохраненные представления** отключена, системный администратор может предоставить личную настройку, которая включает приложение на основе холста, соответствующее набору пользователей на странице **Персонализация**. Кроме того, можно экспортировать персонализации вашей страницы и отправить их одному или нескольким пользователям. Каждый из этих пользователей затем может импортировать персонализации. Панель инструментов персонализации содержит кнопки, которые позволяют экспортировать и импортировать персонализации.

> [!NOTE]
> Если доступ к приложению на основе холста был предоставлен внешним пользователям, эти пользователи не могут использовать внедренное приложение внутри приложений Finance and Operations. Однако они имеют доступ к приложению непосредственно внутри Power Apps. Внешние пользователи включают гостей и пользователей, не принадлежащих к каталогу Microsoft 365 Azure Directory, в котором развернуто приложение Finance and Operations.

См. раздел [Персонализация работы пользователя](personalize-user-experience.md), в котором приведены более подробных сведения о возможностях персонализации в продукте и порядке их использования.

## <a name="building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps"></a>Создание приложения на основе холста, в котором используются данные, отправленные из приложений Finance and Operations

При создании приложения на основе холста, которое будет внедрено в приложение Finance and Operations, одна важная часть процесса — это использование входных данных из этого приложения Finance and Operations. Из процесса разработки Power Apps доступ к входным данным, которые передаются из приложения Finance and Operations, возможен с помощью переменной **Param("EntityId")**. Кроме того, с версии 10.0.19 текущее юридическое лицо также будет передано приложению на основе холста через переменную **Param("cmp")**. 

Например, в функции OnStart приложения можно задать входные данные из приложений Finance and Operations для переменной следующим образом:

``` Power Apps
If(!IsBlank(Param("EntityId")), Set(FinOpsInput, Param("EntityId")), Set(FinOpsInput, ""));

If(!IsBlank(Param("cmp")), Set(FinOpsLegalEntity, Param("cmp")), Set(FinOpsLegalEntity, ""));
```

## <a name="viewing-a-canvas-app"></a>Просмотр приложения на основе холста

Для просмотра внедренного приложения на основе холста на странице в приложениях Finance and Operations просто перейдите на страницу, на которой находится внедренное приложение. Помните, что доступ к приложениям можно получить, нажав кнопку **Power Apps** на стандартной панели действий. Они могут также отображаться непосредственно на странице в виде новой вкладки, экспресс-вкладки или колонки либо в виде нового раздела в рабочей области. При первой попытке загрузить приложение на странице пользователю будет предложено выполнить вход в систему. Этот шаг гарантирует, что у пользователей имеются соответствующие разрешения на использование приложения.

## <a name="editing-an-embedded-app"></a>Изменение внедренного приложения

После того как приложение внедрено на страницу, может потребоваться внести изменения в конфигурацию этого приложения. Например, может потребоваться изменить метку, связанную с внедренным приложением, или была создана новая версии приложения и необходимо обновить идентификатор приложения для указания в последней версии приложения.

Выполните следующие действия, чтобы изменить конфигурацию внедренного приложения.

1. Перейдите в область **Редактировать приложение**.

    - Если доступ к внедренному приложению осуществляется с помощью кнопки меню Power Apps, выберите и удерживайте (или щелкните правой кнопкой мыши) кнопку меню Power Apps и выберите **Персонализация**. Выберите приложение, которое требуется настроить, в раскрывающемся меню **Выбрать приложение**.
    - Если внедренное приложение отображается непосредственно на странице, выберите **Параметры**, затем выберите **Персонализировать эту страницу**. С помощью инструмента **Выбрать** щелкните внедренное приложение.
    - Если встраиваемое приложение было добавлено из панели мониторинга, откройте панель мониторинга, выберите и удерживайте (или щелкните правой кнопкой мыши) плитку, связанную с приложением на основе холста, выберите **Персонализация**, а затем выберите **Изменить страницу**.

2. Внесите необходимые изменения в конфигурацию приложения, затем щелкните **Сохранить**.

## <a name="removing-an-app"></a>Удаление приложения

После того как приложение было внедрено на страницу, существует несколько способов удаления его при необходимости:

- Перейдите в область **Редактировать приложение**, используя инструкции из пункта [Изменение внедренного приложения](#editing-an-embedded-app) ранее в этом разделе. Убедитесь, что в области отображается информация для внедренного приложения, которое вы хотите удалить, затем нажмите кнопку **Удалить**.
- Если встраиваемое приложение было добавлено из панели мониторинга, откройте панель мониторинга, выберите и удерживайте (или щелкните правой кнопкой мыши) плитку, связанную с приложением на основе холста, выберите **Персонализация**, а затем выберите **Удалить страницу**. 
- Поскольку внедренное приложение сохраняется как данные персонализации, очистка персонализации страницы также приведет к удалению всех внедренных приложений на этой странице. Обратите внимание, что очистка персонализации страницы является необратимой и не может быть отменена. Чтобы удалить вашу персонализацию на странице, выберите **Параметры**, затем щелкните **Персонализировать эту страницу**, затем **Очистить**. После обновления браузера все предыдущие персонализации для этой страницы будут удалены. Дополнительные сведения об оптимизации страниц с помощью персонализации см. в разделе [Персонализация работы пользователя](personalize-user-experience.md).

## <a name="appendix"></a>Приложение

### <a name="developer-modeling-a-canvas-app-on-a-form"></a>[Разработчик] Моделирование приложения на основе холста в форме

Хотя в этом разделе основное внимание уделяется внедрению приложений на основе холста с помощью персонализации, разработчики также имеют возможность добавить приложение на основе холста в форму с помощью среды разработки Visual Studio. Чтобы сделать это, просто добавьте PowerAppsHostControl в форму. Свойства метаданных, доступные в элементе управления, обеспечивают те же возможности, что и персонализация.

### <a name="developer-specifying-where-an-app-can-be-embedded"></a>[Разработчик] Указание, где возможно внедрение приложения

По умолчанию пользователи могут внедрять приложения на любой странице, как в кнопку меню Power Apps, так и непосредственно на страницу в виде вкладки, экспресс-вкладки, колонки или нового раздела в рабочей области. Тем не менее при необходимости разработчики также могут настроить эту возможность, чтобы разрешить только внедрение приложений на некоторых страницах путем реализации следующих методов:

- **isPowerAppPersonalizationEnabled** — если этот метод возвращает значение false для конкретной страницы, то кнопка меню Power Apps не будет отображаться и пользователи не смогут внедрять приложения ни в каком месте на этой странице, в том числе в виде вкладки.
- **isPowerAppTabPersonalizationEnabled** — если этот метод возвращает значение false для конкретной страницы, то пользователи не смогут внедрять приложения непосредственно на странице в качестве вкладки, экспресс-вкладки или раздела панорамы. Пользователи по-прежнему будут иметь возможность внедрять приложения через кнопку меню Power Apps, если внедрение разрешено на странице.

Следующий пример показывает новый класс с двумя методами, необходимый для настройки того, где могут быть внедрены приложения.

```powerapps
[ExtensionOf(classStr(FormRunConfigurationPowerAppsConfiguration))]

public final class ClassTest_Extension
{
    public static boolean isPowerAppPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppPersonalizationEnabled(pageName);
        return result;
    }
    
    public static boolean isPowerAppTabPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppTabPersonalizationEnabled(pageName);
        return result;
    }
}
```

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
