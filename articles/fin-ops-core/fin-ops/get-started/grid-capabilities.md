---
title: Возможности сетки
description: В этом разделе описываются несколько функциональных возможностей элемента управления "сетка". Необходимо включить новую функцию сетки для доступа к этим возможностям.
author: jasongre
ms.date: 04/25/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: DefaultDashboard
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2020-02-29
ms.dyn365.ops.version: Platform update 33
ms.openlocfilehash: 57133a853d1700b2d8ebb938f93af475410b82cb
ms.sourcegitcommit: d715e44b92b84b1703f5915d15d403ccf17c6606
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2022
ms.locfileid: "8644424"
---
# <a name="grid-capabilities"></a>Возможности сетки

[!include [banner](../includes/banner.md)]

Новый элемент управления "сетка" предоставляет несколько полезных и мощных возможностей, которые могут использоваться для улучшения производительности пользователя, создания более интересных представлений данных и получения осмысленных аналитических данных. В этой статье рассматриваются следующие возможности: 

- Рассчитываемые итоги
- Опережающий ввод системы
- Оценка математических выражений 
- Группировка табличных данных (включается отдельно с помощью функции **Группировка в сетках**)
- Закрепление столбцов (включено отдельно с помощью функции **Закрепление столбцов в сетках**)
- Автоподбор ширины столбца
- Растягиваемые столбцы

## <a name="calculating-totals"></a>Рассчитываемые итоги
В приложениях для финансов и операций пользователи имеют возможность просматривать итоговые значения в нижней части числовых столбцов в сетках. В разделе нижнего колонтитула в нижней части сетки отображаются эти итоги. 

### <a name="showing-the-grid-footer"></a>Отображение нижнего колонтитула сетки
В нижней части каждой табличной сетки в приложениях для финансов и операций имеется область нижнего колонтитула. В нижнем колонтитуле могут отображаться полезные сведения, имеющие отношение к данным, отображаемым в сетке. Ниже приведены несколько примеров таких сведений:

- Число выбранных строк в таблице (когда вы выбрали более одной записи)
- Общие итоги внизу настроенных числовых столбцов
- Количество строк в наборе данных 

Этот нижний колонтитул по умолчанию скрыт, но вы можете включить его. Чтобы показать нижний колонтитул для сетки, нажмите кнопку **Параметры сетки** в заголовке сетки и выберите пункт **Показать нижний колонтитул**. После включения нижнего колонтитула для определенной сетки этот параметр будет сохранен до тех пор, пока пользователь не решит скрыть нижний колонтитул. Чтобы скрыть нижний колонтитул, выберите **Скрыть нижний колонтитул** в меню **Параметры сетки**.

### <a name="specifying-columns-with-totals"></a>Указание столбцов с итогами
В настоящее время ни в каких столбцах не отображаются итоговые значения по умолчанию. Вместо этого это считается однократным действием настройки, аналогичным настройке ширины столбцов в сетках. После того как вы укажете, что хотите просмотреть итоговые значения для столбца, этот параметр будет сохранен при следующем посещении страницы.

Имеется два способа настройки столбца для отображения итогового значения: 

- Щелкните правой кнопкой мыши столбец для просмотра итогов и затем выберите **Итоговое значение этого столбца**. Это действие приводит к возникновению трех событий:

    1. Нижний колонтитул становится видимым. 
    2. Ваше предпочтение просмотреть итоги по этому столбцу сохранено. 
    3. Вычисление итогов инициируется для этого столбца и всех остальных, для которых вы ранее настроили просмотр итогов. Время, необходимое для отображения итога, зависит от размера набора данных, для которого выполняется подведение итога.

- После отображения нижнего колонтитула выберите **Показать итог** в области нижнего колонтитула в нижней части столбца, для которого нужно просмотреть итог. Если настроенные столбцы отсутствуют, кнопка **Показать итог** будет доступна для всех числовых столбцов. 

    Как только хотя бы один столбец настроен для итогов, кнопки **Показать итоги** будут доступны только при наведении курсора или при фокусе. При выборе команды **Показать итог** просто сохраняется предпочтение для просмотра итогов в этом столбце, так что во время последующих посещениях страницы этот параметр будет применен. В нижнем колонтитуле это состояние обозначается тире, которое отображается в столбце. (В качестве альтернативы, если набор данных достаточно мал, сразу отображается итог.)

Если вы сделали ошибку и больше не нужно просматривать итог в определенном столбце, щелкните правой кнопкой мыши столбец и выберите **Скрыть итог** или выберите кнопку **Скрыть итог** в нижнем колонтитуле этого столбца. Этот параметр также будет сохранен для последующих посещений страницы. 

### <a name="calculating-totals"></a>Рассчитываемые итоги
При переходе к странице с видимым нижним колонтитулом и столбцами с настроенным итогом, итоговые значения в нижнем колонтитуле могут быть отображены или могут отсутствовать. Поведение зависит от размера набора данных на странице. Если набор данных достаточно мал, итоговые значения будут отображаться автоматически вместе с количеством строк в наборе данных. Если в нижнем колонтитуле в столбцах, настроенных для итогов, имеются тире, то набор данных слишком велик для того, чтобы система отображала итоговые значения немедленно, а для расчета итоговых сумм требуется явное действие. Для этого нажмите кнопку **Рассчитать** в нижнем колонтитуле или щелкните правой кнопкой мыши столбец, для которого нужно получить итог, и выберите **Итоговое значение этого столбца**.

Если вычисление занимает слишком много времени, можно отменить операцию, нажав кнопку **Отмена**. Иногда набор данных будет слишком большим для расчета итоговых сумм (пределы, накладываемые вашей организацией), и вы будете извещены о необходимости фильтрации данных. 

> [!NOTE]
> Администратор системы может изменить предельное число записей, доступных для расчета итоговых значений, настроив параметр **Максимальное число локальных записей для каждой сетки** на странице **Параметры производительности клиента**. Значение по умолчанию — 25 000 записей. Администраторы должны быть внимательны при изменении этого значения, поскольку слишком большое значение может исчерпать доступную память на компьютере пользователя. Рекомендуется, чтобы это значение не превышало 50 000 записей.   

Итоги будут обновляться автоматически при обновлении, удалении или создании строк в наборе данных.

## <a name="typing-ahead-of-the-system"></a>Опережающий ввод системы
Во многих бизнес-сценариях возможность быстрого ввода данных в систему очень важна. Перед тем как новый элемент управления сетки был введен, пользователи могли изменить данные только в текущей строке. Перед тем как они смогут создать новую строку или перейти в другую строку, они вынуждены ожидать, пока система не сможет успешно выполнить проверку всех изменений. При попытке уменьшить количество времени, в течение которого пользователи ожидают завершения этих проверок, и повышения производительности пользователей новая сетка корректирует эти проверки так, чтобы они были асинхронными. Таким образом, пользователь может перейти к другим строкам, чтобы внести изменения, пока ожидаются предыдущие проверки строк. 

Для поддержки этого нового поведения новый столбец для статуса строки был добавлен в правую часть столбца выбора строки, когда сетка находится в режиме редактирования. Этот столбец указывает один из следующих статусов:

- **Пусто** — изображение без статуса указывает, что строка успешно сохранена системой.
- **Ожидание обработки** — этот статус указывает, что изменения в строке еще не были сохранены сервером, но находятся в очереди изменений, которые должны быть обработаны. Перед выполнением действия вне сетки необходимо дождаться, чтобы все ожидающие изменения были обработаны. Кроме того, текст в этих строках отображается курсивом, чтобы обозначить несохраненный статус строк. 
- **Недопустимое состояние** — этот статус означает, что во время обработки строки появилось какое-либо предупреждение или сообщение, которое могло помешать системе сохранить изменения в этой строке. В старой сетке вы принудительно возвращались в строку, если операция сохранения завершалась неудачно. Однако в новой сетке будет выдано сообщение о том, что обнаружена проблема проверки, но вы можете решить, когда следует исправить ошибки в строке. Когда вы готовы устранить проблему, вы можете переместить фокус обратно в эту строку вручную. Кроме того, можно выбрать действие **Исправить проблему**. Это действие сразу же переводит фокус обратно в строку, которая содержит проблему, и позволяет вносить изменения внутри сетки или за ее пределами. Обратите внимание, что обработка последующих ожидающих строк останавливается до тех пор, пока не будет исправлено данное предупреждение проверки. 
- **Приостановлено** — этот статус указывает на то, что обработка сервером приостановлена, так как выполняется проверка строки, которая вызвала всплывающее диалоговое окно, требующее ввода данных пользователем. Так как пользователь может вводить данные в какую-либо другую строку, всплывающее диалоговое окно не становится немедленно видимым для этого пользователя. Вместо этого оно будет представлено, когда пользователь решит возобновить обработку. Этот статус сопровождается уведомлением, которое информирует пользователя о ситуации. Уведомление включает действие **Возобновить обработку**, которое запускает всплывающее диалоговое окно.

Когда пользователи вводят данные перед тем местом, которое обрабатывается сервером, они могут ожидать некоторого ухудшения в опыте ввода данных, такого как отсутствие подстановок, проверка на уровне элементов управления и ввод значений по умолчанию. Пользователям, которым требуется раскрывающийся список для поиска значения, рекомендуется подождать, пока сервер не дойдет до текущей строки. Проверка на уровне элемента управления и ввод значений по умолчанию также будут выполняться, когда сервер обрабатывает эту строку.

### <a name="pasting-from-excel"></a>Вставка из Excel
Пользователи всегда могли экспортировать данные из сеток в приложениях для финансов и операций в Microsoft Excel, используя механизм **Экспорт в Excel**. Однако возможность опережающего ввода данных до обработки системой позволяет новой сетке поддерживать копирование таблиц из Excel и их вставку непосредственно в сетки в приложениях для финансов и операций. Ячейка сетки, из которой запускается операция вставки, определяет место, с которого начинается вставка копируемой таблицы. Содержимое сетки перезаписывается содержимым скопированной таблицы, за исключением двух случаев:

- Если число столбцов в копируемой таблице превышает число столбцов, остающихся в сетке, начиная с места вставки, пользователь получает уведомление о том, что лишние столбцы были пропущены. 
- Если количество строк в копируемой таблице превышает число строк в сетке, начиная с места вставки, существующие ячейки перезаписываются вставленным содержимым, а все дополнительные строки скопированной таблицы вставляются в конце сетки как новые строки. 

## <a name="evaluating-math-expressions"></a>Оценка математических выражений
В качестве ускорителя производительности пользователи могут вводить в сетке математические формулы в виде числовых ячеек. Они не должны выполнять расчет в приложении вне системы. Например, если ввести **=15\*4**, а затем нажать клавишу **Tab**, чтобы переместиться из поля, система выполнит оценку выражения и сохранит значение **60** для поля.

Чтобы система распознавала значение как выражение, следует начинать значение со знака равенства (**=**). Дополнительную информацию о поддерживаемых операторах и синтаксисе см. в разделе [Поддерживаемые математические символы](http://bugwheels94.github.io/math-expression-evaluator/#supported-maths-symbols).

## <a name="grouping-tabular-data"></a>Группирование табличных данных
Бизнес-пользователям часто приходится выполнять нерегламентированный анализ данных. Хотя это можно сделать, если экспортировать данные в Microsoft Excel и с помощью сводных таблиц, функция **Группировка в сетках**, которая зависит от новой функции элемента управления сетки, позволяет пользователям организовывать свои табличные данные нужным образом в приложениях для финансов и операций. Поскольку эта функция расширяет функцию **Итог**, **Группирование** позволяет получить осмысленные сведения о данных, представляя промежуточные итоги на уровне группы.

Для использования этой функции щелкните правой кнопкой мыши столбец, по которому необходимо выполнить группировку, и выберите **Группировать по этому столбцу**. Это действие сортирует данные по выбранному столбцу, добавит новый столбец **Группировать по** в начало сетки и вставит "строки заголовков" в начало каждой группы. В этих строках заголовка содержится следующая информация о каждой группе:

- Значение данных для группы 
- Имя столбца (эта информация особенно полезна при наличии нескольких уровней группировки)
- Число строк данных в этой группе
- Промежуточные итоги для любого столбца, настроенного для отображения итогов

Если [Сохраненные представления](saved-views.md) включены, можно сохранить группировку в виде части представления на страницах, которые позволяют сохранять запросы в представлениях. Например, те, которые имеют большие селекторы представлений. Дополнительные сведения см. в разделе [Переключение между представлениями](saved-views.md#switching-between-views). 

### <a name="multiple-levels-of-grouping"></a>Несколько уровней группировки
После группировки данных по одному столбцу можно группировать данные по другому столбцу, выбрав **Группировать по этому столбцу** в нужном столбце. Этот процесс может повторяться до тех пор, пока не будет достигнуто 5 вложенных уровней группировки, что является максимально допустимой глубиной. На этом этапе будет невозможно сгруппировать по дополнительным столбцам.

В любой момент можно удалить группировку по любому столбцу, щелкнув правой кнопкой мыши этот столбец и выбрав команду **Разгруппировать**. Можно также удалить группировку из всех столбцов, выбрав **Параметры сетки**, а затем **Разгруппировать все**.

### <a name="sorting-grouped-data"></a>Сортировка сгруппированных данных
После группировки данных по одному или нескольким столбцам можно изменить направление сортировки для любого столбца группировки с помощью соответствующего заголовка столбца. 

Поведение при сортировке несгруппированных столбцов зависит от версии продукта:

- В версии 10.0.24 и более ранних версиях при сортировке несгруппированного столбца группирование удаляется из всех столбцов и данные сортируются по выбранному столбцу. 
- В версии 10.0.25 и новее при сортировке несгруппированного столбца группирование остается прежним и данные сортируются внутри группы по выбранному столбцу.

### <a name="expanding-and-collapsing-groups"></a>Развертывание и свертывание групп
При начальной группировке данных все группы будут развернуты. Можно создать обобщенные представления данных, сворачивая отдельные группы, или можно использовать развертывание и свертывание групп, чтобы облегчить перемещение по данным. Чтобы развернуть или свернуть группу, нажмите кнопку со знаком "Шеврон" (>) в соответствующей строке заголовка группы. Обратите внимание, что состояние развертывания/свертывания отдельных групп **не** сохраняется в персонализации.

### <a name="selecting-and-unselecting-rows-at-the-group-level"></a>Выбор и отмена выбора строк на уровне группы
Тем же способом, каким можно выбрать (или отменить выбор) все строки в сетке, установив флажок в верхней части первого столбца сетки, можно также быстро выбрать (или отменить выбор) все строки в группе, установив флажок в соответствующей строке заголовка группы. Флажок в строке заголовка группы будет всегда отражать текущее состояние выбора строк в этой группе, независимо от того, выбраны ли все строки, не выбраны никакие строки или выбраны только некоторые строки.

### <a name="hiding-column-names"></a>Скрытие имен столбцов
При группировании данных поведением по умолчанию является отображение имени столбца в строке заголовка группы. Можно отключить вывод имени столбца в строках заголовка группы, выбрав **Параметры сетки** > **Скрыть имя столбца группы**.

### <a name="grouping-on-date-and-time-columns"></a>Группировка по столбцам даты и времени
С версии 10.0.24, для полей даты или даты и времени добавлен параметр для группировки по году, месяцу или дню. "Значение" группы в соответствующей строке заголовка будет соответствовать формату этого поля. Кроме того, для полей даты и времени и времени можно выполнять группировку по часам, минутам или секундам. 

## <a name="freezing-columns"></a>Закрепление столбцов
Некоторые столбцы в сетке могут быть достаточно важными для контекста, чтобы вы не хотели, чтобы они скрывались при прокрутке. Вместо этого вы можете захотеть, чтобы значения в этих столбцах всегда отображались. Функция **Закрепление столбцов в сетках** обеспечивает гибкие возможности для пользователей. 

Чтобы закрепить столбец, щелкните правой кнопкой мыши заголовок столбца, затем выберите команду **Закрепить столбец**. При первом выполнении этого шага выбранный столбец становится первым столбцом и больше не будет скрываться из виду при прокрутке. Все последующие столбцы, которые закрепляются, будут добавлены справа от последнего закрепленного столбца. Можно использовать стандартные функции перемещения для изменения порядка закрепленных столбцов, как это требуется. Однако закрепленные столбцы нельзя переместить, чтобы они отображались среди незакрепленных столбцов. Аналогично, незакрепленные столбцы нельзя переместить, чтобы они отображались среди закрепленных столбцов.

Чтобы отменить закрепление столбца, щелкните правой кнопкой мыши заголовок закрепленного столбца, затем выберите команду **Отменить закрепление столбца**. 

Обратите внимание, что столбцы выбора строк и статуса строки в новой сетке всегда закреплены как первые два столбца. Таким образом, если эти столбцы включены в сетку, они всегда будут видны пользователям, независимо от позиции прокрутки в сетке по горизонтали. Невозможно изменить порядок этих двух столбцов.

## <a name="autofit-column-width"></a>Автоподбор ширины столбца
Аналогично Excel пользователи могут автоматически изменять размеры столбца в зависимости от содержимого, которое в данный момент отображается в этом столбце. Для этого необходимо дважды щелкнуть маркеры изменения размера в столбце или, поместив фокус в заголовок столбца и нажав **A** (для автоподбора). Эта возможность введена в версии 10.0.23.

## <a name="frequently-asked-questions"></a>Вопросы и ответы
### <a name="how-do-i-enable-the-new-grid-control-in-my-environment"></a>Как включить новый элемент управления сетки в моей среде? 

Функция **Создать элемент управления сетки** доступна непосредственно в управлении функциями в любой среде. После включения этой функции в Управлении функциями все последующие сеансы пользователя будут использовать новый элемент управления сетки. 

Эта функция включается по умолчанию начиная с версии 10.0.21 и предназначена для того, чтобы стать обязательной в октябре 2022 года.  

## <a name="developer-opting-out-individual-pages-from-using-the-new-grid"></a>[Разработчик] Отдельные страницы отказа от использования новой сетки 
Если в организации обнаруживается страница, в которой есть несколько проблем с использованием новой сетки, предусмотрен API, позволяющий конкретной форме использовать стандартный элемент управления DataGrid, тем самым разрешая остальным системам использование нового элемента управления "сетка". Чтобы явно отказаться от отдельной страницы в новой сетке, добавьте следующую запись вызова `super()` в метод `run()` для формы.

```this.forceLegacyGrid();```

Этот API будет обрабатываться, пока новый элемент управления grid не станет обязательным. Это изменение в настоящее время запланировано на октябрь 2022. Если какие-либо проблемы требуют использования этого API, сообщите об этом в корпорацию Microsoft.

### <a name="forcing-a-page-to-use-the-new-grid-after-previously-opting-out-the-grid"></a>Принудительное использование страницей новой сетки после предыдущего отказа от сетки
Если вы отказались от того, чтобы отдельная страница использовала новую сетку, возможно, потребуется снова включить новую сетку после того, как будут устранены основные проблемы. Для этого необходимо просто удалить вызов `forceLegacyGrid()`. Изменения не вступят в силу до тех пор, пока не произойдет одно из следующих действий:

- **Повторное развертывание среды**: при обновлении и повторном развертывании среды таблица, в которой хранятся страницы, в которых выключена новая сетка (FormControlReactGridState), автоматически очищается.
- **Очистка таблицы вручную**: для сценариев разработки вам потребуется использовать SQL для очистки таблицы FormControlReactGridState и перезапуска AOS. Это сочетание действий приведет к сбросу кэширования страниц, для которых отменена новая сетка.

## <a name="developer-opting-individual-grids-out-of-the-typing-ahead-of-the-system-capability"></a>[Разработчик] Отдельные сетки отказа от функции Опережающий ввод системы
Есть некоторые сценарии, которые не могут работать правильно с функцией сетки *Опережающий ввод системы*. (Например, если какой-либо код запускается, когда строка проверена, происходит инициирование изучения источника данных, и изучение может повредить незафиксированные изменения существующих строк.) Если в организации обнаруживается такой сценарий, предусмотрен интерфейс API, позволяющий разработчику выбрать отдельную сетку из асинхронной проверки строк и вернуться к прежнему поведению.

Когда асинхронная проверка строк в сетке отключена, пользователи не могут создать новую строку или перейти к другой существующей строке в сетке, пока имеются ошибки проверки текущей строки. В качестве побочного эффекта этого действия таблицы не могут быть вставлены из Excel в сетки Финансы и операции.

Чтобы явно отказаться от отдельной сетки асинхронной проверки строк, добавьте следующий вызов после `super()` в метод `run()` для формы.

```<gridControl>.allowPreemptiveClient(false);```

> [!NOTE]
> - Этот вызов должен быть вызван только в исключительных случаях и не должен использоваться как норма для всех сеток.
> - Мы не рекомендуем переключать этот API во время выполнения после загрузки формы.

## <a name="developer-size-to-available-width-columns"></a>[Разработчик] Столбцы "размера по доступной ширине"
Если разработчик задает для свойства **WidthMode** значение **SizeToAvailable** для столбцов в новой сетке, эти столбцы первоначально имеют одинаковую ширину, которую бы они имели, если бы для этого свойства было задано значение **SizeToContent**. Однако они растягиваются, чтобы использовать любую дополнительную доступную ширину в сетке. Если свойство имеет значение **SizeToAvailable** для нескольких столбцов, все эти столбцы совместно используют любую дополнительную доступную ширину в сетке. Однако если пользователь вручную изменяет размеры одного из этих столбцов, столбец становится статическим. Он останется этой ширины и не будет растягиваться, чтобы занять дополнительную доступную ширину сетки.

## <a name="known-issues"></a>Известные проблемы
В этом разделе ведется список известных проблем для нового элемента управления сетки.

### <a name="open-issues"></a>Открытые проблемы
- После включения функции **Новый элемент управления сетки** для некоторых страниц будет использоваться существующий элемент управления "сетка". Это произойдет в следующих ситуациях:
 
    - На странице есть список карточек, отображаемый в нескольких столбцах.
    - На странице есть сгруппированный список карточек.
    - Столбец сетки с расширяемым элементом управления без реакции.

    Когда пользователь впервые встречает одну из этих ситуаций, будет выведено сообщение об обновлении страницы. После появления этого сообщения на странице будет по-прежнему использоваться существующая сетка для всех пользователей до тех пор, пока не будет обновлена следующая версия продукта. Более качественное управление этими сценариями, чтобы использовать новую сетку, будет учитываться при будущем обновлении.

- [KB 4582758] Если изменить масштаб со 100 на любой другой процент, записи будут размыты
- [KB 4592012] Непредвиденная ошибка клиента в IE11 при вставке нескольких строк из Excel

    Корпорация Майкрософт не пытается исправить эту проблему


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
