---
title: Настройка сопоставления для полей статуса заказа на продажу
description: В этой теме объясняется, как настроить поля статуса заказа на продажу для двойной записи.
author: dasani-madipalli
manager: tonyafehr
ms.date: 06/25/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User, IT Pro
ms.reviewer: rhaertle
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: ''
ms.author: damadipa
ms.dyn365.ops.version: ''
ms.search.validFrom: 2020-06-25
ms.openlocfilehash: 5855581100606003c1faf6b88a0ab234ae378893
ms.sourcegitcommit: 199848e78df5cb7c439b001bdbe1ece963593cdb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "4456597"
---
# <a name="set-up-the-mapping-for-the-sales-order-status-fields"></a>Настройка сопоставления для полей статуса заказа на продажу

[!include [banner](../../includes/banner.md)]

Поля, которые показывают статус заказа на продажу, имеют разные значения перечисления в Microsoft Dynamics 365 Supply Chain Management и Dynamics 365 Sales. Для сопоставления этих полей в двойной записи требуется дополнительная настройка.

## <a name="fields-in-supply-chain-management"></a>Поля в Supply Chain Management

В Supply Chain Management два поля отражают статус заказа на продажу. Поля, которые необходимо сопоставить, это **Статус** и **Статус документа**.

Перечисление **Статус** определяет общий статус заказа. Этот статус отображается в заголовке заказа.

Перечисление **Статус** имеет следующие значения:

- Открытый заказ
- Доставлено
- Оприходовано
- Отменено

Перечисление **Статус документа** указывает последний документ, созданный для данного заказа. Например, если заказ подтвержден, этот документ является подтверждением заказа на продажу. Если по заказу на продажу частично выставлены накладные, а затем подтверждена оставшаяся строка, статус документа остается **Накладная**, поскольку накладная создается позже в процессе.

Перечисление **Статус документа** имеет следующие значения:

- Подтверждение
- Лист подбора
- Отборочная накладная
- Счет-фактура

## <a name="fields-in-sales"></a>Поля в Sales

В Sales два поля указывают статус заказа. Поля, которые необходимо сопоставить, это **Статус** и **Статус обработки**.

Перечисление **Статус** определяет общий статус заказа. Оно имеет следующие значения:

- Активные сотрудники
- Отправлена
- Выполнено
- Оприходовано
- Отменено

Перечисление **Статус обработки** было введено так, чтобы можно было более точно сопоставить статус с Supply Chain Management.

В следующей таблице показано сопоставление поля **Статус обработки** в Supply Chain Management.

| Статус обработки   | Статус в Supply Chain Management | Статус документа в Supply Chain Management |
|---------------------|-----------------------------------|--------------------------------------------|
| Активные сотрудники              | Открытый заказ                        | Не допускается                                       |
| Подтверждено           | Открытый заказ                        | Подтверждение                               |
| Скомплектовано              | Открытый заказ                        | Лист подбора                               |
| Частично доставлено | Открытый заказ                        | Отборочная накладная                               |
| Доставлено           | Доставлено                         | Отборочная накладная                               |
| Частично выставлен счет  | Доставлено                         | Счет-фактура                                    |
| Оприходовано            | Оприходовано                          | Счет-фактура                                    |
| Отменено           | Отменено                         | Неприменимо                             |

В следующей таблице показано сопоставление поля **Статус обработки** между Sales и Supply Chain Management.

| Статус обработки   | Статус в Sales | Статус в Supply Chain Management |
|---------------------|-----------------|-----------------------------------|
| Активные сотрудники              | Активные сотрудники          | Открытый заказ                        |
| Подтверждено           | Отправлена       | Открытый заказ                        |
| Скомплектовано              | Отправлена       | Открытый заказ                        |
| Частично доставлено | Активные сотрудники          | Открытый заказ                        |
| Частично выставлен счет  | Активные сотрудники          | Открытый заказ                        |
| Частично выставлен счет  | Выполнено       | Доставлено                         |
| Оприходовано            | Оприходовано        | Оприходовано                          |
| Отменено           | Отменено       | Отменено                         |

## <a name="setup"></a>Настройка

Чтобы настроить сопоставление для полей статуса заказа на продажу, необходимо включить атрибуты **IsSOPIntegrationEnabled** и **isIntegrationUser**.

Для включения атрибута **IsSOPIntegrationEnabled** выполните следующие шаги.

1. В браузере перейдите к `https://<test-name>.crm.dynamics.com/api/data/v9.0/organizations`. Замените **\<test-name\>** ссылкой вашей компании на Sales.
2. На открытой странице найдите **organizationid** и запишите значение.

    ![Поиск organizationid](media/sales-map-orgid.png)

3. В Sales откройте консоль браузера и запустите следующий сценарий. Используйте значение **organizationid** из шага 2.

    ```javascript
    Xrm.WebApi.updateRecord("organization",
    "d9a7c5f7-acbf-4aa9-86e8-a891c43f748c", {"issopintegrationenabled" :
    true}).then(
        function success(result) {
            console.log("Account updated");
            // perform operations on record update
        },
        function (error) {
            console.log(error.message);
            // handle error conditions
        }
    );
    ```

    ![Код JavaScript в консоли браузера](media/sales-map-script.png)

4. Убедитесь, что для атрибута **IsSOPIntegrationEnabled** установлено значение **true**. Для проверки значения используйте URL-адрес из шага 1.

    ![IsSOPIntegrationEnabled со значением true](media/sales-map-integration-enabled.png)

Для включения атрибута **isIntegrationUser** выполните следующие шаги.

1. В Sales перейдите в раздел **Параметр \> Настройка \> Настроить систему**, выберите пункт **Сущность пользователя** и откройте **Форма \> Пользователь**.

    ![Открытие формы пользователя](media/sales-map-user.png)

2. В обозревателе полей найдите **Пользовательский режим интеграции** и дважды щелкните его, чтобы добавить в форму. Сохраните изменение.

    ![Добавление поля пользовательского режима интеграции в форму](media/sales-map-field-explorer.png)

3. В Sales перейдите к разделу **Параметр \> Безопасность \> Пользователи** и измените представление с **Разрешенные пользователи** на **Пользователи приложения**.

    ![Изменение представления с разрешенных пользователей на пользователей приложения](media/sales-map-enabled-users.png)

4. Выберите две записи для **DualWrite IntegrationUser**.

    ![Список пользователей приложения](media/sales-map-user-mode.png)

5. Измените значение поля **Пользовательский режим интеграции** на **Да**.

    ![Изменение значение поля пользовательского режима интеграции](media/sales-map-user-mode-yes.png)

Заказы на продажу теперь сопоставлены.
