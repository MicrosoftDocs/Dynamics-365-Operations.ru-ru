---
title: Миграция типа данных валюты для двойной записи
description: В этом разделе описывается, как изменить число десятичных знаков, поддерживаемое двойной записью для валюты.
author: RamaKrishnamoorthy
ms.date: 12/08/2021
ms.topic: article
audience: Application User, IT Pro
ms.reviewer: tfehr
ms.search.region: global
ms.author: ramasri
ms.search.validFrom: 2020-04-06
ms.openlocfilehash: bce58631ecd54bb90993bd552d529d3b379de1b1
ms.sourcegitcommit: 6762a674a552353d9f53587923c9acba9b43cb56
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2021
ms.locfileid: "7917738"
---
# <a name="currency-data-type-migration-for-dual-write"></a>Миграция типа данных валюты для двойной записи

[!include [banner](../../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

Можно увеличить число десятичных знаков, поддерживаемое для денежных значений, до максимум 10. Предел по умолчанию равен четырем десятичным знакам. Увеличивая число десятичных разрядов, можно помочь предотвратить потерю данных при использовании двойной записи для синхронизации данных. Увеличение количества десятичных разрядов является изменением по выбору. Чтобы его реализовать, вам необходимо обратиться за помощью в Майкрософт.

Процесс изменения числа знаков после запятой имеет два шага:

1. Запросите миграцию в Microsoft.
2. Измените число знаков после запятой в Dataverse.

Приложение Finance and Operations и Dataverse должны поддерживать одинаковое число десятичных разрядов в значениях валют. В противном случае при синхронизации этих данных между приложениями может произойти потеря данных. Процесс миграции перенастраивает способ хранения значений валют и валютных курсов, но не изменяет никаких данных. После завершения миграции можно увеличить число десятичных разрядов для кодов валют и цен, а данные, вводимые пользователями и отображаемые пользователем, могут иметь большую точность для десятичных знаков.

Миграция не является обязательной. Если вам может пригодиться поддержка большего числа десятичных разрядов, рекомендуется рассмотреть возможность миграции. Для организаций, в которых не требуется наличие значений, имеющих более четырех десятичных знаков, миграция не требуется.

## <a name="requesting-migration-from-microsoft"></a>Запрос миграции в Microsoft

Хранилище для существующих столбцов валюты в Dataverse не может поддерживать более четырех десятичных разрядов. Таким образом, в процессе миграции значения валют копируются в новые внутренние столбцы базы данных. Этот процесс выполняется непрерывно, пока не будут перенесены все данные. Внутри в конце миграции новые типы хранилищ заменяют старые типы хранилищ, но значения данных не изменяются. Столбцы валюты могут поддерживать до 10 десятичных разрядов. В процессе миграции служба Dataverse может продолжать использоваться без перерывов.

В то же время валютные курсы изменяются таким образом, чтобы они поддерживали до 12 десятичных разрядов вместо текущего предельного значения 10. Это изменение необходимо для того, чтобы число знаков после запятой было одинаковым как в приложении Finance and Operations, так и в Dataverse.

При миграции никакие данные не изменяются. После преобразования столбцов валюты и валютного курса администраторы могут настроить систему на использование до 10 десятичных разрядов для столбцов валюты, указав число десятичных знаков для каждой валюты проводки и для цены.

### <a name="request-a-migration"></a>Запрос на миграцию

Чтобы эта функция была доступна, отправьте сообщение электронной почты по адресу **CDSExpandDecimal@microsoft.com** и включите следующую информацию:

+ **Тема:** Запрос на включение расширенной десятичной поддержки для \<organizationID\>
+ **Текст:** Я хочу включить расширенную поддержку десятичных знаков для моей организации \<organizationID\>.

Представитель корпорации Майкрософт свяжется с вами в течение двух-трех рабочих дней для выполнения следующих шагов.

При запросе на миграцию необходимо ознакомиться со следующими подробностями и спланировать их соответствующим образом:

+ Время, необходимое для переноса данных, зависит от объема данных в системе. Миграция больших баз данных может занять несколько дней.
+ Размер базы данных временно увеличивается во время выполнения миграции, так как для индексов требуется дополнительное пространство. Большая часть дополнительного пространства освобождается после завершения миграции.
+ Если в процессе миграции возникают ошибки, которые не позволят выполнить миграцию, система создает оповещения в службе технической поддержки Майкрософт, так что сотрудники службы поддержки могут вмешаться. Однако даже в том случае, если во время миграции возникают ошибки, служба Dataverse остается полностью доступной для обычного использования.
+ Процесс миграции не является обратимым.

## <a name="changing-the-number-of-decimal-places"></a>Изменение числа десятичных знаков

После завершения миграции служба Dataverse может сохранить числа с большим числом десятичных знаков. Администраторы могут указать, сколько десятичных разрядов используется для разных кодов валют и для ценообразования. Пользователи Microsoft Power Apps, Power BI и Power Automate смогут просматривать и использовать числа с большим числом знаков после запятой.

Для выполнения этого изменения необходимо обновить следующие параметры в Power Apps:

+ **Системные параметры: точность валюты для ценообразования** — столбец **Задать точность валюты, используемую для ценообразования во всей системе** определяет, как данная валюта будет вести себя в организации при выборе параметра **Точность цены**.
+ **Управление бизнесом: валюты** — столбец **Точность валюты** позволяет указать пользовательское число десятичных разрядов для конкретной валюты. Имеется резервный вариант настройки в масштабе всей организации.

Имеются некоторые ограничения:

+ Невозможно настроить столбец валюты в таблице.
+ Можно указать более четырех знаков после запятой только на уровнях **Ценообразование** и **Валюта проводки**.

### <a name="system-settings-currency-precision-for-pricing"></a>Параметры системы: точность валюты для ценообразования

После завершения миграции администраторы могут задать точность валюты. Перейдите к пункту **Параметры \> Администрирование** и выберите **Параметры системы**. Затем на вкладке **Общие** измените значение в столбце **Задать точность валюты, используемую для ценообразования во всей системе**, как показано на следующем рисунке.

![Параметры системы для валюты.](media/currency-system-settings.png)

### <a name="business-management-currencies"></a>Управление бизнесом: валюты

Если требуется, чтобы точность конкретной валюты отличалась от точности валюты, используемой для ценообразования, ее можно изменить. Перейдите к пункту **Параметры \> Управление бизнесом**, выберите **Валюты** и выберите валюту, которую необходимо изменить. Затем задайте в столбце **Точность валюты** нужное число десятичных знаков, как показано на следующем рисунке.

![Параметры валюты для определенных региональных параметров.](media/specific-currency.png)

### <a name="tables-currency-column"></a>Таблицы: столбец валюты

Число десятичных разрядов, которые могут быть настроены для некоторых столбцов валюты, ограничивается четырьмя.

### <a name="default-currency-decimal-precision"></a>Десятичная точность валюты по умолчанию
В приведенной ниже таблице содержится ожидаемое поведение для точности десятичных значений валюты по умолчанию в сценариях с миграцией и без миграции. 

| Дата создания  | Поле точности дробной части валют    | Существующая организация (поле валюты не перенесено) | Существующая организация (поле валюты перенесено) | Новая организация, созданная после сборки 9.2.21062.00134 |
|---------------------------------------------------------|-------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|------------------------------------------------|
| Поле валюты, созданное до сборки 9.2.21111.00146  |     |  |       |
|    | Максимальная точность, отображаемая в интерфейсе пользователя   | 4 цифры    | 10 цифр    | Недоступно    |
| | Максимальная точность, видимая в пользовательском интерфейсе базы данных и результатов запроса к базе данных         | 4 цифры   | 10 цифр   | Недоступно    |
| Поле валюты, созданное после сборки 9.2.21111.00146 |    |  |     |   |
|   | Максимальная десятичная точность, отображаемая в интерфейсе пользователя     | 4 цифры   | 10 цифр   | 10 цифр     |
|          | Максимальная десятичная точность, видимая в пользовательском интерфейсе базы данных и результатов запроса к базе данных | 10 цифр. Однако значимыми являются только 4 цифры, после 4 десятичных цифр отображаются все нули. Это позволяет упростить и ускорить миграцию организации, если это необходимо. | 10 цифр      | 10 цифр     |

[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]
