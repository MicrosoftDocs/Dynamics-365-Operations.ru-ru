---
title: Просмотр и обновление данных объекта с помощью Excel
description: В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Excel.
author: jasongre
ms.date: 10/01/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 3b97c585009b50c6623036d10f54e78a65a89cea
ms.sourcegitcommit: 3cb1f49a02e4a849fc34ffeb81fe507f0608b35e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2022
ms.locfileid: "8464947"
---
# <a name="view-and-update-entity-data-with-excel"></a>Просмотр и обновление данных объекта с помощью Excel 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]


[!INCLUDE [PEAP](../../../includes/peap-1.md)]


В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Excel. Чтобы открыть данные объекта, можно начать из Excel или из приложений Финансы и операции.

Открыв данные объекта в Excel, можно быстро и легко просматривать и изменять эти данные с помощью надстройки Excel. Для этой надстройки требуется Microsoft Excel 2016 или более новой версии.

> [!NOTE]
> Если ваш владелец Microsoft Azure Active Directory (Azure AD) настроен на использование служб федерации Active Directory (AD FS), необходимо убедиться, что применено обновление для Office за май 2016 г., чтобы надстройка Excel можно правильно выполнить вход.

Для получения дополнительных сведений о порядке использования надстройки Excel, посмотрите короткое видео [Создание шаблона Excel для шаблонов заголовка и строк](https://youtu.be/RTicLb-6dbI).

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a>Открытие данных объекта в Excel при запуске из приложения Финансы и операции
1. На странице в приложении Финансы и операции выберите **Открыть в Microsoft Office**.

    Если корневой источнику данных (таблица) для страницы совпадает с корневым источником данных для любых объектов, для этой страницы создаются параметры по умолчанию **Открыть в Excel**. Параметры **Открыть в Excel** можно найти на часто используемые страницах, таких как **Все поставщики** и **Все клиенты**.
 
2. Выберите параметр **Открыть в Excel** и откройте созданную книгу. Эта книга содержит сведения о привязке для объекта, указатель на вашу среду и указатель на надстройку Excel.
3. В Excel выберите **Разрешить редактирование**, чтобы разрешить работу надстройки Excel. Надстройка Excel выполняется в области в правой части окна Excel.
4. Если вы используете надстройку Excel в первый раз, выберите **Доверять этой надстройке**.
5. Если появится запрос на вход, выберите **Войти** и войдите в систему, используя те же учетные данные, которые используются для входа в приложении Финансы и операции. Надстройка Excel будет использовать предыдущий контекст входа из браузера и автоматически выполнит вход, если это возможно. (Дополнительные сведения о браузере, используемом в операционной системе, см. в разделе [Браузеры, используемые надстройками Office](/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins). Для проверки того, что вход выполнен успешно, проверьте имя пользователя в верхнем правом углу надстройки Excel. 

Надстройка Excel автоматически считывает данные для выбранного вами объекта. Обратите внимание, что в книге не будет никаких данных, пока надстройка Excel не считает их.

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>Открытие данных объекта в Excel при запуске из Excel
1. В Excel на вкладке **Вставка** в группе **Надстройки** выберите **Магазин**, чтобы открыть Магазин Office.
2. В Магазине Office выполните поиск по ключевому слову **Dynamics**, затем нажмите кнопку **Добавить** рядом с пунктом **Microsoft Dynamics Office Add-in** (надстройка Excel).
3. Если вы используете надстройку Excel в первый раз, выберите **Доверять этой надстройке**, чтобы разрешить запуск этой надстройки Excel. Надстройка Excel выполняется в области в правой части окна Excel.
4. Выберите **Добавить сведения о сервере**, чтобы открыть панель **Параметры**.
5. В браузере скопируйте URL-адрес целевого экземпляра приложения Финансы и операции, вставьте его в поле **URL-адрес сервера**, затем удалить все элементы после имени узла. Полученный URL-адрес должен содержать только имя узла.

    Например, если URL-адрес имеет вид `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, удалите все, кроме `https://xxx.dynamics.com`.

6. Выберите **ОК**, затем выберите **Да**, чтобы подтвердить изменение. Надстройка Excel перезагружается и загружает метаданные.

    Теперь доступна кнопка **Дизайн**. Если в надстройке Excel имеется ссылка **Загрузить приложения**, возможно, что выполнен вход с неправильным пользователем. Дополнительные сведения об устранении этой неполадки см. пункт устранения неполадок [Загрузка приложений](../office-integration/office-integration-troubleshooting.md#issue-the-excel-add-in-loads-but-instead-of-showing-data-it-displays-load-applets-in-the-task-pane).

7. Выберите **Разработка**. Надстройка Excel извлекает метаданные объекта.
8. Выберите **Добавить таблицу**. Отображается список объектов. Объекты перечислены в формате «Имя — Метка».
9. Выберите объект в списке, например **Клиент - клиенты** и затем выберите **Далее**.
10. Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, выберите это поле и выберите **Добавить**. Можно также дважды щелкнуть поле в списке **Доступные поля**.
11. После завершения добавления полей в список **Выбранные поля** убедитесь в том, что курсор находится в нужном месте на листе (например, в ячейке A1), затем выберите **Готово**. Затем для закрытия конструктора выберите **Готово**.
12. Выберите **Обновить** для извлечения набора данных.

## <a name="view-and-update-entity-data-in-excel"></a>Просмотр и обновление данных объекта в Excel
После того как надстройка Excel считает данные объекта в книгу, можно обновить данные в любое время, выбрав **Обновить** в надстройке Excel.

## <a name="edit-entity-data-in-excel"></a>Изменение данных объекта в Excel
Можно внести требуемые изменения в данные объекта ,и затем опубликовать их обратно в приложения Финансы и операции, выбрав **Опубликовать** в надстройке Excel. Чтобы изменить запись, выберите ячейку на листе, затем измените значение ячейки. Чтобы добавить новую запись, выполните одно из следующих действий:

- Щелкните в любом месте таблице источников данных, затем выберите **Создать** в надстройке Excel.
- Щелкните в любом месте последней строки таблицы источников данных, затем нажимайте клавишу Tab, пока курсор не выйдет за последний столбец этой строки и не будет создана новая строка.
- Щелкните в любом месте строки сразу под таблицей источников данных и начните вводить данные в ячейку. Когда пользователь перемещает фокус из этой ячейки, таблица расширяется для включения новой строки.
- Для привязки поля заголовка записей выберите одно из полей и выберите **Создать** в надстройке Excel.

Обратите внимание, что новые записи могут быть созданы только в том случае, если все ключевые и обязательные поля привязаны на листе или если значения по умолчанию были заполнены с помощью условия фильтра.

Чтобы удалить запись, выполните одно из следующих действий:

- Щелкните правой кнопкой мыши номер строки рядом со строкой листа, которую требуется удалить, затем выберите **Удалить**.
- Щелкните правой кнопкой мыши в любом месте строки листа, которую требуется удалить, затем выберите **Удалить** &gt; **Строки таблицы**.

Если источники данных были добавлены как связанные источники данных, заголовок публикуется перед строками. При наличии зависимостей между другими источниками данных может потребоваться изменить используемый по умолчанию порядок публикации. Чтобы изменить порядок публикации, в надстройке Excel выберите кнопку **Параметры** (символ шестеренки), затем на экспресс-вкладке **Соединитель данных** выберите **Настройка порядка публикации**.

## <a name="add-or-remove-columns"></a>Добавить или удалить столбцы
Конструктор можно использовать для настройки столбцов, которые автоматически добавляются на лист.

> [!NOTE]
> Если кнопка **Дизайн** не отображаться под кнопкой **Фильтр** в надстройке Excel, необходимо включить конструктор источников данных. Выберите кнопку **Параметры** (символ шестеренки), затем выберите флажок **Включить разработку**.

1. В надстройке Excel выберите **Дизайн**. Перечисляются все источники данных.
2. Рядом с источником данных выберите кнопку **Изменить** (символ карандаша).
3. В списке **Выбранные поля** настройте требуемым образом список полей:

    - Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, выберите это поле и выберите **Добавить**. Можно также дважды щелкнуть поле в списке **Доступные поля**.
    - Чтобы удалить поле из списка **Выбранные поля**, выберите поле, затем выберите **Удалить**. Можно также дважды щелкнуть это поле.
    - Чтобы изменить порядок полей в списке **Выбранные поля**, выберите поле, затем выберите **Вверх** или **Вниз**.

4. Чтобы применить изменения к источнику данных, выберите **Обновить**. Затем для закрытия конструктора выберите **Готово**.
5. Если было добавлено поле (столбец), выберите **Обновить**, чтобы извлечь обновленный набор данных.

## <a name="change-the-publish-batch-size"></a>Изменение размера пакета публикации
Когда пользователи публикуют изменения записей данных с помощью надстройки Excel, обновления отправляются пакетами. Размер пакета публикации по умолчанию составляет 100 строк. В версии 10.0.17 и более поздних версий функция **Разрешить конфигурацию размера пакета публикации в надстройке Excel** позволяет гибко управлять размером пакета публикации.

Системные администраторы могут задать системный предел размера пакета публикации для книг "Открыть в Excel", установив поле **Лимит пакета публикации** в разделе **Параметры приложения** на странице **Параметры приложения Office**.

Размер пакета публикации можно также изменить для отдельной книги, используя надстройку Excel.

1. Откройте книгу в Excel.
2. Выберите кнопку **Параметры** (значок шестеренки) в правом верхнем углу надстройки Excel.
3. Задайте требуемое значение поля **Размер пакета публикации**. Заданное значение должно быть меньше лимита пакета публикации для всей системы.
4. Нажмите **ОК**.
5. Сохраните книгу. Если не сохранить книгу после внесения изменений в параметры надстройки, эти изменения не будут сохранены при повторном открытии книги.

Авторы шаблонов книги Excel могут использовать ту же процедуру для задания размера пакета публикации для шаблонов перед их отправкой в систему.

## <a name="copy-environment-data"></a>Копировать данные среды

Данные, считанные в книгу из одной среды, можно скопировать в другую среду. Однако невозможно просто изменить URL-адрес подключения, так как кэш данных в книге будет продолжать считать данные существующими. Вместо этого необходимо использовать функцию "Копировать данные среды" для публикации данных в новую среду в виде новых данных.

1. Выберите кнопку **Параметры** (символ шестеренки), затем на экспресс-вкладке **Соединитель данных** выберите **Копировать данные среды**. 
2. Введите URL-адрес сервера для новой среды. 
3. Выберите **ОК**, затем выберите **Да**, чтобы подтвердить действие. Надстройка Excel перезапускается и подключается к новой среде. Все существующие данные в книге рассматриваются как новые данные.

    После перезапуска надстройки Excel в окне сообщения указывается, что книга находится в режиме копии среды.

4. Чтобы скопировать данные в новую среду как новые данные, выберите **Опубликовать**. Чтобы отменить операцию копирования среды и просмотреть существующие данные в новой среде, выберите **Обновить**.

## <a name="troubleshooting"></a>Устранение неполадок
Существует несколько проблем, которые можно разрешить некоторыми простыми действиями.

- **Отображается ссылка "Загрузить приложения"** — дополнительные сведения об устранении этой неполадки см. пункт устранения неполадок [Загрузка приложений](../office-integration/office-integration-troubleshooting.md#issue-the-excel-add-in-loads-but-instead-of-showing-data-it-displays-load-applets-in-the-task-pane). 
- **Вы получаете сообщение "Запрещено"** — если появляется сообщение "Запрещено", когда надстройка Excel загружает метаданные, учетная запись, с который выполнен вход в надстройку Excel, не имеет разрешения на использование целевой службы, экземпляра или базы данных. Чтобы устранить эту проблему, поверьте, правильное ли имя пользователя отображается в правом верхнем углу надстройки Excel. Если отображаются неправильное имя, выберите его, выполните выход, затем выполните вход.
- **Пустая веб-страница отображается над Excel** — если в процессе входа открывается пустая веб-страница, для учетной записи требуются службы AD FS, но версии Excel, в которой выполняется надстройка Excel, слишком старая для загрузки диалогового окна входа. Чтобы решить эту проблему, обновите версию Excel, которую вы используете. Чтобы обновить версию Excel, находясь в предприятии, которое находится в отложенном канале, используйте [Средство развертывания Office](/deployoffice/overview-office-deployment-tool) для [перехода из отложенного канала в текущий канал](/deployoffice/overview-update-channels).
- **Вы получаете ошибку времени ожидания при публикации изменений данных** — если при попытке публикации изменений данных в сущности выводится сообщение об истечении времени ожидания, следует рассмотреть возможность уменьшения размера пакета публикации для данной книги. Сущности, которые запускают большие объемы логики при изменении записей, могут потребовать, чтобы обновления отправлялись в виде небольших пакетов, чтобы предотвратить ошибки времени ожидания.


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
