---
title: Просмотр и обновление данных объекта с помощью Excel
description: В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Excel.
author: jasongre
manager: AnnBe
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 9b7da9867ed86921f3487077081ec63e8b44e92c
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5562557"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="2a27b-103">Просмотр и обновление данных объекта с помощью Excel</span><span class="sxs-lookup"><span data-stu-id="2a27b-103">View and update entity data with Excel</span></span> 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="2a27b-104">В этом разделе объясняется, как открыть данные объекта в Microsoft Excel, и затем просматривать, обновлять и изменять эти данные с помощью надстройки Microsoft Dynamics Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="2a27b-105">Чтобы открыть данные объекта, можно начать из Excel или из приложений Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="2a27b-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="2a27b-106">Открыв данные объекта в Excel, можно быстро и легко просматривать и изменять эти данные с помощью надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="2a27b-107">Для этой надстройки требуется Microsoft Excel 2016 или более новой версии.</span><span class="sxs-lookup"><span data-stu-id="2a27b-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="2a27b-108">Если ваш владелец Microsoft Azure Active Directory (Azure AD) настроен на использование служб федерации Active Directory (AD FS), необходимо убедиться, что применено обновление для Office за май 2016 г., чтобы надстройка Excel можно правильно выполнить вход.</span><span class="sxs-lookup"><span data-stu-id="2a27b-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="2a27b-109">Для получения дополнительных сведений о порядке использования надстройки Excel, посмотрите короткое видео [Создание шаблона Excel для шаблонов заголовка и строк](https://youtu.be/RTicLb-6dbI).</span><span class="sxs-lookup"><span data-stu-id="2a27b-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="2a27b-110">Открытие данных объекта в Excel при запуске из приложения Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="2a27b-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="2a27b-111">На странице в приложении Finance and Operations выберите **Открыть в Microsoft Office**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="2a27b-112">Если корневой источнику данных (таблица) для страницы совпадает с корневым источником данных для любых объектов, для этой страницы создаются параметры по умолчанию **Открыть в Excel**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="2a27b-113">Параметры **Открыть в Excel** можно найти на часто используемые страницах, таких как **Все поставщики** и **Все клиенты**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="2a27b-114">Выберите параметр **Открыть в Excel** и откройте созданную книгу.</span><span class="sxs-lookup"><span data-stu-id="2a27b-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="2a27b-115">Эта книга содержит сведения о привязке для объекта, указатель на вашу среду и указатель на надстройку Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="2a27b-116">В Excel выберите **Разрешить редактирование**, чтобы разрешить работу надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="2a27b-117">Надстройка Excel выполняется в области в правой части окна Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="2a27b-118">Если вы используете надстройку Excel в первый раз, выберите **Доверять этой надстройке**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="2a27b-119">Если появится запрос на вход, выберите **Войти** и войдите в систему, используя те же учетные данные, которые используются для входа в приложение Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="2a27b-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="2a27b-120">Надстройка Excel будет использовать предыдущий контекст входа из браузера и автоматически выполнит вход, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="2a27b-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="2a27b-121">(Дополнительные сведения о браузере, используемом в операционной системе, см. в разделе [Браузеры, используемые надстройками Office](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) Для проверки того, что вход выполнен успешно, проверьте имя пользователя в верхнем правом углу надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="2a27b-122">Надстройка Excel автоматически считывает данные для выбранного вами объекта.</span><span class="sxs-lookup"><span data-stu-id="2a27b-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="2a27b-123">Обратите внимание, что в книге не будет никаких данных, пока надстройка Excel не считает их.</span><span class="sxs-lookup"><span data-stu-id="2a27b-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="2a27b-124">Открытие данных объекта в Excel при запуске из Excel</span><span class="sxs-lookup"><span data-stu-id="2a27b-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="2a27b-125">В Excel на вкладке **Вставка** в группе **Надстройки** выберите **Магазин**, чтобы открыть Магазин Office.</span><span class="sxs-lookup"><span data-stu-id="2a27b-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="2a27b-126">В Магазине Office выполните поиск по ключевому слову **Dynamics**, затем нажмите кнопку **Добавить** рядом с пунктом **Microsoft Dynamics Office Add-in** (надстройка Excel).</span><span class="sxs-lookup"><span data-stu-id="2a27b-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="2a27b-127">Если вы используете надстройку Excel в первый раз, выберите **Доверять этой надстройке**, чтобы разрешить запуск этой надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="2a27b-128">Надстройка Excel выполняется в области в правой части окна Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="2a27b-129">Выберите **Добавить сведения о сервере**, чтобы открыть панель **Параметры**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="2a27b-130">В браузере скопируйте URL-адрес целевого экземпляра приложения Finance and Operations, вставьте его в поле **URL-адрес сервера**, затем удалите все элементы после имени узла.</span><span class="sxs-lookup"><span data-stu-id="2a27b-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="2a27b-131">Полученный URL-адрес должен содержать только имя узла.</span><span class="sxs-lookup"><span data-stu-id="2a27b-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="2a27b-132">Например, если URL-адрес имеет вид `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, удалите все, кроме `https://xxx.dynamics.com`.</span><span class="sxs-lookup"><span data-stu-id="2a27b-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="2a27b-133">Выберите **ОК**, затем выберите **Да**, чтобы подтвердить изменение.</span><span class="sxs-lookup"><span data-stu-id="2a27b-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="2a27b-134">Надстройка Excel перезагружается и загружает метаданные.</span><span class="sxs-lookup"><span data-stu-id="2a27b-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="2a27b-135">Теперь доступна кнопка **Дизайн**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-135">The **Design** button is now available.</span></span> <span data-ttu-id="2a27b-136">Если в надстройке Excel имеется кнопка **Загрузить приложения**, возможно, что выполнен вход с неправильным пользователем.</span><span class="sxs-lookup"><span data-stu-id="2a27b-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="2a27b-137">Дополнительные сведения см. в пункте "Отображается кнопка загрузки приложения" в разделе [Устранение неполадок](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="2a27b-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="2a27b-138">Выберите **Дизайн**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-138">Select **Design**.</span></span> <span data-ttu-id="2a27b-139">Надстройка Excel извлекает метаданные объекта.</span><span class="sxs-lookup"><span data-stu-id="2a27b-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="2a27b-140">Выберите **Добавить таблицу**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-140">Select **Add table**.</span></span> <span data-ttu-id="2a27b-141">Отображается список объектов.</span><span class="sxs-lookup"><span data-stu-id="2a27b-141">A list of entities appears.</span></span> <span data-ttu-id="2a27b-142">Объекты перечислены в формате «Имя — Метка».</span><span class="sxs-lookup"><span data-stu-id="2a27b-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="2a27b-143">Выберите объект в списке, например **Клиент - клиенты** и затем выберите **Далее**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="2a27b-144">Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, выберите это поле и выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="2a27b-145">Можно также дважды щелкнуть поле в списке **Доступные поля**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="2a27b-146">После завершения добавления полей в список **Выбранные поля** убедитесь в том, что курсор находится в нужном месте на листе (например, в ячейке A1), затем выберите **Готово**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="2a27b-147">Затем для закрытия конструктора выберите **Готово**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="2a27b-148">Выберите **Обновить** для извлечения набора данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="2a27b-149">Просмотр и обновление данных объекта в Excel</span><span class="sxs-lookup"><span data-stu-id="2a27b-149">View and update entity data in Excel</span></span>
<span data-ttu-id="2a27b-150">После того как надстройка Excel считает данные объекта в книгу, можно обновить данные в любое время, выбрав **Обновить** в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="2a27b-151">Изменение данных объекта в Excel</span><span class="sxs-lookup"><span data-stu-id="2a27b-151">Edit entity data in Excel</span></span>
<span data-ttu-id="2a27b-152">Можно внести требуемые изменения в данные объекта ,и затем опубликовать их обратно в приложения Finance and Operations, выбрав **Опубликовать** в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="2a27b-153">Чтобы изменить запись, выберите ячейку на листе, затем измените значение ячейки.</span><span class="sxs-lookup"><span data-stu-id="2a27b-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="2a27b-154">Чтобы добавить новую запись, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="2a27b-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="2a27b-155">Щелкните в любом месте таблице источников данных, затем выберите **Создать** в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="2a27b-156">Щелкните в любом месте последней строки таблицы источников данных, затем нажимайте клавишу Tab, пока курсор не выйдет за последний столбец этой строки и не будет создана новая строка.</span><span class="sxs-lookup"><span data-stu-id="2a27b-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="2a27b-157">Щелкните в любом месте строки сразу под таблицей источников данных и начните вводить данные в ячейку.</span><span class="sxs-lookup"><span data-stu-id="2a27b-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="2a27b-158">Когда пользователь перемещает фокус из этой ячейки, таблица расширяется для включения новой строки.</span><span class="sxs-lookup"><span data-stu-id="2a27b-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="2a27b-159">Для привязки поля заголовка записей выберите одно из полей и выберите **Создать** в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="2a27b-160">Обратите внимание, что новые записи могут быть созданы только в том случае, если все ключевые и обязательные поля привязаны на листе или если значения по умолчанию были заполнены с помощью условия фильтра.</span><span class="sxs-lookup"><span data-stu-id="2a27b-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="2a27b-161">Чтобы удалить запись, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="2a27b-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="2a27b-162">Щелкните правой кнопкой мыши номер строки рядом со строкой листа, которую требуется удалить, затем выберите **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="2a27b-163">Щелкните правой кнопкой мыши в любом месте строки листа, которую требуется удалить, затем выберите **Удалить** &gt; **Строки таблицы**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="2a27b-164">Если источники данных были добавлены как связанные источники данных, заголовок публикуется перед строками.</span><span class="sxs-lookup"><span data-stu-id="2a27b-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="2a27b-165">При наличии зависимостей между другими источниками данных может потребоваться изменить используемый по умолчанию порядок публикации.</span><span class="sxs-lookup"><span data-stu-id="2a27b-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="2a27b-166">Чтобы изменить порядок публикации, в надстройке Excel выберите кнопку **Параметры** (символ шестеренки), затем на экспресс-вкладке **Соединитель данных** выберите **Настройка порядка публикации**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="2a27b-167">Добавить или удалить столбцы</span><span class="sxs-lookup"><span data-stu-id="2a27b-167">Add or remove columns</span></span>
<span data-ttu-id="2a27b-168">Конструктор можно использовать для настройки столбцов, которые автоматически добавляются на лист.</span><span class="sxs-lookup"><span data-stu-id="2a27b-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="2a27b-169">Если кнопка **Дизайн** не отображаться под кнопкой **Фильтр** в надстройке Excel, необходимо включить конструктор источников данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="2a27b-170">Выберите кнопку **Параметры** (символ шестеренки), затем выберите флажок **Включить разработку**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="2a27b-171">В надстройке Excel выберите **Дизайн**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="2a27b-172">Перечисляются все источники данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="2a27b-173">Рядом с источником данных выберите кнопку **Изменить** (символ карандаша).</span><span class="sxs-lookup"><span data-stu-id="2a27b-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="2a27b-174">В списке **Выбранные поля** настройте требуемым образом список полей:</span><span class="sxs-lookup"><span data-stu-id="2a27b-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="2a27b-175">Чтобы добавить поле из списка **Доступные поля** в список **Выбранные поля**, выберите это поле и выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="2a27b-176">Можно также дважды щелкнуть поле в списке **Доступные поля**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="2a27b-177">Чтобы удалить поле из списка **Выбранные поля**, выберите поле, затем выберите **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="2a27b-178">Можно также дважды щелкнуть это поле.</span><span class="sxs-lookup"><span data-stu-id="2a27b-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="2a27b-179">Чтобы изменить порядок полей в списке **Выбранные поля**, выберите поле, затем выберите **Вверх** или **Вниз**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="2a27b-180">Чтобы применить изменения к источнику данных, выберите **Обновить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="2a27b-181">Затем для закрытия конструктора выберите **Готово**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="2a27b-182">Если было добавлено поле (столбец), выберите **Обновить**, чтобы извлечь обновленный набор данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="2a27b-183">Изменение размера пакета публикации</span><span class="sxs-lookup"><span data-stu-id="2a27b-183">Change the publish batch size</span></span>
<span data-ttu-id="2a27b-184">Когда пользователи публикуют изменения записей данных с помощью надстройки Excel, обновления отправляются пакетами.</span><span class="sxs-lookup"><span data-stu-id="2a27b-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="2a27b-185">Размер пакета публикации по умолчанию составляет 100 строк.</span><span class="sxs-lookup"><span data-stu-id="2a27b-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="2a27b-186">В версии 10.0.17 и более поздних версий функция **Разрешить конфигурацию размера пакета публикации в надстройке Excel** позволяет гибко управлять размером пакета публикации.</span><span class="sxs-lookup"><span data-stu-id="2a27b-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="2a27b-187">Системные администраторы могут задать системный предел размера пакета публикации для книг "Открыть в Excel", установив поле **Лимит пакета публикации** в разделе **Параметры приложения** на странице **Параметры приложения Office**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="2a27b-188">Размер пакета публикации можно также изменить для отдельной книги, используя надстройку Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="2a27b-189">Откройте книгу в Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="2a27b-190">Выберите кнопку **Параметры** (значок шестеренки) в правом верхнем углу надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="2a27b-191">Задайте требуемое значение поля **Размер пакета публикации**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="2a27b-192">Заданное значение должно быть меньше лимита пакета публикации для всей системы.</span><span class="sxs-lookup"><span data-stu-id="2a27b-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="2a27b-193">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-193">Select **OK**.</span></span>
5. <span data-ttu-id="2a27b-194">Сохраните книгу.</span><span class="sxs-lookup"><span data-stu-id="2a27b-194">Save the workbook.</span></span> <span data-ttu-id="2a27b-195">Если не сохранить книгу после внесения изменений в параметры надстройки, эти изменения не будут сохранены при повторном открытии книги.</span><span class="sxs-lookup"><span data-stu-id="2a27b-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="2a27b-196">Авторы шаблонов книги Excel могут использовать ту же процедуру для задания размера пакета публикации для шаблонов перед их отправкой в систему.</span><span class="sxs-lookup"><span data-stu-id="2a27b-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="2a27b-197">Копировать данные среды</span><span class="sxs-lookup"><span data-stu-id="2a27b-197">Copy environment data</span></span>

<span data-ttu-id="2a27b-198">Данные, считанные в книгу из одной среды, можно скопировать в другую среду.</span><span class="sxs-lookup"><span data-stu-id="2a27b-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="2a27b-199">Однако невозможно просто изменить URL-адрес подключения, так как кэш данных в книге будет продолжать считать данные существующими.</span><span class="sxs-lookup"><span data-stu-id="2a27b-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="2a27b-200">Вместо этого необходимо использовать функцию "Копировать данные среды" для публикации данных в новую среду в виде новых данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="2a27b-201">Выберите кнопку **Параметры** (символ шестеренки), затем на экспресс-вкладке **Соединитель данных** выберите **Копировать данные среды**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="2a27b-202">Введите URL-адрес сервера для новой среды.</span><span class="sxs-lookup"><span data-stu-id="2a27b-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="2a27b-203">Выберите **ОК**, затем выберите **Да**, чтобы подтвердить действие.</span><span class="sxs-lookup"><span data-stu-id="2a27b-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="2a27b-204">Надстройка Excel перезапускается и подключается к новой среде.</span><span class="sxs-lookup"><span data-stu-id="2a27b-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="2a27b-205">Все существующие данные в книге рассматриваются как новые данные.</span><span class="sxs-lookup"><span data-stu-id="2a27b-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="2a27b-206">После перезапуска надстройки Excel в окне сообщения указывается, что книга находится в режиме копии среды.</span><span class="sxs-lookup"><span data-stu-id="2a27b-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="2a27b-207">Чтобы скопировать данные в новую среду как новые данные, выберите **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="2a27b-208">Чтобы отменить операцию копирования среды и просмотреть существующие данные в новой среде, выберите **Обновить**.</span><span class="sxs-lookup"><span data-stu-id="2a27b-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="2a27b-209">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="2a27b-209">Troubleshooting</span></span>
<span data-ttu-id="2a27b-210">Существует несколько проблем, которые можно разрешить некоторыми простыми действиями.</span><span class="sxs-lookup"><span data-stu-id="2a27b-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="2a27b-211">**Отображается кнопка загрузки приложений** — если после входа в надстройке Excel имеется кнопка **Загрузить приложения**, возможно, что выполнен вход с неправильным пользователем.</span><span class="sxs-lookup"><span data-stu-id="2a27b-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="2a27b-212">Чтобы устранить эту проблему, поверьте, правильное ли имя пользователя отображается в правом верхнем углу надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="2a27b-213">Если отображаются неправильное имя, выберите его, выполните выход, затем выполните вход.</span><span class="sxs-lookup"><span data-stu-id="2a27b-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="2a27b-214">**Вы получаете сообщение "Запрещено"** — если появляется сообщение "Запрещено", когда надстройка Excel загружает метаданные, учетная запись, с который выполнен вход в надстройку Excel, не имеет разрешения на использование целевой службы, экземпляра или базы данных.</span><span class="sxs-lookup"><span data-stu-id="2a27b-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="2a27b-215">Чтобы устранить эту проблему, поверьте, правильное ли имя пользователя отображается в правом верхнем углу надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="2a27b-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="2a27b-216">Если отображаются неправильное имя, выберите его, выполните выход, затем выполните вход.</span><span class="sxs-lookup"><span data-stu-id="2a27b-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="2a27b-217">**Пустая веб-страница отображается над Excel** — если в процессе входа открывается пустая веб-страница, для учетной записи требуются службы AD FS, но версии Excel, в которой выполняется надстройка Excel, слишком старая для загрузки диалогового окна входа.</span><span class="sxs-lookup"><span data-stu-id="2a27b-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="2a27b-218">Чтобы решить эту проблему, обновите версию Excel, которую вы используете.</span><span class="sxs-lookup"><span data-stu-id="2a27b-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="2a27b-219">Чтобы обновить версию Excel, находясь в предприятии, которое находится в отложенном канале, используйте [Средство развертывания Office](https://technet.microsoft.com/library/jj219422.aspx) для [перехода из отложенного канала в текущий канал](https://technet.microsoft.com/library/mt455210.aspx).</span><span class="sxs-lookup"><span data-stu-id="2a27b-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](https://technet.microsoft.com/library/jj219422.aspx) to [move from the deferred channel to the current channel](https://technet.microsoft.com/library/mt455210.aspx).</span></span>
- <span data-ttu-id="2a27b-220">**Вы получаете ошибку времени ожидания при публикации изменений данных** — если при попытке публикации изменений данных в сущности выводится сообщение об истечении времени ожидания, следует рассмотреть возможность уменьшения размера пакета публикации для данной книги.</span><span class="sxs-lookup"><span data-stu-id="2a27b-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="2a27b-221">Сущности, которые запускают большие объемы логики при изменении записей, могут потребовать, чтобы обновления отправлялись в виде небольших пакетов, чтобы предотвратить ошибки времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="2a27b-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]