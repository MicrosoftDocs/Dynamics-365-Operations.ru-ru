---
title: Конструктор формул в электронной отчетности (ER)
description: Этот раздел содержит общие сведения об использовании конструктора формул электронной отчетности.
author: NickSelin
manager: kfend
ms.date: 12/05/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 58771
ms.assetid: 24223e13-727a-4be6-a22d-4d427f504ac9
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 0028d1f64aced1bbff91b18456c81adbb95bce30
ms.sourcegitcommit: 36857283d70664742c8c04f426b231c42daf4ceb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/20/2019
ms.locfileid: "2914826"
---
# <a name="formula-designer-in-electronic-reporting-er"></a><span data-ttu-id="73739-103">Конструктор формул в электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="73739-103">Formula designer in Electronic reporting (ER)</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="73739-104">В этом разделе описывается, как использовать конструктор формул в электронной отчетности (ER).</span><span class="sxs-lookup"><span data-stu-id="73739-104">This topic explains how to use the formula designer in Electronic reporting (ER).</span></span> <span data-ttu-id="73739-105">При проектировании формата для определенного электронного документа в ER можно использовать формулы для преобразования данных, чтобы они отвечали требованиям для выполнения и форматирования этого документа.</span><span class="sxs-lookup"><span data-stu-id="73739-105">When you design a format for a specific electronic document in ER, you can use formulas to transform data so that it meets the requirements for the document's fulfillment and formatting.</span></span> <span data-ttu-id="73739-106">Эти формулы напоминают формулы в Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="73739-106">These formulas resemble formulas in Microsoft Excel.</span></span> <span data-ttu-id="73739-107">В формулах поддерживаются различные типы функций: текст, дата и время, математические логические, информация, преобразование типа данных и другое (характерные для конкретных бизнес-доменов функции).</span><span class="sxs-lookup"><span data-stu-id="73739-107">Various types of functions are supported in the formulas: text, date and time, mathematical, logical, information, and data type conversion functions, and also other, business domain–specific functions.</span></span>

## <a name="formula-designer-overview"></a><span data-ttu-id="73739-108">Обзор конструктора формул</span><span class="sxs-lookup"><span data-stu-id="73739-108">Formula designer overview</span></span>

<span data-ttu-id="73739-109">Электронная отчетность (ER) поддерживает конструктор формул.</span><span class="sxs-lookup"><span data-stu-id="73739-109">ER supports the formula designer.</span></span> <span data-ttu-id="73739-110">Поэтому во время разработки имеется возможность задать выражения, которые можно использовать для выполнения следующих задач во время выполнения:</span><span class="sxs-lookup"><span data-stu-id="73739-110">Therefore, at design time, you can configure expressions that can be used for the following tasks at runtime:</span></span>

- <span data-ttu-id="73739-111">Преобразование данных, полученных из базы данных приложения, которые должны вводить в модель данных ER, играющую роль источника данных для форматов ER.</span><span class="sxs-lookup"><span data-stu-id="73739-111">Transform data that is received from an application database and that should be entered in an ER data model that is designed to be a data source for ER formats.</span></span> <span data-ttu-id="73739-112">(Например, эти преобразования могут содержать фильтрацию, группирование и преобразование типов данных.)</span><span class="sxs-lookup"><span data-stu-id="73739-112">(For example, these transformations might include filtering, grouping, and data type conversion.)</span></span>
- <span data-ttu-id="73739-113">Форматирование данных, которые должны быть отправлены в генерирующий электронный документ в соответствии с макетом и условиями определенного формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="73739-113">Format data that must be sent to a generating electronic document in accordance with the layout and conditions of a specific ER format.</span></span> <span data-ttu-id="73739-114">(Например, форматирование может быть выполнено в соответствии с затребованным языком, культурой или кодировкой.)</span><span class="sxs-lookup"><span data-stu-id="73739-114">(For example, the formatting might be done in accordance with the requested language or culture, or the encoding).</span></span>
- <span data-ttu-id="73739-115">Управление процессом создания электронных документов.</span><span class="sxs-lookup"><span data-stu-id="73739-115">Control the process of creating electronic documents.</span></span> <span data-ttu-id="73739-116">(Например, выражения могут включать или отключать вывод конкретных элементов формата, в зависимости от обрабатываемых данных.</span><span class="sxs-lookup"><span data-stu-id="73739-116">(For example, the expressions can enable or disable the output of specific elements of the format, depending on processing data.</span></span> <span data-ttu-id="73739-117">Они также могут прерывать процесс создания документа или выдавать сообщения пользователям.)</span><span class="sxs-lookup"><span data-stu-id="73739-117">They can also interrupt the document creation process or throw messages to users.)</span></span>

<span data-ttu-id="73739-118">Страницу **Конструктор формул** можно открыть при выполнении любого из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="73739-118">You can open the **Formula designer** page when you perform any of the following actions:</span></span>

- <span data-ttu-id="73739-119">Связывание элементов источника данных с компонентами модели данных.</span><span class="sxs-lookup"><span data-stu-id="73739-119">Bind data source items to data model components.</span></span>
- <span data-ttu-id="73739-120">Связывание элементов источника данных с компонентами формата.</span><span class="sxs-lookup"><span data-stu-id="73739-120">Bind data source items to format components.</span></span>
- <span data-ttu-id="73739-121">Завершение обслуживания вычисляемых полей, которые являются частью источников данных.</span><span class="sxs-lookup"><span data-stu-id="73739-121">Complete maintenance of calculated fields that are part of data sources.</span></span>
- <span data-ttu-id="73739-122">Определение условий видимости для параметров пользовательского ввода.</span><span class="sxs-lookup"><span data-stu-id="73739-122">Define the visibility conditions for user input parameters.</span></span>
- <span data-ttu-id="73739-123">Разработка преобразований формата.</span><span class="sxs-lookup"><span data-stu-id="73739-123">Design a format's transformations.</span></span>
- <span data-ttu-id="73739-124">Определение условий включения для компонентов формата.</span><span class="sxs-lookup"><span data-stu-id="73739-124">Define the enabling conditions for the format's components.</span></span>
- <span data-ttu-id="73739-125">Определение имен файлов для компонентов FILE формата.</span><span class="sxs-lookup"><span data-stu-id="73739-125">Define the file names for the format's FILE components.</span></span>
- <span data-ttu-id="73739-126">Определение условий для проверок управления процессом.</span><span class="sxs-lookup"><span data-stu-id="73739-126">Define the conditions for process control validations.</span></span>
- <span data-ttu-id="73739-127">Определение текста сообщения для проверок управления процессом.</span><span class="sxs-lookup"><span data-stu-id="73739-127">Define the message text for process control validations.</span></span>

## <span data-ttu-id="73739-128"><a name="Binding">Привязка данных</a></span><span class="sxs-lookup"><span data-stu-id="73739-128"><a name="Binding">Data binding</a></span></span>

<span data-ttu-id="73739-129">Конструктор формул ER можно использовать для определения выражения, которое конвертирует данные, полученные от источников данных, таким образом, чтобы эти данные можно было ввести в потребителе данных следующим образом во время выполнения:</span><span class="sxs-lookup"><span data-stu-id="73739-129">The ER formula designer can be used to define an expression that transforms data that is received from data sources, so that the data can be entered in the data consumer in the following ways at runtime:</span></span>

- <span data-ttu-id="73739-130">Из источников данных приложения и параметров времени выполнения в модель данных ER</span><span class="sxs-lookup"><span data-stu-id="73739-130">From application data sources and runtime parameters to an ER data model</span></span>
- <span data-ttu-id="73739-131">Из модели данных ER в формат ER</span><span class="sxs-lookup"><span data-stu-id="73739-131">From an ER data model to an ER format</span></span>
- <span data-ttu-id="73739-132">Из источников данных приложения и параметров времени выполнения в формат ER</span><span class="sxs-lookup"><span data-stu-id="73739-132">From application data sources and runtime parameters to an ER format</span></span>

<span data-ttu-id="73739-133">На следующем рисунке показана разработка выражения этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-133">The following illustration shows the design of an expression of this type.</span></span> <span data-ttu-id="73739-134">В этом примере выражение округляет значение поля **Intrastat.AmountMST** таблицы Интрастат до двух десятичных знаков, и затем возвращает округленное значение.</span><span class="sxs-lookup"><span data-stu-id="73739-134">In this example, the expression rounds the value of the **Intrastat.AmountMST** field in the Intrastat table to two decimal places and then returns the rounded value.</span></span>

<span data-ttu-id="73739-135">[![Выражение связывания данных](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-135">[![Data binding expression](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span></span>

<span data-ttu-id="73739-136">На следующем рисунке показано, как может использоваться выражение этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-136">The following illustration shows how an expression of this type can be used.</span></span> <span data-ttu-id="73739-137">В этом примере результат сконструированного выражения вводится в компоненте **Transaction.InvoicedAmount** модели данных **Модель налоговой отчетности**.</span><span class="sxs-lookup"><span data-stu-id="73739-137">In this example, the result of the designed expression is entered in the **Transaction.InvoicedAmount** component of the **Tax reporting model** data model.</span></span>

<span data-ttu-id="73739-138">[![Используемое выражение привязки данных](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-138">[![Data binding expression being used](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span></span>

<span data-ttu-id="73739-139">Во время выполнения созданная формула `ROUND (Intrastat.AmountMST, 2)` округляет значение поля **AmountMST** для каждой записи в таблице Интрастат до двух десятичных разрядов.</span><span class="sxs-lookup"><span data-stu-id="73739-139">At runtime, the designed formula, `ROUND (Intrastat.AmountMST, 2)`, rounds the value of the **AmountMST** field for each record in the Intrastat table to two decimal places.</span></span> <span data-ttu-id="73739-140">Затем она вводит округленное значение в компонент **Transaction.InvoicedAmount** модели данных **Налоговая отчетность**.</span><span class="sxs-lookup"><span data-stu-id="73739-140">It then enters the rounded value in the **Transaction.InvoicedAmount** component of the **Tax reporting** data model.</span></span>

## <span data-ttu-id="73739-141"><a name="Transformation">Формат данных</a></span><span class="sxs-lookup"><span data-stu-id="73739-141"><a name="Transformation">Data formatting</a></span></span>

<span data-ttu-id="73739-142">Конструктор формул ER можно использовать для определения выражения, которое форматирует данные, полученные от источников данных, таким образом, чтобы эти данные можно было отправить как часть создания электронного документа.</span><span class="sxs-lookup"><span data-stu-id="73739-142">The ER formula designer can be used to define an expression that formats data that is received from data sources, so that the data can be sent as part of the generating electronic document.</span></span> <span data-ttu-id="73739-143">Может иметься форматирование, которое должно применяться как типовое правило, которое должно быть повторно использовано для формата.</span><span class="sxs-lookup"><span data-stu-id="73739-143">You might have formatting that must be applied as a typical rule that should be reused for a format.</span></span> <span data-ttu-id="73739-144">В этом случае можно ввести это форматирование один раз в конфигурации формата как именованное преобразование, имеющее выражение форматирования.</span><span class="sxs-lookup"><span data-stu-id="73739-144">In this case, you can introduce that formatting one time in the format configuration, as a named transformation that has a formatting expression.</span></span> <span data-ttu-id="73739-145">Позднее это именованное преобразование можно связывать с многими компонентами формата, выходные данные в которых должны форматироваться в соответствии с созданным выражением форматирования.</span><span class="sxs-lookup"><span data-stu-id="73739-145">This named transformation can then be linked to many format components where the output must be formatted according to the formatting expression that you created.</span></span>

<span data-ttu-id="73739-146">На следующем рисунке показана разработка преобразования этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-146">The following illustration shows the design of a transformation of this type.</span></span> <span data-ttu-id="73739-147">В этом примере преобразование **TrimmedString** усекает входящие данные типа данных *String*, удаляя ведущие и конечные пробелы.</span><span class="sxs-lookup"><span data-stu-id="73739-147">In this example, the **TrimmedString** transformation truncates incoming data of the *String* data type by removing leading and trailing spaces.</span></span> <span data-ttu-id="73739-148">Затем оно возвращает значение усеченной строки.</span><span class="sxs-lookup"><span data-stu-id="73739-148">It then returns the truncated string value.</span></span>

<span data-ttu-id="73739-149">[![Преобразование](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-149">[![Transformation](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span></span>

<span data-ttu-id="73739-150">На следующем рисунке показано, как может использоваться преобразование этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-150">The following illustration shows how a transformation of this type can be used.</span></span> <span data-ttu-id="73739-151">В данном примере несколько компонентов формата отправляют текст как выходные данные для создания электронного документа во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="73739-151">In this example, several format components send text as output to the generating electronic document at runtime.</span></span> <span data-ttu-id="73739-152">Все эти компоненты формата ссылаются на преобразование **TrimmedString** по имени.</span><span class="sxs-lookup"><span data-stu-id="73739-152">All these format components refer to the **TrimmedString** transformation by name.</span></span>

<span data-ttu-id="73739-153">[![Используемое преобразование](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-153">[![Transformation being used](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span></span>

<span data-ttu-id="73739-154">Когда компоненты формата, такие как компонент **partyName** на предыдущем рисунке, ссылаются на преобразование **TrimmedString**, это преобразование отправляет текст как выходные данные в создающий электронный документ.</span><span class="sxs-lookup"><span data-stu-id="73739-154">When format components, such as the **partyName** component in the preceding illustration, refer to the **TrimmedString** transformation, the transformation sends text as output to the generating electronic document.</span></span> <span data-ttu-id="73739-155">Этот текст не включает начальные и конечные пробелы.</span><span class="sxs-lookup"><span data-stu-id="73739-155">This text doesn't include leading and trailing spaces.</span></span>

<span data-ttu-id="73739-156">Если у вас есть форматирование, которое должно применяться индивидуально, его можно внедрить как отдельное выражение привязки определенного компонента "формат".</span><span class="sxs-lookup"><span data-stu-id="73739-156">If you have formatting that must be applied individually, you can introduce that formatting as an individual expression of a binding of a specific format component.</span></span> <span data-ttu-id="73739-157">На следующем рисунке показано выражение этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-157">The following illustration shows an expression of this type.</span></span> <span data-ttu-id="73739-158">В этом примере компонент формата **partyType** привязан к источнику данных через выражение, преобразующее входящие данные из поля **Model.Company.RegistrationType** в источнике данных в текст в верхнем регистре.</span><span class="sxs-lookup"><span data-stu-id="73739-158">In this example, the **partyType** format component is bound to the data source via an expression that converts incoming data from the **Model.Company.RegistrationType** field in the data source to uppercase text.</span></span> <span data-ttu-id="73739-159">Выражение затем отправляет этот текст как выходные данные в электронный документ.</span><span class="sxs-lookup"><span data-stu-id="73739-159">The expression then sends that text as output to the electronic document.</span></span>

<span data-ttu-id="73739-160">[![Применение форматирования к отдельному компоненту](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-160">[![Applying formatting to an individual component](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span></span>

## <span data-ttu-id="73739-161"><a name="Validation">Управление процессом</a></span><span class="sxs-lookup"><span data-stu-id="73739-161"><a name="Validation">Process flow control</a></span></span>

<span data-ttu-id="73739-162">Конструктор формул ER может использоваться для определения выражений для управления процессом формирования электронных документов.</span><span class="sxs-lookup"><span data-stu-id="73739-162">The ER formula designer can be used to define expressions that control the process flow of generating electronic documents.</span></span> <span data-ttu-id="73739-163">Можно выполнить следующие задачи.</span><span class="sxs-lookup"><span data-stu-id="73739-163">You can perform the following tasks:</span></span>

- <span data-ttu-id="73739-164">определения условий, определяющий, когда процесс создания документа должен быть остановлен.</span><span class="sxs-lookup"><span data-stu-id="73739-164">Define conditions that determine when a document creation process must be stopped.</span></span>
- <span data-ttu-id="73739-165">задания выражений, которые либо будут создавать сообщения для пользователя об остановленных процессах, либо записывать сообщения в журнал выполнения о продолжении процесса формирования отчетности;</span><span class="sxs-lookup"><span data-stu-id="73739-165">Specify expressions that either create messages for the user about stopped processes or throw execution log messages about the continuing process of report generation.</span></span>
- <span data-ttu-id="73739-166">Определение имен файлов генерируемых электронных документов и управление условиями их создания.</span><span class="sxs-lookup"><span data-stu-id="73739-166">Specify the file names of generating electronic documents, and control the conditions of their creation.</span></span>

<span data-ttu-id="73739-167">Каждое из правил управления процессом конструируется в виде отдельной валидации.</span><span class="sxs-lookup"><span data-stu-id="73739-167">Each rule of the process flow control is designed as an individual validation.</span></span> <span data-ttu-id="73739-168">На следующем рисунке показана проверка этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-168">The following illustration shows a validation of this type.</span></span> <span data-ttu-id="73739-169">Здесь объяснение конфигурации в этом примере:</span><span class="sxs-lookup"><span data-stu-id="73739-169">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="73739-170">Проверка производится, когда узел **INSTAT** создан во время создания XML-файла.</span><span class="sxs-lookup"><span data-stu-id="73739-170">The validation is evaluated when the **INSTAT** node is created during generation of the XML file.</span></span>
- <span data-ttu-id="73739-171">Если список транзакций пуст, проверка останавливает процесс выполнения и возвращает значение **FALSE**.</span><span class="sxs-lookup"><span data-stu-id="73739-171">If the list of transactions is empty, the validation stops the execution process and returns **FALSE**.</span></span>
- <span data-ttu-id="73739-172">Проверка возвращает сообщение об ошибке, которое включает текст метки SYS70894 на языке, предпочитаемом пользователем.</span><span class="sxs-lookup"><span data-stu-id="73739-172">The validation returns an error message that includes the text of label SYS70894 in the user's preferred language.</span></span>

<span data-ttu-id="73739-173">[![Проверка](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-173">[![Validation](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span></span>

<span data-ttu-id="73739-174">Конструктор формул ER используется также для создания имени файла для формируемого электронного документа и управления процессом создания файла.</span><span class="sxs-lookup"><span data-stu-id="73739-174">The ER formula designer can also be used to generate a file name for a generating electronic document and to control the file creation process.</span></span> <span data-ttu-id="73739-175">На следующем рисунке показана разработка управления процессом этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-175">The following illustration shows the design of a process flow control of this type.</span></span> <span data-ttu-id="73739-176">Здесь объяснение конфигурации в этом примере:</span><span class="sxs-lookup"><span data-stu-id="73739-176">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="73739-177">Список записей из источника данных **model.Intrastat** разделен на пакеты.</span><span class="sxs-lookup"><span data-stu-id="73739-177">The list of records from the **model.Intrastat** data source is divided into batches.</span></span> <span data-ttu-id="73739-178">Каждый пакет содержит до 1000 записей.</span><span class="sxs-lookup"><span data-stu-id="73739-178">Each batch contains up to 1,000 records.</span></span>
- <span data-ttu-id="73739-179">Выпуск создает ZIP-файл, который содержит один файл в формате XML для каждой партии, который была создана.</span><span class="sxs-lookup"><span data-stu-id="73739-179">The output creates a zip file that contains one file in XML format for every batch that was created.</span></span>
- <span data-ttu-id="73739-180">Выражение возвращает имя файла для генерации электронных документов путем объединения имени файла и расширения имени файла.</span><span class="sxs-lookup"><span data-stu-id="73739-180">An expression returns a file name for generating electronic documents by concatenating the file name and the file name extension.</span></span> <span data-ttu-id="73739-181">Для второй партии и всех последующих партий имя файла содержит код партии в качестве суффикса.</span><span class="sxs-lookup"><span data-stu-id="73739-181">For the second batch and all subsequent batches, the file name contains the batch ID as a suffix.</span></span>
- <span data-ttu-id="73739-182">Выражение включает (возвратом значения **TRUE**) процесс создания файла для тех пакетов, которые содержат хотя бы одну запись.</span><span class="sxs-lookup"><span data-stu-id="73739-182">An expression enables (by returning **TRUE**) the file creation process for batches that contain at least one record.</span></span>

<span data-ttu-id="73739-183">[![Управление процессом](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span><span class="sxs-lookup"><span data-stu-id="73739-183">[![Process flow control](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span></span>

## <span data-ttu-id="73739-184"><a name="Enabled">Управление содержимым документов</a></span><span class="sxs-lookup"><span data-stu-id="73739-184"><a name="Enabled">Document content control</a></span></span>

<span data-ttu-id="73739-185">Конструктор формул электронной отчетности можно использовать для настройки выражений, определяющих, какие данные будут помещены в создаваемые электронные документы во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="73739-185">The ER formula designer can be used to configure expressions that control what data will be put into generated electronic documents at runtime.</span></span> <span data-ttu-id="73739-186">Выражения могут включать или отключать вывод конкретных элементов формата, в зависимости от обрабатываемых данных и настроенной логики.</span><span class="sxs-lookup"><span data-stu-id="73739-186">The expressions can enable or disable the output of specific elements of the format, depending on processing data and configured logic.</span></span> <span data-ttu-id="73739-187">Эти выражения могут быть введены для одного элемента формата в поле **Включено** на вкладке **Сопоставление** на странице **Конструктор операций**.</span><span class="sxs-lookup"><span data-stu-id="73739-187">These expressions can be entered for a single format element in the **Enabled** field on the **Mapping** tab of the **Operations designer** page.</span></span> <span data-ttu-id="73739-188">Вы можете ввести выражения как логическое условие, которое возвращает *логическое* значение:</span><span class="sxs-lookup"><span data-stu-id="73739-188">You can enter the expressions as a logic condition that returns a *Boolean* value:</span></span>

- <span data-ttu-id="73739-189">Если условие возвращает **True**, текущий элемент формата выполняется.</span><span class="sxs-lookup"><span data-stu-id="73739-189">If the condition returns **True**, the current format element is run.</span></span>
- <span data-ttu-id="73739-190">Если условие возвращает **False**, текущий элемент формата пропускается.</span><span class="sxs-lookup"><span data-stu-id="73739-190">If the condition returns **False**, the current format element is skipped.</span></span>

<span data-ttu-id="73739-191">На следующем рисунке показаны выражения этого типа.</span><span class="sxs-lookup"><span data-stu-id="73739-191">The following illustration shows expressions of this type.</span></span> <span data-ttu-id="73739-192">(В качестве примера используется версия 11.12.11 конфигурации формата **Перенос кредита ISO20022 (NO)**, предоставляемой корпорацией Майкрософт.) Компонент формата **XMLHeader** настроен для описания структуры сообщения о переносе кредита в соответствии со стандартами сообщений ISO 20022 XML.</span><span class="sxs-lookup"><span data-stu-id="73739-192">(Version 11.12.11 of the **ISO20022 Credit transfer (NO)** format configuration that is provided by Microsoft is used as an example.) The **XMLHeader** format component is configured to describe the structure of the credit transfer message according to the ISO 20022 XML message standards.</span></span> <span data-ttu-id="73739-193">Компонент формата **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** сконфигурирован для добавления к созданному сообщению, элементу XML **Ustrd**, и размещения информации о предъявлении к оплате в неструктурированный формат в виде текста следующих элементов XML:</span><span class="sxs-lookup"><span data-stu-id="73739-193">The **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** format component is configured to add the **Ustrd** XML element to the generated message and to put the remittance information in an unstructured format as text of the following XML elements:</span></span>

- <span data-ttu-id="73739-194">Компонент **PaymentNotes** используется для создания текста платежных примечаний.</span><span class="sxs-lookup"><span data-stu-id="73739-194">The **PaymentNotes** component is used to generate the text of payment notes.</span></span>
- <span data-ttu-id="73739-195">Компонент **DelimitedSequence** создает номера накладных с разделителями-запятыми, которые используются для сопоставления текущего переноса кредита.</span><span class="sxs-lookup"><span data-stu-id="73739-195">The **DelimitedSequence** component generates comma-separated invoice numbers that are used to settle the current credit transfer.</span></span>

<span data-ttu-id="73739-196">[![Компоненты PaymentNotes и DelimitedSequence](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span><span class="sxs-lookup"><span data-stu-id="73739-196">[![PaymentNotes and DelimitedSequence components](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span></span>

> [!NOTE]
> <span data-ttu-id="73739-197">Компоненты **PaymentNotes** и **DelimitedSequence** обозначены с использованием вопросительного знака.</span><span class="sxs-lookup"><span data-stu-id="73739-197">The **PaymentNotes** and **DelimitedSequence** components are labeled by using a question mark.</span></span> <span data-ttu-id="73739-198">Вопросительный знак указывает на то, что использование компонента является условным.</span><span class="sxs-lookup"><span data-stu-id="73739-198">A question mark indicates that the use of a component is conditional.</span></span> <span data-ttu-id="73739-199">В этом случае использование компонентов основано на следующих критериях:</span><span class="sxs-lookup"><span data-stu-id="73739-199">In this case, use of the components is based on the following criteria:</span></span>
>
> - <span data-ttu-id="73739-200">Выражение `@.PaymentsNotes <> ""`, определенное для компонента **PaymentNotes**, разрешает (возвращая **TRUE**) заполнение XML-элемента **Ustrd**, тестом примечаний платежа, если этот текст для текущего переноса кредита не пуст.</span><span class="sxs-lookup"><span data-stu-id="73739-200">The `@.PaymentsNotes <> ""` expression that is defined for the **PaymentNotes** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with the text of payment notes, if that text isn't blank for the current credit transfer.</span></span>
>
>    <span data-ttu-id="73739-201">[![Выражение для компонента PaymentNotes](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span><span class="sxs-lookup"><span data-stu-id="73739-201">[![Expression for the PaymentNotes component](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span></span>
>
> - <span data-ttu-id="73739-202">Выражение `@.PaymentsNotes = ""`, определенное для компонента **DelimitedSequence**, выражение разрешает (возвращая **TRUE**) заполнение XML-элемента **Ustrd** разделенными запятыми номерами накладных, которые используются для сопоставления текущего переноса кредита, когда текст примечаний платежа для этого переноса кредита пуст.</span><span class="sxs-lookup"><span data-stu-id="73739-202">The `@.PaymentsNotes = ""` expression that is defined for the **DelimitedSequence** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with a comma-separated list of the invoice numbers that are used to settle the current credit transfer, if the text of payment notes for that credit transfer is blank.</span></span>
>
>    <span data-ttu-id="73739-203">[![Выражение для компонента DelimitedSequence](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span><span class="sxs-lookup"><span data-stu-id="73739-203">[![Expression for the DelimitedSequence component](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span></span>
> 
> <span data-ttu-id="73739-204">На основе этой настройки созданное сообщение для каждого платежа должника, XML-элемент **Ustrd**, будет содержать либо текст примечаний по платежу, либо, если такой текст пуст, текст с разделенными запятыми номерами накладных, использованных для сопоставления данного платежа.</span><span class="sxs-lookup"><span data-stu-id="73739-204">Based on this setup, the message that is generated for each debtor payment, the **Ustrd** XML element, will contain either the text of payment notes or, when that text is blank, a comma-separated list of the invoice numbers that are used to settle the payment.</span></span>

## <span data-ttu-id="73739-205"><a name="TestFormula">Проверка настроенных формул</a></span><span class="sxs-lookup"><span data-stu-id="73739-205"><a name="TestFormula">Validation of configured formulas</a></span></span>

<span data-ttu-id="73739-206">На странице **конструктора формул** выберите **Тест**, чтобы проверить, как работает настроенная формула.</span><span class="sxs-lookup"><span data-stu-id="73739-206">On the **Formula designer** page, select **Test** to validate how the configured formula works.</span></span>

<span data-ttu-id="73739-207">[![Выбор теста для проверки формулы](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span><span class="sxs-lookup"><span data-stu-id="73739-207">[![Selecting Test to validate a forumula](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span></span>

<span data-ttu-id="73739-208">При необходимости значений аргументов формулы можно открыть диалоговое окно **Тест выражения** на странице **Конструктор формул**.</span><span class="sxs-lookup"><span data-stu-id="73739-208">When the values of formula arguments are required, you can open the **Test expression** dialog box from the **Formula designer** page.</span></span> <span data-ttu-id="73739-209">В большинстве случаев эти аргументы должны быть определены вручную, так как настроенные привязки не запускались во время разработки.</span><span class="sxs-lookup"><span data-stu-id="73739-209">In most cases, these arguments must be manually defined, because the configured bindings aren't run at design time.</span></span> <span data-ttu-id="73739-210">На вкладке **Результаты проверки** на странице **Конструктор формулы** показан результат выполнения настроенной формулы.</span><span class="sxs-lookup"><span data-stu-id="73739-210">The **Test result** tab on the **Formula designer** page shows the result from execution of the configured formula.</span></span>

<span data-ttu-id="73739-211">В следующем примере показано, как можно протестировать формулу, настроенную для домена внешней торговли, чтобы убедиться, что товарный код Интрастат содержит только цифры.</span><span class="sxs-lookup"><span data-stu-id="73739-211">The following example shows how you can test the formula that is configured for the foreign trade domain to make sure that the Intrastat commodity code contains only digits.</span></span>

<span data-ttu-id="73739-212">При тестировании этой формулы можно использовать диалоговое окно **Тест выражения** для указания значения товарного кода Интрастат для тестирования.</span><span class="sxs-lookup"><span data-stu-id="73739-212">When you test this formula, you can use the **Test expression** dialog box to specify the value of the Intrastat commodity code for testing.</span></span>

<span data-ttu-id="73739-213">[![Определение товарного кода Интрастат для тестирования](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span><span class="sxs-lookup"><span data-stu-id="73739-213">[![Specifying the Intrastat commodity code for testing](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span></span>

<span data-ttu-id="73739-214">После указания товарного кода Интрастат и выбора **OK** на вкладке **Результат проверки** на странице конструктора **Конструктор формул** отображается результат выполнения настроенной формулы.</span><span class="sxs-lookup"><span data-stu-id="73739-214">After you specify the Intrastat commodity code and select **OK**, the **Test result** tab on the **Formula designer** page shows the result of execution of the configured formula.</span></span> <span data-ttu-id="73739-215">Затем можно оценить, является ли результат приемлемым.</span><span class="sxs-lookup"><span data-stu-id="73739-215">You can then evaluate whether the result is acceptable.</span></span> <span data-ttu-id="73739-216">Если результат неприемлем, можно обновить формулу и протестировать ее снова.</span><span class="sxs-lookup"><span data-stu-id="73739-216">If the result isn't acceptable, you can update the formula and test it again.</span></span>

<span data-ttu-id="73739-217">[![Результаты проверки](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span><span class="sxs-lookup"><span data-stu-id="73739-217">[![Test result](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span></span>

<span data-ttu-id="73739-218">Некоторые формулы не могут быть протестированы во время разработки.</span><span class="sxs-lookup"><span data-stu-id="73739-218">Some formulas can't be tested at design time.</span></span> <span data-ttu-id="73739-219">Например, формула может вернуть результат типа данных, который не может быть отображен на вкладке **Результат проверки**. В этом случае вы получаете сообщение об ошибке, в котором говорится, что формула не может быть протестирована.</span><span class="sxs-lookup"><span data-stu-id="73739-219">For example, a formula might return a result of a data type that can't be shown on the **Test result** tab. In this case, you receive an error message that states that the formula can't be tested.</span></span>

<span data-ttu-id="73739-220">[![Сообщение об ошибке](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span><span class="sxs-lookup"><span data-stu-id="73739-220">[![Error message](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="73739-221">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="73739-221">Additional resources</span></span>

- [<span data-ttu-id="73739-222">Обзор электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="73739-222">Electronic Reporting overview</span></span>](general-electronic-reporting.md)
- [<span data-ttu-id="73739-223">Язык формул электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="73739-223">Electronic reporting formula language</span></span>](er-formula-language.md)
