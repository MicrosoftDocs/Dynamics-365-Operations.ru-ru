---
title: Хранение резервных копий шаблонов ER
description: В этой теме объясняется, как использовать хранилище резервных копий электронной отчетности (ER) для восстановления шаблонов.
author: NickSelin
ms.date: 04/29/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 27621
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-08-13
ms.dyn365.ops.version: 10.0.5
ms.openlocfilehash: b41760bb58cbef66146b3f1af6f30c6a35a18727
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "5743855"
---
# <a name="backup-storage-of-er-templates"></a>Хранение резервных копий шаблонов ER

[!include [banner](../includes/banner.md)]

[Обзор электронной отчетности (ER)](general-electronic-reporting.md) позволяет бизнес-пользователям настраивать форматы для исходящих электронных документов в соответствии с требованиями законодательства различных стран/регионов. Настроенные форматы ER могут использовать готовые шаблоны для создания исходящих документов в различных форматах, таких как книги Microsoft Excel, документы Microsoft Word или PDF-документы. Шаблоны заполняются данными, которые требуются для настроенного потока данных для созданных документов.

Каждый настроенный формат может быть опубликован как часть решения ER. Каждое решение ER может быть экспортировано из одного экземпляра Finance and Operations и импортировано в другой экземпляр.

Структура ER использует [Настройку управления документами](../../fin-ops/organization-administration/configure-document-management.md), чтобы хранить необходимые шаблоны для текущего экземпляра Finance and Operations. В зависимости от настроек инфраструктуры ER в качестве основного физического места хранения шаблонов можно выбрать хранилище больших двоичных объектов Microsoft Azure или папку Microsoft SharePoint. (Дополнительные сведения см. в разделе [Настройка платформы для электронной отчетности (ER)](electronic-reporting-er-configure-parameters.md).) Таблица DocuValue содержит отдельную запись для каждого шаблона. В каждой записи в поле **AccessInformation** хранится путь к файлу шаблона, расположенному в настроенном месте хранения.

При управлении вашими экземплярами Finance and Operations можно выполнить миграцию текущего экземпляра в другое местоположение. Например, можно перенести производственный экземпляр в новую среду "песочницы". Если платформа ER настроена для хранения шаблонов в хранилище BLOB-объектов, таблица DocuValue в новой среде "песочницы" ссылается на экземпляр хранилища BLOB-объектов в производственной среде. Однако доступ к этому экземпляру из среды "песочницы" невозможен, поскольку процесс миграции не поддерживает миграцию артефактов в хранилище BLOB-объектов. Таким образом, при попытке выполнить формат ER, использующий шаблон для создания деловых документов, происходит исключение, и вы получаете уведомление об отсутствующем шаблоне. Кроме того, вам предлагается воспользоваться средством очистки ER, чтобы удалить и затем повторно импортировать конфигурацию формата ER, содержащую данный шаблон. Поскольку может иметься несколько конфигураций формата ER, этот процесс может занять много времени.

Функция хранения резервных копий шаблонов ER поможет создать шаблоны так, чтобы они всегда были доступны для создания бизнес-документов.

> [!NOTE]
> Эта функция может использоваться только в том случае, если для хранения шаблонов ER в качестве физического хранилища выбрано хранилище BLOB-объектов.

## <a name="automated-recovery-and-notification"></a>Автоматическое восстановление и уведомление

Для этой функции каждый шаблон новой конфигурации формата ER в текущей среде автоматически сохраняется в местоположении хранения резервных копий шаблонов (таблица базы данных ERDocuDatabaseStorage) при возникновении следующих событий:

- Импортируется новая конфигурация формата ER, содержащая шаблон.
- Вы завершаете черновую версию конфигурации формата ER, которая содержит шаблон.

Резервные копии шаблонов мигрируют в новый экземпляр Finance and Operations как часть базы данных приложения.

Если для создания исходящих документов требуется шаблон формата ER, для обработки платежей поставщикам, включая создание уведомлений об оплате и управления отчетами, например, но необходимый шаблон не найден в основном местоположении хранения, происходят следующие события:

- Если шаблон доступен в местоположении хранения резервных копий, он автоматически берется из местоположения хранения резервных копий, восстанавливается в первичное место хранения и используется для текущего выполнения.
- Каждый пользователь, назначенный для роли **Разработчик электронной отчетности** или **Системный администратор**, получает уведомление о проблеме отсутствующего шаблона через центр поддержки. Отображаемое сообщение зависит от значения параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**:

    - Если этот параметр имеет значение **Выкл.**, сообщение рекомендует запустить процесс пакетной обработки для автоматического исправления аналогичных проблем для других шаблонов конфигурации формата ER. Сообщение содержит ссылку, которую можно использовать для запуска пакетного процесса.
    - Если этот параметр имеет значение **Вкл.**, сообщение уведомляет пользователя о том, что обнаружены проблемы с отсутствующими шаблонами, и что новый пакетный процесс **Восстановить нарушенные шаблоны из внутренней резервной базы данных** автоматически запланирован. Этот пакетный процесс будет автоматически исправлять аналогичные ошибки для других шаблонов.

Чтобы настроить параметр **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**, выполните следующие действия:

1. В Finance and Operations откройте **Администрирование организации \> Электронная отчетность \> Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. В диалоговом окне **Параметры пользователя** установите необходимое значение для параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**.

> [!NOTE]
> Этот параметр определяется отдельно для каждого пользователь приложения и выполнившей вход компанию.

![Страница конфигураций электронной отчетности](./media/GER-BackupTemplates-1.png)

На следующем рисунке показан пример сообщения, отображаемого в том случае, когда для параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов** задано значение **Вкл.**.

![Страница журнала платежей поставщика](./media/GER-BackupTemplates-2.png)

На следующем рисунке показан пакетный процесс **Восстановить нарушенные шаблоны из внутренней резервной базы данных** на странице **Пакетное задание**.

![Страница пакетного задания](./media/GER-BackupTemplates-3.png)

Журнал выполнения завершенного процесса пакетной обработки **Восстановить нарушенные шаблоны из внутренней резервной базы данных** содержит сведения о шаблонах, восстановленных из местоположения хранения резервных копий в первичное место хранения.

![Страница истории пакетных заданий](./media/GER-BackupTemplates-4.png)

По умолчанию процесс автоматического создания резервных копий шаблонов, которые находятся в конфигурациях формата ER, включен. Чтобы прекратить создание резервных копий шаблонов, задайте для параметра **Остановить создание резервных копий шаблона** значение **Да** на вкладке **Вложения** страницы **Параметры электронной отчетности**. Вы можете открыть эту страницу из рабочей области **Электронная отчетность**.

Если для параметра **Остановить создание резервных копий шаблона** установлено значение **Да** и не требуется сохранять резервные копии ранее созданных шаблонов, выберите **Очистить резервное хранилище** на странице **Параметры электронной отчетности**.

Если среда была обновлена до Finance and Operations версии 10.0.5 (октябрь 2019 г.) и требуется выполнить миграцию в новую среду, включающую конфигурации формата ER, которые могут быть выполнены, выберите **Заполнить резервное хранилище** на странице **Параметры электронной отчетности** перед выполнением миграции. После нажатия этой кнопки запускается процесс создания резервных копий всех доступных шаблонов, чтобы их можно было сохранить в местоположении хранения резервных копий ER для шаблонов.

![Страница параметров электронной отчетности](./media/GER-BackupTemplates-5.png)

## <a name="manual-recovery"></a>Ручное восстановление

Выберите **Администрирование организации** \> **Электронная отчетность** \> **Восстановить нарушенный шаблоны**, чтобы вручную запустить процесс восстановления шаблонов ER из резервного хранилища в основное расположение хранилища. Прежде чем начать этот процесс, на странице **Восстановление нарушенных шаблонов** можно указать, будет ли он выполняться в интерактивном режиме, или для него можно запланировать пакетную обработку.

## <a name="supported-deployments"></a>Поддерживаемые развертывания

В Finance and Operations версии 10.0.5 функция хранения резервных копий шаблонов ER доступна только при развертывании в облаке.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Обзор электронной отчетности (ER)](general-electronic-reporting.md)

[Настройка платформы для электронной отчетности (ER)](electronic-reporting-er-configure-parameters.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]