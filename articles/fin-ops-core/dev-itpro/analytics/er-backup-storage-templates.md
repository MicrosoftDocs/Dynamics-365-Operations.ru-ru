---
title: Хранение резервных копий шаблонов ER
description: В этой теме объясняется, как использовать хранилище резервных копий электронной отчетности (ER) для восстановления шаблонов.
author: NickSelin
manager: AnnBe
ms.date: 04/29/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 27621
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-08-13
ms.dyn365.ops.version: 10.0.5
ms.openlocfilehash: d1bf2f13833b4441812b1c5326f897415c752091
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5565633"
---
# <a name="backup-storage-of-er-templates"></a><span data-ttu-id="b49ab-103">Хранение резервных копий шаблонов ER</span><span class="sxs-lookup"><span data-stu-id="b49ab-103">Backup storage of ER templates</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="b49ab-104">[Обзор электронной отчетности (ER)](general-electronic-reporting.md) позволяет бизнес-пользователям настраивать форматы для исходящих электронных документов в соответствии с требованиями законодательства различных стран/регионов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-104">The [Electronic reporting (ER) overview](general-electronic-reporting.md) lets business users configure formats for outbound documents according to the legal requirements of various countries and regions.</span></span> <span data-ttu-id="b49ab-105">Настроенные форматы ER могут использовать готовые шаблоны для создания исходящих документов в различных форматах, таких как книги Microsoft Excel, документы Microsoft Word или PDF-документы.</span><span class="sxs-lookup"><span data-stu-id="b49ab-105">Configured ER formats can use predefined templates to generate outbound documents in various formats, such as Microsoft Excel workbooks, Microsoft Word documents, or PDF documents.</span></span> <span data-ttu-id="b49ab-106">Шаблоны заполняются данными, которые требуются для настроенного потока данных для созданных документов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-106">The templates are filled with data that the configured dataflow for generated documents requires.</span></span>

<span data-ttu-id="b49ab-107">Каждый настроенный формат может быть опубликован как часть решения ER.</span><span class="sxs-lookup"><span data-stu-id="b49ab-107">Each configured format can be published as part of an ER solution.</span></span> <span data-ttu-id="b49ab-108">Каждое решение ER может быть экспортировано из одного экземпляра Finance and Operations и импортировано в другой экземпляр.</span><span class="sxs-lookup"><span data-stu-id="b49ab-108">Each ER solution can be exported from one instance of Finance and Operations and imported into another instance.</span></span>

<span data-ttu-id="b49ab-109">Структура ER использует [Настройку управления документами](../../fin-ops/organization-administration/configure-document-management.md), чтобы хранить необходимые шаблоны для текущего экземпляра Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="b49ab-109">The ER framework uses the [Configure document management](../../fin-ops/organization-administration/configure-document-management.md) to keep the required templates for the current Finance and Operations instance.</span></span> <span data-ttu-id="b49ab-110">В зависимости от настроек инфраструктуры ER в качестве основного физического места хранения шаблонов можно выбрать хранилище больших двоичных объектов Microsoft Azure или папку Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b49ab-110">Depending on the settings of the ER framework, Microsoft Azure Blob storage or a Microsoft SharePoint folder can be selected as the physical primary storage location for templates.</span></span> <span data-ttu-id="b49ab-111">(Дополнительные сведения см. в разделе [Настройка платформы для электронной отчетности (ER)](electronic-reporting-er-configure-parameters.md).) Таблица DocuValue содержит отдельную запись для каждого шаблона.</span><span class="sxs-lookup"><span data-stu-id="b49ab-111">(For more information, see [Configure the Electronic reporting (ER) framework](electronic-reporting-er-configure-parameters.md).) The DocuValue table holds an individual record for each template.</span></span> <span data-ttu-id="b49ab-112">В каждой записи в поле **AccessInformation** хранится путь к файлу шаблона, расположенному в настроенном месте хранения.</span><span class="sxs-lookup"><span data-stu-id="b49ab-112">In each record, the **AccessInformation** field stores the path of a template file that is located in the configured storage location.</span></span>

<span data-ttu-id="b49ab-113">При управлении вашими экземплярами Finance and Operations можно выполнить миграцию текущего экземпляра в другое местоположение.</span><span class="sxs-lookup"><span data-stu-id="b49ab-113">When you manage your Finance and Operations instances, you might decide to migrate the current instance to another location.</span></span> <span data-ttu-id="b49ab-114">Например, можно перенести производственный экземпляр в новую среду "песочницы".</span><span class="sxs-lookup"><span data-stu-id="b49ab-114">For example, you might migrate your production instance to a new sandbox environment.</span></span> <span data-ttu-id="b49ab-115">Если платформа ER настроена для хранения шаблонов в хранилище BLOB-объектов, таблица DocuValue в новой среде "песочницы" ссылается на экземпляр хранилища BLOB-объектов в производственной среде.</span><span class="sxs-lookup"><span data-stu-id="b49ab-115">If you configured the ER framework to store templates in Blob storage, the DocuValue table in the new sandbox environment refers to the instance of Blob storage in the production environment.</span></span> <span data-ttu-id="b49ab-116">Однако доступ к этому экземпляру из среды "песочницы" невозможен, поскольку процесс миграции не поддерживает миграцию артефактов в хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-116">However, this instance can't be accessed from the sandbox environment, because the migration process doesn't support the migration of artifacts in Blob storage.</span></span> <span data-ttu-id="b49ab-117">Таким образом, при попытке выполнить формат ER, использующий шаблон для создания деловых документов, происходит исключение, и вы получаете уведомление об отсутствующем шаблоне.</span><span class="sxs-lookup"><span data-stu-id="b49ab-117">Therefore, if you try to run an ER format that uses a template to generate business documents, an exception occurs, and you're notified about the missing template.</span></span> <span data-ttu-id="b49ab-118">Кроме того, вам предлагается воспользоваться средством очистки ER, чтобы удалить и затем повторно импортировать конфигурацию формата ER, содержащую данный шаблон.</span><span class="sxs-lookup"><span data-stu-id="b49ab-118">You're also guided to use the ER cleanup tool to delete and then re-import the ER format configuration that contains the template.</span></span> <span data-ttu-id="b49ab-119">Поскольку может иметься несколько конфигураций формата ER, этот процесс может занять много времени.</span><span class="sxs-lookup"><span data-stu-id="b49ab-119">Because you might have several ER format configurations, this process can be time consuming.</span></span>

<span data-ttu-id="b49ab-120">Функция хранения резервных копий шаблонов ER поможет создать шаблоны так, чтобы они всегда были доступны для создания бизнес-документов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-120">The Backup storage of ER templates feature can help you make your templates so that they are always available to generate business documents.</span></span>

> [!NOTE]
> <span data-ttu-id="b49ab-121">Эта функция может использоваться только в том случае, если для хранения шаблонов ER в качестве физического хранилища выбрано хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-121">This feature can be used only when Blob storage has been selected as the physical storage location for ER templates.</span></span>

## <a name="automated-recovery-and-notification"></a><span data-ttu-id="b49ab-122">Автоматическое восстановление и уведомление</span><span class="sxs-lookup"><span data-stu-id="b49ab-122">Automated recovery and notification</span></span>

<span data-ttu-id="b49ab-123">Для этой функции каждый шаблон новой конфигурации формата ER в текущей среде автоматически сохраняется в местоположении хранения резервных копий шаблонов (таблица базы данных ERDocuDatabaseStorage) при возникновении следующих событий:</span><span class="sxs-lookup"><span data-stu-id="b49ab-123">For this feature, every template of a new ER format configuration in the current environment is automatically saved to the backup storage location for templates (the ERDocuDatabaseStorage database table) when the following events occur:</span></span>

- <span data-ttu-id="b49ab-124">Импортируется новая конфигурация формата ER, содержащая шаблон.</span><span class="sxs-lookup"><span data-stu-id="b49ab-124">You import a new ER format configuration that contains a template.</span></span>
- <span data-ttu-id="b49ab-125">Вы завершаете черновую версию конфигурации формата ER, которая содержит шаблон.</span><span class="sxs-lookup"><span data-stu-id="b49ab-125">You complete the draft version of an ER format configuration that contains a template.</span></span>

<span data-ttu-id="b49ab-126">Резервные копии шаблонов мигрируют в новый экземпляр Finance and Operations как часть базы данных приложения.</span><span class="sxs-lookup"><span data-stu-id="b49ab-126">Backup copies of templates are migrated to a new instance of Finance and Operations as part of the application database.</span></span>

<span data-ttu-id="b49ab-127">Если для создания исходящих документов требуется шаблон формата ER, для обработки платежей поставщикам, включая создание уведомлений об оплате и управления отчетами, например, но необходимый шаблон не найден в основном местоположении хранения, происходят следующие события:</span><span class="sxs-lookup"><span data-stu-id="b49ab-127">If a template of an ER format is required for generation of outbound documents, to process vendor payments including generation of payment advice and control reports, for example, but the required template isn't found in the primary storage location, the following events occur:</span></span>

- <span data-ttu-id="b49ab-128">Если шаблон доступен в местоположении хранения резервных копий, он автоматически берется из местоположения хранения резервных копий, восстанавливается в первичное место хранения и используется для текущего выполнения.</span><span class="sxs-lookup"><span data-stu-id="b49ab-128">If the template is available in the backup storage location, it is automatically taken from the backup storage location, restored to the primary storage location, and used for the current execution.</span></span>
- <span data-ttu-id="b49ab-129">Каждый пользователь, назначенный для роли **Разработчик электронной отчетности** или **Системный администратор**, получает уведомление о проблеме отсутствующего шаблона через центр поддержки.</span><span class="sxs-lookup"><span data-stu-id="b49ab-129">Every user who is assigned to the **Electronic reporting developer** or **System administrator** role is notified about the missing template issue through the Action center.</span></span> <span data-ttu-id="b49ab-130">Отображаемое сообщение зависит от значения параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**:</span><span class="sxs-lookup"><span data-stu-id="b49ab-130">The message that appears depends on the value of the **Automatically run the procedure of restoring the broken templates in batch** parameter:</span></span>

    - <span data-ttu-id="b49ab-131">Если этот параметр имеет значение **Выкл.**, сообщение рекомендует запустить процесс пакетной обработки для автоматического исправления аналогичных проблем для других шаблонов конфигурации формата ER.</span><span class="sxs-lookup"><span data-stu-id="b49ab-131">If this parameter is set to **Off**, the message recommends that you start the batch process to automatically fix similar issues for other ER format configuration templates.</span></span> <span data-ttu-id="b49ab-132">Сообщение содержит ссылку, которую можно использовать для запуска пакетного процесса.</span><span class="sxs-lookup"><span data-stu-id="b49ab-132">The message includes a link that you can use to start the batch process.</span></span>
    - <span data-ttu-id="b49ab-133">Если этот параметр имеет значение **Вкл.**, сообщение уведомляет пользователя о том, что обнаружены проблемы с отсутствующими шаблонами, и что новый пакетный процесс **Восстановить нарушенные шаблоны из внутренней резервной базы данных** автоматически запланирован.</span><span class="sxs-lookup"><span data-stu-id="b49ab-133">If this parameter is set to **On**, the message notifies you that a missing templates issue has been discovered, and that a new batch process, **Restore broken templates from internal database backup**, has been automatically scheduled.</span></span> <span data-ttu-id="b49ab-134">Этот пакетный процесс будет автоматически исправлять аналогичные ошибки для других шаблонов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-134">This batch process will automatically fix similar issues for other templates.</span></span>

<span data-ttu-id="b49ab-135">Чтобы настроить параметр **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b49ab-135">To set up the **Automatically run the procedure of restoring the broken templates in batch** parameter, complete the following steps:</span></span>

1. <span data-ttu-id="b49ab-136">В Finance and Operations откройте **Администрирование организации \> Электронная отчетность \> Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-136">In Finance and Operations, open the **Organization administration \> Electronic reporting \> Configurations page**.</span></span>
2. <span data-ttu-id="b49ab-137">На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-137">On the **Configurations** page, on the Action Pane, on the **Configurations** tab, in the **Advanced settings** group, select **User parameters**.</span></span>
3. <span data-ttu-id="b49ab-138">В диалоговом окне **Параметры пользователя** установите необходимое значение для параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-138">In the **User parameters** dialog box, set the required value for the **Automatically run the procedure of restoring the broken templates in batch** parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="b49ab-139">Этот параметр определяется отдельно для каждого пользователь приложения и выполнившей вход компанию.</span><span class="sxs-lookup"><span data-stu-id="b49ab-139">This parameter is defined as application user and logged company specific.</span></span>

![Страница конфигураций электронной отчетности](./media/GER-BackupTemplates-1.png)

<span data-ttu-id="b49ab-141">На следующем рисунке показан пример сообщения, отображаемого в том случае, когда для параметра **Автоматически запускать пакетную процедуру восстановления отсутствующих шаблонов** задано значение **Вкл.**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-141">The following illustration shows an example of the message that appears when the **Automatically run the procedure of restoring the broken templates in batch** parameter is set to **On**.</span></span>

![Страница журнала платежей поставщика](./media/GER-BackupTemplates-2.png)

<span data-ttu-id="b49ab-143">На следующем рисунке показан пакетный процесс **Восстановить нарушенные шаблоны из внутренней резервной базы данных** на странице **Пакетное задание**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-143">The following illustration shows the **Restore broken templates from internal database backup** batch process on the **Batch job** page.</span></span>

![Страница пакетного задания](./media/GER-BackupTemplates-3.png)

<span data-ttu-id="b49ab-145">Журнал выполнения завершенного процесса пакетной обработки **Восстановить нарушенные шаблоны из внутренней резервной базы данных** содержит сведения о шаблонах, восстановленных из местоположения хранения резервных копий в первичное место хранения.</span><span class="sxs-lookup"><span data-stu-id="b49ab-145">The execution log of the completed **Restore broken templates from internal database backup** batch process includes information about the templates that have been restored from the backup storage location to the primary storage location.</span></span>

![Страница истории пакетных заданий](./media/GER-BackupTemplates-4.png)

<span data-ttu-id="b49ab-147">По умолчанию процесс автоматического создания резервных копий шаблонов, которые находятся в конфигурациях формата ER, включен.</span><span class="sxs-lookup"><span data-stu-id="b49ab-147">By default, the process of automatically creating backup copies of templates that reside in ER format configurations is turned on.</span></span> <span data-ttu-id="b49ab-148">Чтобы прекратить создание резервных копий шаблонов, задайте для параметра **Остановить создание резервных копий шаблона** значение **Да** на вкладке **Вложения** страницы **Параметры электронной отчетности**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-148">To stop making backup copies of templates, set the **Stop making backup copies of template** option to **Yes** on the **Attachments** tab of the **Electronic reporting parameters** page.</span></span> <span data-ttu-id="b49ab-149">Вы можете открыть эту страницу из рабочей области **Электронная отчетность**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-149">You can open this page from the **Electronic reporting** workspace.</span></span>

<span data-ttu-id="b49ab-150">Если для параметра **Остановить создание резервных копий шаблона** установлено значение **Да** и не требуется сохранять резервные копии ранее созданных шаблонов, выберите **Очистить резервное хранилище** на странице **Параметры электронной отчетности**.</span><span class="sxs-lookup"><span data-stu-id="b49ab-150">If you set the **Stop making backup copies of templates** option to **Yes** and don't want to keep the backup copies that were previously made of templates, select **Clean up backup storage** on the **Electronic reporting parameters** page.</span></span>

<span data-ttu-id="b49ab-151">Если среда была обновлена до Finance and Operations версии 10.0.5 (октябрь 2019 г.) и требуется выполнить миграцию в новую среду, включающую конфигурации формата ER, которые могут быть выполнены, выберите **Заполнить резервное хранилище** на странице **Параметры электронной отчетности** перед выполнением миграции.</span><span class="sxs-lookup"><span data-stu-id="b49ab-151">If you upgraded your environment to Finance and Operations version 10.0.5 (October 2019) and want to migrate to a new environment that includes ER format configurations that can be run, select **Fill in backup storage** on the **Electronic reporting parameters** page before the migration occurs.</span></span> <span data-ttu-id="b49ab-152">После нажатия этой кнопки запускается процесс создания резервных копий всех доступных шаблонов, чтобы их можно было сохранить в местоположении хранения резервных копий ER для шаблонов.</span><span class="sxs-lookup"><span data-stu-id="b49ab-152">This button starts the process of making backup copies of all available templates, so that they can be stored in the ER backup storage location for templates.</span></span>

![Страница параметров электронной отчетности](./media/GER-BackupTemplates-5.png)

## <a name="manual-recovery"></a><span data-ttu-id="b49ab-154">Ручное восстановление</span><span class="sxs-lookup"><span data-stu-id="b49ab-154">Manual recovery</span></span>

<span data-ttu-id="b49ab-155">Выберите **Администрирование организации** \> **Электронная отчетность** \> **Восстановить нарушенный шаблоны**, чтобы вручную запустить процесс восстановления шаблонов ER из резервного хранилища в основное расположение хранилища.</span><span class="sxs-lookup"><span data-stu-id="b49ab-155">Go to **Organization administration** \> **Electronic reporting** \> **Restore broken templates** to manually initiate the process of restoring ER templates from the backup storage location to the primary storage location.</span></span> <span data-ttu-id="b49ab-156">Прежде чем начать этот процесс, на странице **Восстановление нарушенных шаблонов** можно указать, будет ли он выполняться в интерактивном режиме, или для него можно запланировать пакетную обработку.</span><span class="sxs-lookup"><span data-stu-id="b49ab-156">Before you start this process, on the **Restore broken templates** page you can specify whether it will be performed interactively, or the batch process will be scheduled for this.</span></span>

## <a name="supported-deployments"></a><span data-ttu-id="b49ab-157">Поддерживаемые развертывания</span><span class="sxs-lookup"><span data-stu-id="b49ab-157">Supported deployments</span></span>

<span data-ttu-id="b49ab-158">В Finance and Operations версии 10.0.5 функция хранения резервных копий шаблонов ER доступна только при развертывании в облаке.</span><span class="sxs-lookup"><span data-stu-id="b49ab-158">In Finance and Operations version 10.0.5, the Backup storage of ER templates feature is available only in cloud deployments.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="b49ab-159">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="b49ab-159">Additional resources</span></span>

[<span data-ttu-id="b49ab-160">Обзор электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="b49ab-160">Electronic reporting (ER) overview</span></span>](general-electronic-reporting.md)

[<span data-ttu-id="b49ab-161">Настройка платформы для электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="b49ab-161">Configure the Electronic reporting (ER) framework</span></span>](electronic-reporting-er-configure-parameters.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]