---
title: Места назначения электронной отчетности (ER)
description: В этой теме приводятся сведения об управлении местами назначения электронной отчетности, типами поддерживаемых мест назначения и о безопасности.
author: nselin
ms.date: 02/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: DocuType, ERSolutionTable
audience: Application User
ms.reviewer: kfend
ms.custom: 97423
ms.assetid: f3055a27-717a-4c94-a912-f269a1288be6
ms.search.region: Global
ms.author: mrolecki
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: 03dd6f81185e8944019eaadbb77690e4cd9ba9a1
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "5751324"
---
# <a name="electronic-reporting-er-destinations"></a>Места назначения электронной отчетности (ER)

[!include [banner](../includes/banner.md)]

Можно настроить назначение для каждой конфигурации формата электронной отчетности и ее выходного компонента (папка или файл). Пользователи, имеющие соответствующие права доступа, также могут изменять настройки назначения во время выполнения. В этой теме описывается управления местом назначения электронной отчетности, поддерживаемые типы мест назначения и вопросы безопасности.

Конфигурации формата электронной отчетности обычно содержат по крайней мере один выходной компонент: файл. Как правило, конфигурации содержат несколько выходных компонентов файлов различных типов (например, XML, TXT, XLSX, DOCX или PDF), сгруппированных в одну или несколько папок. Управление местом назначения электронной отчетности позволяет предварительно настроить поведение при выполнении каждого компонента. По умолчанию при запуске конфигурации отображается диалоговое окно, которое позволяет вам сохранить или открыть файл. То же поведение также используется, если вы импортируете конфигурацию электронной отчетности и не настраиваете какое-либо конкретное место назначения для нее. После создания места назначения для основного выходного компонента это место назначения переопределяет поведение по умолчанию, и папка или файл отправляется согласно настройкам места назначения.

## <a name="availability-and-general-prerequisites"></a>Доступность и общие предварительные условия

Функциональные возможности мест назначений электронной отчетности недоступны в выпуске Microsoft Dynamics AX 7.0 (февраль 2016 г.). Поэтому необходимо установить версию Microsoft Dynamics 365 for Operations 1611 (ноябрь 2016 г.) или более позднюю версию для использования следующих типов назначения:

- [эл. почта](er-destination-type-email.md)
- [Архивировать](er-destination-type-archive.md)
- [Хранилище файлов](er-destination-type-file.md)
- [Экран](er-destination-type-screen.md)
- [Power BI](er-destination-type-powerbi.md)

Можно также установить один из следующих компонентов. Однако имейте в виду, что эти альтернативные варианты обеспечивают более ограниченные возможности мест назначения электронной отчетности.

- Приложение Microsoft Dynamics AX версии 7.0.1 (май 2016 г.)
- [Исправление приложения для управления назначением электронной отчетности](https://fix.lcs.dynamics.com/issue/results/?q=3160213)

Имеется также тип назначения [Печать](er-destination-type-print.md). Чтобы использовать ее, необходимо установить версию Microsoft Dynamics 365 Finance 10.0.9 (апрель 2020 г.).

## <a name="overview"></a>Обзор

Места назначения можно настроить только для конфигураций электронной отчетности, которые были [импортированы](general-electronic-reporting.md#importing-an-er-component-from-lcs-to-use-it-internally) в текущий экземпляр Finance, и для форматов, доступных на странице **Конфигурации электронной отчетности**. Функциональные возможности управления местом назначения электронной отчетности доступны в разделе **Администрирование организации** \> **Электронная отчетность** \> **Место назначения электронной отчетности**.

### <a name="default-behavior"></a>Поведение по умолчанию

Поведение по умолчанию для конфигурации формата ER зависит от типа выполнения, который указывается при запуске формата ER.

В диалоговом окне **Отчет Интрастат**, на экспресс-вкладке **Выполнять в фоновом режиме**, если для параметра **Пакетная обработка** выбрано значение **Нет**, формат ER сразу выполняется в интерактивном режиме. После успешного выполнения сформированный исходящий документ становится доступным для загрузки.

Если для параметра **Пакетная обработка** установлено значение **Да**, то формат ER выполняется в [пакетном](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/sysadmin/batch-processing-overview) режиме. Создается соответствующее пакетное задание на основе параметров, указанных на вкладке **Выполнять в фоновом режиме** диалогового окна **Параметры электронной отчетности**.

> [!NOTE]
> Описание задания информирует пользователя о выполнении сопоставления форматов электронной отчетности. Оно также содержит имя выполняемого компонента электронной отчетности.

[![Выполнение формата ER](./media/ER_Destinations-RunInBatchMode.png)](./media/ER_Destinations-RunInBatchMode.png)

Сведения об этом задании можно найти в нескольких местах:

- Выберите **Общий** \> **Запросы** \> **Пакетные задания** \> **Мои пакетные задания**, чтобы проверить статус запланированного задания.
- Выберите **Администрирование организации** \> **Электронная отчетность** \> **Задания электронной отчетности**, чтобы проверить статус запланированного задания и результаты выполнения завершенного задания. После успешного завершения задания выберите **Показать файлы** на странице **Задания электронной отчетности**, чтобы получить созданный исходящий документ.

    > [!NOTE]
    > Этот документ хранится в виде вложения в текущей записи задания и управляется структурой [управления документами](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management). [Тип документа](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types), который используется для хранения артефактов ER этого типа, настраивается в [параметрах ER](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents).

- На странице **Задания электронной отчетности** выберите **Показать файлы**, чтобы просмотреть список всех ошибок и предупреждений, созданных во время выполнения задания.

    [![Просмотр списка заданий ER](./media/ER_Destinations-ReviewERJobs.png)](./media/ER_Destinations-ReviewERJobs.png)

### <a name="user-configured-behavior"></a>Настраиваемое пользователем поведение

На странице **Место назначения электронной отчетности** можно переопределить поведение по умолчанию для конфигурации. Импортированные конфигурации не отображаются на этой странице, если не выбрать **Создать**, а затем в поле **Ссылка** не выбрать конфигурацию, для которой создаются параметры места назначения.

[![Выбор конфигурации в поле "Ссылка"](./media/ER_Destinations-SelectFormat.png)](./media/ER_Destinations-SelectFormat.png)

После создания ссылки можно создать место назначения файла для каждого выходного компонента **Папка** или **Файл** в указанном формате электронной отчетности.

[![Создание файла места назначения](./media/ER_Destinations-ConfigureElementDestination.png)](./media/ER_Destinations-ConfigureElementDestination.png)

Затем в диалоговом окне **Параметры места назначения** можно включить и отключить отдельные места назначения для места назначения файла. Кнопка **Параметры** используется для управления всеми местами назначения для выбранного места назначения файла. В диалоговом окне **Параметры места назначения** можно управлять каждым местом назначения отдельно, выбрав для него параметр **Включено**.

В версиях Finance **до версии 10.0.9** можно создать **одно место назначения файла** для каждого выходного компонента одинакового формата, например папка или файл, выбранный в поле **Имя файла**. Однако в **версии 10.0.9 и более поздних** можно создать **несколько мест назначений файлов** для каждого выходного компонента того же формата.

Например, можно использовать эту возможность для настройки мест назначений файлов для компонента "файл", используемого для создания исходящего документа в формате Excel. Для хранения исходного файла Excel в архиве заданий электронной отчетности можно настроить одно место назначения ([Архив](er-destination-type-archive.md)), а другое место назначения ([Эл. почта](er-destination-type-email.md)) можно настроить на одновременное [преобразование](#OutputConversionToPDF) файла Excel в формат PDF и отправку файла PDF по электронной почте.

[![Настройка нескольких мест назначения для одного элемента формата](./media/ER_Destinations-SampleDestinations.png)](./media/ER_Destinations-SampleDestinations.png)

При выполнении формата электронной отчетности всегда выполняются все места назначения, которые были настроены для компонентов формата. Кроме того, в Finance **версии 10.0.17 и более поздней** функция мест назначения для электронной отчетности была улучшена, и теперь имеется возможность настроить разные наборы мест назначения для одного формата электронной отчетности. В этой конфигурации каждый набор отмечается как настроенный для определенного действия пользователя. Интерфейс API электронной отчетности был [расширен](er-apis-app10-0-17.md) таким образом, чтобы можно было указать действие, выполняемое пользователем путем запуска формата электронной отчетности. Предоставленный код действия передается местам назначения электронной отчетности. В зависимости от предоставленного кода действия можно выполнить разные места назначения для формата электронной отчетности. Дополнительные сведения см. в разделе [Настройка мест назначений, зависящих от действия, для электронной отчетности](er-action-dependent-destinations.md).

## <a name="destination-types"></a>Типы назначений

В настоящее время поддерживаются следующие назначения для форматов электронной отчетности. Можно включить или отключить все типы одновременно. Таким образом можно либо не предпринимать никаких действий, либо отправить компонент во все настроенные места назначения.

- [эл. почта](er-destination-type-email.md)
- [Архивировать](er-destination-type-archive.md)
- [Хранилище файлов](er-destination-type-file.md)
- [Экран](er-destination-type-screen.md)
- [Power BI](er-destination-type-powerbi.md)
- [Печать](er-destination-type-print.md)

## <a name="applicability"></a>Применимость

Места назначения можно настроить только для конфигураций электронной отчетности, которые были импортированы, и для форматов, доступных на странице **Конфигурации электронной отчетности**.

> [!NOTE]
> Настроенные места назначения относятся к конкретной компании. Если планируется использовать формат электронной отчетности в разных компаниях текущего экземпляра Finance, необходимо настроить для каждой из этих компаний места назначения для этого формата электронной отчетности.

При настройке назначений файлов для выбранного формата они настраиваются для всего формата.

[![Ссылка на конфигурацию](./media/ER_Destinations-ConfigurationLink.png)](./media/ER_Destinations-ConfigurationLink.png)

В то же время может быть несколько [версий](general-electronic-reporting.md#component-versioning) формата, которые были импортированы в текущий экземпляр Finance. Их можно просмотреть, выбрав ссылку **Конфигурация**, которая предлагается при выборе поля **Ссылка**.

[![Версии конфигурации](./media/ER_Destinations-ConfigurationVersions.png)](./media/ER_Destinations-ConfigurationVersions.png)

По умолчанию настроенные места назначения применяются только в том случае, если выполняется версия формата электронной отчетности, имеющая статус **Завершено** или **Общий**. Однако иногда необходимо использовать настроенные места назначения при выполнении черновой версии формата электронной отчетности. Например, вы изменяете черновую версию формата и хотите использовать настроенные места назначения для проверки способа доставки созданных результатов. Выполните следующие действия, чтобы применить назначения для формата электронной отчетности при выполнении черновой версии.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Установите для параметра **Использовать места назначения для статуса черновика** значение **Да**.

[![Использовать места назначения для статуса черновика](./media/ER_Destinations-UserSetting1.png)](./media/ER_Destinations-UserSetting1.png)

Чтобы использовать черновую версию формата электронной отчетности, необходимо соответствующим образом пометить формат электронной отчетности.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Для параметра **Параметр выполнения** выберите значение **Да**.

[![Параметр выполнения](./media/ER_Destinations-UserSetting2.png)](./media/ER_Destinations-UserSetting2.png)

После завершения настройки появится параметр **Выполнить черновик** для форматов электронной отчетности, которые изменяются. Установите для этого параметра значение **Да**, чтобы начать использовать черновую версию формата при выполнении формата.

[![Параметр выполнения черновика](./media/ER_Destinations-FormatSetting.png)](./media/ER_Destinations-FormatSetting.png)

## <a name="destination-failure-handling"></a><a name="DestinationFailure"></a>Обработка сбоя места назначения

Обычно формат электронной отчетности выполняется в области конкретного бизнес-процесса. Однако доставка исходящего документа, создаваемого во время выполнения формата электронной отчетности, должна иногда рассматриваться как часть этого бизнес-процесса. В этом случае, если доставка созданного исходящего документа в настроенное место назначения завершается неудачно, выполнение бизнес-процесса должно быть отменено. Для настройки соответствующего пункта назначения электронной отчетности выберите параметр **Остановить обработку при сбое**.

Например, можно настроить обработку платежа поставщика таким образом, чтобы был выполнен формат электронной отчетности **Перенос кредита ISO20022**, чтобы создать файл платежа и дополнительные документы (например, сопроводительное письмо и контрольный отчет). Если платеж считается обработанным успешно, только если сопроводительное письмо успешно доставлено по электронной почте, необходимо установить флажок **Остановить обработку при сбое** для компонента **CoveringLetter** в соответствующем месте назначении файла, как показано на следующем рисунке. В этом случае статус платежа, выбранного для обработки, изменится с **Нет** на **Отправлено**, только когда созданное сопроводительное письмо успешно принято на доставку поставщиком электронной почты, настроенным в экземпляре Finance.

[![Настройка обработки процесса для сбоя места назначения файлов](./media/ER_Destinations-StopProcessingAtDestinationFailure.png)](./media/ER_Destinations-StopProcessingAtDestinationFailure.png)

Если убрать флажок **Остановить обработку при сбое** для компонента **CoveringLetter** в месте назначении файла, платеж будет считаться успешно обработанным, даже если сопроводительное письмо не доставлено успешно по электронной почте. Статус платежа будет изменен с **Нет** на **Отправлено**, даже если сопроводительное письмо не может быть отправлено, так как, например, адрес электронной почты получателя или отправителя отсутствует или указан неправильно.

## <a name="output-conversion-to-pdf"></a><a name="OutputConversionToPDF"></a>Выходное преобразование в PDF

Можно использовать параметр преобразования PDF для преобразования выходных данных в формате Microsoft Office (Excel или Word) в формат PDF.

### <a name="make-pdf-conversion-available"></a>Сделать доступным преобразование PDF

Чтобы сделать доступным преобразование PDF в текущем экземпляре Finance, откройте рабочую область **Управление функциями** и включите функцию **Преобразовать исходящие документы электронной отчетности из форматов Microsoft Office в PDF**.

[![Включение преобразования PDF для исходящих документов в управлении функциями](./media/ER_Destinations-EnablePdfConversionFeature.png)](./media/ER_Destinations-EnablePdfConversionFeature.png)

### <a name="applicability"></a>Применимость

Параметр преобразования PDF можно включить только для файлов, которые используются для создания выходных данных в формате Office (Excel или Word) (**Файл Excel**). Если этот параметр включен, выходные документы, созданные в формате Office, автоматически преобразуются в формат PDF. В версиях Финансы **до 10.0.18 версии** этот параметр можно включить только для компонентов типа **Excel\\Файл**, используемых для создания выходных данных в формате [Excel](er-fillable-excel.md) или [Word](er-design-configuration-word.md). Однако в **версии 10.0.18 или более поздней** можно также включить этот параметр для компонентов типа **Общее\\Файл**.

> [!NOTE]
> Обратите внимание на предупреждающее сообщение, которое выводится при включении функции преобразования PDF для компонента электронной отчетности типа **Общее\\Файл**. Это сообщение информирует вас о том, что невозможно гарантировать, что выбранный компонент файла будет предоставлять содержимое в формате PDF или содержимое, преобразуемый в формат PDF, в среда выполнения. Поэтому следует включить параметр только в том случае, если выбранный файл был настроен таким образом, чтобы он предоставлял доступ к содержимому в формате PDF или содержимому в формате PDF в среде выполнения.
> 
> Если вы включите параметр преобразования PDF для компонента типа **Excel\\Файл**, если этот компонент предоставляет содержимое в формате, отличном от PDF, и если доступное содержимое невозможно преобразовать в формат PDF, в среде выполнения произойдет исключение. Полученное сообщение информирует пользователя о том, что созданное содержимое невозможно преобразовать в формат PDF.

### <a name="limitations"></a>Ограничения

Параметр преобразования PDF доступен только для развертываний в облаке.

Полученные документ PDF не может быть длиннее 300 страниц.

В Finance **версии 10.0.9** поддерживается только альбомная ориентация страницы в PDF-документе, который создается из выходных данных Excel. С Finance **версии 10.0.10 (май 2020 года) и позднее** можно [указать ориентацию страницы](#SelectPdfPageOrientation) в PDF-документе, который создается на основе выходных данных Excel, при настройке места назначения электронной отчетности.

Только общие системные шрифты операционной системы Window используются для преобразования выходных данных, которые не содержат встроенных шрифтов.

### <a name="use-the-pdf-conversion-option"></a>Использование параметра преобразования PDF

Чтобы включить преобразование PDF для места назначения файлов, установите флажок **Преобразовать в PDF**.

[![Включение преобразования PDF для места назначения файлов](./media/ER_Destinations-TurnOnPDFConversion.png)](./media/ER_Destinations-TurnOnPDFConversion.png)

### <a name=""></a><a name="SelectPdfPageOrientation">Выбор ориентации страницы для преобразования в PDF</a>

Если вы создаете конфигурацию электронной отчетности в формате Excel и хотите преобразовать ее в формат PDF, можно указать ориентацию страницы документа PDF. Если установить флажок **Преобразовать в PDF**, чтобы включить преобразование в PDF для файла назначения, который создает выходной файл в формате Excel, поле **Ориентация страницы** становится доступным на экспресс-вкладке **Параметры преобразования в PDF**. В поле **Ориентация страницы** выберите предпочтительную ориентацию.

[![Выбор ориентации страницы для преобразования в PDF](./media/ER_Destinations-SelectPDFConversionPageOrientation.png)](./media/ER_Destinations-SelectPDFConversionPageOrientation.png)

> [!NOTE]
> Чтобы можно было выбрать ориентацию страницы PDF, необходимо установить Finance версии 10.0.10 или более позднюю версию.
>
> Выбранная ориентация страницы применяется ко всем конфигурациям электронной отчетности, созданным в формате Excel, а затем преобразованным в формат PDF.
>
> Если конфигурация электронной отчетности в формате Word преобразована из формата PDF, ориентация страницы PDF-документа берется из документа Word.

## <a name="security-considerations"></a>Вопросы безопасности

Для мест назначения электронной отчетности используется два типа привилегий. Один тип управляет возможностью ведения всех мест назначения, настроенных для юридического лица (то есть, управляет доступом к странице **Места назначения электронной отчетности**). Второй тип управляет доступной для пользователей приложения возможностью переопределить параметры мест назначения, настроенные разработчиком или консультантом по функциональным возможностям электронной отчетности, во время выполнения.

| Роль (имя AOT)                     | Имя роли                                  | Полномочие (имя в AOT)                     | Название полномочия                                                        |
|-------------------------------------|--------------------------------------------|-------------------------------------|------------------------------------------------------------------|
| ERDeveloper                         | Разработчик электронной отчетности             | ERFormatDestinationConfigure        | Настройка места назначения форматов электронной отчетности                |
| ERFunctionalConsultant              | Консультант по функциональным возможностям электронной отчетности | ERFormatDestinationConfigure        | Настройка места назначения форматов электронной отчетности                |
| PaymAccountsPayablePaymentsClerk    | Сотрудник, обрабатывающий платежи по расчетам с поставщиками            | ERFormatDestinationRuntimeConfigure | Настройка места назначения форматов электронной отчетности во время выполнения |
| PaymAccountsReceivablePaymentsClerk | Сотрудник, обрабатывающий платежи по расчетам с клиентами         | ERFormatDestinationRuntimeConfigure | Настройка места назначения форматов электронной отчетности во время выполнения |

> [!NOTE]
> В указанных выше полномочиях используется две привилегии. Эти привилегии имеют те же имена, что и соответствующие полномочия: **ERFormatDestinationConfigure** и **ERFormatDestinationRuntimeConfigure**.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="i-have-imported-electronic-configurations-and-i-see-them-on-the-electronic-reporting-configurations-page-but-why-dont-i-see-them-on-the-electronic-reporting-destinations-page"></a>Импортированные конфигурации электронной отчетности отображаются на странице "Конфигурации электронной отчетности". Но почему они не отображаются на странице "Места назначения электронной отчетности"?

Убедитесь, что вы выбрали **Создать** и затем выбрали конфигурацию в поле **Ссылка**. На странице **Места назначения электронной отчетности** показаны только те конфигурации, для которых настроены места назначения.

### <a name="is-there-any-way-to-define-which-microsoft-azure-storage-account-and-azure-blob-storage-are-used"></a>Можно ли определить используемую учетную запись хранилища Microsoft Azure и хранилище BLOB-объектов Azure?

№ п/п Используется хранилище BLOB-объектов Microsoft Azure по умолчанию, которое определяется и используется для системы управления документами.

### <a name="what-is-the-purpose-of-the-file-destination-in-the-destination-settings-what-does-that-setting-do"></a>Для чего нужно место назначения "Файл" в параметрах места назначения? Для чего нужен этот параметр?

Место назначения **Файл** используется для управления диалоговым окном веб-браузера при выполнении формата электронной отчетности в интерактивном режиме. Если это место назначения включено или если место назначения не определено для конфигурации, в веб-браузере отобразится диалоговое окно открытия или сохранения после создания выходного файла.

### <a name="can-you-give-an-example-of-the-formula-that-refers-to-a-vendor-account-that-i-can-send-email-to"></a>Можете ли вы привести пример формулы, которая ссылается на счет поставщика, на который можно отправить сообщение электронной почты?

Формула зависит от конфигурации электронной отчетности. Например, при использовании конфигурации перемещения кредита ISO 20022 можно использовать **'$PaymentsForCoveringLetter'.Creditor.Identification.SourceID** или **model.Payments.Creditor.Identification.SourceID** для получения связанного счета поставщика.

### <a name="one-of-my-format-configurations-contains-multiple-files-that-are-grouped-into-one-folder-for-example-folder1-contains-file1-file2-and-file3-how-do-i-set-up-destinations-so-that-folder1zip-isnt-created-at-all-file1-is-sent-by-email-file2-is-sent-to-sharepoint-and-i-can-open-file3-immediately-after-the-configuration-is-run"></a>Одна из моих конфигураций формата содержит несколько файлов, сгруппированных в одну папку (например, папка Folder1 содержит файлы File1, File2 и File3). Как настроить места назначения, чтобы архив Folder1.zip не создавался вообще, File1 отправлялся по электронной почте, File2 отправлялся в SharePoint и File3 можно было открыть сразу же после выполнения конфигурации?

Ваш формат должен быть сначала доступен в конфигурациях электронной отчетности. Если это предварительное условие соблюдено, откройте страницу **Место назначения электронной отчетности** и создайте новую ссылку на конфигурацию. Затем необходимо наличие четырех мест назначения файлов, по одному для каждого выходного компонента. Создайте первое место назначения файла, присвойте ему имя, например **Папка** и выберите имя файла, которое представляет папку в конфигурации. Затем выберите **Параметры** и убедитесь, что все места назначения отключены. Для этого места назначения файла папка создаваться не будет. По умолчанию из-за иерархических зависимостей между файлами и родительскими папками файлы будут вести себя таким же образом. Другими словами, они не будут никуда отправляться. Чтобы переопределить это поведение по умолчанию, необходимо создать три дополнительных места назначения файлов, по одному для каждого файла. В параметрах места назначения для каждого файла необходимо включить место назначения, в которое нужно отправить файл.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Обзор электронной отчетности (ER)](general-electronic-reporting.md)

[Настройка зависящих от действий мест назначения электронной отчетности](er-action-dependent-destinations.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
