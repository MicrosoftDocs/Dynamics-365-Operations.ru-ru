---
title: Тип места назначения ER электронной почты
description: В этой теме объясняется, как настроить местоположение электронной почты для каждого компонента ПАПКА или ФАЙЛ в формате электронной отчетности (ER).
author: NickSelin
manager: AnnBe
ms.date: 12/03/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: DocuType, ERSolutionTable, ERFormatDestinationTable
audience: Application User
ms.reviewer: kfend
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: e2e0da1c724269e0956be2f402b34ff376ed1990
ms.sourcegitcommit: 5192cfaedfd861faea63d8954d7bcc500608a225
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "5094112"
---
# <a name="email-er-destination-type"></a>Тип места назначения ER электронной почты

[!include [banner](../includes/banner.md)]

При выполнении формата электронной отчетности (ER) может быть создан один или несколько исходящих документов. Компоненты формата **Папка** или **Файл** используются в форматах электронной отчетности, чтобы указать структуру исходящих документов. Можно настроить пункт назначения электронной почты для этих типов компонентов для отправки исходящих документов в виде вложений в сообщения электронной почты.

Можно настроить пункт назначения электронной почты для каждого компонента **Папка** или **Файл** в формате электронной отчетности. В этом случае **каждый исходящий документ будет отправляться по электронной почте по отдельности**. На основании этой настройки места назначения созданный документ передается в виде вложения электронной почты. 

> [!NOTE]
> Если никакой документ не создается, из-за того, что **Включенное** выражение для соответствующего компонента **Файл** было настроено на возврат логического значения **False**, сообщение электронной почты не отправляется, даже если для компонента настроен и включен пункт назначения электронной почты.

Имеется также возможность [сгруппировать](#grouping) несколько компонентов **Папка** или **Файл**, а затем настроить пункт назначения электронной почты для всех компонентов в группе. В этом случае все исходящие документы, созданные компонентами, входящими в группу, **отправляются как несколько вложений одного сообщения электронной почты**. На основании этой настройки места назначения каждый созданный документ передается в виде вложения в одно сообщение электронной почты.

> [!NOTE]
> Если по крайней мере один документ создан компонентом **Файл** в составе группы компонентов, отправляется сообщение электронной почты. Если никакой документ не создается сгруппированными компонентами, из-за того, что **Включенное** выражение для каждого компонента **Файл** было настроено на возврат логического значения **False**, сообщение электронной почты не отправляется, даже если для этой группы компонентов настроен и включен пункт назначения электронной почты.
>
> **Адрес электронной почты** — это единственный пункт назначения, который может быть настроен для группы компонентов. Чтобы доставить документ, отправляемый по электронной почте, в соответствии с настройкой адреса электронной почты для группы, добавьте еще одну запись места назначения, выберите нужный компонент, затем настройте другое место назначения для данной записи.

Для одной конфигурации формата электронной отчетности можно настроить несколько групп компонентов. Таким образом можно настроить пункт назначение электронной почты для каждой группы компонентов и адрес электронной почты для каждого компонента.

## <a name="configure-an-email-destination"></a>Настройка места назначения электронной почты

Чтобы отправить выходной файл или несколько выходных файлов по электронной почте, на странице **Место назначения электронной отчетности** на экспресс-вкладке **Место назначения файла** выберите компонент или группу компонентов в сетке, а затем выберите **Параметры**. В открывшемся диалоговом окне **Параметры места назначения** на вкладке **Электронная почта** установите для параметра **Включено** значение **Да**. Затем можно указать получателей сообщения электронной почты, и также изменить тему и текст сообщения электронной почты. Можно настроить постоянный текст для темы и текста сообщения электронной почты, или можно использовать [формулы](er-formula-language.md) электронной отчетности для динамического создания текстов сообщений электронной почты.

Адреса электронной почты для электронной отчетности можно настроить двумя способами. Настройка может быть выполнена так же, как она выполняется средством управления печатью, или можно разрешить адрес электронной почты, используя прямую ссылку на конфигурацию электронной отчетности через формулу.

[![Задание для параметра "Включено" значения "Да" для пункта назначения электронной почты](./media/ER_Destinations-EnableSingleDestination.png)](./media/ER_Destinations-EnableSingleDestination.png)

## <a name="email-address-types"></a>Типы адреса электронной почты

Если выбрать **Изменить** рядом с полем **Кому** или **Копия** в диалоговом окне **Параметры места назначения**, появляется диалоговое окно **Адрес электронной почты**. Выберите **Добавить**, затем выберите тип адреса электронной почты для использования. В настоящее время поддерживаются два типа: **Эл. почта управления печатью** и **Конфигурационное сообщение эл. почты**.

[![Выбор типа адреса электронной почты](./media/ER_Destinations-EmailSelectAddressType.png)](./media/ER_Destinations-EmailSelectAddressType.png)

### <a name="print-management-email"></a>Эл. почта управления печатью

Если в качестве типа адреса электронной почты выбрано **Эл. почта управления печатью**, можно ввести фиксированные адреса электронной почты в диалоговом окне **Кому**, задав следующие поля:

- В поле **Источник электронной почты** выберите **Нет**.
- В поле **Дополнительные адреса электронной почты, разделенные ";"** введите фиксированные адреса электронной почты.

Кроме того, можно получить адреса электронной почты из контактной информации субъекта, для которого создается исходящий документ. Чтобы использовать нефиксированные адреса электронной почты, в поле **Источник электронной почты** выберите [роль](../../fin-ops/organization-administration/overview-global-address-book.md#party-roles) субъекта для места назначения файла. Поддерживаются следующие роли:

- Заказчик
- Поставщик
- Персп. клиент
- Контактное лицо
- Конкуренты
- Рабочий
- Кандидат
- Потенциальный поставщик
- Неодобренный поставщик

Например, чтобы настроить место назначения электронной почты для формата электронной отчетности, который используется для обработки платежей поставщикам, выберите роль **Поставщик**.

После выбора нужной роли выберите кнопку **Привязать** (символ цепочки) рядом с полем **Исходная учетная запись эл. почты**, чтобы открыть страницу [Конструктор формул](general-electronic-reporting-formula-designer.md). Затем можно использовать эту страницу для настройки формулы, которая возвратит во время выполнения номер счета субъекта, назначенного для настроенной роли, из обработанного документа в место назначения электронной почты.

> [!NOTE]
> Формулы зависят от конфигурации электронной отчетности.

На странице **Конструктор формул** в поле **Формула** введите ссылку на поддерживаемую роль для конкретного документа. Вместо того чтобы вводить ссылку, в области **Источник данных** найдите и выберите узел источника данных, который представляет счет настроенной роли, а затем выберите **Добавить источник данных**, чтобы обновить формулу. Например, при настройке адреса электронной почты для конфигурации **Перенос кредита ISO 20022**, используемой для обработки платежей поставщикам, используется узел `'$PaymentsForCoveringLetter'.Creditor.Identification.SourceID`, представляющий счет поставщика.

![Настройка учетной записи источника электронной почты](./media/er_destinations-emaildefineaddresssource.gif)

Если номера счетов настроенной роли уникальны для всего экземпляра Microsoft Dynamics 365 Finance, поле **Компания источника электронной почты** в диалоговом окне **Электронная почта** может остаться пустым.

Также может возникнуть ситуация, когда разные стороны в [глобальной адресной книге](../../fin-ops/organization-administration/overview-global-address-book.md) были зарегистрированы в разных компаниях ([юридических лицах](../../fin-ops/organization-administration/organizations-organizational-hierarchies.md#legal-entities)) таким образом, что все они используют один и тот же номер счета для заполнения настроенной роли. В этом случае номера счетов для настроенной роли не являются уникальными для всего экземпляра Finance. Таким образом, чтобы явно выбрать субъект, нельзя указать только номер счета. Также необходимо указать компанию, для которой субъект был зарегистрирован в области для заполнения настроенной роли. Выберите кнопку **Привязать** (символ цепочки) рядом с полем **Компания источника электронной почты** в диалоговом окне **Кому**, чтобы открыть страницу [Конструктор формул](general-electronic-reporting-formula-designer.md). Затем можно использовать эту страницу для настройки формулы, возвращающей во время выполнения код компании, в области которой должен быть найден нужный источник.

> [!TIP]
> Если необходимо использовать код компании для запуска формата электронной отчетности, но формат электронной отчетности не предоставляет источника данных, из которого может быть получен код компании, настройте формулу `GetCurrentCompany()`, используя встроенную функцию электронной отчетности [GETCURRENTCOMPANY](er-functions-other-getcurrentcompany.md).

> [!NOTE]
> Формулы зависят от конфигурации электронной отчетности.

Чтобы указать тип адресов электронной почты, которые должны использоваться во время выполнения, в диалоговом окне **Кому** выберите **Правка** рядом с полем **Кому**, чтобы открыть раскрывающееся диалоговое окно **Назначение адреса электронной почты**. Затем задайте следующие поля:

- В поле **Назначение** выберите требуемые цели. Будут использоваться только адреса электронной почты выбранных целей из контактов обнаруженного субъекта.
- Установите для параметра **Основной контакт** значение **Да**, чтобы использовать адрес электронной почты, настроенный для обнаруженного субъекта в качестве основного адреса электронной почты.

> [!NOTE]
> Если цели выбраны в поле **Назначение**, и одновременно для параметра **Основной контакт** задано значение **Да**, то во время выполнения будут использоваться все сообщения электронной почты, удовлетворяющие по крайней мере одному настроенному критерию.

### <a name="configuration-email"></a>Конфигурационное сообщение эл. почты

Выберите **Конфигурационное сообщение эл. почты** в качестве типа адреса электронной почты, если используемая конфигурация имеет узел в источниках данных, который возвращает либо один адрес электронной почты, либо несколько адресов электронной почты, разделенных точкой с запятой (;). Можно использовать [источники данных](general-electronic-reporting.md#FormatComponentOutbound) и [функции](er-formula-language.md#functions) в конструкторе формул для получения правильно отформатированного адреса электронной почты или правильно отформатированных адресов электронной почты, разделенных точками с запятой. Например, при использовании конфигурации **Перенос кредита ISO 20022** узел, который представляет основной адрес электронной почты поставщика из сведений о контактах поставщика, по которому должно быть отправлено сопроводительное письмо, будет `'$PaymentsForCoveringLetter'.Creditor.ContactDetails.Email`.

[![Настройка источника адреса электронной почты](./media/ER_Destinations-EmailDefineAddressSource2.png)](./media/ER_Destinations-EmailDefineAddressSource2.png)

## <a name="group-format-components"></a><a id="grouping"></a>Группировка компонентов формата

Чтобы сгруппировать компоненты формата, на странице **Место назначения электронной отчетности** на экспресс-вкладке **Место назначения файла** выберите компоненты в сетке, затем выберите **Группировать**.

**Адрес электронной почты** — это единственный ранее настроенное место назначения, которое по-прежнему доступно для выбранных компонентов. Все остальные ранее настроенные места назначения недоступны, так как они рассматриваются как неподдерживаемые для группы компонентов. Вы получите соответствующее уведомление об этих изменениях.

Ранее добавленная запись считается заголовком созданной группы. Эта запись заголовка содержит настройки места назначения электронной почты для группы. Другие записи являются участниками группы, которые будут использовать настройки места назначения электронной почты для записи заголовка группы.

Чтобы разгруппировать компоненты формата, на экспресс-вкладке **Место назначение файла** выберите запись, принадлежащую группе, а затем выберите **Разгруппировать**.

- Если выбрана запись заголовка, вся группа будет разгруппирована.
- Если выбрана запись участника и она является последней записью участника в группе, вся группа будет разгруппирована.
- При выборе записи участника, которая не является последней записью участника в группе, эта запись будет исключена из текущей группы.

На следующем рисунке показана структура формата электронной отчетности, которая была настроена для создания исходящего файла ZIP, который содержит примечание к письму-напоминанию и соответствующие накладные клиента в формате PDF.

[![Структура формата электронной отчетности, которая создает исходящие документы](./media/ER_Destinations-Email-Grouping1.png)](./media/ER_Destinations-Email-Grouping1.png)

На следующем рисунке показан процесс, описанный в этой теме, для группировки отдельных компонентов и включения места назначения **Электронная почта** для новой группы, чтобы примечание к письму-напоминанию было отправлено вместе с соответствующими накладными клиентов как вложения электронной почты.

[![Группировка отдельных компонентов и включение места назначения электронной почты](./media/ER_Destinations-Email-Grouping2.gif)](./media/ER_Destinations-Email-Grouping2.gif)

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Обзор электронной отчетности (ER)](general-electronic-reporting.md)
- [Места назначения электронной отчетности (ER)](electronic-reporting-destinations.md)
- [Конструктор формул в электронной отчетности (ER)](general-electronic-reporting-formula-designer.md)
