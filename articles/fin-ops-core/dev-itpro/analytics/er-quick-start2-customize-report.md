---
title: Настройка формата электронной отчетности для создания пользовательского электронного документа
description: В этой теме объясняется, как настроить поставляемый корпорацией Майкрософт формат электронной отчетности (ER), чтобы он создавал специальный электронный документ.
author: NickSelin
ms.date: 06/22/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, ERParameters, ERDataModelDesigner, ERModelMappingTable, ERModelMappingDesigner, EROperationDesigner, ERVendorTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom:
- "220314"
- intro-internal
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 14976aab474b6571c2a25907f04fd4d7ae053e74
ms.sourcegitcommit: d5d6b81bd8b08de20cc018c2251436065982489e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2022
ms.locfileid: "8323825"
---
# <a name="adjust-an-er-format-to-generate-a-custom-electronic-document"></a>Настройка формата электронной отчетности для создания пользовательского электронного документа

[!include[banner](../includes/banner.md)]

Процедуры данного раздела объясняют, как пользователь с ролью системного администратора или функционального консультанта по электронной отчетности может выполнять следующие задачи:

- Настройка параметров для [платформы электронной отчетности (ER)](general-electronic-reporting.md).
- Импорт конфигураций ER, которые предоставляются корпорацией Майкрософт и используются для создания файла платежа при обработке [платежа поставщику](../../../finance/cash-bank-management/tasks/vendor-payment-overview.md).
- Создание настраиваемой версии стандартной конфигурации формата ER, предоставляемой корпорацией Microsoft.
- Изменение пользовательской конфигурации формата ER таким образом, чтобы она создавала файлы платежей, соответствующие требованиям конкретного банка.
- Адаптация изменений, внесенных в стандартную конфигурацию формата ER, в пользовательской конфигурации формата ER.

Все следующие процедуры могут выполняться в компании **GBSI**. Написание кода не требуется.

- [Настройка платформы электронной отчетности](#ConfigureFramework)

    - [Настройка параметров ER](#ConfigureParameters)
    - [Активация поставщика конфигураций электронной отчетности](#ActivateProvider)

        - [Просмотр списка поставщиков конфигурации электронной отчетности](#ReviewProvidersList)
        - [Добавление нового поставщика конфигурации электронной отчетности](#ActivateProvider)
        - [Активация поставщика конфигураций электронной отчетности](#ActivateAddedProvider)

- [Импорт стандартных конфигураций формата электронной отчетности](#ImportERSolution1)

    - [Импорт стандартных конфигураций электронной отчетности](#ImportERFormat1)
    - [Проверка импортированных конфигураций электронной отчетности](#ReviewImportedERSolution)

- [Подготовка обработки платежа поставщику](#PrepareVendorPayment)

    - [Добавление банковской информации для счета поставщика](#AddBankAccount)
    - [Ввод платежа поставщику](#EnterVendorPayment)

- [Обработка платежа поставщику с помощью стандартного формата электронной отчетности](#ProcessVendorPayment1)

    - [Настройка способа оплаты с помощью электронного платежа](#ConfigureMethodOfPayment1)
    - [Обработка платежа поставщику](#ProcessPayment1)

- [Настройка стандартного формата электронной отчетности](#CustomizeProvidedFormat)

    - [Создание пользовательского формата](#DeriveProvidedFormat)
    - [Изменение пользовательского формата](#ConfigureDerivedFormat)
    - [Пометка пользовательского формата как готового к запуску](#MarkFormatRunnable)

- [Обработка платежа поставщику с помощью пользовательского формата электронной отчетности](#ProcessVendorPayment2)

    - [Настройка способа оплаты с помощью электронного платежа](#ConfigureMethodOfPayment2)
    - [Обработка платежа поставщику](#ProcessPayment2)

- [Импорт новых версий стандартных конфигураций формата электронной отчетности](#ImportERSolution2)

    - [Импорт новых версий стандартных конфигураций электронной отчетности](#ImportERFormat2)
    - [Проверка импортированных конфигураций формата электронной отчетности](#ReviewImportedERFormat)

- [Адаптация изменений в новой версии импортированного формата в пользовательском формате](#AdoptNewBaseVersion)

    - [Завершение текущей черновой версии пользовательского формата](#CompleteDerivedFormat)
    - [Перемещение пользовательского формата на новую базовую версию](#RebaseDerivedFormat)
    - [Обработка платежа поставщику с помощью перемещенного формата электронной отчетности](#ProcessPayment3)

- [Дополнительные ресурсы](#References)

## <a name="configure-the-er-framework"></a><a id="ConfigureFramework"></a>Настройка платформы электронной отчетности

В качестве пользователя в роли функционального консультанта по электронной отчетности вам необходимо настроить минимальный набор параметров ER, прежде чем можно будет начать использовать платформу электронной отчетности для создания пользовательской версии стандартного формата электронной отчетности.

### <a name="configure-er-parameters"></a><a id="ConfigureParameters"></a>Настройка параметров ER

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Параметры электронной отчетности**.
3. На странице **Параметры электронной отчетности** на вкладке **Общие сведения** задайте для параметра **Включить режим конструктора** значение **Да**.
4. На вкладке **Вложения** установите следующие параметры.

    - В поле **Конфигурации** выберите тип **Файл** для компании **USMF**.
    - В полях **Архив заданий**, **Временная**, **Базовый** и **Другие** выберите тип **Файл**.

Дополнительные сведения о настройке параметров электронной отчетности см. в разделе [Настройка платформы электронной отчетности](electronic-reporting-er-configure-parameters.md).

### <a name="activate-an-er-configuration-provider"></a><a id="ActivateProvider"></a>Активация поставщика конфигураций электронной отчетности

Каждая добавленная конфигурация электронной отчетности помечается как принадлежащая поставщику конфигурации электронной отчетности. Для этой цели используется поставщик конфигурации электронной отчетности, который активирован в рабочей области **Электронная отчетность**. Поэтому перед началом добавления или изменения конфигураций электронной отчетности необходимо активировать поставщика конфигурации электронной отчетности в рабочей области **Электронная отчетность**.

> [!NOTE]
> Только владелец конфигурации электронной отчетности может редактировать ее. Поэтому перед редактированием конфигурации электронной отчетности необходимо активировать соответствующего поставщика конфигурации электронной отчетности в рабочей области **Электронная отчетность**.

#### <a name="review-the-list-of-er-configuration-providers"></a><a id="ReviewProvidersList"></a>Просмотр списка поставщиков конфигурации электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Поставщики конфигураций**.
3. На странице **Таблица поставщиков конфигураций** каждая запись поставщика имеет уникальное имя и URL-адрес. Проверьте содержимое данной страницы. Если запись для **Litware, Inc.** (`https://www.litware.com`) уже существует, пропустите следующую процедуру, [Добавление нового поставщика конфигурации электронной отчетности](#ActivateProvider).

#### <a name="add-a-new-er-configuration-provider"></a><a id="ActivateProvider"></a>Добавление нового поставщика конфигурации электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Поставщики конфигураций**.
3. На странице **Поставщики конфигураций** выберите **Создать**.
4. В поле **Имя** введите **Litware, Inc.**
5. В поле **Интернет-адрес** введите `https://www.litware.com`.
6. Нажмите **Сохранить**.

#### <a name="activate-an-er-configuration-provider"></a><a id="ActivateAddedProvider"></a>Активация поставщика конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Litware, Inc.**, затем выберите **Установить активные**.

Дополнительные сведения о поставщиках конфигурации электронной отчетности см. в разделе [Создание поставщиков конфигураций и пометка их как активных](tasks/er-configuration-provider-mark-it-active-2016-11.md).

## <a name="import-the-standard-er-format-configurations"></a><a id="ImportERSolution1"></a>Импорт стандартных конфигураций формата электронной отчетности

### <a name="import-the-standard-er-configurations"></a><a id="ImportERFormat1"></a>Импорт стандартных конфигураций электронной отчетности

Чтобы добавить стандартные конфигурации электронной отчетности в текущий экземпляр Microsoft Dynamics 365 Finance, необходимо импортировать их из [репозитория](general-electronic-reporting.md#Repository) электронной отчетности, который был настроен для этого экземпляра.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Майкрософт**, затем выберите **Репозитории**, чтобы просмотреть список репозиториев для поставщика Майкрософт.
3. На странице **Репозитории конфигураций** выберите репозиторий типа **Глобальный**, затем выберите **Открыть**. Если будет предложено выполнить проверку подлинности для подключения к службе Regulatory Configuration Service, следуйте инструкциям по проверке подлинности.
4. На странице **Репозиторий конфигураций** в дереве конфигураций на левой панели выберите конфигурацию формата **BACS (UK)**.
5. На экспресс-вкладке **Версии** выберите версию **1.1** выбранной конфигурации формата электронной отчетности.
6. Выберите **Импорт** для загрузки выбранной версии из глобального репозитория в текущий экземпляр Finance.

![Страница репозитория конфигурации.](./media/er-quick-start2-import-solution1.png)

> [!TIP]
> При возникновении проблем с доступом к [глобальному репозиторию](er-download-configurations-global-repo.md) можно вместо этого [загрузить конфигурации](download-electronic-reporting-configuration-lcs.md) из служб Microsoft Dynamics Lifecycle Services (LCS).

### <a name="review-the-imported-er-configurations"></a><a id="ReviewImportedERSolution"></a>Проверка импортированных конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**.
4. Обратите внимание, что в дополнение к выбранному формату **BACS (UK)** были импортированы другие необходимые конфигурации электронной отчетности. Убедитесь, что в дереве конфигураций доступны следующие конфигурации электронной отчетности:

    - **Модель платежа** — эта конфигурация содержит компонент модели данных электронной отчетности, который представляет структуру данных бизнес-домена платежа.
    - **Сопоставление модели платежа 1611** — эта конфигурация содержит компонент сопоставления моделей электронной отчетности, описывающий заполнение модели данных данными приложения во время выполнения.
    - **BACS (UK)** — данная конфигурация содержит формат и компоненты сопоставления форматов электронной отчетности. Компонент формата определяет макет отчета. Компонент сопоставления формата содержит источник данных модели и определяет, как заполняется макет отчета при помощи этого источника данных во время выполнения.

![Страница конфигураций с заданными конфигурациями электронной отчетности, доступными в дереве.](./media/er-quick-start2-imported-solution1.png)

## <a name="prepare-a-vendor-payment-for-processing"></a><a id="PrepareVendorPayment"></a>Подготовка обработки платежа поставщику

### <a name="add-bank-information-for-a-vendor-account"></a><a id="AddBankAccount"></a>Добавление банковской информации для счета поставщика

Необходимо добавить банковскую информацию для счета поставщика, на который позднее будете ссылаться в зарегистрированном платеже.

1. Перейдите в раздел **Расчеты с поставщиками** \> **Поставщики** \> **Все поставщики**.
2. На странице **Все поставщики** выберите счет поставщика **GB_SI_000001**, затем в области действий на вкладке **Поставщик** в группе **Настройка** выберите **Банковские счета**.
3. На странице **Банковские счета поставщика** выберите **Создать**, затем введите следующие сведения:

    1. В поле **Банковский счет** введите **GBP OPER**.
    2. В поле **Банковские группы** выберите **BankGBP**.
    3. В поле **Номер банковского счета** введите **202015**.
    4. В поле **Код SWIFT** введите <a id="DefineSWIFTCode"></a>**CHASDEFXXXX**.
    5. В поле **IBAN** введите **GB33BUKB20201555555555**.
    6. В поле **Номер маршрутизации** сохраните значение по умолчанию <a id="DefineRoutingNumber"></a>**123456**.

    ![Страница банковских счетов поставщика.](./media/er-quick-start2-bank-account.png)

4. Нажмите **Сохранить**.
5. Закройте страницу.
6. На странице **Все поставщики** откройте счет поставщика **GB_SI_000001**.
7. На странице сведения о поставщике выберите **Правка**, чтобы сделать страницу редактируемой, если это необходимо.
8. На экспресс-вкладке **Платеж** в поле **Банковский счет** выберите **GBP OPER**.

    ![Страница сведений о поставщике.](./media/er-quick-start2-bank-account-reference.png)

9. Нажмите **Сохранить**.
10. Закройте страницу.

### <a name="enter-a-vendor-payment"></a><a id="EnterVendorPayment"></a>Ввод платежа поставщику

Необходимо ввести новый платеж поставщику с помощью [предложения по оплате](../../../finance/accounts-payable/create-vendor-payments-payment-proposal.md).

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. На странице **Журнал платежей поставщикам** выберите **Создать**.
3. В поле **Имя** выберите **VendPay**.
4. Выберите **Строки**.
5. Выберите **Предложение по оплате** \> **Создать предложение по оплате**.
6. В диалоговом окне **Предложение по оплате поставщику** настройте условия для фильтрации записей только для счета поставщика **GB_SI_000001**, затем выберите **ОК**.
7. Выберите строку для счета **00000007_Inv**, затем выберите **Создать платеж**.

    ![Диалоговое окно предложения по оплате поставщику.](./media/er-quick-start2-payment-proposal.png)

8. Убедитесь, что введенный платеж настроен на использование **электронного** метода оплаты.

    ![Страница платежей поставщикам.](./media/er-quick-start2-payment-line.png)

## <a name="process-a-vendor-payment-by-using-the-standard-er-format"></a><a id="ProcessVendorPayment1"></a>Обработка платежа поставщику с помощью стандартного формата электронной отчетности

### <a name="set-up-the-electronic-payment-method"></a><a id="ConfigureMethodOfPayment1"></a>Настройка способа оплаты с помощью электронного платежа

Необходимо настроить электронный способ оплаты, чтобы он использовал импортированную конфигурацию формата электронной отчетности.

1. Перейдите в раздел **Расчеты с поставщиками** \> **Настройка платежей** \> **Способы оплаты**.
2. На странице **Методы оплаты — поставщики** выберите **электронный** способ оплаты на левой панели.
3. Выберите **Правка**.
4. На экспресс-вкладке **Форматы файлов** установите для параметра **Универсальный электронный формат экспорта** значение **Да**.
5. В поле **Экспорт конфигурации формата** выберите конфигурацию формата **BACS (UK)**.

    ![Страница «Способы оплаты - поставщики» для настройки метода электронных платежей для обработки платежей поставщикам со стандартным форматом.](./media/er-quick-start2-method-of-payment1.png)

6. Нажмите **Сохранить**.

### <a name="process-a-vendor-payment"></a><a id="ProcessPayment1"></a>Обработка платежа поставщику

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. На странице **Журнал платежей поставщику** выберите добавленный ранее журнал платежей, затем выберите **Строки**.
3. На странице **Платежи поставщикам** выберите **Создать платежи**.
4. В диалоговом окне **Создать платежи** укажите следующие сведения:

    - В поле **Способ оплаты** выберите **Электронный**.
    - В поле **Банковский счет** выберите **GBSI OPER**.

5. Нажмите **ОК**.
6. В диалоговом окне **Параметры электронного отчета** установите для параметра **Печать контрольного отчета** значение **Да**, затем выберите **ОК**.

    ![Страница диалогового окна параметров электронной отчетности.](./media/er-quick-start2-payment-dialog1.png)

    > [!NOTE]
    > В дополнение к файлу платежа теперь можно создать контрольный отчет.

7. Загрузите ZIP-файл, затем извлеките из него следующие файлы:

    - Контрольный отчет в формате Excel
    - Файл платежей в формате TXT

        Обратите внимание, что в соответствии со [структурой](#PositionRoutingNumber) указанного формата электронной отчетности строка платежа в созданном файле начинается с кода банка, который был [определен](#DefineRoutingNumber) для настроенного банковского счета.

        ![Файл платежей в формате TXT.](./media/er-quick-start2-payment-file1.png)

## <a name="customize-the-standard-er-format"></a><a id="CustomizeProvidedFormat"></a>Настройка стандартного формата электронной отчетности

Для примера, показанного в этом разделе, вы хотите использовать конфигурации электронной отчетности, предоставляемые корпорацией Майкрософт, для создания файлов платежей поставщиков в формате BACS, но необходимо добавить настройки для поддержки требований конкретного банка. Кроме того, необходимо иметь возможность обновить пользовательский формат, когда станут доступны новые версии конфигурации электронной отчетности. Однако необходимо иметь возможность выполнять обновление с самыми низкими затратами.

В этом случае, как представитель Litware, Inc., необходимо создать (наследовать) новую конфигурацию формата электронной отчетности, используя конфигурацию **BACS (UK)**, предоставляемую корпорацией Майкрософт в качестве базы.

### <a name="create-a-custom-format"></a><a id="DeriveProvidedFormat"></a>Создание пользовательского формата

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, затем выберите **BACS (UK)**. Litware, Inc. будет использовать конфигурацию формата электронной отчетности версии 1.1 в качестве основы для пользовательской версии.
3. Выберите **Создать конфигурацию**, чтобы открыть раскрывающееся диалоговое окно. Вы можете использовать диалоговое окно, чтобы создать новую конфигурацию для пользовательского формата платежей.
4. В группе полей **Создать** выберите параметр **Производное от имени: BACS (UK), Microsoft**.
5. В поле **Имя** введите **BACS (Соединенное Королевство, пользовательский)**.

    ![Раскрывающееся диалоговое окно создания конфигурации.](./media/er-quick-start2-add-derived-format.png)

6. Выберите **Создать конфигурацию**.

Создана версии 1.1.1 конфигурация формата электронной отчетности **BACS (Соединенное Королевство, пользовательский)**. Эта версия имеет [статус](general-electronic-reporting.md#component-versioning) **Черновик** и может редактироваться. Текущее содержимое пользовательского формата электронной отчетности соответствует содержимому формата, предоставленного корпорацией Майкрософт.

![Страница конфигураций с версией 1.1.1 конфигурации формата электронной отчетности BACS (Соединенное Королевство, пользовательский).](./media/er-quick-start2-derived-format-configuration1.png)

### <a name="edit-a-custom-format"></a><a id="ConfigureDerivedFormat"></a>Изменение пользовательского формата

Необходимо настроить пользовательский формат, чтобы он соответствовал требованиям конкретного банка. Например, банк может требовать, чтобы создаваемые файлы платежа содержали код SWIFT банка, которому назначена роль агента в обработанном платеже поставщика. Коды SWIFT являются международными кодами банка, которые определяют конкретные банки во всем мире. Они также называются идентификационными кодами банка (БИК). Код SWIFT должен иметь длину 11 символов и должен быть введен в начале каждой строки платежа в созданном файле платежа.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, затем выберите **BACS (Соединенное Королевство, пользовательский)**.
3. На экспресс-вкладке **Версии** выберите версию **1.1.1** выбранной конфигурации.
4. Выберите **Конструктор**.
5. На странице **Конструктор форматов** выберите **Показать сведения** для просмотра дополнительных сведений об элементах формата.
6. Разверните и изучите следующие элементы:

    - Элемент **BACSReportsFolder** типа **Папка**. Этот элемент используется для создания выходных данных в формате ZIP.
    - Элемент **файл** типа **Файл**. Этот элемент используется для создания файла платежей в формате TXT.
    - Элемент **транзакции** типа **Последовательность**. Этот элемент используется для создания одной строки платежа в файле платежей.
    - Элемент **транзакция** типа **Последовательность**. Этот элемент используется для создания отдельных полей одной строки платежа.

7. Выберите элемент **транзакция**.

    ![Элемент "транзакция" в конструкторе операций электронной отчетности.](./media/er-quick-start2-derived-format0.png)

    > [!NOTE]
    > Представленный отчет настроен таким образом, что <a id="PositionRoutingNumber"></a>каждая строка платежа начинается с кода банка. Для этой цели используется элемент формата **vendBankRouteNum**. 

8. Выберите **Добавить**, затем выберите тип **Текст\\Строка** для добавляемого элемента формата:

    1. В поле **Имя** введите **vendBankSWIFT**.
    2. В поле **Минимальная длина** введите **11**.
    3. В поле **Максимальная длина** введите **11**.
    4. Нажмите **ОК**.

    > [!NOTE]
    > Элемент **vendBankSWIFT** будет использоваться для ввода SWIFT-кода банка поставщика в созданных файлах.

9. В дереве структуры формата выберите **vendBankSWIFT**.
10. Выберите **Вверх**, чтобы переместить выбранный элемент форматирования на один уровень вверх. Повторяйте этот шаг до тех пор, пока элемент **vendBankSWIFT** не станет <a id="PositionSWIFTCode"></a>первым элементом родительского элемента **транзакция**.

    ![VendBankSWIFT в качестве первого элемента в проводке в конструкторе операций электронной отчетности.](./media/er-quick-start2-derived-format1.png)

11. Когда **vendBankSWIFT** все еще выбран в дереве структуры формата, выберите вкладку **Сопоставление**, затем — источник данных **модели**.
12. Разверните узел **model.Payment** \> **model.Payment.CreditorAgent** и выберите поле источника данных **model.Payment.CreditorAgent.BICFI**. Это поле источника данных представляет SWIFT-код банка поставщика, которому назначена роль агента в обработанном платеже поставщику.
13. Выберите **Связать**. Элемент формата **vendBankSWIFT** теперь привязан к полю источника данных **model.Payment.CreditorAgent.BICFI**, так что коды SWIFT будут вводиться в создаваемые файлы платежей.

    ![Элемент форматирования vendBankSWIFT, связанный с полем источника model.Payment.CreditorAgent.BICFI в конструкторе операций электронной отчетности.](./media/er-quick-start2-derived-format2.png)

14. Нажмите **Сохранить**.
15. Закройте страницу конструктора.

### <a name="mark-a-custom-format-as-runnable"></a><a id="MarkFormatRunnable"></a>Пометка пользовательского формата как готового к запуску

Теперь, когда была создана первая версия пользовательского формата и она имеет статус **Черновик**, ее можно запустить для целей тестирования. Для выполнения отчета необходимо обработать платеж поставщику с помощью метода платежа, который ссылается на пользовательский формат электронной отчетности. По умолчанию при вызове формата электронной отчетности из приложения [учитываются](general-electronic-reporting.md#component-versioning) только те версии, которые имеют статус **Завершено** и **Общие**. Это позволяет предотвратить использование в форматах электронной отчетности незаконченных макетов. Однако для выполнения тестов можно заставить приложение использовать версию формата электронной отчетности, имеющую статус **Черновик**. Таким образом, можно откорректировать текущую версию формата, если требуется внести изменения. Дополнительные сведения см. в разделе [Применимость](electronic-reporting-destinations.md#applicability).

Чтобы использовать черновую версию формата электронной отчетности, необходимо явно пометить формат электронной отчетности.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. В диалоговом окне **Параметры пользователя** установите для параметра **Параметры выполнения** значение **Да**, затем выберите **ОК**.
4. При необходимости выберите **Правка**, чтобы сделать текущую страницу редактируемой.
5. В дереве конфигурации в левой области выберите **BACS (UK, пользовательский)**.
6. Для параметра **Выполнить черновик** выберите значение **Да**.

    ![Параметр "Выполнить черновик" на странице конфигурации.](./media/er-quick-start2-derived-format-configuration2.png)

## <a name="process-a-vendor-payment-by-using-the-custom-er-format"></a><a id="ProcessVendorPayment2"></a>Обработка платежа поставщику с помощью пользовательского формата электронной отчетности

### <a name="set-up-the-electronic-payment-method"></a><a id="ConfigureMethodOfPayment2"></a>Настройка способа оплаты с помощью электронного платежа

Необходимо настроить электронный способ оплаты, чтобы пользовательский формат электронной отчетности использовался для обработки платежей поставщикам.

1. Перейдите в раздел **Расчеты с поставщиками** \> **Настройка платежей** \> **Способы оплаты**.
2. На странице **Методы оплаты — поставщики** выберите **электронный** способ оплаты на левой панели.
3. Выберите **Правка**.
4. На экспресс-вкладке **Формат файла** установите для параметра **Универсальный электронный формат экспорта** значение **Да**.
5. В поле **Экспорт конфигурации формата** выберите конфигурацию формата **BACS (UK, пользовательский)**.

    ![Страница «Способы оплаты - поставщики» для настройки метода электронных платежей для обработки платежей поставщикам с настраиваемым форматом.](./media/er-quick-start2-method-of-payment2.png)

6. Нажмите **Сохранить**.

### <a name="process-a-vendor-payment"></a><a id="ProcessPayment2"></a>Обработка платежа поставщику

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. На странице **Журнал платежей поставщику** выберите созданный ранее журнал платежей.
3. Выберите **Строки**.
4. На странице **Платежи поставщикам** над сеткой выберите **Статус платежа** \> **Нет**.
5. Выберите **Создать платеж**.
6. В диалоговом окне **Создать платежи** укажите следующие сведения:

    - В поле **Способ оплаты** выберите **Электронный**.
    - В поле **Банковский счет** выберите **GBSI OPER**.

7. Нажмите **ОК**.
8. В диалоговом окне **Параметры электронного отчета** установите для параметра **Печать контрольного отчета** значение **Да**, затем выберите **ОК**.

    > [!NOTE]
    > В дополнение к файлу платежа можно создать только контрольный отчет.

9. Загрузите ZIP-файл, затем извлеките из него следующие файлы:

    - Контрольный отчет в формате Excel
    - Файл платежей в формате TXT

        Обратите внимание, что в соответствии со структурой пользовательского формата электронной отчетности строка платежа в созданном файле теперь [начинается](#PositionSWIFTCode) с кода SWIFT, который был [введен](#DefineSWIFTCode) для банковского счета поставщика, платеж которого был обработан.

        ![Файл платежа в формате TXT, используемый для обработки платежа поставщику.](./media/er-quick-start2-payment-file2.png)

## <a name="import-new-versions-of-the-standard-er-format-configurations"></a><a id="ImportERSolution2"></a>Импорт новых версий стандартных конфигураций формата электронной отчетности

В примере, показанном в этом разделе, выводится уведомление о статье базы знаний [KB3763330](https://fix.lcs.dynamics.com/Issue/Details?kb=3182046). Это уведомление информирует вас о новой версии формата электронной отчетности **BACS (UK)**, которая была опубликована корпорацией Майкрософт. В дополнение к контрольному отчету, эта новая версия позволяет пользователям создавать отчет уведомления о платеже и отчет докладной о посещении во время обработки платежа поставщику. Вы хотите начать использовать эту функцию.

### <a name="import-new-versions-of-the-standard-er-configurations"></a><a id="ImportERFormat2"></a>Импорт новых версий стандартных конфигураций электронной отчетности

Чтобы добавить новые версии конфигураций электронной отчетности в текущий экземпляр Finance, необходимо импортировать их из [репозитория](general-electronic-reporting.md#Repository) электронной отчетности, который был настроен вами.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Майкрософт**, затем выберите **Репозитории**, чтобы просмотреть список репозиториев для поставщика Майкрософт.
3. На странице **Репозитории конфигураций** выберите репозиторий типа **Глобальный**, затем выберите **Открыть**. Если будет предложено выполнить проверку подлинности для подключения к службе Regulatory Configuration Service, следуйте инструкциям по проверке подлинности.
4. На странице **Репозиторий конфигураций** в дереве конфигураций на левой панели выберите конфигурацию формата **BACS (UK)**.
5. На экспресс-вкладке **Версии** выберите версию **3.3** выбранной конфигурации формата электронной отчетности.
6. Выберите **Импорт** для загрузки выбранной версии из глобального репозитория в текущий экземпляр Finance.

![Страница репозитория конфигураций, экспресс-вкладка версий, кнопка импорта.](./media/er-quick-start2-import-solution2.png)

> [!TIP]
> При возникновении проблем с доступом к [глобальному репозиторию](er-download-configurations-global-repo.md) можно вместо этого [загрузить конфигурации](download-electronic-reporting-configuration-lcs.md) из служб LCS.

### <a name="review-the-imported-er-format-configurations"></a><a id="ReviewImportedERFormat"></a>Проверка импортированных конфигураций формата электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, затем выберите **BACS (UK)**.
4. На экспресс-вкладке **Версии** выберите версию **3.3**.
5. Выберите **Конструктор**.
6. На странице **Конструктор формата** разверните элемент формата **BACSReportsFolder**.
7.  Обратите внимание, что версия 3.3 содержит элемент формата **PaymentAdviceReport**, который используется для создания отчета уведомления о платеже при обработке платежа поставщику.

    ![Элемент формата PaymentAdviceReport в конструкторе операций электронной отчетности.](./media/er-quick-start2-imported-solution2.png)

8. Закройте страницу конструктора.

## <a name="adopt-the-changes-in-the-new-version-of-an-imported-format-in-a-custom-format"></a><a id="AdoptNewBaseVersion"></a>Адаптация изменений в новой версии импортированного формата в пользовательском формате

### <a name="complete-the-current-draft-version-of-a-custom-format"></a><a id="CompleteDerivedFormat"></a>Завершение текущей черновой версии пользовательского формата

Если требуется сохранить текущее состояние пользовательского формата, завершите черновую версию 1.1.1, изменив ее статус с **Черновик** на **Завершено**.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, разверните **BACS (UK)**, затем выберите **BACS (UK, пользовательский)**.
4. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 1.1.1 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавлена новая редактируемая версия, 1.1.2, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемый формат электронной отчетности.

### <a name="rebase-a-custom-format-to-a-new-base-version"></a><a id="RebaseDerivedFormat"></a>Перемещение пользовательского формата на новую базовую версию

Чтобы начать использовать новые функции версии 3.3 в формате **BACS (UK)** в вашей настройке, необходимо изменить основную версию конфигурации для пользовательской конфигурации **BACS (UK пользовательская)**. Этот процесс называется [повторным размещением](general-electronic-reporting.md#upgrading-a-format-selecting-a-new-version-of-base-format-rebase). Вместо версии 1.1 **BACS (UK)** используйте версию 3.3.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, затем выберите **BACS (Соединенное Королевство, пользовательский)**.
3. На экспресс-вкладке **Версии** выберите версию **1.1.2**, а затем выберите **Повторно разместить**.
4. В диалоговом окне **Повторно разместить** в поле **Целевая версия** выберите версию **3.3** базовой конфигурации, чтобы применить ее в качестве новой базы, и используйте ее для обновления конфигурации.

    ![Диалоговое окно повторного размещения.](./media/er-quick-start2-rebase1.png)

5. Нажмите **ОК**.
6. Обратите внимание, что номер черновой версии был изменен с **1.1.2** на **3.3.2**, чтобы отразить изменение в базовой версии.

    При объединении пользовательской версии и новой базовой версии могут быть обнаружены некоторые конфликты из-за изменений формата, которые невозможно объединить автоматически.

    ![Перемещенная конфигурация с конфликтами на странице конфигураций.](./media/er-quick-start2-rebase2.png)

    При обнаружении конфликтов их необходимо разрешить вручную в конструкторе форматов.

7. На экспресс-вкладке **Версии** выберите версию **3.3.2**.
8. Выберите **Конструктор**.
9. На странице **Конструктор формата** на экспресс-вкладке **Сведения** выберите запись о конфликте для изменения базы, затем выберите **Применить базовое значение**.

    ![Запись конфликта изменения базы в конструкторе операций электронной отчетности.](./media/er-quick-start2-rebase3.png)

10. Нажмите **Сохранить**.

    Запись о конфликте изменения базы не должна больше отображаться на экспресс-вкладке **Сведения**.

    ![Конфликт, разрешенный в конструкторе операций электронной отчетности.](./media/er-quick-start2-rebase4.png)

    > [!NOTE]
    > Этот конфликт был устранен путем подтверждения того, что в этом формате электронной отчетности должна использоваться версия 3 базовой модели.

11. Разверните **BACSReportsFolder** \> **файл** \> **транзакции** \> **транзакция**.
12. На вкладке **Сопоставление** обратите внимание на то, что версия 3.3.2 настраиваемого формата электронной отчетности содержит настройку (элемент формата **vendBankSWIFT** и его привязку) и новые функции версии 3.3 базового формата электронной отчетности, которые были предоставлены корпорацией Майкрософт (элемент форматирования **PaymentAdviceReport** вместе с вложенными элементами и настроенными привязками). С помощью нескольких щелчков мышью можно адаптировать изменения новой базовой версии, объединив их с настройкой.

    ![Объединенный формат в конструкторе операций электронной отчетности.](./media/er-quick-start2-rebase5.png)

13. Закройте страницу конструктора.

> [!NOTE]
> Операция изменения базы обратима. Чтобы отменить это изменение базы, выберите версию **1.1.1** для формата **BACS (UK, пользовательский)** на экспресс-вкладке **Версии**, затем выберите **Получить эту версию**. Версия 3.3.2 будет перенумерована в 1.1.2, а содержимое черновой версии 1.1.2 будет соответствовать содержимому версии 1.1.1.

### <a name="process-a-vendor-payment-by-using-a-rebased-er-format"></a><a id="ProcessPayment3"></a>Обработка платежа поставщику с помощью перемещенного формата электронной отчетности

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. На странице **Журнал платежей поставщику** выберите созданный ранее журнал платежей.
3. Выберите **Строки**.
4. На странице **Платежи поставщикам** над сеткой выберите **Статус платежа** \> **Нет**.
5. Выберите **Создать платеж**.
6. В диалоговом окне **Создать платежи** укажите следующие сведения:

    - В поле **Способ оплаты** выберите **Электронный**.
    - В поле **Банковский счет** выберите **GBSI OPER**.

7. Нажмите **ОК**.
8. В диалоговом окне **Параметры электронной отчетности** введите следующие сведения:

    - Задайте для параметра **Печать контрольного отчета** значение **Да**.
    - Задайте для параметра **Печать уведомления об оплате** значение **Да**.

    ![Диалоговое окно параметров электронной отчетности.](./media/er-quick-start2-payment-dialog2.png)

    > [!NOTE]
    > В дополнение к файлу платежа теперь можно создать как контрольный отчет, так и отчет уведомления об оплате.

9. Нажмите **ОК**.
10. Загрузите ZIP-файл, затем извлеките из него следующие файлы:

    - Контрольный отчет в формате Excel
    - Отчет уведомления об оплате в формате Excel

        ![Отчет уведомления об оплате в формате Excel.](./media/er-quick-start2-payment-advice-report.png)

    - Файл платежей в формате TXT

        Обратите внимание, что строка платежа в созданном файле начинается с кода SWIFT, который был введен для банковского счета поставщика, платеж которого был обработан.

        ![Файл платежа в формате TXT, используемый для обработки платежа поставщику с использованием перемещенного формата электронной отчетности.](./media/er-quick-start2-payment-file3.png)

## <a name="additional-resources"></a><a id="References"></a>Дополнительные ресурсы

- [Обзор электронной отчетности](general-electronic-reporting.md)
- [Загрузка конфигураций электронной отчетности из Lifecycle Services](download-electronic-reporting-configuration-lcs.md)
- [Загрузка конфигураций электронной отчетности из глобального репозитория Configuration Service](er-download-configurations-global-repo.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
