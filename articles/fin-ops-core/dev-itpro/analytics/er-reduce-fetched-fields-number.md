---
title: Повышение производительности решений электронной отчетности путем уменьшения количества полей таблицы, выбираемых во время выполнения
description: В этой статье описывается, как можно повысить производительность путем уменьшения количества полей таблицы, получаемых во время выполнения.
author: NickSelin
ms.date: 05/12/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERModelMappingDesigner, EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.28
ms.openlocfilehash: eb76c415da87d421b8135a93b84f4e905f01e70d
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2022
ms.locfileid: "8847461"
---
# <a name="improve-performance-of-er-solutions-by-reducing-the-number-of-table-fields-that-are-fetched-at-runtime"></a>Повышение производительности решений электронной отчетности путем уменьшения количества полей таблицы, выбираемых во время выполнения

[!include[banner](../includes/banner.md)]

Можно разработать [форматы](er-overview-components.md#format-components-for-outgoing-electronic-documents) [электронной отчетности](general-electronic-reporting.md) (ER) для создания исходящих документов в различных форматах. Когда создается документ, формат электронной отчетности обращается к источникам данных, которые были настроены в соответствующем [сопоставлении моделей](er-overview-components.md#model-mapping-component) электронной отчетности. Чтобы настроить доступ к таблицам приложения, запросам или объектам для извлечения записей можно использовать источники данных электронной отчетности типа *Записи таблицы*. По умолчанию источник данных для типа *Записи таблицы* извлекает значения всех полей в запрошенных записях. Однако этот тип источника данных можно настроить таким образом, чтобы он мог получать только те значения полей, которые необходимы для запущенного формата ER. Эта конфигурация помогает сократить потребление памяти сервером приложений, выполняющим получение данных и дальнейшее кэширование записей.

Чтобы узнать больше о том, как ограничить список получаемых полей источников данных типа *Записи таблицы*, выполните пример в этой статье.

## <a name="example-reduce-the-number-of-table-fields-that-are-fetched-at-runtime"></a>Пример. Сократите количество полей таблицы, выбираемых во время выполнения

Следующие процедуры показывают, как пользователь в роли "Системный администратор" или "Разработчик электронной отчетности" может настроить сопоставление модели ER таким образом, чтобы извлекались только поля, необходимые для выполнения формата ER, чтобы уменьшить потребление памяти сервера приложений.

Эти процедуры можно выполнить в компании **USMF** в Microsoft Dynamics 365 Finance. Написание кода не требуется.

Чтобы выполнить пример в этом разделе, необходимо иметь доступ к компании **USMF** для одной из следующих ролей:

- Консультант по функциональным возможностям электронной отчетности
- Системный администратор

В этом примере вам предстоит использовать [конфигурации](general-electronic-reporting.md#Configuration) ER, предоставленные для демонстрационной компании **Litware, Inc.** Убедитесь, что поставщик конфигурации для демонстрационной компании **Litware, Inc.** (`http://www.litware.com`) указан для платформы электронной отчетности, который помечен как **Активный**. Если этого поставщика конфигурации нет в списке или он не помечен как **Активный**, следуйте указаниям в теме [Создание поставщика конфигурации и пометка его как активного](tasks/er-configuration-provider-mark-it-active-2016-11.md).

### <a name="configure-the-er-framework"></a>Настройка платформы электронной отчетности

Выполните шаги из раздела [Настройка платформы электронной отчетности](er-quick-start2-customize-report.md#ConfigureFramework), чтобы настроить минимальный набор параметров электронной отчетности. Необходимо завершить эту настройку до начала использования платформы электронной отчетности для изменения источника данных предоставленного решения электронной отчетности.

### <a name="import-the-sample-er-configurations"></a>Импорт примера конфигураций электронной отчетности

Если вы еще не выполнили пример в статье [Создание нового решения ER для печати пользовательского отчета](er-quick-start1-new-solution.md), загрузите и локально сохраните файлы XML для следующих конфигураций предоставленного решения ER.

| Описание содержания            | Имя файла |
|--------------------------------|-----------|
| Конфигурации модели данных электронной отчетности    | [Questionnaires model.version.1.xml](https://download.microsoft.com/download/b/6/3/b633bd34-d200-4422-96d9-8f62eb5218f8/Questionnaires_model.version.1.xml) |
| Конфигурация сопоставления модели ER | [Questionnaires mapping.version.1.1.xml](https://download.microsoft.com/download/7/b/2/7b258e4e-4bd5-46a4-8114-27419ae4acd8/Questionnaires_mapping.version.1.1.xml) |
| Конфигурация формата электронной отчетности        | [Questionnaires format.version.1.1.xml](https://download.microsoft.com/download/1/b/a/1ba39ec2-257a-44d8-972f-25bf7d18fb41/Questionnaires_format.version.1.1.xml) |

Затем выполните следующие действия, чтобы загрузить конфигурации предоставленного решения ER в ваш экземпляр Finance.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. Выберите **Конфигурации отчетности**.
3. На странице **Конфигурации** импортируйте конфигурацию модели данных электронной отчетности .

    1. Выберите **Обмен**, а затем выберите **Загрузить из XML-файла**.
    2. Выберите **Обзор**, найдите и выберите файл **Questionnaires model.version.1.xml**, затем нажмите **OK**.

4. Импортируйте конфигурацию сопоставления модели электронной отчетности.

    1. Выберите **Обмен**, а затем выберите **Загрузить из XML-файла**.
    2. Выберите **Обзор**, найдите и выберите файл **Questionnaires mapping.version.1.1.xml**, затем нажмите **OK**.

5. Импорт конфигурации формата ER.

    1. Выберите **Обмен**, а затем выберите **Загрузить из XML-файла**.
    2. Выберите **Обзор**, найдите и выберите файл **Questionnaires format.1.1.xml**, затем нажмите **OK**.

6. В дереве конфигурации разверните **Модель анкет**.
7. Просмотрите список импортированных конфигураций ER в дереве конфигурации.

    ![Проверка списка импортированных конфигураций ER на странице конфигураций.](./media/er-reduce-fetched-fields-number-configurations.png)

### <a name="review-the-provided-er-model-mapping"></a>Просмотр предоставленного сопоставления модели ER

1. На странице **Конфигурации** выберите **Сопоставление анкет**.
2. В области действий выберите **Конструктор**.
3. На странице **Сопоставление модели и источника данных** выберите **Конструктор**.
4. На странице **Конструктор сопоставлений моделей** на панели операций выберите **Представление группы**, чтобы включить **Представления группы**.
5. В области **Модель данных** разверните **Анкета**.

    Обратите внимание, что источник данных **Анкета** был настроен для получения доступа к таблице приложений `KMCollection`.

6. В области **Источники данных** разверните **Записи таблицы** \> **Анкета** \> **Поля**.

    Обратите внимание, сколько полей из таблицы приложения `KMCollection` предоставлены источником данных **Анкета** типа *Записи таблицы*.

    ![Просмотр предоставленных сопоставлений моделей на странице конструктора сопоставления моделей, когда параметр представления группы включен.](./media/er-reduce-fetched-fields-number-mapping1.png)

7. На панели операций снова выберите **Представление группы**, чтобы отключить представление **Группа**, а затем выберите **Показать все** \> **Показать только сопоставленные**.

    Обратите внимание, что несколько полей таблицы приложения `KMCollection` используются для заполнения списка записей **Анкета** в модели данных ER:

    - `Active`
    - `Description`
    - `questionMode`
    - `kmCollectionId`

    ![Просмотр предоставленных сопоставлений моделей на странице конструктора сопоставления моделей, когда параметр представления группы выключен.](./media/er-reduce-fetched-fields-number-mapping2.png)

### <a name="turn-on-the-er-performance-trace"></a>Включение трассировки производительности электронной отчетности

Выполните действия, описанные в разделе [Включение трассировки производительности электронной отчетности](trace-execution-er-troubleshoot-perf.md#turn-on-the-er-performance-trace) для задания параметров пользователя ER, позволяющих выполнять трассировку компонентов ER.

### <a name="run-the-provided-er-format-by-using-the-provided-model-mapping"></a>Запуск предоставленного формата ER с помощью предоставленного сопоставления модели

Выполните действия, указанные в разделе [Выполнение созданного формата из ER](er-quick-start1-new-solution.md#RunFormatFromER), для выполнения предоставленного формата ER для одной анкеты на странице **Конфигурации**.

### <a name="review-the-execution-trace-of-the-first-run"></a>Просмотр трассировки выполнения первого запуска

1. Перейдите в раздел **Управление организацией** \> **Электронная отчетность \> Конфигурации**.
2. На странице **Конфигурации** разверните **Модель анкеты** и выберите **Сопоставление анкет**.

    > [!NOTE]
    > Сведения на экспресс-вкладке **Версии** показывают, что выбрана черновая версия конфигурации **Сопоставление анкет**. Таким образом, можно изменить содержимое этого сопоставления модели.

3. В области действий выберите **Конструктор**.
4. На странице **Сопоставление модели и источника данных** выберите **Конструктор**.
5. На странице **Конструктор сопоставления модели** в области действий выберите **Трассировка производительности**.
6. В диалоговом окне **Параметры результата трассировки производительности** выберите трассировку, созданную в ходе последнего выполнения форматирования.

    ![Выбор трассировки в диалоговом окне "Параметры результатов трассировки производительности".](./media/er-reduce-fetched-fields-number-select-trace-1.png)

7. Нажмите **ОК**. 
8. На экспресс-вкладке **Сведения** отфильтруйте путь **Анкета**, указывающий на источник данных **Анкета**.
9. Просмотрите сведения о запросе базы данных, созданном при вызове источника данных **Анкета**.

    Обратите внимание, что все поля таблицы приложений `KMCollection` были получены во время выполнения, когда был вызван источник данных **Анкета**.

    ![Просмотр сведений запроса базы данных на странице конструктора сопоставления модели](./media/er-reduce-fetched-fields-number-query1.png)

### <a name="modify-the-provided-er-model-mapping"></a>Изменения предоставленного сопоставления модели ER

1. На странице **Конструктор сопоставления модели** в области **Источники данных** выберите источник данных **Анкета**.
2. В области данных **Источники данных** выберите **Правка**.
3. В диалоговом окне **Свойства источника данных** выберите **Выбрать поля**, чтобы указать список полей таблицы приложения `KMCollection`, на которую дана ссылка и которая будет получена во время выполнения при вызове редактируемого источника данных **Анкета**.

    ![Выбор параметра "Выбрать поля" в диалоговом окне "Свойства источника данных", чтобы начать конфигурацию полей списка, которые будут получены из таблицы приложения с помощью редактируемого источника данных.](./media/er-reduce-fetched-fields-number-select-fields1.png)

4. На странице **Выбор полей** выберите **Автозаполнение**.

    Список **Выбранные поля** заполняется автоматически на основе заранее настроенных артефактов сопоставления модели. Все поля и отношения связанной таблицы, упоминаемые в любой привязке, формуле или источнике данных сопоставления модели, добавляются в список.

    ![Настройка списка полей, которые будут получены из таблицы приложения на странице "Выбор полей".](./media/er-reduce-fetched-fields-number-select-fields2.png)

5. Выберите **Сохранить**, затем закройте страницу **Выбор полей**.
6. Нажмите **ОК**, чтобы сохранить изменения, внесенные в параметры источника данных.
7. На панели операций выберите **Показать все**.

    Обратите внимание, что в источнике данных **Анкета** теперь отображается текст **\<Fields are filtered\>**. Этот текст указывает на то, что источник данных был настроен таким образом, чтобы получать ограниченное количество полей из таблицы приложения, на которую дана ссылка.

    ![Проверка обновленного сопоставления модели на странице конструктора сопоставления модели.](./media/er-reduce-fetched-fields-number-mapping3.png)

8. Нажмите **Сохранить**, чтобы сохранить изменения, внесенные в редактированное сопоставление модели.

    > [!NOTE]
    > Во время выполнения электронная отчетность анализирует добавленные отношения и добавляет все поля, используемые в них, к запросу базы данных, даже если эти поля не были добавлены в список полей, полученных во время разработки.

### <a name="run-the-provided-er-format-by-using-the-updated-model-mapping"></a>Запуск предоставленного формата ER, используя обновленное сопоставление модели

Выполните действия, указанные в разделе [Выполнение созданного формата из ER](er-quick-start1-new-solution.md#RunFormatFromER), для выполнения предоставленного формата ER для одной анкеты на странице **Конфигурации**.

### <a name="review-the-execution-trace-of-the-second-run"></a>Просмотр трассировки выполнения второго запуска

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** разверните **Модель анкеты** и выберите **Сопоставление анкет**.
3. В области действий выберите **Конструктор**.
4. На странице **Сопоставление модели и источника данных** выберите **Конструктор**.
5. На странице **Конструктор сопоставления модели** в области действий выберите **Трассировка производительности**.
6. В диалоговом окне **Параметры результата трассировки производительности** выберите трассировку, созданную в ходе последнего выполнения форматирования.
7. Нажмите **ОК**.
8. На экспресс-вкладке **Сведения** отфильтруйте путь **Анкета**, указывающий на источник данных **Анкета**.
9. Просмотрите сведения о запросе базы данных, созданном при вызове источника данных **Анкета**.

    Обратите внимание, что только поля, необходимые для заполнения источника данных, были получены во время выполнения из таблицы приложения `KMCollection` при вызове источника данных **Анкета**.

    > [!NOTE]
    > Некоторые поля, например, поля ИД раздела, кода области данных и кода записи, добавляются автоматически структурой управления данными приложения Finance.

    ![Просмотр сведений запроса базы данных для обновленного сопоставления модели на странице конструктора сопоставления модели](./media/er-reduce-fetched-fields-number-query2.png)

Этот метод можно использовать для уменьшения числа полученных записей при необходимости уменьшения потребления выполняемым сопоставлением модели ER и форматом ER.

## <a name="limitations"></a>Ограничения

Если ограничить число полученных полей для источника данных типа *Записи таблицы*, то нельзя будет использовать методы таблицы приложения, к которой относится источник данных, так как метаданные приложения не предоставляют сведения о полях таблицы, которые необходимы для вызова этих методов.

## <a name="usage-notes"></a>Примечания по использованию

Несмотря на то, что команда **Автозаполнение** автоматически добавляет поля, она не удаляет автоматически ранее добавленные поля, даже если они больше не используются в привязках, формулах и источниках данных редактируемого сопоставления модели.

При выборе **Автозаполнение** электронная отчетность анализирует привязки, формулы и источники данных, которые были у редактируемого сопоставления модели, когда они были открыты для редактирования. При изменении привязок, формул и источников данных редактируемого сопоставления и при необходимости использования команды **Автозаполнение** закройте конструктор сопоставления модели, а затем откройте его снова, чтобы изменить сопоставление модели. 

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Трассировка выполнения форматов электронной отчетности для устранения неполадок, связанных с производительностью](trace-execution-er-troubleshoot-perf.md)
- [Устранение проблем с производительностью в конфигурациях электронной отчетности](er-troubleshoot-perf-issues-in-configurations.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
