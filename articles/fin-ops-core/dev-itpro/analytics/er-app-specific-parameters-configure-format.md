---
title: Настройка форматов ER для использования параметров, указанных для юридического лица
description: В этом разделе объясняется, как настроить форматы электронной отчетности (ER) для использования параметров, которые указаны для юридического лица.
author: NickSelin
ms.date: 03/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, EROperationDesigner, ERLookupDesigner, ERComponentLookupStructureEditing
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: Release 8.1.3
ms.openlocfilehash: 16eab3ffa7d4a780ec9709f5c8a5c263b1e75365
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "5751186"
---
# <a name="configure-er-formats-to-use-parameters-that-are-specified-per-legal-entity"></a><span data-ttu-id="5cd02-103">Настройка форматов ER для использования параметров, указанных для юридического лица</span><span class="sxs-lookup"><span data-stu-id="5cd02-103">Configure ER formats to use parameters that are specified per legal entity</span></span>

[!include[banner](../includes/banner.md)]

## <a name="overview"></a><span data-ttu-id="5cd02-104">Обзор</span><span class="sxs-lookup"><span data-stu-id="5cd02-104">Overview</span></span>

<span data-ttu-id="5cd02-105">Во многих форматах электронной отчетности (ER), которые будут создаваться, необходимо фильтровать данные с помощью набора значений, которые относятся к каждому юридическому лицу вашего экземпляра (например, набору налоговых кодов для фильтрации проводок по налогу).</span><span class="sxs-lookup"><span data-stu-id="5cd02-105">In many of the Electronic reporting (ER) formats that you will design, you must filter data by using a set of values that are specific to each legal entity of your instance (for example, a set of tax codes to filter tax transactions).</span></span> <span data-ttu-id="5cd02-106">В настоящее время, когда фильтрация этого типа настроена в формате ER, значения, зависящие от юридического лица (например, налоговые коды), используются в выражениях в формате ER для указания правил фильтрации данных.</span><span class="sxs-lookup"><span data-stu-id="5cd02-106">Currently, when filtering of this type is configured in an ER format, values that are dependent on the legal entity (for example, tax codes) are used in expressions of the ER format to specify data filtering rules.</span></span> <span data-ttu-id="5cd02-107">Таким образом, используется формат ER для компании, а для создания необходимых отчетов необходимо создать производные копии оригинального формата ER для каждого юридического лица, для которого нужен формат ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-107">Therefore, the ER format is made legal entity–specific, and to generate the required reports, you must create derived copies of the original ER format for each legal entity where you have to run the ER format.</span></span> <span data-ttu-id="5cd02-108">Каждый производный формат ER должен быть изменен для того, чтобы передать в него значения, зависящие от юридического лица, изменяя основу при обновлении исходной (базовой) версии, которая экспортируется из тестовой среды и импортируется в производственную среду, когда она должна быть развернута для практического использования и т. д.</span><span class="sxs-lookup"><span data-stu-id="5cd02-108">Each derived ER format must be edited to bring legal entity–specific values into it, rebased whenever the original (base) version has been updated, exported from a test environment and imported into a production environment when it must be deployed for production use, and so on.</span></span> <span data-ttu-id="5cd02-109">Таким образом, обслуживание этого типа настроенного решения ER является довольно сложным и требует много времени по нескольким причинам:</span><span class="sxs-lookup"><span data-stu-id="5cd02-109">Therefore, maintenance of this type of configured ER solution is quite complex and time-consuming for several reasons:</span></span>

-   <span data-ttu-id="5cd02-110">Чем больше юридических лиц, тем большее количество конфигураций формата ER необходимо поддерживать.</span><span class="sxs-lookup"><span data-stu-id="5cd02-110">The more legal entities there are, the more ER format configurations must be maintained.</span></span>
-   <span data-ttu-id="5cd02-111">Для поддержки конфигураций ER требуется, чтобы у бизнес-пользователей были сведения об ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-111">Maintenance of ER configurations requires that business users have ER knowledge.</span></span>

<span data-ttu-id="5cd02-112">Параметры, зависящие от приложения ER, позволяют опытным пользователям настраивать фильтрацию данных в формате ER, чтобы они основывались на наборе абстрактных правил.</span><span class="sxs-lookup"><span data-stu-id="5cd02-112">The ER application-specific parameters feature lets power users configure data filtering in an ER format so that it's based on a set of abstract rules.</span></span> <span data-ttu-id="5cd02-113">Этот набор правил может быть настроен таким образом, чтобы использовать источники данных, доступные в формате ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-113">This set of rules can be configured to use the data sources that are available in an ER format.</span></span> <span data-ttu-id="5cd02-114">Бизнес-пользователи могут затем указать реальные правила за пределами среды ER, используя пользовательский интерфейс, который автоматически создается на основе настроек соответствующего формата ER и текущих данных юридического лица, к которым будут иметь доступ источники данных в формате ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-114">Business users can then specify real rules beyond the ER framework by using the user interface (UI) that is automatically generated based on the settings of the corresponding ER format and the current legal entity data that will be accessed by the ER format's data sources.</span></span> <span data-ttu-id="5cd02-115">Набор правил, указанный для формата ER, может быть экспортирован из текущего юридического лица экземпляра Dynamics 365 Finance (Finance).</span><span class="sxs-lookup"><span data-stu-id="5cd02-115">The set of rules that is specified for an ER format can be exported from the current legal entity of the Dynamics 365 Finance (Finance) instance.</span></span> <span data-ttu-id="5cd02-116">Затем он может быть импортирован в другое юридическое лицо того же или другого экземпляра в качестве набора правил для того же формата ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-116">It can then be imported into another legal entity of either the same Finance instance or a different instance as a set of rules for the same ER format.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="5cd02-117">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="5cd02-117">Prerequisites</span></span>

<span data-ttu-id="5cd02-118">Чтобы выполнить примеры в этом разделе, необходимо иметь доступ к экземпляру служб Regulatory Configuration Service (RCS), который был настроен для того же клиента, что и Finance, для одной из следующих ролей:</span><span class="sxs-lookup"><span data-stu-id="5cd02-118">To complete the examples in this topic, you must have access to the instance of Regulatory Configuration Services (RCS) that has been provisioned for the same tenant as Finance for one of the following roles:</span></span>

- <span data-ttu-id="5cd02-119">Разработчик электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="5cd02-119">Electronic reporting developer</span></span>
- <span data-ttu-id="5cd02-120">Консультант по функциональным возможностям электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="5cd02-120">Electronic reporting functional consultant</span></span>
- <span data-ttu-id="5cd02-121">Системный администратор</span><span class="sxs-lookup"><span data-stu-id="5cd02-121">System administrator</span></span>

<span data-ttu-id="5cd02-122">Рекомендуется выполнить шаги, указанные в разделе [Поддержка параметризованных вызовов источников данных электронной отчетности для рассчитанного типа поля](er-calculated-field-type.md).</span><span class="sxs-lookup"><span data-stu-id="5cd02-122">We recommend that you complete the steps in the [Support parameterized calls of ER data sources of CALCULATED FIELD type](er-calculated-field-type.md) topic.</span></span> <span data-ttu-id="5cd02-123">После выполнения этих шагов можно пропустить шаги в разделе **Импорт конфигураций ER в RCS**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-123">If you've already completed those steps, you can skip the steps in the **Import ER configurations into RCS** section that follows.</span></span>

## <a name="import-er-configurations-into-rcs"></a><span data-ttu-id="5cd02-124">Импорт конфигураций ER в RCS</span><span class="sxs-lookup"><span data-stu-id="5cd02-124">Import ER configurations into RCS</span></span>

<span data-ttu-id="5cd02-125">Загрузите и локально сохраните следующие конфигурации электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="5cd02-125">Download and locally store the following ER configurations.</span></span>

| <span data-ttu-id="5cd02-126">**Описание содержания**</span><span class="sxs-lookup"><span data-stu-id="5cd02-126">**Content description**</span></span>                        | <span data-ttu-id="5cd02-127">**Имя файла**</span><span class="sxs-lookup"><span data-stu-id="5cd02-127">**File name**</span></span>                                        |
|------------------------------------------------|------------------------------------------------------|
| <span data-ttu-id="5cd02-128">Пример файла конфигурации **Модель данных ER**</span><span class="sxs-lookup"><span data-stu-id="5cd02-128">Sample **ER data model** configuration file</span></span>    | [<span data-ttu-id="5cd02-129">Model to learn parameterized calls.version.1.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-129">Model to learn parameterized calls.version.1.xml</span></span>](https://download.microsoft.com/download/2/d/b/2db913a0-3622-494e-91a2-97fc494af9b9/Modeltolearnparameterizedcalls.version.1.xml)     |
| <span data-ttu-id="5cd02-130">Пример файла конфигурации **Метаданные ER**</span><span class="sxs-lookup"><span data-stu-id="5cd02-130">Sample **ER metadata** configuration file</span></span>      | [<span data-ttu-id="5cd02-131">Metadata to learn parameterized calls.version.1.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-131">Metadata to learn parameterized calls.version.1.xml</span></span>](https://download.microsoft.com/download/1/b/3/1b343968-5a47-4000-b5a8-6487698ef4c0/Metadatatolearnparameterizedcalls.version.1.xml)  |
| <span data-ttu-id="5cd02-132">Пример файла конфигурации **Сопоставления модели ER**</span><span class="sxs-lookup"><span data-stu-id="5cd02-132">Sample **ER model mapping** configuration file</span></span> | [<span data-ttu-id="5cd02-133">Mapping to learn parameterized calls.version.1.1.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-133">Mapping to learn parameterized calls.version.1.1.xml</span></span>](https://download.microsoft.com/download/8/6/6/866e0ab6-2e05-4d98-9d52-d2da2038f6e4/Mappingtolearnparameterizedcalls.version.1.1.xml) |
| <span data-ttu-id="5cd02-134">Пример конфигурации **Формат ER**</span><span class="sxs-lookup"><span data-stu-id="5cd02-134">Sample **ER format** configuration</span></span>             | [<span data-ttu-id="5cd02-135">Format to learn parameterized calls.version.1.1.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-135">Format to learn parameterized calls.version.1.1.xml</span></span>](https://download.microsoft.com/download/e/3/9/e392eadc-b9b4-4834-95c3-b8066dd00b9c/Formattolearnparameterizedcalls.version.1.1.xml)  |

<span data-ttu-id="5cd02-136">Затем войдите в экземпляр RCS.</span><span class="sxs-lookup"><span data-stu-id="5cd02-136">Next, sign in to your RCS instance.</span></span>

<span data-ttu-id="5cd02-137">В этом примере вам предстоит создать конфигурацию для компании-образца Litware, Inc.</span><span class="sxs-lookup"><span data-stu-id="5cd02-137">In this example, you will create a configuration for the Litware, Inc sample company.</span></span> <span data-ttu-id="5cd02-138">Перед выполнением этой процедуры необходимо сначала выполнить шаги в разделе [Создание поставщика конфигурации и пометка его как активного](tasks/er-configuration-provider-mark-it-active-2016-11.md) в RCS.</span><span class="sxs-lookup"><span data-stu-id="5cd02-138">Before you can complete this procedure, you must complete the steps in the [Create a configuration provider and mark it as active](tasks/er-configuration-provider-mark-it-active-2016-11.md) topic in RCS.</span></span>

1.  <span data-ttu-id="5cd02-139">В панели мониторинга по умолчанию выберите **Электронная отчетность**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-139">On the default dashboard, select **Electronic reporting**.</span></span>
2.  <span data-ttu-id="5cd02-140">Выберите **Конфигурации отчетности**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-140">Select **Reporting configurations**.</span></span>
3.  <span data-ttu-id="5cd02-141">Импортируйте конфигурации ER, загруженные ранее в RCS, в следующей последовательности: модель данных, метаданные, сопоставление модели и формат.</span><span class="sxs-lookup"><span data-stu-id="5cd02-141">Import the ER configurations that you downloaded earlier into RCS, in the following order: data model, metadata, model mapping, and format.</span></span> <span data-ttu-id="5cd02-142">Для каждой конфигурации ER выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="5cd02-142">For each ER configuration, follow these steps:</span></span>

    1.  <span data-ttu-id="5cd02-143">Выберите **Обменять**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-143">Select **Exchange**.</span></span>
    2.  <span data-ttu-id="5cd02-144">Выберите **Загрузить из XML-файла**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-144">Select **Load from XML file**.</span></span>
    3.  <span data-ttu-id="5cd02-145">Выберите **Обзор**, чтобы выбрать файл для требуемой конфигурации ER в формате XML.</span><span class="sxs-lookup"><span data-stu-id="5cd02-145">Select **Browse** to select the file for the required ER configuration in XML format.</span></span>
    4.  <span data-ttu-id="5cd02-146">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-146">Select **OK**.</span></span>

## <a name="review-the-er-solution-that-is-provided"></a><span data-ttu-id="5cd02-147">Предварительный просмотр предоставленного решения ER</span><span class="sxs-lookup"><span data-stu-id="5cd02-147">Review the ER solution that is provided</span></span>

1.  <span data-ttu-id="5cd02-148">В дереве конфигурации разверните содержимое пункта **Модели для изучения параметризованных вызовов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-148">In the configuration tree, expand the contents of the **Model to learn parameterized calls** item.</span></span>
2.  <span data-ttu-id="5cd02-149">Выберите элемент **Формат для изучения параметризованных вызовов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-149">Select the **Format to learn parameterized calls** item.</span></span>
3.  <span data-ttu-id="5cd02-150">Выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-150">Select **Designer**.</span></span>
4.  <span data-ttu-id="5cd02-151">Выберите **Развернуть/Свернуть**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-151">Select **Expand/Collapse**.</span></span>

    <span data-ttu-id="5cd02-152">Формат ER **Формат для изучения параметризованных вызовов** предназначен для создания налоговой выписки в формате XML, представляющей несколько уровней налогообложения (обычный, сокращенный и отсутствует).</span><span class="sxs-lookup"><span data-stu-id="5cd02-152">The **Format to learn parameterized calls** ER format is designed to generate a tax statement in XML format that presents several levels of taxation (regular, reduced, and none).</span></span> <span data-ttu-id="5cd02-153">На каждом уровне разное число деталей.</span><span class="sxs-lookup"><span data-stu-id="5cd02-153">Each level has a different number of details.</span></span>

    ![Несколько уровней формата электронной отчетности, Формат для изучения параметризованных вызовов](./media/RCS-AppSpecParms-ReviewFormat.PNG)

5.  <span data-ttu-id="5cd02-155">На вкладке **Сопоставление** раскройте элементы **Модель**, **Данные** и **Сводка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-155">On the **Mapping** tab, expand the **Model**, **Data**, and **Summary** items.</span></span>

    <span data-ttu-id="5cd02-156">В качестве источника данных **Model.Data.Summary** возвращается список налоговых проводок.</span><span class="sxs-lookup"><span data-stu-id="5cd02-156">The **Model.Data.Summary** data source returns the list of tax transactions.</span></span> <span data-ttu-id="5cd02-157">Такие проводки упорядочиваются по налоговому коду.</span><span class="sxs-lookup"><span data-stu-id="5cd02-157">These transactions are summarized by tax code.</span></span> <span data-ttu-id="5cd02-158">Для этого источника данных вычисляемое поле **Model.Data.Summary.Level** настроено для возврата кода уровня налогообложения для каждой записи сводки.</span><span class="sxs-lookup"><span data-stu-id="5cd02-158">For this data source, the **Model.Data.Summary.Level** calculated field has been configured to return the code for the taxation level of each summarized record.</span></span> <span data-ttu-id="5cd02-159">Для любого кода налога, получаемого из источника данных **Model.Data.Summary** во время выполнения, вычисляемое поле возвращает код уровня налогообложения (**обычный**, **пониженный**, **отсутствует** или **другой**) в виде текстового значения.</span><span class="sxs-lookup"><span data-stu-id="5cd02-159">For any tax code that can be retrieved from the **Model.Data.Summary** data source at runtime, the calculated field returns the taxation level code (**Regular**, **Reduced**, **None**, or **Other**) as a text value.</span></span> <span data-ttu-id="5cd02-160">Вычисляемое поле **Model.Data.Summary.Level** используется для фильтрации записей источника данных **Model.Data.Summary** и ввода отфильтрованных данных в каждый элемент XML, представляющий уровень налогообложения, с помощью полей **Model.Data2.Level1**, **Model.Data2.Level2** и **Model.Data2.Level3**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-160">The **Model.Data.Summary.Level** calculated field is used to filter records of the **Model.Data.Summary** data source and enter the filtered data in each XML element that represents a taxation level by using the **Model.Data2.Level1**, **Model.Data2.Level2**, and **Model.Data2.Level3** fields.</span></span>

    ![Источник данных Model.Data.Summary содержит список налоговых проводок](./media/RCS-AppSpecParms-ReviewFormat-Data2Fld.PNG)

    <span data-ttu-id="5cd02-162">Вычисляемое поле **Model.Data.Summary.Level** было настроено, чтобы оно содержало выражение ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-162">The **Model.Data.Summary.Level** calculated field has been configured so that it contains an ER expression.</span></span> <span data-ttu-id="5cd02-163">Обратите внимание, что налоговые коды (**VAT19**, **InVAT19**, **VAT7**, **InVAT7**, **THIRD** и **InVAT0**) жестко запрограммированы в этой конфигурации.</span><span class="sxs-lookup"><span data-stu-id="5cd02-163">Note that tax codes (**VAT19**, **InVAT19**, **VAT7**, **InVAT7**, **THIRD**, and **InVAT0**) are hardcoded into this configuration.</span></span> <span data-ttu-id="5cd02-164">Поэтому этот формат ER зависит от юридических лиц, в которых настроены эти налоговые коды.</span><span class="sxs-lookup"><span data-stu-id="5cd02-164">Therefore, this ER format is dependent on the legal entity where these tax codes were configured.</span></span>

    ![Вычисляемое поле Model.Data.Summary.Level с налоговыми кодами, запрограммированными в коде](./media/RCS-AppSpecParms-ReviewFormat-LevelFld.PNG)

    <span data-ttu-id="5cd02-166">Для поддержки различных наборов налоговых кодов для каждого юридического лица необходимо выполнить следующие действия:</span><span class="sxs-lookup"><span data-stu-id="5cd02-166">To support a different set of tax codes for each legal entity, you must follow these steps:</span></span>

    - <span data-ttu-id="5cd02-167">Создайте производную версию формата ER для каждого юридического лица.</span><span class="sxs-lookup"><span data-stu-id="5cd02-167">Create a derived version of the ER format for each legal entity.</span></span>
    - <span data-ttu-id="5cd02-168">Обновите налоговые коды в вычисляемом поле **Model.Data.Summary.Level** на основе параметра юридического лица.</span><span class="sxs-lookup"><span data-stu-id="5cd02-168">Update the tax codes in the **Model.Data.Summary.Level** calculated field, based on the legal entity setting.</span></span>

6.  <span data-ttu-id="5cd02-169">Закройте страницу **Конструктор форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-169">Close the **Format designer** page.</span></span>

## <a name="create-a-derived-format"></a><span data-ttu-id="5cd02-170">Создание производного формата</span><span class="sxs-lookup"><span data-stu-id="5cd02-170">Create a derived format</span></span>

<span data-ttu-id="5cd02-171">Затем будут использованы параметры, зависящие от приложения ER, для поддержки различных наборов налоговых кодов для каждого юридического лица в одном формате ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-171">Next, you will use the ER application-specific parameters feature to support a different set of tax codes for each legal entity in a single ER format.</span></span>

1.  <span data-ttu-id="5cd02-172">В дереве конфигурации разверните содержимое пункта **Модели для изучения параметризованных вызовов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-172">In the configuration tree, expand the contents of the **Model to learn parameterized calls** item.</span></span>
2.  <span data-ttu-id="5cd02-173">Выберите элемент **Формат для изучения параметризованных вызовов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-173">Select the **Format to learn parameterized calls** item.</span></span>
3.  <span data-ttu-id="5cd02-174">Выберите **Создать конфигурацию**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-174">Select **Create configuration**.</span></span>
4.  <span data-ttu-id="5cd02-175">Выберите **Производное от имени: формат для изучения параметризованных вызовов, Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-175">Select the **Derive from Name: Format to learn parameterized calls, Microsoft** option.</span></span>
5.  <span data-ttu-id="5cd02-176">В поле **Имя** введите **Формат для изучения поиска данных LE**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-176">In the **Name** field, enter **Format to learn how to lookup LE data**.</span></span>
6.  <span data-ttu-id="5cd02-177">Выберите **Создать конфигурацию**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-177">Select **Create configuration**.</span></span>

## <a name="configure-a-derived-format"></a><span data-ttu-id="5cd02-178">Настройка производного формата</span><span class="sxs-lookup"><span data-stu-id="5cd02-178">Configure a derived format</span></span>

### <a name="add-a-format-enumeration"></a><span data-ttu-id="5cd02-179">Добавление перечисления форматов</span><span class="sxs-lookup"><span data-stu-id="5cd02-179">Add a format enumeration</span></span>

<span data-ttu-id="5cd02-180">Далее необходимо добавить новое перечисление формата ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-180">Next, you will add a new ER format enumeration.</span></span> <span data-ttu-id="5cd02-181">Значения этого перечисления форматов будут представлены для бизнес-пользователей, которые будут определять зависимые от компании наборы налоговых кодов для различных уровней налогообложения, используемых в формате ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-181">The values of this format enumeration will be presented to business users, who will specify legal entity–dependent sets of tax codes for the various taxation levels that are used in the ER format.</span></span>

1.  <span data-ttu-id="5cd02-182">Выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-182">Select **Designer**.</span></span>
2.  <span data-ttu-id="5cd02-183">Выберите **Перечисление форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-183">Select **Format enumerations**.</span></span>
3.  <span data-ttu-id="5cd02-184">Выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-184">Select **Add**.</span></span>
4.  <span data-ttu-id="5cd02-185">В поле **Имя** введите **Список уровней налогообложения**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-185">In the **Name** field, enter **List of taxation levels**.</span></span>
5.  <span data-ttu-id="5cd02-186">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-186">Select **Save**.</span></span>
6.  <span data-ttu-id="5cd02-187">На вкладке **Значения перечисления форматов** выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-187">On the **Format enumeration values** tab, select **Add**.</span></span>
7.  <span data-ttu-id="5cd02-188">В поле **Имя** введите **Обычное налогообложение**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-188">In the **Name** field, enter **Regular taxation**.</span></span>
8.  <span data-ttu-id="5cd02-189">Снова выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-189">Select **Add** again.</span></span>
9.  <span data-ttu-id="5cd02-190">В поле **Имя** введите **Сокращенное налогообложение**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-190">In the **Name** field, enter **Reduced taxation**.</span></span>
10. <span data-ttu-id="5cd02-191">Снова выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-191">Select **Add** again.</span></span>
11. <span data-ttu-id="5cd02-192">В поле **Имя** введите **Нет налогообложения**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-192">In the **Name** field, enter **No taxation**.</span></span>
12. <span data-ttu-id="5cd02-193">Снова выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-193">Select **Add** again.</span></span>
13. <span data-ttu-id="5cd02-194">В поле **Имя** введите **Другое**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-194">In the **Name** field, enter **Other**.</span></span>

    ![Новая запись на странице перечислений форматов](./media/RCS-AppSpecParms-ConfigureFormat-Enum.PNG)

    <span data-ttu-id="5cd02-196">Так как бизнес-пользователи могут использовать другие языки для указания зависящих от компании наборов налоговых кодов, рекомендуется перевести значения этого перечисления в языки, настроенные в качестве предпочтительных языков для пользователей в Finance.</span><span class="sxs-lookup"><span data-stu-id="5cd02-196">Because the business users might use different languages to specify legal entity–dependent sets of tax codes, we recommend that you translate the values of this enumeration into the languages that are configured as the preferred languages for those users in Finance.</span></span>

14. <span data-ttu-id="5cd02-197">Выберите запись **Нет налогообложения**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-197">Select the **No taxation** record.</span></span>
15. <span data-ttu-id="5cd02-198">Щелкните поле **Метка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-198">Click in the **Label** field.</span></span>
16. <span data-ttu-id="5cd02-199">Выберите **Перевести**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-199">Select **Translate**.</span></span>
17. <span data-ttu-id="5cd02-200">В области **Перевод текста** в поле **Код метки** введите **LBL_LEVELENUM_NO**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-200">In the **Text translation** pane, in the **Label Id** field, enter **LBL_LEVELENUM_NO**.</span></span>
18. <span data-ttu-id="5cd02-201">В поле **Текст на языке по умолчанию** введите **Нет налогообложения**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-201">In the **Text in default language** field, enter **No taxation**.</span></span>
19. <span data-ttu-id="5cd02-202">В поле **Язык** выберите **DE**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-202">In the **Language** field, select **DE**.</span></span>
20. <span data-ttu-id="5cd02-203">В поле **Переведенный текст** введите **keine Besteuerung**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-203">In the **Translated text** field, enter **keine Besteuerung**.</span></span>
21. <span data-ttu-id="5cd02-204">Выберите **Перевести**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-204">Select **Translate**.</span></span>

    ![Раскрывающийся список перевода текста](./media/RCS-AppSpecParms-ConfigureFormat-EnumTranslate.PNG)

22. <span data-ttu-id="5cd02-206">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-206">Select **Save**.</span></span>
23. <span data-ttu-id="5cd02-207">Закройте страницу **Перечисления форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-207">Close the **Format enumerations** page.</span></span>

### <a name="add-a-new-lookup-data-source"></a><span data-ttu-id="5cd02-208">Добавление нового источника данных поиска</span><span class="sxs-lookup"><span data-stu-id="5cd02-208">Add a new lookup data source</span></span>

<span data-ttu-id="5cd02-209">Далее необходимо добавить новый источник данных, чтобы указать, как бизнес-пользователи будут задавать правила, зависящие от компании, чтобы определить правильный уровень налогообложения для каждой суммарной записи проводки.</span><span class="sxs-lookup"><span data-stu-id="5cd02-209">Next, you will add a new data source to specify how business users will specify legal entity–dependent rules to recognize the correct taxation level for each summarized transaction record.</span></span>

1.  <span data-ttu-id="5cd02-210">На вкладке **Сопоставление** выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-210">On the **Mapping** tab, select **Add**.</span></span>
2.  <span data-ttu-id="5cd02-211">Выберите **Перечисление/поиск форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-211">Select **Format enumeration\Lookup**.</span></span>

    <span data-ttu-id="5cd02-212">Только что было определено, что каждое правило, указанное бизнес-пользователями для распознавания на уровне налогообложения, возвратит значение перечисления формата ER.</span><span class="sxs-lookup"><span data-stu-id="5cd02-212">You just identified that each rule that business users specify for taxation level recognition will return a value of an ER format enumeration.</span></span> <span data-ttu-id="5cd02-213">Обратите внимание на то, что тип источника данных **Поиск** может быть доступен в **модели данных** и блоках **Dynamics 365 for Operations** в дополнение к блоку **Перечисление форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-213">Notice that the **Lookup** data source type can be accessed under the **Data model** and **Dynamics 365 for Operations** blocks in addition to the **Format enumeration** block.</span></span> <span data-ttu-id="5cd02-214">Таким образом, перечисления модели данных ER и перечисления приложений могут использоваться для указания типа значений, которые возвращаются для источников данных этого типа.</span><span class="sxs-lookup"><span data-stu-id="5cd02-214">Therefore, ER data model enumerations and application enumerations can be used to specify the type of values that is are returned for data sources of that type.</span></span>
    
3.  <span data-ttu-id="5cd02-215">В поле **Имя** введите **Выбор**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-215">In the **Name** field, enter **Selector**.</span></span>
4.  <span data-ttu-id="5cd02-216">В поле **Перечисление форматов** выберите **Список уровней налогообложения**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-216">In the **Format enumeration** field, select **List of taxation levels**.</span></span>

    <span data-ttu-id="5cd02-217">Вы только что указали, что для каждого правила, указанного в этом источнике данных, бизнес-пользователь должен выбрать одно из значений перечисления форматов **Список уровней налогообложения** в качестве возвращенного значения.</span><span class="sxs-lookup"><span data-stu-id="5cd02-217">You just specified that, for each rule that is specified in this data source, a business user must select one of the values of the **List of taxation levels** format enumeration as a returned value.</span></span>
    
5.  <span data-ttu-id="5cd02-218">Выберите **Изменить поиск**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-218">Select **Edit lookup**.</span></span>
6.  <span data-ttu-id="5cd02-219">Выберите **Столбцы**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-219">Select **Columns**.</span></span>
7.  <span data-ttu-id="5cd02-220">Разверните элемент **Model**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-220">Expand the **Model** item.</span></span>
8.  <span data-ttu-id="5cd02-221">Разверните элемент **Данные**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-221">Expand the **Data** item.</span></span>
9.  <span data-ttu-id="5cd02-222">Разверните элемент **Налог**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-222">Expand the **Tax** item.</span></span>
10. <span data-ttu-id="5cd02-223">Выберите элемент **Model.Data.Tax.Code**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-223">Select the **Model.Data.Tax.Code** item.</span></span>
11. <span data-ttu-id="5cd02-224">Нажмите кнопку **Добавить** (стрелка вправо).</span><span class="sxs-lookup"><span data-stu-id="5cd02-224">Select the **Add** button (the right arrow).</span></span>

    ![Раскрывающийся список столбцов](./media/RCS-AppSpecParms-ConfigureFormat-Lookup1.PNG)

    <span data-ttu-id="5cd02-226">Вы только что указали, что для каждого правила, указанного в этом источнике данных для распознавания уровня налогообложения, бизнес-пользователь должен выбрать один из кодов налога в качестве условия.</span><span class="sxs-lookup"><span data-stu-id="5cd02-226">You just specified that, for each rule that is specified in this data source for taxation level recognition, a business user must select one of the tax codes as a condition.</span></span> <span data-ttu-id="5cd02-227">Список налоговых кодов, которые может выбрать пользователь, будет возвращен в источнике данных **Model.Data.Tax**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-227">The list of tax codes that the business user can select will be returned by the **Model.Data.Tax** data source.</span></span> <span data-ttu-id="5cd02-228">Поскольку этот источник данных содержит поле **Имя**, имя налогового кода будет отображаться для каждого значения налогового кода в поиске, представляемом для бизнес-пользователя.</span><span class="sxs-lookup"><span data-stu-id="5cd02-228">Because this data source contains the **Name** field, the name of the tax code will be shown for each tax code value in the lookup that is presented to the business user.</span></span>
    
12. <span data-ttu-id="5cd02-229">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-229">Select **OK**.</span></span>

    ![Страница конструктора подстановок](./media/RCS-AppSpecParms-ConfigureFormat-Lookup2.PNG)

    <span data-ttu-id="5cd02-231">Бизнес-пользователи могут добавить несколько правил в виде записей этого источника данных.</span><span class="sxs-lookup"><span data-stu-id="5cd02-231">Business users can add multiple rules as records of this data source.</span></span> <span data-ttu-id="5cd02-232">Каждая запись будет пронумерована с помощью кода строки.</span><span class="sxs-lookup"><span data-stu-id="5cd02-232">Each record will be numbered by a line code.</span></span> <span data-ttu-id="5cd02-233">Правила будут оценены в порядке возрастания номера строки.</span><span class="sxs-lookup"><span data-stu-id="5cd02-233">Rules will be evaluated in order of increasing line number.</span></span>

    <span data-ttu-id="5cd02-234">Так как в качестве условия для правил в источнике данных поиска выбрано поле **Налоговый код**, и поскольку **Налоговый код** задан как поле типа данных **Строка**, каждое правило будет оцениваться во время выполнения путем сравнения налогового кода, который передается в источник данных, с налоговым кодом, который указан в этой записи источника данных.</span><span class="sxs-lookup"><span data-stu-id="5cd02-234">Because you selected the **Tax code** field as a condition for rules in this lookup data source, and because **Tax code** is set up as a field of the **String** data type, each rule will be evaluated at runtime by comparing the tax code that is passed to the data source with the tax code that is defined in this record of the data source.</span></span>

    <span data-ttu-id="5cd02-235">При обнаружении правила, удовлетворяющего настроенному условию, этот источник данных возвращает значение поиска для правила, которое определено в поле **Результат поиска**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-235">When a rule that satisfies the configured condition is found, this data source returns the lookup value of the rule that is defined in the **Lookup result** field.</span></span> <span data-ttu-id="5cd02-236">Если правило не найдено, выдается исключение, уведомляющее пользователя о том, что текущий источник данных не может вернуть правильное значение.</span><span class="sxs-lookup"><span data-stu-id="5cd02-236">If no rule is found, an exception is thrown to notify the user that the current data source can't return a correct value.</span></span>

13. <span data-ttu-id="5cd02-237">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-237">Select **Save**.</span></span>
14. <span data-ttu-id="5cd02-238">Закройте страницу **Конструктор поиска**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-238">Close the **Lookup designer** page.</span></span>
15. <span data-ttu-id="5cd02-239">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-239">Select **OK**.</span></span>

    <span data-ttu-id="5cd02-240">Обратите внимание, что был добавлен новый источник данных, который будет возвращать уровень налогообложения в виде значения перечисления форматоров **Список уровней налогообложения** для любого налогового кода, который передается в источник данных в качестве аргумента параметра **Код** с типом данных **Строка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-240">Notice that you added a new data source that will return the taxation level as the value of the **List of taxation levels** format enumeration for any tax code that is passed to the data source as the argument of the **Code** parameter of the **String** data type.</span></span>
    
    ![Страница конструктора форматов с новым источником данных](./media/RCS-AppSpecParms-ConfigureFormat-SelectorFld.PNG)

    <span data-ttu-id="5cd02-242">Обратите внимание, что оценка настроенных правил зависит от типа данных полей, которые были выбраны для определения условий этих правил.</span><span class="sxs-lookup"><span data-stu-id="5cd02-242">Note that the evaluation of configured rules depends on the data type of the fields that have been selected to define conditions of those rules.</span></span> <span data-ttu-id="5cd02-243">При выборе поля, настроенного в качестве поля типа **Числовой** или **Данные**, критерии будут отличаться от критериев, описанных выше, для типа данных **Строка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-243">When you select a field that is configured as a field of either the **Numeric** or **Date** data type, the criteria will differ from the criteria that were described earlier for the **String** data type.</span></span> <span data-ttu-id="5cd02-244">Для полей **Числовой** и **Данные** правило должно быть определено как диапазон значений.</span><span class="sxs-lookup"><span data-stu-id="5cd02-244">For **Numeric** and **Date** fields, the rule must be specified as a range of values.</span></span> <span data-ttu-id="5cd02-245">Затем условие правила будет считаться удовлетворенным, когда значение, передаваемое в источник данных, попадает в настроенный диапазон.</span><span class="sxs-lookup"><span data-stu-id="5cd02-245">The condition of the rule will then be considered satisfied when a value that is passed to the data source is in the configured range.</span></span>
    
    <span data-ttu-id="5cd02-246">На следующем рисунке приведен пример этого типа настройки.</span><span class="sxs-lookup"><span data-stu-id="5cd02-246">The following illustration shows an example of this type of setup.</span></span> <span data-ttu-id="5cd02-247">В дополнение к полю **Model.Data.Tax.Code** типа данных **Строка** поле **Model.Tax.Summary.Base** типа данных **Вещественный** используется для определения условий для источника данных поиска.</span><span class="sxs-lookup"><span data-stu-id="5cd02-247">In addition to the **Model.Data.Tax.Code** field of the **String** data type, the **Model.Tax.Summary.Base** field of the **Real** data type is used to specify conditions for a lookup data source.</span></span>
    
    ![Страница конструктора подстановок с дополнительными столбцами](./media/RCS-AppSpecParms-ConfigureFormat-SelectorFld2.PNG)

    <span data-ttu-id="5cd02-249">Так как для этого источника данных поиска выбраны поля **Model.Data.Tax.Code** и **Model.Tax.Summary.Base**, каждое правило этого источника данных будет настроено следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5cd02-249">Because the **Model.Data.Tax.Code** and **Model.Tax.Summary.Base** fields are selected for this lookup data source, each rule of this data source will be configured in the following way:</span></span>
    
    -   <span data-ttu-id="5cd02-250">В представленном списке значение перечисления форматов **Список уровней налогообложения** должно быть выбрано как возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="5cd02-250">In the list that is presented, the value of the **List of taxation levels** format enumeration must be selected as a returned value.</span></span>
    -   <span data-ttu-id="5cd02-251">Налоговый код должен быть введен как условие этого правила.</span><span class="sxs-lookup"><span data-stu-id="5cd02-251">The tax code must be entered as a condition of this rule.</span></span> <span data-ttu-id="5cd02-252">Применимы только налоговые коды, предоставляемые в источнике данных **Model.Data.Tax**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-252">Only tax codes that are provided by the **Model.Data.Tax** data source are applicable.</span></span>
    -   <span data-ttu-id="5cd02-253">Минимальное и максимальное значения базовой суммы налога должны вводиться в качестве условий этого правила.</span><span class="sxs-lookup"><span data-stu-id="5cd02-253">Minimum and maximum values of the tax base amount must be entered as conditions of this rule.</span></span>

    <span data-ttu-id="5cd02-254">Ниже показано, как каждое правило этого источника данных будет оцениваться во время выполнения:</span><span class="sxs-lookup"><span data-stu-id="5cd02-254">Here is how each rule of this data source will be evaluated at runtime:</span></span>
    -   <span data-ttu-id="5cd02-255">Совпадает ли код типа данных **Строка**, переданного в этот источник данных, с кодом налога правила?</span><span class="sxs-lookup"><span data-stu-id="5cd02-255">Does the code of the **String** data type that was passed to this data source equal the tax code of a rule?</span></span>
    -   <span data-ttu-id="5cd02-256">Попадает ли значение типа данных **Вещественный**, переданное в этот источник данных, в интервал между указанными минимальным и максимальным значениями?</span><span class="sxs-lookup"><span data-stu-id="5cd02-256">Does the value of the **Real** data type that was passed to this data source fall between specific minimum and maximum values?</span></span>

    <span data-ttu-id="5cd02-257">Правило будет учитываться как применимое, если удовлетворяются оба условия.</span><span class="sxs-lookup"><span data-stu-id="5cd02-257">A rule will be considered applicable when both conditions are satisfied.</span></span>

### <a name="translate-the-label-of-the-lookup-data-source-that-was-added"></a><span data-ttu-id="5cd02-258">Перевод метки добавленного источника данных поиска</span><span class="sxs-lookup"><span data-stu-id="5cd02-258">Translate the label of the lookup data source that was added</span></span>

<span data-ttu-id="5cd02-259">Так как бизнес-пользователи могут использовать другие языки для указания зависящих от компании наборов налоговых кодов, рекомендуется перевести этикетку добавляемого источника данных поиска, чтобы она отображалась на предпочитаемом языке пользователя на соответствующей странице.</span><span class="sxs-lookup"><span data-stu-id="5cd02-259">Because business users might use different languages to specify legal entity–dependent sets of tax codes, we recommend that you translate the label of any lookup data source that you add, so that it's presented in each user's preferred language on the corresponding page.</span></span>

1.  <span data-ttu-id="5cd02-260">Выберите источник данных **Model.Data.Selector**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-260">Select the **Model.Data.Selector** data source.</span></span>
2.  <span data-ttu-id="5cd02-261">Выберите **Правка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-261">Select **Edit**.</span></span>
3.  <span data-ttu-id="5cd02-262">Щелкните поле **Метка**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-262">Click in the **Label** field.</span></span>
4.  <span data-ttu-id="5cd02-263">Выберите **Перевести**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-263">Select **Translate**.</span></span>
5.  <span data-ttu-id="5cd02-264">В области **Перевод текста** в поле **Код метки** введите **LBL_SELECTOR_DS**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-264">In the **Text translation** pane, in the **Label Id** field, enter **LBL_SELECTOR_DS**.</span></span>
6.  <span data-ttu-id="5cd02-265">В поле **Текст на языке по умолчанию** введите **Выбрать уровень налогообложения по коду налога**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-265">In the **Text in default language** field, enter **Select tax level by tax code**.</span></span>
7.  <span data-ttu-id="5cd02-266">В поле **Язык** выберите **DE**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-266">In the **Language** field, select **DE**.</span></span>
8.  <span data-ttu-id="5cd02-267">В поле **Переведенный текст** введите **Steuerebene für Steuerkennzeichen auswählen**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-267">In the **Translated text** field, enter **Steuerebene für Steuerkennzeichen auswählen**.</span></span>
9.  <span data-ttu-id="5cd02-268">Выберите **Перевести**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-268">Select **Translate**.</span></span>
10. <span data-ttu-id="5cd02-269">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-269">Select **OK**.</span></span>

    ![Раскрывающийся список свойств источника данных](./media/RCS-AppSpecParms-ConfigureFormat-SelectorFldTranslate.PNG)

### <a name="add-a-new-field-to-consume-the-configured-lookup"></a><span data-ttu-id="5cd02-271">Добавление нового поля для использования настроенного поиска</span><span class="sxs-lookup"><span data-stu-id="5cd02-271">Add a new field to consume the configured lookup</span></span>

1.  <span data-ttu-id="5cd02-272">Разверните элемент **Model.Data**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-272">Expand the **Model.Data** item.</span></span>
2.  <span data-ttu-id="5cd02-273">Выберите элемент **Model.Data.Summary**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-273">Select the **Model.Data.Summary** item.</span></span>
3.  <span data-ttu-id="5cd02-274">Выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-274">Select **Add**.</span></span>
4.  <span data-ttu-id="5cd02-275">Выберите **Функции/Вычисляемое поле**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-275">Select **Functions/Calculated field**.</span></span>
5.  <span data-ttu-id="5cd02-276">В поле **Имя** введите **LevelByLookup**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-276">In the **Name** field, enter **LevelByLookup**.</span></span>
6.  <span data-ttu-id="5cd02-277">Выберите **Изменить формулу**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-277">Select **Edit formula**.</span></span>
7.  <span data-ttu-id="5cd02-278">В поле **Формула** введите **Model.Selector(Model.Data.Summary.Code)**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-278">In the **Formula field**, enter **Model.Selector(Model.Data.Summary.Code)**.</span></span>
8.  <span data-ttu-id="5cd02-279">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-279">Select **Save**.</span></span>

    ![Добавление Model.Selector(Model.Data.Summary.Code) на страницу конструктора формул](./media/RCS-AppSpecParms-ConfigureFormat-AddLevelByLookupFld.PNG)

9.  <span data-ttu-id="5cd02-281">Закройте страницу **Редактор формул**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-281">Close the **Formula editor** page.</span></span>
10. <span data-ttu-id="5cd02-282">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-282">Select **OK**.</span></span>

    ![Страница конструктора форматов с добавленной новой формулой](./media/RCS-AppSpecParms-ConfigureFormat-AddLevelByLookupFld2.PNG)

    <span data-ttu-id="5cd02-284&quot;>Обратите внимание, что добавленное вычисляемое поле **LevelByLookup** будет возвращать уровень налогообложения как значение перечисления форматов **Список уровней налогообложения** для каждой сводной записи налоговых проводок.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-284&quot;>Notice that the **LevelByLookup** calculated field that you added will return the taxation level as the value of the **List of taxation levels** format enumeration for each summarized tax transactions record.</span></span> <span data-ttu-id=&quot;5cd02-285&quot;>Налоговый код записи будет передан в источник данных поиска **Model.Selector**, и набор правил для этого источника данных будет использоваться для выбора правильного уровня налогообложения.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-285&quot;>The tax code of the record will be passed to the **Model.Selector** lookup data source, and the set of rules for this data source will be used to select the correct taxation level.</span></span>

### <a name=&quot;add-a-new-format-enumeration-based-data-source&quot;></a><span data-ttu-id=&quot;5cd02-286&quot;>Добавление нового источника данных на основе перечисления форматов</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-286&quot;>Add a new format enumeration-based data source</span></span>

<span data-ttu-id=&quot;5cd02-287&quot;>Далее будет добавлен новый источник данных, относящийся к перечислению форматов, добавленному ранее.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-287&quot;>Next, you will add a new data source that refers to the format enumeration that you added earlier.</span></span> <span data-ttu-id=&quot;5cd02-288&quot;>Значения этого источника данных будут использоваться в выражении формата ER позднее.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-288&quot;>Values of this data source will be used in an ER format expression later.</span></span>

1.  <span data-ttu-id=&quot;5cd02-289&quot;>Выберите **Добавить корень**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-289&quot;>Select **Add root**.</span></span>
2.  <span data-ttu-id=&quot;5cd02-290&quot;>Выберите **Перечисление форматов/перечисление**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-290&quot;>Select **Format enumerations\Enumeration**.</span></span>
3.  <span data-ttu-id=&quot;5cd02-291&quot;>В поле **Имя** введите **TaxationLevel**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-291&quot;>In the **Name** field, enter **TaxationLevel**.</span></span>
4.  <span data-ttu-id=&quot;5cd02-292&quot;>В поле **Перечисление форматов** выберите **Список уровней налогообложения**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-292&quot;>In the **Format enumeration** field, select **List of taxation levels**.</span></span>
5.  <span data-ttu-id=&quot;5cd02-293&quot;>Нажмите **Сохранить**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-293&quot;>Select **Save**.</span></span>

### <a name=&quot;modify-an-existing-field-to-start-to-use-the-lookup&quot;></a><span data-ttu-id=&quot;5cd02-294&quot;>Измените существующее поле, чтобы начать использовать поиск</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-294&quot;>Modify an existing field to start to use the lookup</span></span>

<span data-ttu-id=&quot;5cd02-295&quot;>Далее будет изменено существующее вычисляемое поле, чтобы оно использовало настроенный источник данных поиска для возврата значения налогообложения в зависимости от налогового кода.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-295&quot;>Next, you will modify the existing calculated field so that it uses the configured lookup data source to return the correct taxation level value, depending on the tax code.</span></span>

1.  <span data-ttu-id=&quot;5cd02-296&quot;>Выберите элемент **Model.Data.Summary.Level**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-296&quot;>Select the **Model.Data.Summary.Level** item.</span></span>
2.  <span data-ttu-id=&quot;5cd02-297&quot;>Выберите **Правка**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-297&quot;>Select **Edit**.</span></span>
3.  <span data-ttu-id=&quot;5cd02-298&quot;>Выберите **Изменить формулу**.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-298&quot;>Select **Edit formula**.</span></span>

    <span data-ttu-id=&quot;5cd02-299&quot;>Обратите внимание, что текущее выражение поля **Model.Data.Summary.Level** включает следующие жестко запрограммированные налоговые коды:</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;5cd02-299&quot;>Notice that the current expression of the **Model.Data.Summary.Level** field includes the following hard-coded tax codes:</span></span>
    
    <span data-ttu-id=&quot;5cd02-300&quot;>CASE (@.Code, &quot;VAT19&quot;, &quot;Обычный&quot;, &quot;InVAT19&quot;, &quot;Обычный&quot;, &quot;VAT7&quot;, &quot;Сокращенный&quot;, &quot;InVAT7&quot;, &quot;Сокращенный&quot;, &quot;THIRD&quot;, &quot;Нет&quot;, &quot;InVAT0&quot;, &quot;Нет&quot;, &quot;Другой")</span><span class="sxs-lookup"><span data-stu-id="5cd02-300">CASE (@.Code, "VAT19", "Regular", "InVAT19", "Regular", "VAT7", "Reduced", "InVAT7", "Reduced", "THIRD", "None", "InVAT0", "None", "Other")</span></span>

4.  <span data-ttu-id="5cd02-301">В поле **Формула** введите **CASE(@.LevelByLookup, TaxationLevel.'Regular taxation', "Regular", TaxationLevel.'Reduced taxation', "Reduced", TaxationLevel.'No taxation', "None", "Other")**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-301">In the **Formula** field, enter **CASE(@.LevelByLookup, TaxationLevel.'Regular taxation', "Regular", TaxationLevel.'Reduced taxation', "Reduced", TaxationLevel.'No taxation', "None", "Other")**.</span></span>

    ![Страница конструктора операций ER](./media/RCS-AppSpecParms-ConfigureFormat-ChangeLookupFld.PNG)
    
    <span data-ttu-id="5cd02-303">Обратите внимание, что выражение в поле **Model.Data.Summary.Level** теперь возвращает уровень налогообложения на основе налогового кода текущей записи и набора правил, которые бизнес-пользователь настраивает в источнике данных поиска **Model.Data.Selector**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-303">Notice that the expression of the **Model.Data.Summary.Level** field will now return the taxation level, based on the tax code of the current record and the set of rules that that a business user configures in the **Model.Data.Selector** lookup data source.</span></span>
    
5.  <span data-ttu-id="5cd02-304">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-304">Select **Save**.</span></span>
6.  <span data-ttu-id="5cd02-305">Закройте страницу **Конструктор формул**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-305">Close **Formula designer** page.</span></span>
7.  <span data-ttu-id="5cd02-306">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-306">Select **OK**.</span></span>
8.  <span data-ttu-id="5cd02-307">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-307">Select **Save**.</span></span>
9.  <span data-ttu-id="5cd02-308">Закройте страницу **Конструктор форматов**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-308">Close **Format designer** page.</span></span>

## <a name="complete-the-draft-version-of-a-derived-format"></a><span data-ttu-id="5cd02-309">Завершение черновой версии производного формата</span><span class="sxs-lookup"><span data-stu-id="5cd02-309">Complete the draft version of a derived format</span></span>

1.  <span data-ttu-id="5cd02-310">На экспресс-вкладке **Версии** выберите **Изменить статус**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-310">On the **Versions** FastTab, select **Change status**.</span></span>
2.  <span data-ttu-id="5cd02-311">Выберите **Завершено**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-311">Select **Complete**.</span></span>
3.  <span data-ttu-id="5cd02-312">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-312">Select **OK**.</span></span>

## <a name="export-completed-version-of-modified-format"></a><span data-ttu-id="5cd02-313">Экспорт завершенной версии измененного формата</span><span class="sxs-lookup"><span data-stu-id="5cd02-313">Export completed version of modified format</span></span>

1.  <span data-ttu-id="5cd02-314">В дереве конфигурации выберите элемент **Формат для изучения поиска данных LE**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-314">In the configuration tree, select the **Format to learn how to lookup LE data** item.</span></span>
2.  <span data-ttu-id="5cd02-315">На экспресс-вкладке **Версии** выберите запись со статусом **Завершено**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-315">On the **Versions** FastTab, select the record that has a status of **Completed**.</span></span>
3.  <span data-ttu-id="5cd02-316">Выберите **Обменять**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-316">Select **Exchange**.</span></span>
4.  <span data-ttu-id="5cd02-317">Выберите **Экспорт в виде XML-файла**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-317">Select **Export as XML file**.</span></span>
5.  <span data-ttu-id="5cd02-318">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-318">Select **OK**.</span></span>
6.  <span data-ttu-id="5cd02-319">Веб-браузер загружает файл **Format to learn how to lookup LE data.xml**.</span><span class="sxs-lookup"><span data-stu-id="5cd02-319">The web browser downloads a **Format to learn how to lookup LE data.xml** file.</span></span> <span data-ttu-id="5cd02-320">Сохраните этот файл локально.</span><span class="sxs-lookup"><span data-stu-id="5cd02-320">Store this file locally.</span></span>

<span data-ttu-id="5cd02-321">Повторите шаги в этом разделе для родительских элементов формата **Формат для изучения поиска данных LE** и сохраните следующие файлы локально:</span><span class="sxs-lookup"><span data-stu-id="5cd02-321">Repeat steps in this section for parent items of the **Format to learn how to lookup LE data** format, and store the following files locally:</span></span>

-   <span data-ttu-id="5cd02-322">Формат для изучения параметризованных вызовов.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-322">Format to learn parameterized calls.xml</span></span>
-   <span data-ttu-id="5cd02-323">Сопоставление для изучения параметризованных вызовов.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-323">Mapping to learn parameterized calls.xml</span></span>
-   <span data-ttu-id="5cd02-324">Модели для изучения параметризованных вызовов.xml</span><span class="sxs-lookup"><span data-stu-id="5cd02-324">Model to learn parameterized calls.xml</span></span>

<span data-ttu-id="5cd02-325">Чтобы узнать, как использовать настроенный формат ER **Формат для изучения поиска данных LE** для настройки наборов налоговых кодов для юридического лица для фильтрации налоговых проводок с разными уровнями налогообложения, выполните шаги в разделе [Настройка параметров формата ER для юридического лица](er-app-specific-parameters-set-up.md).</span><span class="sxs-lookup"><span data-stu-id="5cd02-325">To learn how to use the configured **Format to learn how to lookup LE data** ER format to set up legal entity–dependent sets of tax codes to filter tax transactions by different taxation levels, complete the steps in the [Set up the parameters of an ER format per legal entity](er-app-specific-parameters-set-up.md) topic.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="5cd02-326">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="5cd02-326">Additional resources</span></span>

[<span data-ttu-id="5cd02-327">Конструктор формул в электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="5cd02-327">Formula designer in Electronic reporting</span></span>](general-electronic-reporting-formula-designer.md)

[<span data-ttu-id="5cd02-328">Настройка параметров формата ER для юридического лица</span><span class="sxs-lookup"><span data-stu-id="5cd02-328">Set up the parameters of an ER format per legal entity</span></span>](er-app-specific-parameters-set-up.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
