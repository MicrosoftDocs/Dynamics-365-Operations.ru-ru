---
title: Очистка миграции ER
description: В этой теме объясняется, как использовать функцию очистки ER после миграции для разрешения проблем с шаблонами ER.
author: NickSelin
ms.date: 04/29/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, ERWorkspace, ERParameters, ERMigrationCleanup
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-01-01
ms.dyn365.ops.version: AX 8.0.0
ms.openlocfilehash: 8b6e81e47cd781bbe856676b1cecb50b8ee1adfc
ms.sourcegitcommit: c08a9d19eed1df03f32442ddb65a2adf1473d3b6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2021
ms.locfileid: "6351057"
---
# <a name="er-migration-cleanup"></a>Очистка миграции ER 

[!include[banner](../includes/banner.md)]

При управлении экземплярами Finance можно выполнить миграцию текущего экземпляра в другое местоположение. Например, можно перенести производственный экземпляр в новую среду "песочницы". Если платформа электронной отчетности (ER) настроена для хранения шаблонов в хранилище BLOB-объектов Microsoft Azure, таблица **DocuValue** в новой среде "песочницы" ссылается на экземпляр хранилища BLOB-объектов в производственной среде. Однако доступ к этому экземпляру из среды "песочницы" невозможен, поскольку процесс миграции не поддерживает миграцию артефактов в хранилище BLOB-объектов. Скорее всего, в новой среде "песочницы" вы ссылаетесь на экземпляр хранилища BLOB-объектов в среде "песочницы", где еще не получены шаблоны ER.

При попытке выполнить формат ER, использующий шаблон, для создания деловых документов, происходит исключение, и вы получаете уведомление об отсутствующем шаблоне. Кроме того, вам предлагается воспользоваться очисткой миграции ER, чтобы удалить и затем повторно импортировать конфигурацию формата ER, содержащую данный шаблон.

[![Выполнение формата ER.](./media/er-migration-cleanup-run.png)](./media/er-migration-cleanup-run.png)

Аналогичная ошибка будет получена при переходе на страницу **Конфигурации** (**Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**) и попытке удалить конфигурацию формата ER, использующую шаблон, в дереве конфигураций.

[![Удаление формата ER.](./media/er-migration-cleanup-delete.png)](./media/er-migration-cleanup-delete.png)

Выполните следующие действия для устранения проблем с шаблонами ER, к которым невозможно получить доступ.

1.  Перейдите на страницу **Администрирование организации** \> **Периодические** \> **Очистка миграции**.
2.  Выберите конфигурацию формата ER, которую невозможно выполнить или удалить.
3.  Выберите **Удалить**.
4.  Подтвердите удаление выбранной конфигурации формата ER.
5.  [Импортируйте](download-electronic-reporting-configuration-lcs.md) удаленную конфигурацию формата ER в текущий экземпляр Finance.

## <a name="applicability"></a>Применимость

> [Важно] Параметр **Очистка миграции** предназначен только для конфигураций формата ER, которые содержат недоступные шаблоны ER. При удалении конфигурации формата ER с помощью параметра **Очистка миграции** ER удаляет шаблоны, которые относятся к артефактам конфигурации в единственной базе данных приложения. Существование соответствующих физических файлов в хранилище BLOB-объектов не проверяется. Вместо этого предполагается, что их нет. Поэтому не рекомендуется использовать параметр **Очистка миграции** в качестве альтернативы удалению конфигурации ER на странице **Конфигурации**. Используйте параметр **Очистка миграции** только в том случае, если вам не удалось удалить конфигурацию ER на странице **Конфигурации**.
>
> При удалении конфигурации формата ER с помощью параметра **Очистка миграции**, если соответствующий шаблон доступен в хранилище BLOB-объектов, вы удаляете только артефакты конфигурации в базе данных приложения. Физический файл шаблона в хранилище BLOB-объектов остается. Перезапись файлов в хранилище BLOB-объектов больше не разрешена. Дополнительные сведения см. в статье [KB4557217](https://fix.lcs.dynamics.com/Issue/Details?kb=4557217). Кроме того, вы больше не сможете повторно импортировать конфигурации, удаленные с помощью очистки миграции в этой среде. Чтобы решить эту проблему, необходимо найти соответствующий файл в хранилище BLOB-объектов и вручную удалить его.

[![Импорт формата ER.](./media/er-migration-cleanup-import.png)](./media/er-migration-cleanup-import.png)

Аналогичная проблема возникает, если вы перемещаете экземпляр приложения в другое местоположение, которое использовалось в качестве цели миграции несколько раз, и для которого хранилище BLOB-объектов уже содержит файлы шаблонов ER.

Поскольку может иметься несколько конфигураций формата ER, этот процесс может занять много времени. Поэтому рекомендуется использовать функцию [хранения резервных копий шаблонов ER](er-backup-storage-templates.md) для автоматического восстановления шаблонов с поврежденными ссылками.


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]