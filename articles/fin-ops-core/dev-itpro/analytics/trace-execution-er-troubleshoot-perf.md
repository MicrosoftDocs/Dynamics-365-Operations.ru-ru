---
title: Трассировка выполнения форматов электронной отчетности для устранения неполадок, связанных с производительностью
description: В этой теме приводятся сведения об использовании функции трассировки производительности в электронной отчетности (ER) для устранения проблем с производительностью.
author: NickSelin
manager: AnnBe
ms.date: 06/12/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.1
ms.openlocfilehash: 6585e44701160bf31c107c07226f992b12cf035e
ms.sourcegitcommit: 75db3b75d35d27034f9b56e7119c9d0cb7666830
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2019
ms.locfileid: "2550656"
---
# <a name="trace-the-execution-of-er-formats-to-troubleshoot-performance-issues"></a><span data-ttu-id="c31e8-103">Трассировка выполнения форматов электронной отчетности для устранения проблем с производительностью</span><span class="sxs-lookup"><span data-stu-id="c31e8-103">Trace the execution of ER formats to troubleshoot performance issues</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="c31e8-104">В процессе разработки конфигураций электронной отчетности (ER) для создания электронных документов определяется метод, используемый для извлечения данных из приложения и ввода их в создаваемые выводные данные.</span><span class="sxs-lookup"><span data-stu-id="c31e8-104">As part of the process of designing Electronic reporting (ER) configurations to generate electronic documents, you define the method that is used to get data out of the application and enter it in the output that is generated.</span></span> <span data-ttu-id="c31e8-105">Функция трассировки производительности электронной отчетности позволяет значительно сократить время и затраты, связанные со сбором сведений о выполнении формата ER, и использовать их для устранения неполадок, связанных с производительностью.</span><span class="sxs-lookup"><span data-stu-id="c31e8-105">The ER performance trace feature helps significantly reduce the time and cost that are involved in collecting the details of ER format execution and using them to troubleshoot performance issues.</span></span> <span data-ttu-id="c31e8-106">В этом учебнике приводятся инструкции по выполнению трассировки производительности для выполняемых форматов электронной отчетности, а также по использованию сведений из этих трассировок для повышения производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-106">This tutorial provides guidelines about how to take performance traces for executed ER formats, and how to use the information from these traces to help improve performance.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c31e8-107">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="c31e8-107">Prerequisites</span></span>

<span data-ttu-id="c31e8-108">Чтобы завершить примеры из этого учебника, необходимы следующие возможности доступа:</span><span class="sxs-lookup"><span data-stu-id="c31e8-108">To complete the examples in this tutorial, you must have the following access:</span></span>

- <span data-ttu-id="c31e8-109">Доступ к одной из следующих ролей:</span><span class="sxs-lookup"><span data-stu-id="c31e8-109">Access to one of the following roles:</span></span>

    - <span data-ttu-id="c31e8-110">Разработчик электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-110">Electronic reporting developer</span></span>
    - <span data-ttu-id="c31e8-111">Консультант по функциональным возможностям электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-111">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="c31e8-112">Системный администратор</span><span class="sxs-lookup"><span data-stu-id="c31e8-112">System administrator</span></span>

- <span data-ttu-id="c31e8-113">Доступ к экземпляру служб Regulatory Configuration Service (RCS), который был настроен для того же клиента, что и приложение, для одной из следующих ролей:</span><span class="sxs-lookup"><span data-stu-id="c31e8-113">Access to the instance of Regulatory Configuration Services (RCS) that has been provisioned for the same tenant as the application, for one of the following roles:</span></span>

    - <span data-ttu-id="c31e8-114">Разработчик электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="c31e8-115">Консультант по функциональным возможностям электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="c31e8-116">Системный администратор</span><span class="sxs-lookup"><span data-stu-id="c31e8-116">System administrator</span></span>

<span data-ttu-id="c31e8-117">Кроме того, необходимо загрузить следующие файлы и сохранить их локально.</span><span class="sxs-lookup"><span data-stu-id="c31e8-117">You must also download and locally store the following files.</span></span>

| <span data-ttu-id="c31e8-118">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="c31e8-118">File</span></span>                                  | <span data-ttu-id="c31e8-119">Содержание</span><span class="sxs-lookup"><span data-stu-id="c31e8-119">Content</span></span>                               |
|---------------------------------------|---------------------------------------|
| <span data-ttu-id="c31e8-120">Модель трассировки производительности.версия.1</span><span class="sxs-lookup"><span data-stu-id="c31e8-120">Performance trace model.version.1</span></span>     | [<span data-ttu-id="c31e8-121">Пример конфигурации модели данных электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-121">Sample ER data model configuration</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg)    |
| <span data-ttu-id="c31e8-122">Метаданные трассировки производительности.версия.1</span><span class="sxs-lookup"><span data-stu-id="c31e8-122">Performance trace metadata.version.1</span></span>  | [<span data-ttu-id="c31e8-123">Пример конфигурации метаданных электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-123">Sample ER metadata configuration</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg)      |
| <span data-ttu-id="c31e8-124">Сопоставление трассировки производительности.версия.1.1</span><span class="sxs-lookup"><span data-stu-id="c31e8-124">Performance trace mapping.version.1.1</span></span> | [<span data-ttu-id="c31e8-125">Пример конфигурации сопоставления модели электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-125">Sample ER model mapping configuration</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg) |
| <span data-ttu-id="c31e8-126">Формат трассировки производительности.версия.1.1</span><span class="sxs-lookup"><span data-stu-id="c31e8-126">Performance trace format.version.1.1</span></span>  | [<span data-ttu-id="c31e8-127">Пример конфигурации формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-127">Sample ER format configuration</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg)       |

### <a name="configure-er-parameters"></a><span data-ttu-id="c31e8-128">Настройка параметров ER</span><span class="sxs-lookup"><span data-stu-id="c31e8-128">Configure ER parameters</span></span>

<span data-ttu-id="c31e8-129">Каждая трассировка производительности электронной отчетности, созданная в приложении, сохраняется в виде вложения в записи журнала выполнения.</span><span class="sxs-lookup"><span data-stu-id="c31e8-129">Each ER performance trace that is generated in the application is stored as an attachment of the execution log record.</span></span> <span data-ttu-id="c31e8-130">Для управления этими вложениями используется структура управления документооборотом (DM).</span><span class="sxs-lookup"><span data-stu-id="c31e8-130">The Document management (DM) framework is used to manage these attachments.</span></span> <span data-ttu-id="c31e8-131">Необходимо заранее настроить параметры электронной отчетности, чтобы указать тип документа DM, который должен использоваться для вложения трассировок производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-131">You must configure ER parameters in advance, to specify the DM document type that should be used to attach performance traces.</span></span> <span data-ttu-id="c31e8-132">В рабочей области **Электронная отчетность** выберите **Параметры электронной отчетности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-132">In the **Electronic reporting** workspace, select **Electronic reporting parameters**.</span></span> <span data-ttu-id="c31e8-133">Затем на странице **Параметры электронной отчетности** на вкладке **Вложения** в поле **Прочие** выберите тип документа DM, который будет использоваться для трассировок производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-133">Then, on the **Electronic reporting parameters** page, on the **Attachments** tab, in the **Others** field, select the DM document type to use for performance traces.</span></span>

![Страница параметров электронной отчетности](./media/GER-PerfTrace-GER-Parameters-DocumentType.png)

<span data-ttu-id="c31e8-135">Чтобы тип документа DM был доступным в поле подстановки **Прочие**, он должен быть настроен следующим образом на странице **Типы документов** (**Администрирование организации \> Управление документами \> Типы документов**):</span><span class="sxs-lookup"><span data-stu-id="c31e8-135">To be available in the **Others** lookup field, a DM document type must be configured in the following manner on the **Document types** page (**Organization administration \> Document management \> Document types**):</span></span>

- <span data-ttu-id="c31e8-136">**Класс:** Вложить файл</span><span class="sxs-lookup"><span data-stu-id="c31e8-136">**Class:** Attach file</span></span>
- <span data-ttu-id="c31e8-137">**Группа:** Файл</span><span class="sxs-lookup"><span data-stu-id="c31e8-137">**Group:** File</span></span>

![Страница типов документов](./media/GER-PerfTrace-DM-DocumentType.png)

> [!NOTE]
> <span data-ttu-id="c31e8-139">Выбранный тип документа должен быть доступен в каждой компании в текущем экземпляре, поскольку вложения DM являются специфическими для компании.</span><span class="sxs-lookup"><span data-stu-id="c31e8-139">The selected document type must be available in every company of the current instance, because DM attachments are company-specific.</span></span>

### <a name="configure-rcs-parameters"></a><span data-ttu-id="c31e8-140">Настройка параметров RCS</span><span class="sxs-lookup"><span data-stu-id="c31e8-140">Configure RCS parameters</span></span>

<span data-ttu-id="c31e8-141">Создаваемые трассировки производительности электронной отчетности будет импортированы в службу RCS для анализа с помощью конструктора форматов электронной отчетности и конструктора сопоставления электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-141">ER performance traces that are generated will be imported into RCS for analysis by using the ER format designer and the ER mapping designer.</span></span> <span data-ttu-id="c31e8-142">Так как трассировки производительности электронной отчетности хранятся в виде вложений в запись журнала выполнения, которая относится к формату электронной отчетности, необходимо заранее настроить параметры службы RCS, чтобы указать тип документа DM, который должен использоваться для присоединения трассировок производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-142">Because ER performance traces are stored as attachments of the execution log record that is related to the ER format, you must configure RCS parameters in advance, to specify the DM document type that should be used to attach performance traces.</span></span> <span data-ttu-id="c31e8-143">В экземпляре службы RCS, который был подготовлен для компании, в рабочей области **Электронная отчетность** выберите **Параметры электронной отчетности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-143">In the instance of RCS that has been provisioned for your company, in the **Electronic reporting** workspace, select **Electronic reporting parameters**.</span></span> <span data-ttu-id="c31e8-144">Затем на странице **Параметры электронной отчетности** на вкладке **Вложения** в поле **Прочие** выберите тип документа DM, который будет использоваться для трассировок производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-144">Then, on the **Electronic reporting parameters** page, on the **Attachments** tab, in the **Others** field, select the DM document type to use for performance traces.</span></span>

![Страница параметров электронной отчетности в службе RCS](./media/GER-PerfTrace-RCS-Parameters-DocumentType.png)

<span data-ttu-id="c31e8-146">Чтобы тип документа DM был доступным в поле подстановки **Прочие**, он должен быть настроен следующим образом на странице **Типы документов** (**Администрирование организации \> Управление документами \> Типы документов**):</span><span class="sxs-lookup"><span data-stu-id="c31e8-146">To be available in the **Others** lookup field, a DM document type must be configured in the following manner on the **Document types** page (**Organization administration \> Document management \> Document types**):</span></span>

- <span data-ttu-id="c31e8-147">**Класс:** Вложить файл</span><span class="sxs-lookup"><span data-stu-id="c31e8-147">**Class:** Attach file</span></span>
- <span data-ttu-id="c31e8-148">**Группа:** Файл</span><span class="sxs-lookup"><span data-stu-id="c31e8-148">**Group:** File</span></span>

## <a name="design-an-er-solution"></a><span data-ttu-id="c31e8-149">Разработка решения электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-149">Design an ER solution</span></span>

<span data-ttu-id="c31e8-150">Предположим, что вы приступили к разработке нового решения ER для создания нового отчета, представляющего проводки по поставщику.</span><span class="sxs-lookup"><span data-stu-id="c31e8-150">Assume that you've started to design a new ER solution to generate a new report that presents vendor transactions.</span></span> <span data-ttu-id="c31e8-151">В настоящее время на странице **Проводки по поставщику** можно найти проводки для выбранного поставщика (перейдите по пути **Расчеты с поставщиками \> Поставщики \> Все поставщики**, выберите поставщика, затем на панели операций на вкладке **Поставщик** в группе **Проводки** выберите **Проводки**).</span><span class="sxs-lookup"><span data-stu-id="c31e8-151">Currently, you can find the transactions for a selected vendor on the **Vendor transactions** page (go to **Account payable \> Vendors \> All vendors**, select a vendor, and then, on the Action Pane, on the **Vendor** tab, in the **Transactions** group, select **Transactions**).</span></span> <span data-ttu-id="c31e8-152">Однако необходимо иметь одновременно все проводки поставщика в одном электронном документе в формате XML.</span><span class="sxs-lookup"><span data-stu-id="c31e8-152">However, you want to have all vendor transaction at the same time in one electronic document in XML format.</span></span> <span data-ttu-id="c31e8-153">Это решение будет состоять из нескольких конфигураций ER, которые содержат требуемую модель данных, метаданные, сопоставление моделей и компоненты формата.</span><span class="sxs-lookup"><span data-stu-id="c31e8-153">This solution will consist of several ER configurations that contain the required data model, metadata, model mapping, and format components.</span></span>

1. <span data-ttu-id="c31e8-154">Выполните вход в экземпляр службы RCS, который был подготовлен для вашей компании.</span><span class="sxs-lookup"><span data-stu-id="c31e8-154">Sign in to the instance of RCS that has been provisioned for your company.</span></span>
2. <span data-ttu-id="c31e8-155">В этом учебнике вам предстоит создать и изменить конфигурации для демонстрационной компании **Litware, Inc**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-155">In this tutorial, you will create and modify configurations for the **Litware, Inc.** sample company.</span></span> <span data-ttu-id="c31e8-156">Поэтому убедитесь, что данный поставщик конфигурации был добавлен в RCS и выбран как активный.</span><span class="sxs-lookup"><span data-stu-id="c31e8-156">Therefore, make sure that this configuration provider has been added to RCS and selected as active.</span></span> <span data-ttu-id="c31e8-157">Инструкции см. в процедуре [Создание поставщиков конфигураций и пометка их как активных](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/analytics/tasks/er-configuration-provider-mark-it-active-2016-11).</span><span class="sxs-lookup"><span data-stu-id="c31e8-157">For instructions, see the [Create configuration providers and mark them as active](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/analytics/tasks/er-configuration-provider-mark-it-active-2016-11) procedure.</span></span>
3. <span data-ttu-id="c31e8-158">В рабочей области **Электронная отчетность** выберите плитку **Конфигурации отчетности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-158">In the **Electronic reporting** workspace, select the **Reporting configurations** tile.</span></span>
4. <span data-ttu-id="c31e8-159">На странице **Конфигурации** импортируйте конфигурации электронной отчетности, загруженные в качестве необходимого компонента в RCS, в следующем порядке: модель данных, метаданные, сопоставление моделей, формат.</span><span class="sxs-lookup"><span data-stu-id="c31e8-159">On the **Configurations** page, import the ER configurations that you downloaded as a prerequisite into RCS, in the following order: data model, metadata, model mapping, format.</span></span> <span data-ttu-id="c31e8-160">Для каждой конфигурации выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="c31e8-160">For each configuration, follow these steps:</span></span>

    1. <span data-ttu-id="c31e8-161">На панели действий выберите пункт **Обмен \> Загрузить из XML-файла**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-161">On the Action Pane, select **Exchange \> Load from XML file**.</span></span>
    2. <span data-ttu-id="c31e8-162">Выберите **Обзор**, чтобы выбрать соответствующий файл для требуемой конфигурации ER в формате XML.</span><span class="sxs-lookup"><span data-stu-id="c31e8-162">Select **Browse** to select the appropriate file for the required ER configuration in XML format.</span></span>
    3. <span data-ttu-id="c31e8-163">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-163">Select **OK**.</span></span>

    ![Страница конфигураций в службе RCS](./media/GER-PerfTrace-RCS-ImportedConfigurations.png)

## <a name="run-the-er-solution-to-trace-execution"></a><span data-ttu-id="c31e8-165">Запуск решения электронной отчетности для трассировки выполнения</span><span class="sxs-lookup"><span data-stu-id="c31e8-165">Run the ER solution to trace execution</span></span>

<span data-ttu-id="c31e8-166">Предположим, что вы завершили разработку первой версии решения ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-166">Assume that you've finished designing the first version of the ER solution.</span></span> <span data-ttu-id="c31e8-167">Теперь необходимо проверить его в своем экземпляре и проанализировать производительность выполнения.</span><span class="sxs-lookup"><span data-stu-id="c31e8-167">You now want to test it in your instance and analyze execution performance.</span></span>

### <a id='import-configuration'></a><span data-ttu-id="c31e8-168">Импорт конфигурации ER из службы RCS в Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="c31e8-168">Import an ER configuration from RCS into Finance and Operations</span></span>

1. <span data-ttu-id="c31e8-169">Выполните вход в экземпляр приложения.</span><span class="sxs-lookup"><span data-stu-id="c31e8-169">Sign in to your application instance.</span></span>
2. <span data-ttu-id="c31e8-170">В этом учебнике будут импортированы конфигурации из экземпляра RCS (где вы разрабатываете компоненты электронной отчетности) в ваш экземпляр (где они проверяются и затем используются).</span><span class="sxs-lookup"><span data-stu-id="c31e8-170">For this tutorial, you will import configurations from your RCS instance (where you design your ER components) into your instance (where you test and finally use them).</span></span> <span data-ttu-id="c31e8-171">Поэтому необходимо убедиться, что все необходимые артефакты подготовлены.</span><span class="sxs-lookup"><span data-stu-id="c31e8-171">Therefore, you must make sure that all the required artifacts have been prepared.</span></span> <span data-ttu-id="c31e8-172">Инструкции см. в процедуре [Импорт конфигураций электронной отчетности из служб Regulatory Configuration Service (RCS)](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/analytics/rcs-download-configurations)</span><span class="sxs-lookup"><span data-stu-id="c31e8-172">For instructions, see the [Import Electronic reporting (ER) configurations from Regulatory Configuration Services (RCS)](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/analytics/rcs-download-configurations) procedure.</span></span>
3. <span data-ttu-id="c31e8-173">Выполните следующие действия, чтобы импортировать конфигурации из RCS в приложение:</span><span class="sxs-lookup"><span data-stu-id="c31e8-173">Follow these steps to import the configurations from RCS into the application:</span></span>

    1. <span data-ttu-id="c31e8-174">В рабочей области **Электронная отчетность** на плитке поставщика конфигурации **Litware, Inc.** выберите **Репозитории**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-174">In the **Electronic reporting** workspace, on the tile for the **Litware, Inc.** configuration provider, select **Repositories**.</span></span>
    2. <span data-ttu-id="c31e8-175">На странице **Репозиторий конфигураций** выберите репозиторий типа **RCS**, затем выберите **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-175">On the **Configuration repository** page, select the repository of the **RCS** type, and then select **Open**.</span></span>
    3. <span data-ttu-id="c31e8-176">На экспресс-вкладке **Конфигурации** выберите конфигурацию **Формат трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-176">On the **Configurations** FastTab, select the **Performance trace format** configuration.</span></span>
    4. <span data-ttu-id="c31e8-177">На экспресс-вкладке **Версии** выберите версию **1.1** выбранной конфигурации, затем выберите **Импорт**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-177">On the **Versions** FastTab, select version **1.1** of the selected configuration, and then select **Import**.</span></span>

    ![Страница репозитория конфигурации](./media/GER-PerfTrace-GER-ImportedConfigurations.png)

<span data-ttu-id="c31e8-179">Соответствующие версии модели данных и конфигурации сопоставления моделей автоматически импортируются как необходимые условия для импортированной конфигурации формата ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-179">The corresponding versions of the data model and model mapping configurations are automatically imported as prerequisites for the imported ER format configuration.</span></span>

### <a name="turn-on-the-er-performance-trace"></a><span data-ttu-id="c31e8-180">Включение трассировки производительности электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-180">Turn on the ER performance trace</span></span>

1. <span data-ttu-id="c31e8-181">Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-181">Go to **Organization administration \> Electronic reporting \> Configurations**.</span></span>
2. <span data-ttu-id="c31e8-182">На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-182">On the **Configurations** page, on the Action Pane, on the **Configurations** tab, in the **Advanced settings** group, select **User parameters**.</span></span>
3. <span data-ttu-id="c31e8-183">В диалоговом окне **Параметры пользователя** в разделе **Трассировка выполнения** выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="c31e8-183">In the **User parameters** dialog box, in the **Execution tracing** section, follow these steps:</span></span>

    1. <span data-ttu-id="c31e8-184">В поле **Формат трассировки выполнения** выберите **Отладка формата трассировки**, чтобы начать сбор сведений о выполнении формата ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-184">In the **Execution trace format** field, select **Debug trace format** to start to collect the details of ER format execution.</span></span> <span data-ttu-id="c31e8-185">Если выбрано это значение, трассировка производительности будет собирать сведения о времени, затраченном на выполнение следующих действий:</span><span class="sxs-lookup"><span data-stu-id="c31e8-185">When this value is selected, the performance trace will collect information about the time that is spent on the following actions:</span></span>

        - <span data-ttu-id="c31e8-186">Выполнение каждого источника данных в сопоставлении модели, которое вызывается для извлечения данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-186">Running each data source in the model mapping that is called to get data</span></span>
        - <span data-ttu-id="c31e8-187">Обработка каждого элемента формата для ввода данных в создаваемые выходные данные</span><span class="sxs-lookup"><span data-stu-id="c31e8-187">Processing each format item to enter data in the output that is generated</span></span>

        <span data-ttu-id="c31e8-188">Поле **Формат трассировки выполнения** используется для указания формата созданного отслеживания производительности, в котором хранятся сведения о выполнении, для формата ER и элементов сопоставления.</span><span class="sxs-lookup"><span data-stu-id="c31e8-188">You use the **Execution trace format** field to specify the format of the generated performance trace that the execution details are stored in for ER format and mapping elements.</span></span> <span data-ttu-id="c31e8-189">Выбрав **Отладка формата трассировки** в качестве значения, можно проанализировать содержимое трассировки в конструкторе операций электронной отчетности и просмотреть формат ER или элементы сопоставления, которые упоминаются в трассировке.</span><span class="sxs-lookup"><span data-stu-id="c31e8-189">By selecting **Debug trace format** as the value, you will be able to analyze the content of the trace in ER Operation designer, and see the ER format or mapping elements that are mentioned in the trace.</span></span>

    2. <span data-ttu-id="c31e8-190">Задайте для следующих параметров значение **Да**, чтобы собрать определенные подробные сведения о выполнении сопоставления модели ER и компонентах формата ER:</span><span class="sxs-lookup"><span data-stu-id="c31e8-190">Set the following options to **Yes** to collect specific details of the execution of the ER model mapping and ER format components:</span></span>

        - <span data-ttu-id="c31e8-191">**Сбор статистики запросов** — когда этот параметр включен, трассировка производительности соберет следующую информацию:</span><span class="sxs-lookup"><span data-stu-id="c31e8-191">**Collect query statistics** – When this option is turned on, the performance trace will collect the following information:</span></span>

            - <span data-ttu-id="c31e8-192">Число вызовов базы данных, выполненных источниками данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-192">The number of database calls that were made by data sources</span></span>
            - <span data-ttu-id="c31e8-193">Количество дублированных обращений к базе данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-193">The number of duplicate calls to the database</span></span>
            - <span data-ttu-id="c31e8-194">Подробные сведения об инструкциях SQL, которые использовались для выполнения вызовов базы данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-194">Details of the SQL statements that were used to make database calls</span></span>

        - <span data-ttu-id="c31e8-195">**Отслеживания доступа кэширования** — если этот параметр включен, трассировка производительности будет собирать сведения об использовании кэша сопоставлений модели ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-195">**Trace access of caching** – When this option is turned on, the performance trace will collect information about the ER model mapping's cache usage.</span></span>
        - <span data-ttu-id="c31e8-196">**Трассировка доступа к данным** — когда этот параметр включен, трассировка производительности будет собирать сведения о количестве обращений к базе данных для запущенных источников данных типа списка записей.</span><span class="sxs-lookup"><span data-stu-id="c31e8-196">**Trace data access** – When this option is turned on, the performance trace will collect information about the number of calls to the database for executed data sources of the record list type.</span></span>
        - <span data-ttu-id="c31e8-197">**Перечисление списка трассировки** — когда этот параметр включен, трассировка производительности будет собирать сведения о количестве записей, запрошенных из источников данных типа списка записей.</span><span class="sxs-lookup"><span data-stu-id="c31e8-197">**Trace list enumeration** – When this option is turned on, the performance trace will collect information about the number of records that are requested from data sources of the record list type.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c31e8-198">Параметры в диалоговом окне **Параметры пользователя** относятся только к этому пользователю и текущей компании.</span><span class="sxs-lookup"><span data-stu-id="c31e8-198">The parameters in the **User parameters** dialog box are specific to the user and the current company.</span></span>

    ![Диалоговое окно параметров пользователя](./media/GER-PerfTrace-GER-UserParameters.png)

### <a id='run-format'></a><span data-ttu-id="c31e8-200">Выполнение формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-200">Run the ER format</span></span>

1. <span data-ttu-id="c31e8-201">Выберите компанию **DEMF**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-201">Select the **DEMF** company.</span></span>
2. <span data-ttu-id="c31e8-202">Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-202">Go to **Organization administration \> Electronic reporting \> Configurations**.</span></span>
3. <span data-ttu-id="c31e8-203">На странице **Конфигурации** в дереве конфигураций выберите пункт **Формат трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-203">On the **Configurations** page, in the configuration tree, select the **Performance trace format** item.</span></span>
4. <span data-ttu-id="c31e8-204">В области действий выберите **Выполнить**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-204">On the Action Pane, select **Run**.</span></span>

<span data-ttu-id="c31e8-205">Обратите внимание, что создаваемый файл содержит информацию о 265 транзакциях для шести поставщиков.</span><span class="sxs-lookup"><span data-stu-id="c31e8-205">Notice that the file that is generated presents information about 265 transactions for six vendors.</span></span>

## <a name="review-the-execution-trace"></a><span data-ttu-id="c31e8-206">Просмотр трассировки выполнения</span><span class="sxs-lookup"><span data-stu-id="c31e8-206">Review the execution trace</span></span>

### <a id='export-trace'></a><span data-ttu-id="c31e8-207">Экспорт созданной трассировки из приложения</span><span class="sxs-lookup"><span data-stu-id="c31e8-207">Export the generated trace from the application</span></span>

<span data-ttu-id="c31e8-208">Трассировки производительности не связаны с исходным форматом ER и могут быть сериализованы во внешний ZIP-файл.</span><span class="sxs-lookup"><span data-stu-id="c31e8-208">Performance traces are decoupled from the source ER format and can be serialized to an external zip file.</span></span>

1. <span data-ttu-id="c31e8-209">Перейдите в раздел **Администрирование организации \> Электронная отчетность \> Журналы отладки конфигураций**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-209">Go to **Organization administration \> Electronic reporting \> Configuration debug logs**.</span></span>
2. <span data-ttu-id="c31e8-210">На странице **Журналы выполнения электронной отчетности** в левой области в поле **Имя конфигурации** выберите **Формат трассировки производительности** для поиска записей журнала, созданных при выполнении конфигурации **Формат трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-210">On the **Electronic reporting run logs** page, in the left pane, in the **Configuration name** field, select **Performance trace format** to find the log records that have been generated by the execution of the **Performance trace format** configuration.</span></span>
3. <span data-ttu-id="c31e8-211">Выберите кнопку **Вложения** (символ скрепки) в верхнем правом углу страницы или нажмите **Ctrl+Shift+A**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-211">Select the **Attachments** button (the paper clip symbol) in the upper-right corner of the page, or press **Ctrl+Shift+A**.</span></span>

    ![Кнопка вложений на странице журналов выполнения электронной отчетности](./media/GER-PerfTrace-GER-DebugLog.png)

4. <span data-ttu-id="c31e8-213">На странице **Вложения для журналов выполнения прикрепления электронной отчетности** на панели операций выберите **Открыть**, чтобы получить трассировку производительности в виде ZIP-файла и сохранить ее локально.</span><span class="sxs-lookup"><span data-stu-id="c31e8-213">On the **Attachments for Electronic reporting run logs** page, on the Action Pane, select **Open** to get the performance trace as a zip file and store it locally.</span></span>

    ![Вложения для журналов выполнения электронной отчетности](./media/GER-PerfTrace-GER-DebugLog-AttachedTrace.png)

> [!NOTE]
> <span data-ttu-id="c31e8-215">Создаваемая трассировка имеет ссылку на исходный отчет ER с помощью уникального идентификатора отчета только в формате **GUID**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-215">The trace that is generated has a reference to the source ER report via a unique report identifier in **GUID** format only.</span></span> <span data-ttu-id="c31e8-216">Нумерация версий этого формата не учитывается.</span><span class="sxs-lookup"><span data-stu-id="c31e8-216">The version numbering of the format isn't considered.</span></span>

<span data-ttu-id="c31e8-217">Обратите внимание, что связь между трассировкой производительности, созданной для выполненного формата ER, и сопоставлением модели ER основана на используемом корневом дескрипторе и общей модели данных.</span><span class="sxs-lookup"><span data-stu-id="c31e8-217">Notice that the association between the performance trace that has been generated for the executed ER format and the ER model mapping is based on the root descriptor that was used and the common data model.</span></span> <span data-ttu-id="c31e8-218">Нумерация версий этого формата и сопоставление модели не учитывается.</span><span class="sxs-lookup"><span data-stu-id="c31e8-218">The version numbering of the format and model mapping isn't considered.</span></span> <span data-ttu-id="c31e8-219">Настройка флага **По умолчанию для сопоставления модели** для сопоставления модели также не учитывается.</span><span class="sxs-lookup"><span data-stu-id="c31e8-219">The setting of the **Default for model mapping** flag for the model mapping also isn't considered.</span></span>

### <a id='import-trace'></a><span data-ttu-id="c31e8-220">Импорт созданной трассировки в службу RCS</span><span class="sxs-lookup"><span data-stu-id="c31e8-220">Import the generated trace into RCS</span></span>

1. <span data-ttu-id="c31e8-221">В службе RCS в рабочей области **Электронная отчетность** выберите плитку **Конфигурации отчетности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-221">In RCS, in the **Electronic reporting** workspace, select the **Reporting configurations** tile.</span></span>
2. <span data-ttu-id="c31e8-222">На странице **Конфигурации** в дереве конфигураций разверните элемент **Модели трассировки производительности** и выберите пункт **Формат трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-222">On the **Configurations** page, in the configuration tree, expand the **Performance trace model** item, and select the **Performance trace format** item.</span></span>
3. <span data-ttu-id="c31e8-223">В области действий выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-223">On the Action Pane, select **Designer**.</span></span>
4. <span data-ttu-id="c31e8-224">На странице **Конструктор форматов** в области действий выберите **Трассировка производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-224">On the **Format designer** page, on the Action Pane, select **Performance trace**.</span></span>
5. <span data-ttu-id="c31e8-225">В диалоговом окне **Параметры результатов трассировки производительности** выберите **Импорт трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-225">In the **Performance trace result settings** dialog box, select **Import performance trace**.</span></span>
6. <span data-ttu-id="c31e8-226">Выберите **Обзор**, чтобы выбрать экспортированный ранее ZIP-файл.</span><span class="sxs-lookup"><span data-stu-id="c31e8-226">Select **Browse** to select the zip file that you exported earlier.</span></span>
7. <span data-ttu-id="c31e8-227">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-227">Select **OK**.</span></span>

    ![Диалоговое окно "Параметры результатов трассировки производительности" в RCS](./media/GER-PerfTrace-RCS-ImportedPerfTrace.png)

### <a name="use-the-performance-trace-for-analysis-in-rcs--format-execution"></a><span data-ttu-id="c31e8-229">Используйте трассировку производительности для анализа в RCS — выполнение формата</span><span class="sxs-lookup"><span data-stu-id="c31e8-229">Use the performance trace for analysis in RCS – Format execution</span></span>

1. <span data-ttu-id="c31e8-230">В RCS на странице **Конструктор формата** выберите **Развернуть/свернуть**, чтобы развернуть содержимое всех элементов формата.</span><span class="sxs-lookup"><span data-stu-id="c31e8-230">In RCS, on the **Format designer** page, select **Expand/collapse** to expand the content of all format items.</span></span>

    <span data-ttu-id="c31e8-231">Обратите внимание, что для некоторых элементов текущего формата отображаются дополнительные сведения:</span><span class="sxs-lookup"><span data-stu-id="c31e8-231">Notice that additional information is shown for some items of the current format:</span></span>

    - <span data-ttu-id="c31e8-232">Фактическое время, потраченное на ввод данных в генерируемые выходные данные с использованием элемента формата</span><span class="sxs-lookup"><span data-stu-id="c31e8-232">The actual time that was spent entering data in the generated output by using the format item</span></span>
    - <span data-ttu-id="c31e8-233">То же время, выраженное в процентах от общего времени, затраченного на формирование всех выходных данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-233">The same time expressed as a percentage of the total time that was spent generating the whole output</span></span>

    ![Страница конструктора форматов в службе RCS](./media/GER-PerfTrace-RCS-TraceInfoInFormat.png)

2. <span data-ttu-id="c31e8-235">Закройте страницу **Конструктор форматов**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-235">Close **Format designer** page.</span></span>

### <a id='use-trace'></a><span data-ttu-id="c31e8-236">Используйте трассировку производительности для анализа в RCS — сопоставление модели</span><span class="sxs-lookup"><span data-stu-id="c31e8-236">Use the performance trace for analysis in RCS – Model mapping</span></span>

1. <span data-ttu-id="c31e8-237">В службе RCS на странице **Конфигурации** в дереве конфигураций выберите пункт **Сопоставление трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-237">In RCS, on the **Configurations** page, in the configuration tree, select the **Performance trace mapping** item.</span></span>
2. <span data-ttu-id="c31e8-238">В области действий выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-238">On the Action Pane, select **Designer**.</span></span>
3. <span data-ttu-id="c31e8-239">Выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-239">Select **Designer**.</span></span>
4. <span data-ttu-id="c31e8-240">На странице **Конструктор сопоставления модели** в области действий выберите **Трассировка производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-240">On the **Model mapping designer** page, on the Action Pane, select **Performance trace**.</span></span>
5. <span data-ttu-id="c31e8-241">Выберите ранее импортированную трассировку.</span><span class="sxs-lookup"><span data-stu-id="c31e8-241">Select the trace that you imported earlier.</span></span>
6. <span data-ttu-id="c31e8-242">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-242">Select **OK**.</span></span>

<span data-ttu-id="c31e8-243">Обратите внимание, что новые сведения становятся доступны для некоторых элементов источника данных в текущем сопоставлении модели:</span><span class="sxs-lookup"><span data-stu-id="c31e8-243">Notice that new information becomes available for some data source items of the current model mapping:</span></span>

- <span data-ttu-id="c31e8-244">Фактическое время, потраченное на получение данных с использованием источника данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-244">The actual time that was spent getting data by using the data source</span></span>
- <span data-ttu-id="c31e8-245">То же время, выраженное в процентах от общего времени, затраченного на выполнение всего сопоставления модели</span><span class="sxs-lookup"><span data-stu-id="c31e8-245">The same time expressed as a percentage of the total time that was spent running the whole model mapping</span></span>

<span data-ttu-id="c31e8-246">Обратите внимание, что электронная отчетность информирует о том, что текущее сопоставление модели дублирует запросы к базе данных, когда выполняется источник данных VendTable/\<Relations/VendTrans.VendTable\_AccountNum</span><span class="sxs-lookup"><span data-stu-id="c31e8-246">Notice that ER informs you that the current model mapping duplicates database requests while the VendTable/\<Relations/VendTrans.VendTable\_AccountNum data source is run.</span></span> <span data-ttu-id="c31e8-247">Такое дублирование происходит из-за того, что список проводок поставщика вызывается два раза для каждой итерации записи поставщика:</span><span class="sxs-lookup"><span data-stu-id="c31e8-247">This duplication occurs because the list of vendor transactions is called two times for each iterated vendor record:</span></span>

- <span data-ttu-id="c31e8-248">Один вызов выполняется для ввода подробных сведений о каждой проводке в модели данных на основе настроенных привязок.</span><span class="sxs-lookup"><span data-stu-id="c31e8-248">One call is made to enter details of each transaction in the data model, based on configured bindings.</span></span>
- <span data-ttu-id="c31e8-249">Один вызов создается для ввода рассчитанного количества проводок по поставщику в модели данных.</span><span class="sxs-lookup"><span data-stu-id="c31e8-249">One call is made to enter the calculated number of transactions per vendor in the data model.</span></span>

![Сообщение о дубликатах запросов базы данных на странице конструктора сопоставления модели в RCS](./media/GER-PerfTrace-RCS-TraceInfoInMapping1.png)

<span data-ttu-id="c31e8-251">Значение **\[Q:530\]** указывает на то, что таблица VendTrans была вызвана 530 раз, чтобы вернуть запись из этой таблицы в источник данных VendTable/\<Relations/VendTrans.VendTable\_AccountNum.</span><span class="sxs-lookup"><span data-stu-id="c31e8-251">The value **\[Q:530\]** indicates that the VendTrans table was called 530 times to return a record from that table to the VendTable/\<Relations/VendTrans.VendTable\_AccountNum data source.</span></span> <span data-ttu-id="c31e8-252">Значение **\[530\]** указывает на то, что источник данных VendTable/\<Relations/VendTrans.VendTable\_AccountNum был вызван 530 раз, чтобы вернуть запись из этого источника данных и ввести сведения из нее в модель данных.</span><span class="sxs-lookup"><span data-stu-id="c31e8-252">The value **\[530\]** indicates that the VendTable/\<Relations/VendTrans.VendTable\_AccountNum data source was called 530 times to return a record from that data source and enter the details from it in the data model.</span></span>

<span data-ttu-id="c31e8-253">Рекомендуется использовать кэширование для источника данных VendTable/\<Relations/VendTrans.VendTable\_AccountNum, чтобы уменьшить число вызовов, которые были сделаны для получения сведений о 265 транзакциях и помочь улучшить производительность сопоставления модели.</span><span class="sxs-lookup"><span data-stu-id="c31e8-253">We recommend that you use caching for the VendTable/\<Relations/VendTrans.VendTable\_AccountNum data source, to reduce the number of calls that are made to get the details for 265 transactions and help improve the performance of the model mapping.</span></span>

<span data-ttu-id="c31e8-254">Также может быть полезно уменьшить количество вызовов, выполненных в источнике данных LedgerTransTypeList.</span><span class="sxs-lookup"><span data-stu-id="c31e8-254">It can also be useful to reduce the number of calls that are made to the LedgerTransTypeList data source.</span></span> <span data-ttu-id="c31e8-255">Этот источник данных используется для связи каждого значения перечисления **LedgerTransType** с его меткой.</span><span class="sxs-lookup"><span data-stu-id="c31e8-255">This data source is used to associate each value of the **LedgerTransType** enumeration with its label.</span></span> <span data-ttu-id="c31e8-256">Используя этот источник данных, можно найти соответствующую метку и ввести ее в модель данных для каждой проводки поставщика.</span><span class="sxs-lookup"><span data-stu-id="c31e8-256">By using this data source, you can find an appropriate label and enter it in the data model for each vendor transaction.</span></span> <span data-ttu-id="c31e8-257">Текущее число вызовов этого источника данных (9 027) довольно большое для 265 проводок.</span><span class="sxs-lookup"><span data-stu-id="c31e8-257">The current number of calls to this data source (9,027) is quite high for 265 transactions.</span></span>

![Страница конструктора сопоставлений моделей в RCS, в которой показаны 9 027 вызовов в источнике данных](./media/GER-PerfTrace-RCS-TraceInfoInMapping1a.png)

## <a name="improve-the-model-mapping-based-on-information-from-the-execution-trace"></a><span data-ttu-id="c31e8-259">Улучшите сопоставление модели на основе информации из трассировки выполнения</span><span class="sxs-lookup"><span data-stu-id="c31e8-259">Improve the model mapping based on information from the execution trace</span></span>

### <a name="modify-the-logic-of-the-model-mapping"></a><span data-ttu-id="c31e8-260">Изменение логики сопоставления модели</span><span class="sxs-lookup"><span data-stu-id="c31e8-260">Modify the logic of the model mapping</span></span>

1. <span data-ttu-id="c31e8-261">Выполните следующие действия, чтобы использовать кэширование, чтобы предотвратить повторные обращения к базе данных:</span><span class="sxs-lookup"><span data-stu-id="c31e8-261">Follow these steps to use caching, to help prevent duplicate calls to the database:</span></span>

    1. <span data-ttu-id="c31e8-262">В службе RCS на странице **Конструктор сопоставления модели** в области **Источники данных** выберите элемент **VendTable**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-262">In RCS, on the **Model mapping designer** page, in the **Data sources** pane, select the **VendTable** item.</span></span>
    2. <span data-ttu-id="c31e8-263">Выберите **Кэш**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-263">Select **Cache**.</span></span>
    3. <span data-ttu-id="c31e8-264">Разверните элемент **VendTable**, раскройте список отношений "один ко многим" для источника данных VendTable (элемент **\<Отношения**) и выберите пункт **VendTrans.VendTable\_AccountNum**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-264">Expand the **VendTable** item, expand the list of one-to-many relations for the VendTable data source (the **\<Relations** item), and select the **VendTrans.VendTable\_AccountNum** item.</span></span>
    4. <span data-ttu-id="c31e8-265">Выберите **Кэш**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-265">Select **Cache**.</span></span>

    ![Настройка кэширования, помогающая предотвратить дублированные вызовы](./media/GER-PerfTrace-RCS-ChangeMapping-Cache.png)

2. <span data-ttu-id="c31e8-267">Выполните следующие действия, чтобы перенести источник данных LedgerTransTypeList в область источника данных VendTable:</span><span class="sxs-lookup"><span data-stu-id="c31e8-267">Follow these steps to bring the LedgerTransTypeList data source into the scope of the VendTable data source:</span></span>

    1. <span data-ttu-id="c31e8-268">В области **Типы источников данных** раскройте элемент **Функции** и выберите элемент **Вычисляемое поле**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-268">In the **Data source types** pane, expand the **Functions** item, and select the **Calculated field** item.</span></span>
    2. <span data-ttu-id="c31e8-269">В области **Источники данных** выберите элемент **VendTable**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-269">In the **Data sources** pane, select the **VendTable** item.</span></span>
    3. <span data-ttu-id="c31e8-270">Выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-270">Select **Add**.</span></span>
    4. <span data-ttu-id="c31e8-271">В поле **Имя** введите **\$TransType**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-271">In the **Name** field, enter **\$TransType**.</span></span>
    5. <span data-ttu-id="c31e8-272">Выберите **Изменить формулу**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-272">Select **Edit formula**.</span></span>
    6. <span data-ttu-id="c31e8-273">В поле **Формула** введите **LedgerTransTypeList**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-273">In the **Formula** field, enter **LedgerTransTypeList**.</span></span>
    7. <span data-ttu-id="c31e8-274">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-274">Select **Save**.</span></span>
    8. <span data-ttu-id="c31e8-275">Закройте страницу **Редактор формул**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-275">Close the **Formula editor** page.</span></span>
    9. <span data-ttu-id="c31e8-276">Щелкните **OK**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-276">Click **OK**.</span></span>

3. <span data-ttu-id="c31e8-277">Выполните следующие действия, чтобы выполнить кэширование поля **\$TransType**:</span><span class="sxs-lookup"><span data-stu-id="c31e8-277">Follow these steps to do caching of the **\$TransType** field:</span></span>

    1. <span data-ttu-id="c31e8-278">Выберите элемент **LedgerTransTypeList**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-278">Select the **LedgerTransTypeList** item.</span></span>
    2. <span data-ttu-id="c31e8-279">Выберите **Кэш**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-279">Select **Cache**.</span></span>
    3. <span data-ttu-id="c31e8-280">Выберите элемент **VendTable.\$TransType**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-280">Select the **VendTable.\$TransType** item.</span></span>
    4. <span data-ttu-id="c31e8-281">Выберите **Кэш**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-281">Select **Cache**.</span></span>

    ![Настройка кэширования для поля $TransType](./media/GER-PerfTrace-RCS-ChangeMapping-Cache2.png)

4. <span data-ttu-id="c31e8-283">Выполните следующие действия для изменения поля **\$TransTypeRecord** таким образом, чтобы оно начинало использовать кэшированное поле **\$TransType**:</span><span class="sxs-lookup"><span data-stu-id="c31e8-283">Follow these steps to change the **\$TransTypeRecord** field so that it starts to use the cached **\$TransType** field:</span></span>

    1. <span data-ttu-id="c31e8-284">На панели **Источники данных** разверните элемент **VendTable**, разверните элемент **\<Отношения**, разверните элемент **VendTrans.VendTable\_AccountNum** и выберите элемент **VendTable. VendTrans.VendTable\_AccountNum.\$TransTypeRecord**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-284">In the **Data sources** pane, expand the **VendTable** item, expand the **\<Relations** item, expand the **VendTrans.VendTable\_AccountNum** item, and select the **VendTable. VendTrans.VendTable\_AccountNum.\$TransTypeRecord** item.</span></span>
    2. <span data-ttu-id="c31e8-285">Выберите **Правка**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-285">Select **Edit**.</span></span>
    3. <span data-ttu-id="c31e8-286">Выберите **Изменить формулу**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-286">Select **Edit formula**.</span></span>
    4. <span data-ttu-id="c31e8-287">В поле **Формула** найдите следующее выражение:</span><span class="sxs-lookup"><span data-stu-id="c31e8-287">In the **Formula** field, find the following expression:</span></span>

        <span data-ttu-id="c31e8-288">FIRSTORNULL (WHERE (LedgerTransTypeList, LedgerTransTypeList.Enum = \@.TransType))</span><span class="sxs-lookup"><span data-stu-id="c31e8-288">FIRSTORNULL (WHERE (LedgerTransTypeList, LedgerTransTypeList.Enum = \@.TransType))</span></span>

    5. <span data-ttu-id="c31e8-289">В поле **Формула** введите следующее выражение:</span><span class="sxs-lookup"><span data-stu-id="c31e8-289">In the **Formula** field, enter the following expression:</span></span>

        <span data-ttu-id="c31e8-290">FIRSTORNULL (WHERE (VendTable.'\$TransType', VendTable.'\$TransType'.Enum = \@.TransType)).</span><span class="sxs-lookup"><span data-stu-id="c31e8-290">FIRSTORNULL (WHERE (VendTable.'\$TransType', VendTable.'\$TransType'.Enum = \@.TransType)).</span></span>

    6. <span data-ttu-id="c31e8-291">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-291">Select **Save**.</span></span>
    7. <span data-ttu-id="c31e8-292">Закройте страницу **Редактор формул**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-292">Close the **Formula editor** page.</span></span>
    8. <span data-ttu-id="c31e8-293">Нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-293">Select **OK**.</span></span>

5. <span data-ttu-id="c31e8-294">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-294">Select **Save**.</span></span>
6. <span data-ttu-id="c31e8-295">Закройте страницу **Конструктор сопоставления модели**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-295">Close the **Model mapping designer** page.</span></span>
7. <span data-ttu-id="c31e8-296">Закройте страницу **Сопоставления модели**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-296">Close the **Model mappings** page.</span></span>

### <a name="complete-the-modified-version-of-the-er-model-mapping"></a><span data-ttu-id="c31e8-297">Выполните измененную версию сопоставления модели ER</span><span class="sxs-lookup"><span data-stu-id="c31e8-297">Complete the modified version of the ER model mapping</span></span>

1. <span data-ttu-id="c31e8-298">В RCS на странице **Конфигурации** на экспресс-вкладке **Версии** выберите версию **1.2** конфигурации **Сопоставление трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-298">In RCS, on the **Configurations** page, on the **Versions** FastTab, select version **1.2** of the **Performance trace mapping** configuration.</span></span>
2. <span data-ttu-id="c31e8-299">Выберите **Изменить статус**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-299">Select **Change status**.</span></span>
3. <span data-ttu-id="c31e8-300">Выберите **Завершено**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-300">Select **Complete**.</span></span>

### <a name="import-the-modified-er-model-mapping-configuration-from-rcs-into-the-application"></a><span data-ttu-id="c31e8-301">Импорт измененной конфигурации сопоставления модели ER из RCS в приложение</span><span class="sxs-lookup"><span data-stu-id="c31e8-301">Import the modified ER model mapping configuration from RCS into the application</span></span>

<span data-ttu-id="c31e8-302">Повторите шаги из раздела [Импорт конфигурации ER из службы RCS в Finance and Operations](#import-configuration) выше в этой теме, чтобы импортировать версию 1.2 конфигурации **Сопоставление трассировки производительности**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-302">Repeat the steps in the [Import an ER configuration from RCS into Finance and Operations](#import-configuration) section earlier in this topic to import version 1.2 of the **Performance trace mapping** configuration.</span></span>

## <a name="run-the-modified-er-solution-to-trace-execution"></a><span data-ttu-id="c31e8-303">Запуск измененного решения электронной отчетности для трассировки выполнения</span><span class="sxs-lookup"><span data-stu-id="c31e8-303">Run the modified ER solution to trace execution</span></span>

### <a name="run-the-er-format"></a><span data-ttu-id="c31e8-304">Выполнение формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-304">Run the ER format</span></span>

<span data-ttu-id="c31e8-305">Повторите шаги в разделе [Выполнение формата электронной отчетности](#run-format) ранее в этой теме, чтобы создать новую трассировку производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-305">Repeat the steps in the [Run the ER format](#run-format) section earlier in this topic to generate a new performance trace.</span></span>

## <a name="review-the-execution-trace"></a><span data-ttu-id="c31e8-306">Просмотр трассировки выполнения</span><span class="sxs-lookup"><span data-stu-id="c31e8-306">Review the execution trace</span></span>

### <a name="export-the-generated-trace-from-the-application"></a><span data-ttu-id="c31e8-307">Экспорт созданной трассировки из приложения</span><span class="sxs-lookup"><span data-stu-id="c31e8-307">Export the generated trace from the application</span></span>

<span data-ttu-id="c31e8-308">Повторите шаги из раздела [Экспорт созданной трассировки из приложения](#export-trace) ранее в этой теме, чтобы сохранить новую трассировку производительности локально.</span><span class="sxs-lookup"><span data-stu-id="c31e8-308">Repeat the steps in the [Export the generated trace from the application](#export-trace) section earlier in this topic to save a new performance trace locally.</span></span>

### <a name="import-the-generated-trace-into-rcs"></a><span data-ttu-id="c31e8-309">Импорт созданной трассировки в службу RCS</span><span class="sxs-lookup"><span data-stu-id="c31e8-309">Import the generated trace into RCS</span></span>

<span data-ttu-id="c31e8-310">Повторите шаги из раздела [Импорт созданной трассировки в службу RCS](#import-trace) ранее в этой теме для импорта новой трассировки производительности в RCS.</span><span class="sxs-lookup"><span data-stu-id="c31e8-310">Repeat the steps in the [Import the generated trace into RCS](#import-trace) section earlier in this topic to import the new performance trace into RCS.</span></span>

### <a name="use-the-performance-trace-for-analysis-in-rcs--model-mapping"></a><span data-ttu-id="c31e8-311">Используйте трассировку производительности для анализа в RCS — сопоставление модели</span><span class="sxs-lookup"><span data-stu-id="c31e8-311">Use the performance trace for analysis in RCS – Model mapping</span></span>

<span data-ttu-id="c31e8-312">Повторите шаги из раздела [Используйте трассировку производительности для анализа в RCS — сопоставление модели](#use-trace), приведенного ранее в этой теме, для анализа последней трассировки производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-312">Repeat the steps in the [Use the performance trace for analysis in RCS – Model mapping](#use-trace) section earlier in this topic to analyze the latest performance trace.</span></span>

<span data-ttu-id="c31e8-313">Обратите внимание, что изменения, внесенные в сопоставление модели, исключают повторяющиеся запросы к базе данных.</span><span class="sxs-lookup"><span data-stu-id="c31e8-313">Notice that the adjustments that you made to the model mapping have eliminated duplicate queries to database.</span></span> <span data-ttu-id="c31e8-314">Также уменьшилось число обращений к таблицам базы данных и источникам данных для данного сопоставления модели.</span><span class="sxs-lookup"><span data-stu-id="c31e8-314">The number of calls to database tables and data sources for this model mapping has been also reduced.</span></span> <span data-ttu-id="c31e8-315">Поэтому производительность всего решения ER улучшилась.</span><span class="sxs-lookup"><span data-stu-id="c31e8-315">Therefore, the performance of the whole ER solution has improved.</span></span>

![Сведения отслеживания для источника данных VendTable на странице конструктора сопоставления модели в службе RCS](./media/GER-PerfTrace-RCS-TraceInfoInMapping2.png)

<span data-ttu-id="c31e8-317">В данных трассировки значение **\[12\]** для источника данных VendTable указывает, что этот источник данных вызывался 12 раз.</span><span class="sxs-lookup"><span data-stu-id="c31e8-317">In the trace information, the value **\[12\]** for the VendTable data source indicates that this data source was called 12 times.</span></span> <span data-ttu-id="c31e8-318">Значение **\[Q:6\]** указывает, что шесть вызовов были преобразованы в вызовы таблицы VendTable базы данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-318">The value **\[Q:6\]** indicates that six calls were translated to database calls to the VendTable table.</span></span> <span data-ttu-id="c31e8-319">Значение **\[C:6\]** указывает, что записи, которые были извлечены из базы данных, были кэшированы, и шесть других вызовов были обработаны с использованием кэша.</span><span class="sxs-lookup"><span data-stu-id="c31e8-319">The value **\[C:6\]** indicates that the records that were fetched from the database were cached, and six other calls were processed by using the cache.</span></span>

<span data-ttu-id="c31e8-320">Обратите внимание, что количество вызовов источника данных LedgerTransTypeList уменьшилось с 9 027 до 240.</span><span class="sxs-lookup"><span data-stu-id="c31e8-320">Notice that the number of calls to the LedgerTransTypeList data source has been reduced from 9,027 to 240.</span></span>

![Сведения отслеживания для источника данных LedgerTransTypeList на странице конструктора сопоставления модели в службе RCS](./media/GER-PerfTrace-RCS-TraceInfoInMapping2a.png)

## <a name="review-the-execution-trace-in-the-application"></a><span data-ttu-id="c31e8-322">Просмотр трассировки выполнения в приложении</span><span class="sxs-lookup"><span data-stu-id="c31e8-322">Review the execution trace in the application</span></span>

<span data-ttu-id="c31e8-323">В дополнение к RCS, некоторые версии могут предоставлять возможности для конструктора структуры электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-323">In addition to RCS, some versions might offer capabilities for an ER framework designer experience.</span></span> <span data-ttu-id="c31e8-324">Эти версии имеют параметр **Включить режим конструктора**, который может быть включен.</span><span class="sxs-lookup"><span data-stu-id="c31e8-324">These versions have an **Enable design mode** option that can be turned on.</span></span> <span data-ttu-id="c31e8-325">Этот параметр можно найти на вкладке **Общие** страницы **Параметры электронной отчетности**, которую можно открыть из рабочей области **Электронная отчетность**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-325">You can find this option on the **General** tab of the **Electronic reporting parameters** page, which you can open from the **Electronic reporting** workspace.</span></span>

![Параметр "Включить режим конструктора" на странице параметров электронной отчетности](./media/GER-PerfTrace-GER-Parameters-DesignMode.png)

<span data-ttu-id="c31e8-327">При использовании одной из этих версий можно анализировать подробные сведения о созданных трассировках производительности непосредственно в приложении.</span><span class="sxs-lookup"><span data-stu-id="c31e8-327">If you use one of these versions, you can analyze the details of generated performance traces directly in the application.</span></span> <span data-ttu-id="c31e8-328">Нет необходимости экспортировать их из приложения и импортировать в RCS.</span><span class="sxs-lookup"><span data-stu-id="c31e8-328">You don't have to export them from the application and import them into RCS.</span></span>

## <a name="review-the-execution-trace-by-using-external-tools"></a><span data-ttu-id="c31e8-329">Просмотр трассировки выполнения с помощью внешних средств</span><span class="sxs-lookup"><span data-stu-id="c31e8-329">Review the execution trace by using external tools</span></span>

### <a name="configure-user-parameters"></a><span data-ttu-id="c31e8-330">Настройка параметров пользователя</span><span class="sxs-lookup"><span data-stu-id="c31e8-330">Configure user parameters</span></span>

1. <span data-ttu-id="c31e8-331">Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-331">Go to **Organization administration \> Electronic reporting \> Configurations**.</span></span>
2. <span data-ttu-id="c31e8-332">На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-332">On the **Configurations** page, on the Action Pane, on the **Configurations** tab, in the **Advanced settings** group, select **User parameters**.</span></span>
3. <span data-ttu-id="c31e8-333">В диалоговом окне **Параметры пользователя** в разделе **Трассировка выполнения** в поле **Формат трассировки выполнения** выберите **PerfView XML**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-333">In the **User parameters** dialog box, in the **Execution tracing** section, in the **Execution trace format** field, select **PerfView XML**.</span></span>

### <a name="run-the-er-format"></a><span data-ttu-id="c31e8-334">Выполнение формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-334">Run the ER format</span></span>

<span data-ttu-id="c31e8-335">Повторите шаги в разделе [Выполнение формата электронной отчетности](#run-format) ранее в этой теме, чтобы создать новую трассировку производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-335">Repeat the steps in the [Run the ER format](#run-format) section earlier in this topic to generate a new performance trace.</span></span>

<span data-ttu-id="c31e8-336">Обратите внимание, что веб-браузер предлагает ZIP-файл для загрузки.</span><span class="sxs-lookup"><span data-stu-id="c31e8-336">Notice that the web browser offers a zip file for download.</span></span> <span data-ttu-id="c31e8-337">Этот файл содержит трассировку производительности в формате PerfView.</span><span class="sxs-lookup"><span data-stu-id="c31e8-337">This file contains the performance trace in PerfView format.</span></span> <span data-ttu-id="c31e8-338">Затем можно воспользоваться средством анализа производительности PerfView, чтобы проанализировать сведения о выполнении формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-338">You can then use the PerfView performance analysis tool to analyze the details of ER format execution.</span></span>

![Сведения трассировки для выполненного формата электронной отчетности в PerfView](./media/GER-PerfTrace2-PerfViewTrace1.PNG)

## <a name="use-external-tools-to-review-an-execution-trace-that-includes-database-queries"></a><span data-ttu-id="c31e8-340">Использование внешних инструментов для просмотра трассировки выполнения, в которой имеются запросы базы данных</span><span class="sxs-lookup"><span data-stu-id="c31e8-340">Use external tools to review an execution trace that includes database queries</span></span>

<span data-ttu-id="c31e8-341">Вследствие улучшений, сделанных в среде электронной отчетности, трассировка производительности, созданная в формате PerfView, сейчас предоставляет более подробные сведения о выполнении формата ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-341">Because of improvements that have been made to the ER framework, the performance trace that is generated in PerfView format now offers more details about ER format execution.</span></span> <span data-ttu-id="c31e8-342">В Microsoft Dynamics 365 for Finance and Operations версии 10.0.4 (июль 2019 г.) эта трассировка также может включать сведения о выполненных запросах SQL в базу данных приложения.</span><span class="sxs-lookup"><span data-stu-id="c31e8-342">In Microsoft Dynamics 365 for Finance and Operations version 10.0.4 (July 2019), this trace can also include details of executed SQL queries to the application database.</span></span>

### <a name="configure-user-parameters"></a><span data-ttu-id="c31e8-343">Настройка параметров пользователя</span><span class="sxs-lookup"><span data-stu-id="c31e8-343">Configure user parameters</span></span>

1. <span data-ttu-id="c31e8-344">Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-344">Go to **Organization administration** \> **Electronic reporting** \> **Configurations**.</span></span>
2. <span data-ttu-id="c31e8-345">На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-345">On the **Configurations** page, on the Action Pane, on the **Configurations** tab, in the **Advanced settings** group, select **User parameters**.</span></span>
3. <span data-ttu-id="c31e8-346">В диалоговом окне **Параметры пользователя** в разделе **Трассировка выполнения** задайте следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="c31e8-346">In the **User parameters** dialog box, in the **Execution tracing** section, set the following parameters:</span></span>

    - <span data-ttu-id="c31e8-347">В поле **Формат трассировки выполнения** выберите **PerfView XML**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-347">In the **Execution trace format** field, select **PerfView XML**.</span></span>
    - <span data-ttu-id="c31e8-348">Установите для параметра **Сбор статистики запроса** значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-348">Set the **Collect query statistics** option to **Yes**.</span></span>
    - <span data-ttu-id="c31e8-349">Для параметра **Отслеживать запрос** задайте значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="c31e8-349">Set the **Trace query** option to **Yes**.</span></span>

    ![Диалоговое окно параметров пользователя](./media/GER-PerfTrace2-GER-UserParameters.PNG)

### <a name="run-the-er-format"></a><span data-ttu-id="c31e8-351">Выполнение формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="c31e8-351">Run the ER format</span></span>

<span data-ttu-id="c31e8-352">Повторите шаги в разделе [Выполнение формата электронной отчетности](#run-format) ранее в этой теме, чтобы создать новую трассировку производительности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-352">Repeat the steps in the [Run the ER format](#run-format) section earlier in this topic to generate a new performance trace.</span></span>

<span data-ttu-id="c31e8-353">Обратите внимание, что веб-браузер предлагает ZIP-файл для загрузки.</span><span class="sxs-lookup"><span data-stu-id="c31e8-353">Notice that the web browser offers a zip file for download.</span></span> <span data-ttu-id="c31e8-354">Этот файл содержит трассировку производительности в формате PerfView.</span><span class="sxs-lookup"><span data-stu-id="c31e8-354">This file contains the performance trace in PerfView format.</span></span> <span data-ttu-id="c31e8-355">Затем можно воспользоваться средством анализа производительности PerfView, чтобы проанализировать сведения о выполнении формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="c31e8-355">You can then use the PerfView performance analysis tool to analyze the details of ER format execution.</span></span> <span data-ttu-id="c31e8-356">В данный момент трассировка включает в себя подробные сведения о доступе к базе данных SQL во время выполнения формата ER.</span><span class="sxs-lookup"><span data-stu-id="c31e8-356">This trace now includes the details of SQL database access during the execution of the ER format.</span></span>

![Сведения трассировки для выполненного формата электронной отчетности в PerfView](./media/GER-PerfTrace2-PerfViewTrace2.PNG)
