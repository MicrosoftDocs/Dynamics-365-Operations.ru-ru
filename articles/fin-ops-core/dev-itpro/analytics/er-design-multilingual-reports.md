---
title: Разработка многоязычных отчетов в электронной отчетности
description: В этой теме объясняется, как использовать метки электронной отчетности (ER) для проектирования и создания многоязыковых отчетов.
author: NickSelin
ms.date: 11/30/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERDataModelDesigner, ERModelMappingDesigner, EROperationDesigner, ERExpressionDesignerFormula
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: e5c6b28dc115719922e418cb7a6156032d994d39
ms.sourcegitcommit: 89655f832e722cefbf796a95db10c25784cc2e8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/31/2022
ms.locfileid: "8074950"
---
# <a name="design-multilingual-reports-in-electronic-reporting"></a>Разработка многоязычных отчетов в электронной отчетности

[!include[banner](../includes/banner.md)]

## <a name="overview"></a>Обзор

Как бизнес-пользователь, вы можете использовать [инфраструктуру электронной отчетности (ER)](general-electronic-reporting.md) для настройки форматов исходящих электронных документов, которые должны быть созданы в соответствии с требованиями законодательства различных стран или регионов. Когда эти требования требуют создания исходящих документов на разных языках для разных стран или регионов, можно настроить один формат электронной отчетности, содержащий ресурсы, зависящие от языка. Таким образом можно повторно использовать формат для создания исходящих документов для различных стран или регионов. Кроме того, можно использовать один формат ER для создания исходящего документа на разных языках для соответствующих клиентов, поставщиков, дочерних подразделений или других сторон.

Модели данных ER и сопоставления моделей можно настроить как источники данных настроенных форматов ER, чтобы определить поток данных, который определяет, какие данные приложения помещаются в создаваемые документы. В качестве [поставщика](general-electronic-reporting.md#Provider) конфигурации электронной отчетности вы можете [публиковать](tasks/er-upload-configuration-into-lifecycle-services.md#upload-a-configuration-into-lcs) настроенные [модели данных](general-electronic-reporting.md#data-model-and-model-mapping-components), [сопоставления моделей](general-electronic-reporting.md#data-model-and-model-mapping-components) и форматы как компоненты решения электронной отчетности для создания конкретных исходящих документов. Можно также позволить клиентам [отправить](general-electronic-reporting-manage-configuration-lifecycle.md) опубликованное решение ER, чтобы его можно было использовать и настроить. Если предполагается, что клиенты могут говорить на других языках, можно настроить компоненты ER так, чтобы они содержали ресурсы, зависящие от языка. Таким образом, содержимое редактируемого компонента ER может быть представлено на предпочтительном для клиента языке в режиме разработки.

Зависящие от языка ресурсы можно настроить как метки ER. Затем эти метки можно использовать для настройки компонентов ER для следующих целей:

- Во время разработки:

    - Представление содержимого настроенных компонентов ER на предпочтительном языке пользователя.

- Во время выполнения:

    - Создание для исходящих документов содержимого, зависящего от языка.
    - Выдача предупреждений и сообщений об ошибках на предпочтительном языке пользователя.
    - Запрос обязательных полей на предпочтительном языке пользователя.

Метки ER могут быть настроены в каждой [конфигурации](general-electronic-reporting.md#Configuration) ER, которая содержит другие компоненты. Метки могут поддерживаться независимо от настроенной логики моделей данных ER, сопоставлений моделей ER и компонентов формата ER.

Каждая метка ER определяется идентификатором, который уникален в области конфигурации ER, в которой содержится эта метка. Каждая метка может содержать текст метки для каждого языка, поддерживаемого в текущем экземпляре Microsoft Dynamics 365 Finance. Эти поддерживаемые языки включают в себя языки развернутых настроек.

## <a name="entry"></a>Ввод

При создании модели данных ER, сопоставления модели ER или формата ER параметр **Перевести** выводится каждый раз при выборе поля, которое может содержать переводимый контекст. При выборе этого параметра можно связать выбранное поле с меткой ER на <a name="TextTranslationPane">панели</a> **перевода текста**. Можно выбрать существующую метку ER или добавить новую метку ER, если она еще не доступна. При выборе или добавлении метки ER можно добавить связанный текст для каждого языка, который поддерживается в текущем экземпляре Finance.

На следующем рисунке показано, как выполняется перевод в редактируемой модели данных ER. В этом примере атрибут **Описание** поля **PurchaseOrder** для редактируемой **модели накладных** переводится на австрийского немецкий (DE-AT) и японский (JA) языки.

![Предоставление перевода метки ER в конструкторе модели данных ER.](./media/er-multilingual-labels-refer.png)

Можно перевести только текст метки для меток, находящихся в редактируемом компоненте ER. Например, если выбрано **Перевести** для атрибута метка источника данных сопоставления модели ER, а затем выбрана метка ER, которая расположена в родительской модели данных ER, будет отображено содержимое метки, но оно не может быть изменено. В этих случаях поле **Переведенный текст** недоступно, как показано на следующем рисунке.

![Проверка предоставленного перевода метки ER в конструкторе сопоставления модели ER.](./media/er-multilingual-labels-refer-mapping.png)

> [!NOTE]
> Нельзя использовать конструкторы для удаления метки, которая была введена в редактируемом компоненте ER.

## <a name="scope"></a>Результат

На метки ER можно ссылаться в нескольких переводимых атрибутах компонентов ER.

### <a name="data-model-component"></a>Компонент "модель данных"

При настройке модели данных ER можно добавить для нее метки ER. Атрибуты **Метка** и **Описание** элемента модели, каждое поле модели и каждое значение <a id="LinkModelEnum"></a>перечисления модели могут быть связаны с меткой ER, которая добавляется к модели данных ER.

![Предоставление перевода для атрибута "Описание" в конструкторе модели данных ER.](./media/er-multilingual-labels-refer.png)

Если модель данных ER настроена таким образом, ее содержимое будет представлено пользователям в конструкторе модели данных ER для каждого из предпочитаемых пользователем языков. Таким образом, обслуживание модели упрощено. На следующем рисунке показано, как работают эти функции для пользователей, которые имеют в качестве предпочтительного языка значение "DE-AT" и "JA".

![Макет конструктора модели данных ER для пользователя, у которого в качестве предпочитаемого языка задано значение DE-AT.](./media/er-multilingual-labels-refer-de.png)

![Макет конструктора модели данных ER для пользователя, у которого в качестве предпочитаемого языка задано значение JA.](./media/er-multilingual-labels-refer-ja.png)

### <a name="model-mapping-component"></a>Компонент сопоставления моделей

Поскольку сопоставление модели ER выполняется на основе модели данных ER, метки элементов модели данных, на которые указывает ссылка, отображаются на предпочитаемом пользователем языке в конструкторе сопоставления моделей. На следующем рисунке показано, как значение поля **PurchaseOrder** поясняется в сопоставлении редактируемой модели с помощью метки атрибута **Описание**, которая была добавлена в сконфигурированную модель данных. Обратите внимание, что эта метка представлена на предпочтительном языке пользователя (в данном примере DE-AT).

![Макет конструктора сопоставления модели ER для пользователя, у которого в качестве предпочитаемого языка задано значение DE-AT.](./media/er-multilingual-labels-show-mapping.png)

Если атрибут **Метка** в источнике данных **Параметр пользовательского ввода** настроен как связанный с меткой ER, поле параметра, соответствующее этому источнику данных, отображается в диалоговом окне пользователя во время выполнения для пользователей на их предпочтительном языке.

### <a name="format-component"></a>Компонент формата

При настройке формата ER можно добавить для него метки ER. Атрибуты **Метка** и **Текст справки** для каждого источника данных могут быть связаны с меткой ER, которая добавляется к формату ER. Атрибуты **Метка** и **Описание** каждого значения <a id="LinkFormatEnum"></a>перечисления формата также могут быть связаны с меткой ER, доступной из редактируемого формата ER.

> [!NOTE]
> Можно также связать эти атрибуты с меткой ER родительской модели данных ER, которая повторно использует метки модели в каждом формате ER, настроенном для этой модели данных ER.

Если формат ER настроен таким образом, содержимое формата будет представлено пользователям в конструкторе операций ER для каждого из предпочитаемых языков пользователя. Таким образом, упрощены обслуживание и анализ формата настроенной логики.

Поскольку формат ER основан на модели данных ER, метки, на которые имеются ссылки в элементах модели данных, отображаются в конструкторе формата ER на предпочитаемом пользователем языке.

Если атрибут **Метка** в источнике данных **Параметр пользовательского ввода** связан с меткой ER, поле, соответствующее этому параметру, отображается в диалоговом окне пользователя во время выполнения на предпочтительном языке пользователя в виде приглашения. На следующем рисунке показано, как можно связать атрибут **Метка** в источнике данных **Параметр ввода пользователем** во время разработки с меткой ER, чтобы пользователи получали запрос на ввод параметров на разных предпочитаемых ими языках (показанным на английском языке США (EN-US) и языке DE-AT) во время выполнения.

![Перевод атрибутов параметра пользовательского ввода в конструкторе операций электронной отчетности.](./media/er-multilingual-labels-refer-format.png)

![Обработка электронной отчетности по платежу поставщику во время выполнения для предпочтительного языка пользователя EN-US.](./media/er-multilingual-labels-show-runtime-en.png)

![Обработка электронной отчетности по платежу поставщику во время выполнения для предпочтительного языка пользователя DE-AT.](./media/er-multilingual-labels-show-runtime-de.png)

### <a name="expressions"></a>Выражения

Для использования метки в [выражении](er-formula-language.md) ER необходимо использовать синтаксис **@"GER\_LABEL:X"**, где префикс **@** указывает, что операнд ссылается на метку, **GER\_LABEL** указывает, что используется метка ER, а **X** — это идентификатор метки ER.

![Настройка выражения ER, содержащего ссылку на метку ER в конструкторе формул ER.](./media/er-multilingual-labels-expression1.png)

Для ссылки на метку системы (приложения) используется синтаксис **@"X"**, где префикс **@** указывает, что операнд ссылается на метку, а **X** — это идентификатор системной метки.

![Настройка выражения ER, содержащего ссылку на метку приложения в конструкторе формул ER.](./media/er-multilingual-labels-expression2.png)

#### <a name="model-mapping"></a>Подбор модели

С помощью метки можно настроить выражение сопоставления модели ER. При вызове этого сопоставления в формате ER, который запускается для создания исходящего документа, контекст выполнения включает код языка. Настроенная метка выражения будет заполняться текстом метки, настроенным для языка данного контекста.

Если метка, на которую указывает ссылка, не имеет перевода для языка контекста выполнения формата, который вызывает сопоставление модели, вместо этого используется текст метки на языке EN-US.

#### <a name="format"></a>Формат

С помощью меток можно настроить выражение ER формата ER. При выполнении этого формата для создания исходящего документа, контекст выполнения включает код языка. Настроенная метка выражения будет заполняться текстом метки, настроенным для языка данного контекста.

![Предоставление перевода метки ER для редактируемого выражения ER в конструкторе формул ER.](./media/er-multilingual-labels-refer-in-expression.png)

![Образец привязки данных, ссылающейся на метку ER в конструкторе операций ER.](./media/er-multilingual-labels-refer-in-binding.png)

Можно настроить компонент **ФАЙЛ** в формате ER, чтобы создать отчет на выбранном пользователем языке.

![Настройте компонент файла в конструкторе операций ER, чтобы создать отчет в выбранном пользователем языке.](./media/er-multilingual-labels-language-context-user.png)

Если формат ER настроен таким образом, отчет создается с использованием соответствующего текста меток ER. На следующих рисунках показаны примеры отчетов для языков EN-US и DE-AT пользователя.

![Предварительный просмотр отчета, созданного в предпочитаемом языке пользователя EN-US.](./media/er-multilingual-labels-report-preview-en.png)

![Предварительный просмотр отчета, созданного в предпочитаемом языке пользователя DE-AT.](./media/er-multilingual-labels-report-preview-de.png)

Если метка, на которую указывает ссылка, не имеет перевода для языка контекста выполнения формата, вместо этого используется текст метки на языке EN-US.

## <a name="language"></a>Язык

ER поддерживает различные способы указания языка для созданного отчета. В поле **Языковые предпочтения** на вкладке **Формат** можно выбрать следующие значения:

- **Настройка компании** — создание отчета на языке, определенном компанией.

    ![Укажите в конструкторе операций ER предпочтительный язык компании в качестве языка созданного отчета.](./media/er-multilingual-labels-language-context-company.png)

- **Пользовательские предпочтения** — создание отчета на предпочтительном языке пользователя.
- **Явно определено** — создает отчет на языке, указанном во время разработки.

    ![Укажите в конструкторе операций ER определенный на этапе разработки язык в качестве языка созданного отчета.](./media/er-multilingual-labels-language-context-fixed.png)

- **Определено во время выполнения** — создает отчет на языке, указанном во время выполнения. Если выбрано это значение, в поле **Язык** настройте выражение ER, возвращающее код языка для языка, например, язык соответствующего клиента.

    ![Укажите в конструкторе операций ER определенный во время выполнения язык в качестве языка созданного отчета.](./media/er-multilingual-labels-language-context-runtime.png)

## <a name="culture-specific-formatting"></a>Форматирование, зависящее от культуры

ER поддерживает различные способы указания культуры для созданного отчета. Таким образом, правильное форматирование для определенной культуры может использоваться для значений даты, времени и числовых величин. При разработке формата ER на вкладке **Формат** в поле **Настройки культуры** можно выбрать одно из следующих значений для каждого компонента форматирования для **Общий\\файл**, **Файла\\Excel**, **PDF\\файла** или **PDF\\Merger**:

- **Пользовательская настройка** — форматирование значений в соответствии с предпочитаемым пользователем культурой пользователя. Эта культура определяется в поле **Дата, время и формат числа** на вкладке **Настройки** страницы **Параметры пользователя**.

    ![Определение предпочитаемого пользователем языка и региональных параметров в качестве языка и региональных параметров созданного отчета в конструкторе операций ER.](./media/er-multilingual-labels-culture-context-user-preferred.png)

- **Явно определено** — форматирует значения в соответствии с культурой, указанной во время разработки.

    ![Определение культуры, заданной во время разработки как культуры созданного отчета в конструкторе операций ER.](./media/er-multilingual-labels-culture-context-fixed.png)

- **Определено во время выполнения** — форматирует значения в соответствии с культурой, указанной во время выполнения. Если выбрано это значение, на вкладке **Сопоставление** в поле **Дата, время и формат числа** настройте выражение ER, которое возвращает код культуры для культуры, например, культуру соответствующего клиента.

    ![Определение культуры, заданное во время выполнения как культуры созданного отчета в конструкторе операций ER.](./media/er-multilingual-labels-culture-context-runtime.png)

> [!NOTE]
> Компонент ER, для которого определен язык и региональные параметры, может содержать дочерние компоненты ER, которые были настроены для заполнения текстового значения. По умолчанию для форматирования значений этих компонентов используется язык и региональные параметры родительского компонента. Можно использовать следующие встроенные функции ER для настройки привязок для этих компонентов и применения альтернативного языка и региональных параметров для форматирования значений:
>
> - [DATEFORMAT](er-functions-datetime-dateformat.md#syntax-2)
> - [DATETIMEFORMAT](er-functions-datetime-datetimeformat.md#syntax-2)
> - [NUMBERFORMAT](er-functions-text-numberformat.md#syntax-2)
>
> В версии 10.0.20 и более поздней языковой стандарт компонентов форматирования типов файлов **Общий\\файл** и **Excel\\файл** используется для форматирования значений во время [преобразования PDF](electronic-reporting-destinations.md#OutputConversionToPDF) для созданного документа.

## <a name="translation"></a>Трансляция

Можно добавить необходимые метки ER в редактируемый компонент электронной отчетности. При добавлении метки ER ее можно перевести двумя способами: вручную и автоматически.

### <a name="manual-translation"></a>Перевод вручную

При добавлении метки ER на [панель](#TextTranslationPane) **Перевод текста** ее можно перевести вручную на все языки, поддерживаемые в текущем экземпляре Finance. Можно выбрать предпочтительный язык в поле **Язык** в разделе **Системный язык** или **Язык пользователя**, ввести соответствующий текст в соответствующее поле **Переведенный текст**, затем выбрать **Перевести**. Этот процесс должен повторяться для каждого нужного языка и каждой добавляемой метки.

### <a name="automatic-translation"></a>Автоматический перевод

Настройка компонента электронной отчетности выполняется в черновой версии конфигурации ER, в которой находится редактируемый компонент ER.

![Страница конфигурации ER, предлагающая доступ к версии конфигурации в статусе черновика.](./media/er-multilingual-labels-configurations.png)

Как описано ранее в этом разделе, можно добавить необходимые метки электронной отчетности в редактируемый компонент электронной отчетности. Таким образом можно указать текст для меток ER на языке EN-US. Затем можно экспортировать метки компонента ER с помощью встроенной функции электронной отчетности. Выберите черновую версию конфигурации ER, которая содержит редактируемый компонент электронной отчетности, затем выберите **Обмен \> Экспорт меток**.

![Страница конфигурации ER, позволяющая экспортировать метки ER из выбранной версии конфигурации.](./media/er-multilingual-labels-export.png)

Можно экспортировать либо все метки, либо метки для одного языка, указанного в начале экспорта. Метки экспортируются как ZIP-файл, содержащий файлы XML. Каждый файл XML содержит метки для одного языка.

![Пример экспортированного файла, содержащего метки ER для языка DE-AT.](./media/er-multilingual-labels-in-xml.png)

Этот формат используется для автоматического перевода меток внешними службами перевода, такими как [Dynamics 365 Translation Service](../lifecycle-services/translation-service-overview.md). После получения переведенных меток их можно импортировать обратно в черновую версию конфигурации ER, содержащую компоненты электронной отчетности, которым принадлежат соответствующие метки. Выберите черновую версию конфигурации ER, которая содержит редактируемый компонент электронной отчетности, и выберите **Обмен \> Загрузить метки**.

![Страница конфигурации ER, позволяющая импортировать метки ER в выбранную версию конфигурации.](./media/er-multilingual-labels-load.png)

Переведенные метки будут импортированы в выбранную конфигурацию ER. Переведенные метки, существующие в этой конфигурации ER, заменяются. Если в конфигурации ER отсутствует переведенная метка, она добавляется.

## <a name="lifecycle"></a>Жизненный цикл

Метки компонента электронной отчетности, которые могут редактироваться, сохраняются вместе с другим содержимым компонента в соответствующей версии конфигурации ER.

На метки базового компонента электронной отчетности можно ссылаться в производной версии компонента ER, создаваемой для введения изменений.

Система управления версиями ER управляет назначением метки любому атрибуту в компоненте ER. Изменения назначения метки записываются в списке изменений (дельта) редактируемого компонента электронной отчетности, который был создан как производная версия предоставленного компонента электронной отчетности. Эти изменения будут проверены, когда производная версия будет переопределена в новую базовую версию.

## <a name="functions"></a>Функции

Встроенная функция ER [LISTOFFIELDS](er-functions-list-listoffields.md) может получить доступ к меткам ER, которые были настроены для некоторых элементов компонентов ER.

Как описывалось ранее в этом разделе, атрибуты **Метка** и **Описание** для каждого значения перечисления ER [модели](#LinkModelEnum) или [формата](#LinkFormatEnum) могут быть связаны с меткой ER, доступной в соответствующем компоненте электронной отчетности. Можно настроить выражение ER для вызова функции **LISTOFFIELDS**, используя в качестве аргумента перечисление ER. Это выражение возвращает список, содержащий запись для каждого значения перечисления ER, которое было определено в качестве аргумента данной функции. Каждая запись содержит значение метки ER, связанное со значением перечисления ER:

- Значение метки ER, связанной с атрибутами **Метка**, сохраняется в поле **Метка** возвращаемой записи.
- Значение метки ER, связанной с атрибутами **Описание**, сохраняется в поле **Описание** возвращаемой записи.

## <a name="performance"></a><a name=performance></a>Производительность

При настройке компонента формата электронной отчетности для создания отчета на предпочитаемом [языке](#language) или импорте входящего документа, в котором содержимое анализируется на предпочитаемом языке, рекомендуется включить функцию **Кэшировать предпочитаемый язык текущего пользователя для выполнения ER** в рабочей области [Управление функциями](../../fin-ops/get-started/feature-management/feature-management-overview.md). Эта функция позволяет повысить производительность, особенно для компонентов формата ER, которые содержат несколько ссылок на этикетки в формулах ER и привязки и множество правил [проверки](general-electronic-reporting-formula-designer.md#TestFormula) для создания сообщений пользователя на предпочитаемом языке.

При изменении статуса версии конфигурации ER с **черновик** на **завершено**, если версия конфигурации содержит метки ER, эти метки сохраняются в базе данных приложений. Схема хранения зависит от состояния функции **Ускорение хранения меток ER**:

- Если эта функция не активирована, все метки хранятся в поле **LABELXML** таблицы **ERSOLUTIONVERSIONTABLE** в виде единого фрагмента XML.
- Если эта функция включена, для каждого языка в таблице **ERSOLUTIONVERSIONLABELSTABLE** создается отдельная запись. В поле **CONTENTS** этой таблицы хранятся метки для каждого языка в виде сжатого фрагмента XML.

Рекомендуется включить функцию **Ускорение хранения меток ER** в рабочей области **управления функциями**. Эта функция позволяет повысить пропускную способность сети и общую производительность системы, поскольку в большинстве случаев метки ER одного языка используются при работе с одной конфигурацией ER.

Чтобы применить выбранную схему хранения для хранения меток всех конфигураций ER в текущем экземпляре Finance, выполните следующие действия.

1. Перейдите в **Администрирование организации** > **Периодический** > **Применить выбранную схему хранения меток для всех конфигураций ER**.
2. Нажмите **ОК**.


## <a name="additional-resources"></a>Дополнительные ресурсы

- [Обзор электронной отчетности](general-electronic-reporting.md)
- [Функции электронной отчетности](er-formula-language.md#Functions)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
