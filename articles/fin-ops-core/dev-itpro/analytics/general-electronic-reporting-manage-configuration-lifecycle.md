---
title: Управление жизненным циклом конфигураций электронной отчетности (ER)
description: В этой статье описывается, как управлять жизненным циклом конфигураций электронной отчетности (ER) для Dynamics 365 Finance.
author: kfend
ms.date: 07/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.custom: 58801
ms.assetid: 35ad19ea-185d-4fce-b9cb-f94584b14f75
ms.search.form: ERDataModelDesigner, ERMappedFormatDesigner, ERModelMappingDesigner, ERModelMappingTable, ERSolutionImport, ERSolutionTable, ERVendorTable, ERWorkspace
ms.openlocfilehash: fe23d4cb2b293af466df2236b153974f95f636f8
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/12/2022
ms.locfileid: "9271594"
---
# <a name="manage-the-electronic-reporting-er-configuration-lifecycle"></a>Управление жизненным циклом конфигураций электронной отчетности (ER)

[!include [banner](../includes/banner.md)]

В этой статье описывается, как управлять жизненным циклом [конфигураций](general-electronic-reporting.md#Configuration) [электронной отчетности](general-electronic-reporting.md) (ER) для Dynamics 365 Finance.

## <a name="overview"></a>Обзор

Электронная отчетность (ER) — это механизм для поддержки обязательных электронных документов, существующих в различных странах. Обычно ER подразумевает возможность выполнять следующие задачи для одного электронного документа. Дополнительные сведения см. в разделе [Обзор электронной отчетности (ER)](general-electronic-reporting.md).

- Создание шаблона для электронного документа:

    - Определение необходимых источников данных, которые могут быть представлены в документе:

        - Лежащие в основе данные, такие как таблицы данных, сущности данных и классы.
        - Свойства, относящиеся к конкретному процессу, такие как дата и время выполнения и часовой пояс.
        - Параметры пользовательского ввода, указанные конечным пользователь во время выполнения.

    - Определение необходимых элементов документа и их топологии для задания формата окончательного документа.
    - Конфигурирование желаемого потока данных из выбранных источников данных в заданные элементы документа (посредством привязки источников данных к компонентам формата документа) и задание логики управления процессом.

- Обеспечение доступности шаблона, чтобы его можно было использовать в других экземплярах:

    - Преобразование шаблона документа, созданного в конфигурации ER, и экспорт конфигурации из текущего экземпляра приложения в виде XML-пакета, который можно сохранить локально или в Lifecycle Services (LCS).
    - Преобразование конфигурации ER в шаблон документа приложения.
    - Импорт XML-пакета, который хранится локально или в LCS, в текущий экземпляр.

- Настройка шаблона электронного документа:

    - импорт шаблона из LCS в текущий экземпляр в качестве конфигурации ER;
    - конструирование пользовательской версии конфигурации ER с сохранением ссылки на ее базовую версию.

- Интеграция шаблона с определенным бизнес-процессом, чтобы он был доступен в приложении:

    - Настройка параметров так, чтобы приложение начало использовать конфигурацию ER, путем ссылки на эту конфигурацию в параметре, связанном с процессом. Например, задайте ссылку на конфигурацию ER в конкретном способе оплаты для расчетов с поставщиками, чтобы создавать сообщения электронных платежей для обработки накладных.

- Использование шаблона в конкретном бизнес-процессе:

    - Запуск созданной конфигурации ER в конкретном бизнес-процессе. Например, для формирования электронного платежного сообщения для обработки накладных, если выбран метод платежа, который ссылается на конфигурацию ER.

## <a name="concepts"></a>Концепции
Следующие роли и соответствующие действия связаны с жизненным циклом конфигурации ER.

| Роль                                       | Мероприятия                                                      | описание |
|--------------------------------------------|-----------------------------------------------------------------|-------------|
| Консультант по функциональным возможностям электронной отчетности | Создание компонентов ER (модели и форматы) и управление ими.           | Бизнес-специалист, который разрабатывает модели данных, специфичные для домена ER, разрабатывает необходимые шаблоны для электронных документов и связывает их соответствующим образом. |
| Разработчик электронной отчетности             | Создание сопоставлений моделей данных и управление ими.                          | Специалист, который выбирает необходимые источники данных Finance и связывает их с моделями данных, специфичными для домена ER. |
| Супервизор по учету                      | Задание настроек, связанных с процессом, которые ссылаются на артефакты ER. | Например, роль **Супервизор по учету**, которая позволяет использовать настройки конфигурации ER в определенном способе оплаты для расчетов с поставщиками, чтобы создавать сообщения электронных платежей для обработки накладных. |
| Сотрудник, обрабатывающий платежи по расчетам с поставщиками            | Использование артефактов ER в конкретном бизнес-процессе.                | Например, роль **Сотрудник, обрабатывающий платежи по расчетам с поставщиками**, позволяющая создавать сообщения электронного платежа для обработки накладных на основе формата ER, который настроен для определенного способа оплаты. |

## <a name="er-configuration-development-lifecycle"></a>Жизненный цикл разработки конфигурации ER
По следующим связанным с ER причинам рекомендуется разрабатывать конфигурации ER в среде разработки — отдельном экземпляре приложений для управления финансами и операциями:

- Пользователи, которые выполняют роли **Разработчик электронной отчетности** или **Консультант по функциональным возможностям электронной отчетности**, могут редактировать конфигурации и запускать их в целях тестирования. Этот сценарий может привести к вызовам методов классов и таблиц, которые могут повредить бизнес-данные и негативно сказаться на работе экземпляра.
- Вызовы методов классов и таблиц как источников данных ER конфигураций ER не ограничиваются точками входа и содержанием, принадлежащим вошедшей в систему компании. Это значит, что пользователи, которые играют роли **Разработчик электронной отчетности** или **Консультант по функциональным возможностям электронной отчетности**, могут получить доступ к конфиденциальным бизнес-данным.

Разработанные в среде разработки конфигурации электронной отчетности можно [отправлять](#data-persistence-consideration) в тестовую среду для оценки конфигурации (надлежащей интеграции в процесс, правильности результатов и быстродействия) и контроля качества, например правильность прав доступа на основе ролей и разделение обязанностей. Функции, которые включают обмен конфигурациями ER, можно использовать для этой цели. Проверенные конфигурации электронной отчетности можно либо отправлять в LCS, чтобы поделиться ими с подписчикам службы, или их можно [импортировать](#data-persistence-consideration) в рабочую среду для внутреннего использования.

![Жизненный цикл конфигурации электронной отчетности.](./media/ger-configuration-lifecycle.png)

## <a name="data-persistence-consideration"></a>Вопрос сохранения данных

Вы можете индивидуально [импортировать](tasks/er-import-configuration-lifecycle-services.md) разные [версии](general-electronic-reporting.md#component-versioning) [конфигурации](general-electronic-reporting.md#Configuration) электронной отчетности в ваш экземпляр Финансы. Когда импортируется новая версия конфигурации электронной отчетности, система управляет содержимым черновой версии данной конфигурации:

- Когда импортируемая версия ниже самой верхней версии данной конфигурации в текущем экземпляре Финансов, содержимое черновой версии этой конфигурации остается неизменным.
- Если импортируемая версия выше какой-либо другой версии данной конфигурации в текущем экземпляре Финансов, содержимое импортируемой версии копируется в черновую версию этой конфигурации, чтобы продолжить редактирование последней выполненной версии.

Если эта конфигурация принадлежит активированному в данный момент [поставщику](general-electronic-reporting.md#Provider) конфигурации, черновую версию этой конфигурации видят пользователь на экспресс-вкладке **версии** страницы **конфигурации** (**Администрирование организации** > **Электронная отчетность** > **Конфигурации**). Можно выбрать черновую версию конфигурации и [изменить](er-quick-start2-customize-report.md#ConfigureDerivedFormat) ее содержимое, используя соответствующий конструктор электронной отчетности. Когда вы редактируете черновую версию конфигурации электронной отчетности, ее содержимое больше не совпадает с содержимым самой последней версии данной конфигурации в текущем экземпляре Финансов. Чтобы избежать потери изменений, система выводит сообщение о том, что импорт не может быть продолжен из-за того, что версия этой конфигурации выше, чем максимальная версия данной конфигурации в текущем экземпляре Финансов. В таком случае, например, в конфигурации формата **X**, будет выводиться сообщение **Версия формата 'X' не завершена**.

Чтобы отменить изменения, введенные в черновую версию, выберите самую последнюю завершенную или общую версию вашей конфигурации электронной отчетности в Финансы на экспресс-вкладке **версии**, а затем выберите параметр **получить эту версию**. Содержимое выбранной версии копируется в черновую версию.

## <a name="applicability-consideration"></a>Соображения применимости

При разработке новой версии конфигурации ER можно определить [зависимость](tasks/er-define-dependency-er-configurations-from-other-components-july-2017.md) от других программных компонентов. Этот шаг считается необходимым условием для управления загрузкой версии этой конфигурации из репозитория электронной отчетности или внешнего файла XML и всего дальнейшего использования этой версии. При попытке импортировать новую версию конфигурации ER система использует настроенные необходимые компоненты, чтобы указать, можно ли импортировать эту версию.

В некоторых случаях может потребоваться, чтобы система игнорировала настроенные необходимые компоненты при импорте новых версий конфигурации ER. Чтобы система игнорировала необходимые условия при импорте, выполните следующие действия.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Установите флажок **Пропускать проверки обновлений продукта и обязательные условия версии при импорте** как **Да**.

    > [!NOTE]
    > Этот параметр используется отдельно для пользователя и для компании.

## <a name="dependencies-on-other-components"></a>Зависимости от других компонентов

Конфигурации электронной отчетности могут быть настроены как [зависимые](er-download-configurations-global-repo.md#import-filtered-configurations) от других конфигураций. Например, можно [импортировать](er-download-configurations-global-repo.md) конфигурацию [модели данных](er-overview-components.md#data-model-component) ER из глобального репозитория в ваш экземпляр [Microsoft Regulatory Configuration Services (RCS)](../../../finance/localizations/rcs-overview.md) или Dynamics 365 Finance, а затем создать новую конфигурацию [формата](er-overview-components.md#format-component) ER, являющуюся [производной](er-quick-start2-customize-report.md#DeriveProvidedFormat) от импортированной конфигурации модели данных ER. Производная конфигурация формата ER будет зависеть от основной конфигурации модели данных ER.

![Производная конфигурация формата ER на странице конфигураций.](./media/ger-configuration-lifecycle-img1.png)

После завершения создания формата можно изменить статус первоначальной [версии](general-electronic-reporting.md#component-versioning) формата ER с **Черновик** на **Завершено**. Затем можно использовать завершенную версию конфигурации формата ER, [опубликовав](../../../finance/localizations/rcs-global-repo-upload.md) ее в глобальном репозитории. Затем можно получить доступ к глобальному репозиторию из любого облачного экземпляра Finance или RCS. Затем можно импортировать любую версию конфигурации ER, применимую к приложению из глобального репозитория, в это приложение.

![Опубликованная конфигурация формата платежей ER на странице репозитория конфигураций.](./media/ger-configuration-lifecycle-img2.png)

При выборе конфигурации формата ER в глобальном репозитории для импорта в только что развернутый экземпляр RCS или Finance, основная конфигурация модели данных ER автоматически настраивается в глобальном репозитории и импортируется вместе с выбранной конфигурацией формата ER в качестве основной конфигурации (с учетом зависимости конфигурации).

Можно также экспортировать версию конфигурации формата ER из текущего экземпляра RCS или Finance и сохранить ее локально в виде XML-файла.

![Экспорт конфигурации формата ER в виде XML на странице конфигурации.](./media/ger-configuration-lifecycle-img3.png)

В версиях **Finance** до 10.0.29 при попытке импортировать версию конфигурации формата ER из этого XML-файла или из любого другого репозитория, отличного от глобального, во вновь развернутый экземпляр RCS или Finance, который еще не содержит никаких конфигураций ER, будет создано следующее исключение, сообщающее о том, что невозможно получить основную конфигурацию:

> Остались неразрешенные ссылки<br>
Не удается установить ссылку объекта "\<imported configuration name\>" на объект "Основная" (\<globally unique identifier of the missed base configuration\>, \<version of the missed base configuration\>).

![Импорт версии конфигурации формата ER на странице репозитория конфигураций.](./media/ger-configuration-lifecycle-img4.gif)

В версии **10.0.29 и более поздних** при попытке выполнить один и тот же импорт конфигурации, если базовая конфигурация не найдена в текущем экземпляре приложения или в исходном репозитории, используемом в данный момент (если применимо), среда ER будет автоматически пытаться найти имя отсутствующей базовой конфигурации в кэше глобального репозитория. После этого будет представлено имя и глобальный уникальный идентификатор (GUID) отсутствующей базовой конфигурации в тексте создаваемого исключения.

> Остались неразрешенные ссылки<br>
Не удается установить ссылку объекта "\<imported configuration name\>" на объект "Основная" (\<name of the missed base configuration\> \<globally unique identifier of the missed base configuration\>,\<version of the missed base configuration\>)

![Исключение на странице репозитория конфигураций, если базовая конфигурация не найдена.](./media/ger-configuration-lifecycle-img5.png)

Можно использовать предоставляемое имя для поиска основной конфигурации, а затем импортировать ее вручную.

> [!NOTE]
> Этот новый параметр работает только в том случае, если хотя бы один пользователь уже выполнил вход в глобальный репозиторий с помощью страницы [репозиториев конфигурации](er-download-configurations-global-repo.md#open-configurations-repository) или одного из полей [поиска](er-extended-format-lookup.md) в глобальном репозитории в текущем экземпляре Finance, а также при кэшировании содержимого глобального репозитория.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Обзор электронной отчетности (ER)](general-electronic-reporting.md)

[Определение зависимости конфигураций электронной отчетности от других компонентов](tasks/er-define-dependency-er-configurations-from-other-components-july-2017.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]

