---
title: Управление несколькими производными сопоставлениями для одного корня модели
description: В этой теме объясняется, как управлять несколькими производными сопоставлениями, которые были настроены для одного корня модели.
author: NickSelin
ms.date: 01/04/2021
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, ERModelMappingTable
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: a774a0edf00a17be674b7a1bb07f6494e90554c3
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "5743687"
---
# <a name="manage-several-derived-mappings-for-a-single-model-root"></a>Управление несколькими производными сопоставлениями для одного корня модели

[!include [banner](../includes/banner.md)]

Компонент [модели](general-electronic-reporting.md#data-model-and-model-mapping-components) данных [электронной отчетности (ER)](general-electronic-reporting.md) используется в каждом настроенном компоненте [формата](general-electronic-reporting.md#FormatComponentOutbound) электронной отчетности в качестве источника данных для создания исходящих документов. Для описания одного бизнес-домена настройте компонент модели данных, содержащий множество корневых определений. 

Каждое корневое определение позволяет представлять данные этого домена в том виде, в котором они лучше всего подходят для целей отчетности. Для каждого корневого определения можно настроить компонент [сопоставления модели](general-electronic-reporting.md#data-model-and-model-mapping-components) электронной отчетности в качестве специфической для Microsoft Dynamics 365 Finance реализации модели данных. Таким образом, вы описываете, как будет осуществляться заполнение модели данных во время выполнения.

Компоненты сопоставления модели электронной отчетности могут находиться в [конфигурациях](general-electronic-reporting.md#Configuration) модели данных электронной отчетности и в конфигурациях сопоставления моделей электронной отчетности. Одна конфигурация электронной отчетности может содержать множество компонентов сопоставления, каждый из которых настроен для одного корневого определения. В качестве альтернативы, одна конфигурация электронной отчетности может содержать только один компонент сопоставления, который настроен для одного корневого определения.

Многие поставщики конфигураций могут предоставлять конфигурации сопоставления моделей электронной отчетности для одной и той же модели данных электронной отчетности. Эти конфигурации сопоставления моделей могут содержать компоненты сопоставления для других корневых определений. Можно использовать сопоставление модели для одного корневого определения, предлагаемого одним [поставщиком](general-electronic-reporting.md#Provider), и использовать сопоставление модели для другого корневого определения, предлагаемого другим поставщиком.

В данном разделе описаны процедуры управления несколькими конфигурациями сопоставления моделей электронной отчетности для модели данных электронной отчетности, когда они содержат различные компоненты сопоставления моделей, настроенные для одного и того же корневого определения. 

Чтобы выполнить процедуры в этой теме необходимо, чтобы вам была назначена роль "Системный администратор" или "Разработчик электронной отчетности".

Все следующие процедуры могут выполняться в компании USMF. Написание кода не требуется.

## <a name="configure-the-er-framework"></a>Настройка платформы электронной отчетности

В качестве пользователя в роли разработчика электронной отчетности [настройте минимальный набор](er-quick-start2-customize-report.md#ConfigureFramework) параметров электронной отчетности, прежде чем можно будет начать использовать платформу электронной отчетности для создания бизнес-документов.

## <a name="import-the-standard-er-format-configurations"></a>Импорт стандартных конфигураций формата электронной отчетности

Чтобы добавить стандартные конфигурации электронной отчетности в текущий экземпляр Finance, необходимо импортировать их из репозитория электронной отчетности, который был настроен для этого экземпляра. Выполните действия, указанные в разделе [Загрузка конфигураций электронной отчетности из глобального репозитория службы конфигурации](er-download-configurations-global-repo.md), чтобы импортировать следующие конфигурации форматов электронной отчетности:

- **Накладная с произвольным текстом (Excel)**, версия 220.106
- **Накладная по проекту (Excel)**, версия 226.27

## <a name="review-the-imported-er-configurations"></a>Проверка импортированных конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной**.

    ![Проверка импортированных конфигураций на странице конфигураций](./media/er-multiple-model-mappings-image1.png)

4. Проверьте формат **Накладная с произвольным текстом (Excel)**:

    1. В дереве конфигураций в левой области выберите **Накладная с произвольным текстом (Excel)**.
    2. В области действий выберите **Конструктор**.
    3. На странице **Конструктор форматов** на вкладке **Сопоставление** в списке источников данных выберите **Модель**.
    4. Выберите **Представление**.
    
       Текущий формат электронной отчетности настроен на использование корневого определения **InvoiceCustomer** для параметра **Модель накладных**. При выполнении этого формата и вызове источника данных **Модель** для доступа к данным приложения и заполнения модели данных используется сопоставление модели, настроенное для корневого определения **InvoiceCustomer**.

        ![Проверка источника данных модели на странице конструктора форматов](./media/er-multiple-model-mappings-image2.png)

    6. Закройте страницу **Конструктор форматов**.

5. Просмотрите содержимое конфигурации **Сопоставления модели накладных**:

    1. В дереве конфигураций в левой области выберите **Сопоставление модели накладных**.
    2. В области действий выберите **Конструктор**.
    3. На странице **Сопоставление модели источнику данных** обратите внимание, что текущая конфигурация сопоставления модели электронной отчетности содержит несколько компонентов сопоставления моделей:

        + Сопоставление модели **Накладная клиента** настроено для корневого определения **InvoiceCustomer** пункта **Модель накладных**. Таким образом, при выполнении формата электронной отчетности **Накладная с произвольным текстом (Excel)** для доступа к данным приложения и заполнения модели данных может быть выбрано сопоставление модели **Накладная клиента** этой конфигурации электронной отчетности.
        + Сопоставление модели **Накладная по проекту** настроено для корневого определения **InvoiceProject** пункта **Модель накладных**. Таким образом, при выполнении формата электронной отчетности **Накладная по проекту (Excel)** для доступа к данным приложения и заполнения модели данных может быть выбрано сопоставление модели **Накладная по проекту** этой конфигурации электронной отчетности.

        ![Сопоставление модели накладных на странице сопоставления модели с источником данных](./media/er-multiple-model-mappings-image3.png)

    4. Закройте страницу **Сопоставление модели и источника данных**.
    5. На экспресс-вкладке **Версии** выберите **Удалить**, чтобы удалить все версии данной конфигурации электронной отчетности, которые позже версии 240.175.

6. Просмотрите содержимое конфигурации **Сопоставления модели накладных по проекту (RDP)**:

    1. В дереве конфигураций в левой области выберите **Сопоставление модели накладных по проекту (RDP)**.
    2. В области действий выберите **Конструктор**.
    3. На странице **Сопоставление модели с источником данных** обратите внимание, что текущая конфигурации сопоставления модели электронной отчетности содержит сопоставление модели **InvoiceProject**, и что это сопоставление модели настроено для корневого определения **InvoiceProject** пункта **Модель накладной**. При выполнении формата электронной отчетности **Накладная по проекту (Excel)** для доступа к данным приложения и заполнения модели данных выберите сопоставление модели **InvoiceProject** этой конфигурации электронной отчетности.

        ![Сопоставление модели накладных по проекту на странице сопоставления модели с источником данных](./media/er-multiple-model-mappings-image4.png)

    4. Закройте страницу **Сопоставление модели и источника данных**.
    5. На экспресс-вкладке **Версии** выберите **Удалить**, чтобы удалить все версии данной конфигурации электронной отчетности, которые позже версии 226.35.

## <a name="customize-the-imported-er-configurations"></a>Настройка импортированных конфигураций электронной отчетности

В этом разделе объясняется , как [настроить](er-quick-start3-customize-report.md#customize-the-model-mapping-configuration) сопоставления моделей, предоставляемых корпорацией Майкрософт. Например, настройка может потребоваться для реализации пользовательской логики или добавления отсутствующих привязок.

### <a name="customize-the-invoice-model-mapping-configuration"></a>Настройка конфигурации сопоставления моделей накладных

1. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Сопоставление модели накладных**.
2. В панели операций выберите **Создать конфигурацию**.
3. В раскрывающемся диалоговом окне **Создание конфигурации** в поле **Создать** выберите **Производное от имени: сопоставление моделей накладных, Microsoft**.
4. В поле **Имя** введите **Сопоставление моделей накладных Litware**.
5. Выберите **Создать конфигурацию**.
6. [Пометьте](er-quick-start2-customize-report.md#MarkFormatRunnable) [черновую](general-electronic-reporting.md#component-versioning) версию производного сопоставления как доступную для использования во время выполнения:

    1. В области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
    2. В диалоговом окне **Параметры пользователя** установите для параметра **Параметры выполнения** значение **Да**, затем выберите **ОК**.
    3. При необходимости выберите **Правка**, чтобы сделать страницу редактируемой.
    4. Для конфигурации **Сопоставления модели накладных Litware**, которая в настоящее время выбрана в дереве конфигурации, установите для параметра **Выполнить черновик** значение **Да**.

7. В области действий выберите **Конструктор** для просмотра сопоставлений моделей данной конфигурации.

    ![Проверка сопоставлений модели накладных на странице сопоставления модели с источником данных](./media/er-multiple-model-mappings-image5.png)

    > [!TIP]
    > Теперь можно открыть любой из компонентов модели электронной отчетности данной конфигурации электронной отчетности в конструкторе для настройки пользовательской логики. Дополнительные сведения см. в разделе [Настройка конфигурации сопоставления моделей](er-quick-start3-customize-report.md#customize-the-model-mapping-configuration).

8. Закройте страницу **Сопоставление модели и источника данных**.

Теперь у вас имеются конфигурации **Сопоставление модели накладных** и **Сопоставление модели накладных Litware**, каждая из которых имеет сопоставление модели, настроенное для корневого определения **InvoiceCustomer**. Явно назначьте одно из сопоставлений модели в качестве сопоставления модели по умолчанию, которое используется в любом из форматов электронной отчетности, таких как **Накладная с произвольным текстом (Excel)**, который содержит источник данных модели с корневым определением **InvoiceCustomer**. В противном случае при выполнении, изменении или проверке одного из форматов электронной отчетности создается следующее исключение, уведомляющее о том, что сопоставление модели по умолчанию не было явно назначено:
 
> Более одного сопоставления модели существует для модели данных "\<model name\> (\<root descriptor\>)" в конфигурациях \<configuration names separated by commas\>. Установите одну из конфигураций по умолчанию.

![Открытие формата для редактирования на странице конфигураций](./media/er-multiple-model-mappings-image6.gif)

### <a name="customize-the-project-invoice-model-mapping-rdp-configuration"></a>Настройка конфигурации сопоставления моделей накладных по проекту (RDP)

1. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Сопоставление модели накладных по проекту (RDP)**.
2. В панели операций выберите **Создать конфигурацию**.
3. В диалоговом окне **Создание конфигурации** в поле **Создать** выберите **Производное от имени: сопоставление моделей накладных по проекту (RDP)**.
4. В поле **Имя** введите **Сопоставление моделей накладных по проекту Litware**.
5. Выберите **Создать конфигурацию**.
6. Для конфигурации **Сопоставления модели накладных по проекту Litware**, которая в настоящее время выбрана в дереве конфигурации, установите для параметра **Выполнить черновик** значение **Да**.
7. В области действий выберите **Конструктор** для просмотра сопоставлений моделей данной конфигурации.

    ![Проверка настроенных сопоставлений модели накладных по проекту на странице сопоставления модели с источником данных](./media/er-multiple-model-mappings-image7.png)

8. Закройте страницу **Сопоставление модели и источника данных**.

Теперь у вас есть конфигурации **Сопоставление модели накладных**, **Сопоставление модели накладных по проекту (RDP)** и **Сопоставление модели накладных по проекту Litware**. Каждая из этих конфигураций имеет сопоставление моделей, настроенное для корневого определения **InvoiceProject**. Явно назначьте одно из сопоставлений модели в качестве сопоставления модели по умолчанию, которое используется в любом из форматов электронной отчетности. Например, используйте формат **Накладная по проекту (Excel)**, который содержит источник данных модели с корневым определением **InvoiceProject**. В противном случае при выполнении или изменении одного из форматов электронной отчетности создается исключение, уведомляющее о том, что сопоставление модели по умолчанию не было явно назначено.

## <a name="select-the-derived-invoice-model-mapping-litware-configuration-as-the-configuration-that-contains-default-model-mappings"></a>Выберите производную конфигурацию сопоставления модели накладной Litware в качестве конфигурации, содержащей сопоставления модели по умолчанию.

1. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Сопоставление модели накладных Litware**.
2. Установите для параметра **По умолчанию для сопоставления модели** значение **Да**.

    ![Задание сопоставления модели в качестве сопоставления модели по умолчанию на странице конфигураций](./media/er-multiple-model-mappings-image8.png)

    В связи с этой настройкой сопоставление модели **Копирования накладной клиента** используется при выполнении формата **Накладная с произвольным текстом (Excel)**, а также при ее редактировании или проверке. Сопоставление модели **Накладная клиента** из конфигурации **Сопоставление модели накладных** игнорируется.

    Теперь можно открыть формат **Накладная с произвольным текстом (Excel)** для просмотра в конструкторе форматов.

## <a name="select-the-derived-project-invoice-model-mapping-litware-configuration-as-the-configuration-that-contains-default-model-mappings"></a>Выберите производную конфигурацию сопоставления модели накладной по проекту Litware в качестве конфигурации, содержащей сопоставления модели по умолчанию.

1. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Сопоставление модели накладных по проекту Litware**.
2. Установите для параметра **По умолчанию для сопоставления модели** значение **Да**.

    В этом случае, в отличие от случая, описанного для конфигурации **Сопоставление модели накладных Litware** в предыдущем разделе, невозможно будет начать использовать сопоставление модели **Копирование InvoiceProject** из конфигурации **Сопоставление модели накладных по проекту Litware**. Две конфигурации, содержащие сопоставление модели для конревого определения **InvoiceProject**, в настоящее время отмечены в качестве конфигурации по умолчанию. Поэтому они имеют одинаковый приоритет для использования. Чтобы решить эту проблему, выполните остальные шаги этой процедуры.

3. В дереве конфигураций в левой области выберите **Сопоставление модели накладных Litware**.
4. В области действий выберите **Конструктор**.
5. На странице **Сопоставление модели с источником данных** выберите **Правка**, чтобы сделать страницу редактируемой в соответствии с требованиями.
6. Выберите сопоставление модели **Копирование накладных по проекту**, затем установите флажок **Удалено** для него.

    ![Задание сопоставления модели как виртуально удаленной на странице сопоставления модели с источником данных](./media/er-multiple-model-mappings-image9.png)

    Вследствие этой настройки конфигурация **Сопоставление модели накладных Litware** обрабатывается, как будто она не имеет сопоставления модели для корневого определения **InvoiceProject**. Сопоставление модели **Копирование InvoiceProject**, выпущенной по умолчанию. Конфигурация **Сопоставления модели накладной по проекту Litware**, которая содержит это сопоставление модели, помечается как конфигурация по умолчанию. Поскольку она помечена как используемая по умолчанию, она имеет более высокий приоритет, чем сопоставление модели **InvoiceProject** из конфигурации **Сопоставления модели накладных по проекту (RDP)**.

## <a name="other-considerations"></a>Другие вопросы

Сопоставление модели **Копирование InvoiceProject** конфигурации **Сопоставление модели накладных по проекту Litware** предназначена для использования источника данных **ReportDataProvider**. Источник данных является частью типа *Объект*, который ссылается на класс приложения **PsaProjInvoiceDP**. Этот класс реализован в качестве поставщика данных для отчета служб SQL Server Reporting Services (SSRS) по накладным по проектам платформы управления печатью. Выберите этот источник данных в качестве [точки интеграции](er-apis-app10-0-11.md#api-to-run-a-format-mapping-for-the-generation-of-outbound-documents) электронной отчетности. Текущая реализация электронной отчетности для отчетов управления печатью учитывает этот параметр. Дополнительные сведения см. в исходном коде класса приложения **ERPrintMgmtDataProviderReport**. Во время выполнения назначение источника данных **ReportDataProvider** как точки интеграции сопоставления моделей заставляет Finance обрабатывать этот компонент сопоставления с более высоким приоритетом, чем компонент сопоставления **InvoiceProject** из конфигурации **Сопоставление модели накладных по проекту (RDP)**.

## <a name="see-also"></a>См. также

- [Управление сопоставлением модели электронной отчетности в отдельных конфигурациях электронной отчетности](./tasks/er-manage-model-mapping-configurations-july-2017.md)
- [Настройка сопоставлений моделей электронной отчетности (ER) с учетом контекста страны](er-country-dependent-model-mapping.md)
- [Изменения API платформы электронной отчетности](er-apis-app10-0-11.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]