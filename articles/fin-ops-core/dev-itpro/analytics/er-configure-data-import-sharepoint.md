---
title: Настройка импорта данных из SharePoint
description: В этой теме объясняется, как импортировать данные из Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: c11123c0d53fcf4ba67e83fe64d2d6e692d5b6f1
ms.sourcegitcommit: fbc106af09bdadb860677f590464fb93223cbf65
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "2771360"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="a9244-103">Настройка импорта данных из SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="a9244-104">Чтобы импортировать данные из входящего файла с помощью платформы для электронной отчетности (электронной отчетности), необходимо конфигурировать формат электронной отчетности, которая поддерживает импорт, и запустить соответствие модели типу **К месту назначения**, в котором используется данный формат в качестве источника данных.</span><span class="sxs-lookup"><span data-stu-id="a9244-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="a9244-105">Чтобы импортировать данные, необходимо перейти к файлу, который требуется импортировать.</span><span class="sxs-lookup"><span data-stu-id="a9244-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="a9244-106">Входящий файл может быть вручную выбран пользователем.</span><span class="sxs-lookup"><span data-stu-id="a9244-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="a9244-107">При помощи новых возможностей электронной отчетности для поддержки импорта данных из Microsoft SharePoint можно настроить этот процесс как не требующий участия пользователя.</span><span class="sxs-lookup"><span data-stu-id="a9244-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="a9244-108">Чтобы выполнить импорт данных из файлов, которые хранятся в папках Microsoft SharePoint можно использовать конфигурации аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="a9244-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="a9244-109">В этом разделе объясняется, как выполнить импорт из SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a9244-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="a9244-110">В примерах используются транзакции по поставщику по поставщику в качестве бизнес-данных.</span><span class="sxs-lookup"><span data-stu-id="a9244-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="a9244-111">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="a9244-111">Prerequisites</span></span>
<span data-ttu-id="a9244-112">Чтобы завершить примеры из этой темы необходимы следующие возможности доступа:</span><span class="sxs-lookup"><span data-stu-id="a9244-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="a9244-113">Доступ к одной из следующих ролей:</span><span class="sxs-lookup"><span data-stu-id="a9244-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="a9244-114">Разработчик электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="a9244-115">Консультант по функциональным возможностям электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="a9244-116">Системный администратор</span><span class="sxs-lookup"><span data-stu-id="a9244-116">System administrator</span></span>

- <span data-ttu-id="a9244-117">Откройте экземпляр Microsoft SharePoint Server, который настроен для использования с приложением.</span><span class="sxs-lookup"><span data-stu-id="a9244-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="a9244-118">Конфигурации формата и модели электронной отчетности для платежей по форме 1099.</span><span class="sxs-lookup"><span data-stu-id="a9244-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="a9244-119">Создать необходимые конфигурации электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-119">Create required ER configurations</span></span>
<span data-ttu-id="a9244-120">Запустите проводники по задаче **Импорт данных электронной отчетности из файла Microsoft Excel**, входящие в состав бизнес-процесса **7.5.4.3 Приобретение/разработка компонентов ИТ-услуг и решений (10677)**.</span><span class="sxs-lookup"><span data-stu-id="a9244-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="a9244-121">Эти проводники по задаче объясняет процесс разработки и использования конфигураций электронной отчетности для интерактивного импорта проводок по поставщику из файлов Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="a9244-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="a9244-122">Дополнительные сведения см. в разделе [Разбор входящих документов в формате Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a9244-122">For more information, see [Parse incoming documents in Excel format](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="a9244-123">После завершения руководств по задачам вы будете иметь следующие настройки.</span><span class="sxs-lookup"><span data-stu-id="a9244-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="a9244-124">Конфигурации электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-124">ER configurations</span></span>

- <span data-ttu-id="a9244-125">Конфигурация модели электронной отчетности, **Модель платежей по форме 1099**</span><span class="sxs-lookup"><span data-stu-id="a9244-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="a9244-126">Конфигурации формата электронной отчетности, **Формат для импорта проводок поставщиков из Excel**</span><span class="sxs-lookup"><span data-stu-id="a9244-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![Конфигурации электронной отчетности для импорта данных из SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="a9244-128">Образец входящего файла для импорта данных</span><span class="sxs-lookup"><span data-stu-id="a9244-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="a9244-129">Файл Excel **1099import data.xlsx**, с транзакциями поставщика, которые должны быть импортированы.</span><span class="sxs-lookup"><span data-stu-id="a9244-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![Образец файла Microsoft Excel для импорта из SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="a9244-131">Формат для импорта проводок поставщика выбран в качестве сопоставление модели по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a9244-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="a9244-132">Таким образом, если выполнить сопоставление модели **Модель платежей по форме 1099** и это сопоставления модели типа **К месту назначения**, сопоставление модели выполняет этот формат, чтобы импортировать данные из внешних файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="a9244-133">Затем эти данные используются для обновления таблицы приложения.</span><span class="sxs-lookup"><span data-stu-id="a9244-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="a9244-134">Настройка доступа к SharePoint для хранения файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="a9244-135">Для хранения файлов электронных отчетов в расположении SharePoint необходимо настроить доступ к экземпляру SharePoint Server, который будет использоваться текущей компанией.</span><span class="sxs-lookup"><span data-stu-id="a9244-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="a9244-136">В этом примере это компания USMF.</span><span class="sxs-lookup"><span data-stu-id="a9244-136">In this example, the company is USMF.</span></span> <span data-ttu-id="a9244-137">Инструкции см. в разделе [Настройка хранения в SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="a9244-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="a9244-138">Выполните шаги из раздела [Настройка хранения в SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="a9244-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="a9244-139">Откройте настроенный сайт SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a9244-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="a9244-140">Создайте следующие папки, в которых будут храниться входящие файлы электронной отчетности:</span><span class="sxs-lookup"><span data-stu-id="a9244-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="a9244-141">Источник импорта файлов (основной) (пример показан на снимке экрана ниже)</span><span class="sxs-lookup"><span data-stu-id="a9244-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="a9244-142">Источник импорта файлов (альтернативный)</span><span class="sxs-lookup"><span data-stu-id="a9244-142">Files import source (alternative)</span></span>

    ![Источник импорта файлов (основной)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="a9244-144">(Необязательно) Создайте следующие папки, в которых будут храниться файлы после импорта.</span><span class="sxs-lookup"><span data-stu-id="a9244-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="a9244-145">Папка архива файлов — эта папка предназначена для успешно импортированных файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="a9244-146">Папка для файлов с предупреждениями — эта папка предназначена для файлов, которые были импортированы с предупреждением.</span><span class="sxs-lookup"><span data-stu-id="a9244-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="a9244-147">Папка для файлов с ошибками — эта папка предназначена для файлов, импорт которых завершился сбоем.</span><span class="sxs-lookup"><span data-stu-id="a9244-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="a9244-148">Выберите **Управление организацией > Управление документами > Типы документов**.</span><span class="sxs-lookup"><span data-stu-id="a9244-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="a9244-149">Создайте следующие типы документов, которые будут использоваться для доступа к папкам SharePoint, которые были созданы.</span><span class="sxs-lookup"><span data-stu-id="a9244-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="a9244-150">Инструкции см. в разделе [Настройка типов документов](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="a9244-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="a9244-151">Вид документа</span><span class="sxs-lookup"><span data-stu-id="a9244-151">Document type</span></span>       | <span data-ttu-id="a9244-152">Групповое</span><span class="sxs-lookup"><span data-stu-id="a9244-152">Group</span></span>              | <span data-ttu-id="a9244-153">Местоположение</span><span class="sxs-lookup"><span data-stu-id="a9244-153">Location</span></span>      | <span data-ttu-id="a9244-154">Папка SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="a9244-155">Основной полуфабрикат</span><span class="sxs-lookup"><span data-stu-id="a9244-155">SP Main</span></span>             |<span data-ttu-id="a9244-156">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-156">File</span></span>                |<span data-ttu-id="a9244-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-157">SharePoint</span></span>     |<span data-ttu-id="a9244-158">Источник импорта файлов (основной)</span><span class="sxs-lookup"><span data-stu-id="a9244-158">Files import source (main)</span></span>|
|<span data-ttu-id="a9244-159">Альтернативный полуфабрикат</span><span class="sxs-lookup"><span data-stu-id="a9244-159">SP Alternative</span></span>             |<span data-ttu-id="a9244-160">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-160">File</span></span>                |<span data-ttu-id="a9244-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-161">SharePoint</span></span>     |<span data-ttu-id="a9244-162">Источник импорта файлов (альтернативный)</span><span class="sxs-lookup"><span data-stu-id="a9244-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="a9244-163">Архив SP</span><span class="sxs-lookup"><span data-stu-id="a9244-163">SP Archive</span></span>             |<span data-ttu-id="a9244-164">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-164">File</span></span>                |<span data-ttu-id="a9244-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-165">SharePoint</span></span>     |<span data-ttu-id="a9244-166">Папка архива файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-166">Files archive folder</span></span>|
|<span data-ttu-id="a9244-167">Предупреждение SP</span><span class="sxs-lookup"><span data-stu-id="a9244-167">SP Warning</span></span>             |<span data-ttu-id="a9244-168">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-168">File</span></span>                |<span data-ttu-id="a9244-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-169">SharePoint</span></span>     |<span data-ttu-id="a9244-170">Папка для файлов с предупреждениями</span><span class="sxs-lookup"><span data-stu-id="a9244-170">Files warning folder</span></span>|
|<span data-ttu-id="a9244-171">Ошибка SP</span><span class="sxs-lookup"><span data-stu-id="a9244-171">SP Error</span></span>             |<span data-ttu-id="a9244-172">Хранилище файлов</span><span class="sxs-lookup"><span data-stu-id="a9244-172">File</span></span>                |<span data-ttu-id="a9244-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-173">SharePoint</span></span>     |<span data-ttu-id="a9244-174">Папка для файлов с ошибками</span><span class="sxs-lookup"><span data-stu-id="a9244-174">Files error folder</span></span>|

![Настройка SharePoint — новый тип документа](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="a9244-176">Настроить источники электронной отчетности для формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="a9244-177">Перейдите в раздел **Управление организацией** \> **Электронная отчетность** \> **Источник электронной отчетности**.</span><span class="sxs-lookup"><span data-stu-id="a9244-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="a9244-178">На странице **Источник электронной отчетности** настройте исходные файлы для импорта данных с использованием сконфигурированного формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="a9244-179">Определите маску имени файла, таким образом, чтобы импортировались только файлы с расширением .xlsx.</span><span class="sxs-lookup"><span data-stu-id="a9244-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="a9244-180">Маска имени файла является необязательной и используется только в том случае, если она была определена.</span><span class="sxs-lookup"><span data-stu-id="a9244-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="a9244-181">Можно определить только одну маску для каждого формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="a9244-182">Измените значение параметра **Сортировать файлы перед импортом** на **Не сортировать**, если существует много файлов для импорта и не важен порядок импорта</span><span class="sxs-lookup"><span data-stu-id="a9244-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="a9244-183">Выберите все папки SharePoint, которые были созданы ранее.</span><span class="sxs-lookup"><span data-stu-id="a9244-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="a9244-184">[![Настройка источника файлов электронной отчетности](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="a9244-185">*Источник* электронной отчетности определяется индивидуально для каждой компании приложения.</span><span class="sxs-lookup"><span data-stu-id="a9244-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="a9244-186">Напротив, *Конфигурации* электронной отчетности используются совместно несколькими компаниями.</span><span class="sxs-lookup"><span data-stu-id="a9244-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="a9244-187">При удалении настройки источника электронной отчетности в формате электронной отчетности также удаляются все состояния связанного файла (см. ниже) при подтверждении.</span><span class="sxs-lookup"><span data-stu-id="a9244-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="a9244-188">Просмотрите состояния файлов для формата электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="a9244-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="a9244-189">На странице **Источник электронной отчетности** выберите **Состояния файлов для источников** для просмотра содержимого источников файлов, настроенных для текущего формата электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="a9244-190">В разделе **Файлы** просмотрите список файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="a9244-191">Этот список будут включены следующие:</span><span class="sxs-lookup"><span data-stu-id="a9244-191">This list presents the following:</span></span>

    - <span data-ttu-id="a9244-192">Исходные файлы, которые применимы на основе маски имя файла (если маска файла определена), и готовые для импорта данных.</span><span class="sxs-lookup"><span data-stu-id="a9244-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="a9244-193">Для этих файлов раздел **Журналы источников для формата импорта** пуст.</span><span class="sxs-lookup"><span data-stu-id="a9244-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="a9244-194">Ранее импортированные файлы.</span><span class="sxs-lookup"><span data-stu-id="a9244-194">Previously imported files.</span></span> <span data-ttu-id="a9244-195">Для каждого из этих файлов, в разделе **Журналы источников для формата импорта** можно просмотреть историю импорта этого файла.</span><span class="sxs-lookup"><span data-stu-id="a9244-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="a9244-196">Можно также открыть страницу **Состояния файлов для источников**, выбрав **Управление организацией** \> **Электронная отчетность** \> **Состояния файлов для источников**.</span><span class="sxs-lookup"><span data-stu-id="a9244-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="a9244-197">В этом случае страница предоставляет сообщение об источниках файла для всех форматов электронной отчетности, которые были сконфигурированы для источников файлов в компании, в которую выполнен вход в данный момент.</span><span class="sxs-lookup"><span data-stu-id="a9244-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="a9244-198">Импорт данных из файлов Excel, которые находятся в папке SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="a9244-199">В SharePoint необходимо отправить файл Microsoft Excel **1099import data.xlsx**, содержащий транзакции поставщика, в папку SharePoint **Источник импорта файлов (основной)**, созданную ранее.</span><span class="sxs-lookup"><span data-stu-id="a9244-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="a9244-200">[![Содержимое SharePoint — файл Microsoft Excel для импорта](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="a9244-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="a9244-201">На странице **Состояния файлов для источников** выберите **Обновить** для обновления страницы.</span><span class="sxs-lookup"><span data-stu-id="a9244-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="a9244-202">Обратите внимание, что файл Excel, отправленный в SharePoint, появился на этой странице со статусом **Готово**.</span><span class="sxs-lookup"><span data-stu-id="a9244-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="a9244-203">На данный момент поддерживаются следующие статусы:</span><span class="sxs-lookup"><span data-stu-id="a9244-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="a9244-204">**Готово** — назначается автоматически для каждого нового файла в папке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a9244-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="a9244-205">Этот статус означает, что файл готов для импорта.</span><span class="sxs-lookup"><span data-stu-id="a9244-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="a9244-206">**Выполняется импорт** — назначается автоматически отчетом по электронной отчетности, когда файл будет заблокирован процессом импорта для предотвращения использования другими процессами (при одновременном запуске многие из них).</span><span class="sxs-lookup"><span data-stu-id="a9244-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="a9244-207">**Импортировано** — назначается автоматически отчетом по электронной отчетности после успешного завершения импорта файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="a9244-208">Этот статус означает, что импортируемый файл был удален из конфигурированного источника файлов (папка SharePoint).</span><span class="sxs-lookup"><span data-stu-id="a9244-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="a9244-209">**Сбой** — назначается автоматически отчетом по электронной отчетности, когда импорт файла завершается с ошибками или исключениями.</span><span class="sxs-lookup"><span data-stu-id="a9244-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="a9244-210">**Заблокировано** — назначается вручную пользователем на этой странице.</span><span class="sxs-lookup"><span data-stu-id="a9244-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="a9244-211">Этот статус означает, что файл не будут импортированы в данный момент.</span><span class="sxs-lookup"><span data-stu-id="a9244-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="a9244-212">Этот статус используется для откладывания некоторых файлов импорта.</span><span class="sxs-lookup"><span data-stu-id="a9244-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="a9244-213">[![Страница состояния файла электронной отчетности для выбранных источников](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="a9244-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="a9244-214">Импорт данных из файлов SharePoint</span><span class="sxs-lookup"><span data-stu-id="a9244-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="a9244-215">Откройте дерево конфигурации электронной отчетности, выберите **Модель платежей по форме 1099**и разверните список компонентов модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="a9244-216">Выберите имя сопоставления модели, чтобы открыть список сопоставлений модели конфигурации выбранной модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="a9244-217">[![Страница состояния файла электронной отчетности для выбранных источников](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="a9244-218">Выберите **Выполнить** для выполнения сопоставления выбранной модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="a9244-219">Так как источники файла для формата электронной отчетности были сконфигруированы, можно изменять настройку параметра **Источник файла**, если требуется.</span><span class="sxs-lookup"><span data-stu-id="a9244-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="a9244-220">Если сохранить настройку этого параметра, файлы .xslx импортируются из конфигурируемых источников (в данном примере, папки SharePoint).</span><span class="sxs-lookup"><span data-stu-id="a9244-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="a9244-221">В этом примере импортируется только один файл.</span><span class="sxs-lookup"><span data-stu-id="a9244-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="a9244-222">Тем не менее если имеется множественные файлы, они будут выбраны для импорта в том порядке, в котором они были добавлены в папку SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a9244-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="a9244-223">Каждое выполнения формата электронной отчетности импортирует один выбранный файл.</span><span class="sxs-lookup"><span data-stu-id="a9244-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="a9244-224">[![Запустить сопоставление модели электронной отчетности](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="a9244-225">Сопоставление модели может запускаться автоматически в пакетном режиме.</span><span class="sxs-lookup"><span data-stu-id="a9244-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="a9244-226">В этом случае каждый раз, когда пакетное задание будет выполнять этот формат электронной отчетности, будет импортироваться один файл из конфигурированных источников файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="a9244-227">Когда файл из папки SharePoint успешно импортирован, он удаляется из этой папки и перемещается в папку для успешно импортированных файлов или в папку для импортированных файлов с предупреждениями.</span><span class="sxs-lookup"><span data-stu-id="a9244-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="a9244-228">В противном случае он перемещается в папку для файлов со сбоями или остается в этой папке, если папка для файлов со сбоями не настроена.</span><span class="sxs-lookup"><span data-stu-id="a9244-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="a9244-229">Введите идентификатор ваучера, например **V-00001**, а затем выберите **OK**.</span><span class="sxs-lookup"><span data-stu-id="a9244-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="a9244-230">[![Запустить сопоставление моделиэлектронной отчетности](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="a9244-231">На странице **Состояния файлов для источников** выберите **Обновить** для обновления страницы.</span><span class="sxs-lookup"><span data-stu-id="a9244-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="a9244-232">[![Страница состояния файла электронной отчетности для выбранных источников](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="a9244-233">В разделе **Файлы** просмотрите список файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="a9244-234">Раздел **Журналы источников для формата импорта** содержит журнал импорта файлов Excel.</span><span class="sxs-lookup"><span data-stu-id="a9244-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="a9244-235">Так как этот файл был успешно завершен, он помечается как **Удалено** в папке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a9244-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="a9244-236">Проверьте папку SharePoint **Источник импорта файлов (основной)**.</span><span class="sxs-lookup"><span data-stu-id="a9244-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="a9244-237">Файлы Excel, которые были успешно импортированы, были удалены из этой папки.</span><span class="sxs-lookup"><span data-stu-id="a9244-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="a9244-238">Перейдите в раздел **Расчеты с поставщиками** \> **Периодические задачи** \> **Налог по форме 1099** \> **Сопоставление поставщика для формы 1099**.</span><span class="sxs-lookup"><span data-stu-id="a9244-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="a9244-239">В полях **Дата начала** и **Дата окончания** введите соответствующие значения.</span><span class="sxs-lookup"><span data-stu-id="a9244-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="a9244-240">Затем выберите **транзакции по форме 1099 вручную**.</span><span class="sxs-lookup"><span data-stu-id="a9244-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="a9244-241">транзакции поставщика, которые были импортированы из файлов Excel на сайте SharePoint для ваучера **V-00001**, будут показаны на странице.</span><span class="sxs-lookup"><span data-stu-id="a9244-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="a9244-242">[![Страница проводок поставщика по форме 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="a9244-243">Подготовить файл Excel к импорту</span><span class="sxs-lookup"><span data-stu-id="a9244-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="a9244-244">Открытие файла Excel, который использовался ранее.</span><span class="sxs-lookup"><span data-stu-id="a9244-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="a9244-245">В строке 1 столбца 3 добавьте код поставщика, который не существует в приложении.</span><span class="sxs-lookup"><span data-stu-id="a9244-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="a9244-246">Добавьте дополнительную дополнительную ложную информацию поставщика в строку.</span><span class="sxs-lookup"><span data-stu-id="a9244-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="a9244-247">[![Образец файла Microsoft Excel для импорта из SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="a9244-248">Отправьте обновленный файл Excel, содержащий транзакции поставщиков, в папку SharePoint **Источник импорта файлов (основной)**.</span><span class="sxs-lookup"><span data-stu-id="a9244-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="a9244-249">Откройте дерево конфигурации электронной отчетности, выберите **Модель платежей по форме 1099**и разверните список компонентов модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="a9244-250">Выберите имя сопоставления модели, чтобы обновить сопоставление модели таким образом, чтобы неверный код поставщика был оценен как ошибка во время импорта данных.</span><span class="sxs-lookup"><span data-stu-id="a9244-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="a9244-251">Выберите **Конструктор**.</span><span class="sxs-lookup"><span data-stu-id="a9244-251">Select **Designer**.</span></span>
6. <span data-ttu-id="a9244-252">На вкладке **Проверки** необходимо изменить действие после проверки для правила проверки, которое было настроено для оценки наличия счета поставщика, который был импортирован в приложении.</span><span class="sxs-lookup"><span data-stu-id="a9244-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="a9244-253">Обновите значение поля **Действия после проверки** на **Остановить выполнение**, сохранить изменения и закрыть страницу.</span><span class="sxs-lookup"><span data-stu-id="a9244-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="a9244-254">[![Страница конструктора сопоставления модели электронной отчетности](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="a9244-255">Сохраните изменения и закройте конструктор сопоставления модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="a9244-256">Выберите **Выполнить** для выполнения сопоставления модифицированной модели электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="a9244-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="a9244-257">Введите идентификатор ваучера, например **V-00002**, а затем выберите **OK**.</span><span class="sxs-lookup"><span data-stu-id="a9244-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="a9244-258">Обратите внимание, что в окне Infolog содержатся уведомления о том, что в папке SharePoint находится файл, который содержит неверный код поставщика и не может быть импортирован.</span><span class="sxs-lookup"><span data-stu-id="a9244-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="a9244-259">[![Конструктор-сопоставления-модели-ER</1](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="a9244-260">На странице **Состояния файла для источников** выберите **Обновить**и затем в разделе **Файлы** просмотрите список файлов.</span><span class="sxs-lookup"><span data-stu-id="a9244-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="a9244-261">[![Страница состояния файла ER для выбранных источников](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="a9244-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="a9244-262">Раздел **Журналы источников для формата импорта** указывает, что произошла ошибка при импорте и файл до сих пор находится в папке SharePoint для файлов с ошибками (флажок **Удален** не установлен).</span><span class="sxs-lookup"><span data-stu-id="a9244-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="a9244-263">Если исправить этот файл на сайте SharePoint, добавив правильный код поставщика, затем переместить его в папку SharePoint источника импорта файлов (основного), можно импортировать этот файл еще раз.</span><span class="sxs-lookup"><span data-stu-id="a9244-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="a9244-264">Выберите **Расчеты с поставщиками** \> **Периодические задачи** \> **Налог по форме 1099** \> **Сопоставление записей поставщика по форме 1099**, введите соответствующие значения в поля **Дата начала** и **Дата окончания**, а затем выберите **транзакции пр форме 1099 вручную**.</span><span class="sxs-lookup"><span data-stu-id="a9244-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="a9244-265">Доступны только транзакции для ваучера V-00001.</span><span class="sxs-lookup"><span data-stu-id="a9244-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="a9244-266">Нет проводок для ваучера V-00002, несмотря на то, что была обнаружена ошибка в последней импортированной транзакции в файле Excel.</span><span class="sxs-lookup"><span data-stu-id="a9244-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
