---
title: Создание формата электронной отчетности, чтобы строки оставались на одной странице Excel
description: В этой теме объясняется, как разработать формат электронной отчетности (ER), в котором строки остаются на одной странице Microsoft Excel.
author: NickSelin
ms.date: 02/28/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2022-03-01
ms.dyn365.ops.version: Version 10.0.26
ms.openlocfilehash: 06782a4933fb5c3e86ad436b853f207fd3d5cddb
ms.sourcegitcommit: 2977e92a76211875421e608555311c363cfbdc25
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2022
ms.locfileid: "8612380"
---
# <a name="design-an-er-format-to-keep-rows-together-on-the-same-excel-page"></a>Создание формата электронной отчетности, чтобы строки оставались на одной странице Excel

[!include [banner](../includes/banner.md)]


В этой теме поясняется, как пользователь с ролью "Системный администратор" или "Функциональный консультант по электронной отчетности" может настроить [формат](er-overview-components.md#format-component) [электронной отчетности (ER)](general-electronic-reporting.md), который создает исходящие документы в Microsoft Excel и управляет разбивкой документа на страницы таким образом, что созданные строки остаются на одной странице.

В этом примере изменяется формат электронной отчетности, предоставленный корпорацией Майкрософт, который используется для печати накладных с произвольным текстом в Excel. Изменения позволяют управлять разбивкой на странице созданного отчета по накладным с произвольным текстом, чтобы все строки одной строки накладной оставались на одной странице, если это возможно.

Процедуры в этой теме могут быть выполнены в компании **USMF**. Написание кода не требуется.

В этом примере вам предстоит создать необходимые [конфигурации](general-electronic-reporting.md#Configuration) ER для демонстрационной компании **Litware, Inc.** Убедитесь, что поставщик конфигурации для демонстрационной компании **Litware, Inc.** (`http://www.litware.com`) указан для платформы электронной отчетности, который помечен как **Активный**. Если этого поставщика конфигурации нет в списке или он не помечен как **Активный**, следуйте указаниям в теме [Создание поставщика конфигурации и пометка его как активного](tasks/er-configuration-provider-mark-it-active-2016-11.md).

## <a name="enter-a-new-free-text-invoice"></a>Введите новую накладную с произвольным текстом

1. Следуйте шагам в разделе [Создание накладной с произвольным текстом](../../../finance/accounts-receivable/create-free-text-invoice-new.md#create-a-free-text-invoice-1) для добавления накладной с произвольным текстом.

    1. Добавьте одну строку в счет.
    2. Добавьте пять примечаний к строке накладной.

    ![Просмотр примечаний строки накладной на странице вложений.](./media/er-keep-excel-rows-together-notes.png)

2. Выполните шаги в разделе [Копирование строк](../../../finance/accounts-receivable/create-free-text-invoice-new.md#copy-lines), чтобы создать пять дополнительных строк накладной, которые являются копиями строки накладной, добавленной на предыдущем шаге.

    ![Просмотр строк накладной с произвольным текстом на странице накладной с произвольным текстом.](./media/er-keep-excel-rows-together-invoice.png)

## <a name="configure-the-er-framework"></a>Настройка платформы электронной отчетности

Выполните шаги из раздела [Настройка платформы электронной отчетности](er-quick-start2-customize-report.md#ConfigureFramework), чтобы настроить минимальный набор параметров электронной отчетности. Необходимо завершить эту настройку до начала использования платформы электронной отчетности для разработки пользовательской версии стандартного формата электронной отчетности.

## <a name="import-the-standard-er-format-configuration"></a>Импорт стандартной конфигурации формата электронной отчетности

Следуйте шагам в разделе [Импорт стандартной конфигурации формата электронной отчетности](er-quick-start2-customize-report.md#ImportERSolution1), чтобы добавить стандартные конфигурации электронной отчетности в текущий экземпляр Dynamics 365 Finance. Например, импортируйте версию **252.116** конфигурации формата **Накладная с произвольным текстом (Excel)**. Базовая версия **252** базовой конфигурации **Модель накладной** автоматически импортируется из репозитория вместе с требуемой конфигурацией **Сопоставление модели накладных**.

## <a name="set-up-print-management-to-use-the-standard-er-format"></a>Настройка управления печатью для использования стандартного формата электронной отчетности

Следуйте шагам в разделе [Настройка управления печатью](er-embed-images-header-footer-excel-reports.md#ConfigurePrintManagement1), чтобы настроить управление печатью для модуля **Расчеты с клиентами** таким образом, чтобы стандартный формат электронной отчетности использовался для печати накладных с произвольным текстом.

## <a name="configure-a-format-destination-for-the-standard-er-format"></a>Настройка назначения формата для стандартного формата электронной отчетности

Выполните шаги, описанные в разделе [Настройка формата назначения для предварительного просмотра на экране](er-quick-start1-new-solution.md#ConfigureDestination), чтобы настроить [экран](er-destination-type-screen.md) в качестве места назначения формата электронной отчетности для стандартного формата электронной отчетности, чтобы созданные отчеты преобразовывались в формат PDF и отображались на новой вкладке браузера.

## <a name="print-a-free-text-invoice-by-using-the-standard-er-format"></a>Печать накладной с произвольным текстом с использованием стандартного формата ER

1. Следуйте шагам в разделе [Печать накладной с произвольным текстом](er-embed-images-header-footer-excel-reports.md#ProcessInvoice1) для использования стандартного формата электронной отчетности для создания отчета по накладной с произвольным текстом в формате Excel для добавленной накладной.
2. Загрузите созданную рабочую книгу Excel и просмотрите ее в классическом приложении Excel.

    Обратите внимание, что шестая строка накладной начинается на первой странице отчета и продолжается на второй странице. Последняя запись отображается на второй странице, и не очевидно, что она относится к шестой строке накладной. Таким образом, разрыв страницы в середине содержимого для строки накладной делает этот документ более трудным для чтения.

    ![Просмотр разбивки на страницы созданной накладной с произвольным текстом в классическом приложении Excel.](./media/er-keep-excel-rows-together-invoice1.gif)

Остальные процедуры данной темы показывают, как можно настроить стандартный формат электронной отчетности, чтобы улучшить вид и удобочитаемость отчета по накладным, сохраняя все содержимое одной строки накладной на одной странице.

## <a name="create-a-custom-format"></a>Создание пользовательского формата

Выполните действия, описанные в разделе [Создание пользовательского формата](er-embed-images-header-footer-excel-reports.md#DeriveProvidedFormat), чтобы извлечь формат из импортированного формата электронной отчетности, и создайте **настраиваемую конфигурацию электронной отчетности для накладной с произвольным текстом (Excel)**, доступную для редактирования и изменения.

## <a name="edit-the-custom-format"></a>Изменение пользовательского формата

1. Выполните действия, описанные в разделе [Создание пользовательского формата](er-embed-images-header-footer-excel-reports.md#ConfigureDerivedFormat), для открытия производного формата электронной отчетности для редактирования в конструкторе форматов электронной отчетности.
2. На странице **Конструктор формата** в дереве компонентов формата на левой панели разверните узел **Накладная с произвольным текстом \> Лист \> InvoiceLines** и выберите компонент **InvoiceLines_Values**.
3. На вкладке **Формат** задайте параметр **Оставлять строки вместе** как **Да**.

    ![Установка параметра «Оставлять строки вместе» для редактируемого формата электронной отчетности на странице конструктора формата.](./media/er-keep-excel-rows-together-format.png)

4. Выберите **Сохранить** и закройте страницу.

## <a name="mark-the-custom-format-as-runnable"></a>Пометка пользовательского формата как готового к запуску

Чтобы сделать измененную версию настраиваемого формата электронной отчетности пригодной к запуску, следуйте шагам из раздела [Отметить пользовательский формат как пригодный к запуску](er-embed-images-header-footer-excel-reports.md#MarkFormatRunnable).

## <a name="set-up-print-management-to-use-the-custom-er-format"></a>Настройка управления печатью для использования пользовательского формата электронной отчетности

Следуйте шагам в разделе [Настройка управления печатью](er-embed-images-header-footer-excel-reports.md#ConfigurePrintManagement2), чтобы настроить управление печатью для модуля **Расчеты с клиентами** таким образом, чтобы пользовательский формат электронной отчетности использовался для печати накладных с произвольным текстом.

## <a name="configure-a-format-destination-for-the-custom-er-format"></a>Настройка назначения формата для пользовательского формата электронной отчетности

Выполните шаги, описанные в разделе [Настройка формата назначения для предварительного просмотра на экране](er-quick-start1-new-solution.md#ConfigureDestination), чтобы настроить **экран** в качестве места назначения формата электронной отчетности для пользовательского формата электронной отчетности, чтобы созданные отчеты преобразовывались в формат PDF и отображались на новой вкладке браузера.

## <a name="print-a-free-text-invoice-by-using-the-custom-er-format"></a>Печать накладной с произвольным текстом с использованием настраиваемого формата ER

1. Следуйте шагам в разделе [Печать накладной с произвольным текстом](er-embed-images-header-footer-excel-reports.md#ProcessInvoice2) для использования пользовательского формата электронной отчетности для создания отчета по накладной с произвольным текстом в формате Excel для добавленной накладной.
2. Загрузите созданную рабочую книгу Excel и просмотрите ее в классическом приложении Excel.

    Обратите внимание, что шестая строка накладной начинается на второй странице, и все строки Excel, представляющие эту строку накладной, отображаются вместе на этой странице.

    ![Просмотр обновленной разбивки на страницы созданной накладной с произвольным текстом в классическом приложении Excel.](./media/er-keep-excel-rows-together-invoice2.gif)

## <a name="additional-resources"></a>Дополнительные ресурсы

[Разработка конфигурации для создания документов в формате Excel](er-fillable-excel.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
