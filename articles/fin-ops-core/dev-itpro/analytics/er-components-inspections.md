---
title: Проверка настроенного компонента электронной отчетности для предотвращения неполадок среды выполнения
description: В этой теме объясняется, как проверить настроенные компоненты электронной отчетности (ER), чтобы исключить возможные проблемы среды выполнения.
author: NickSelin
manager: AnnBe
ms.date: 12/04/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERSolutionTable, ERDataModelDesigner, ERModelMappingTable, ERModelMappingDesigner, EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 72db7660c07b2f57f8609ab6c14964193e842d75
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2020
ms.locfileid: "4688575"
---
# <a name="inspect-the-configured-er-component-to-prevent-runtime-issues"></a>Проверка настроенного компонента электронной отчетности для предотвращения неполадок среды выполнения

[!include[banner](../includes/banner.md)]

Каждый настроенный [формат](general-electronic-reporting.md#FormatComponentOutbound) [электронной отчетности (ER)](general-electronic-reporting.md) и компонент [сопоставления моделей](general-electronic-reporting.md#data-model-and-model-mapping-components) могут быть [проверены](er-fillable-excel.md#validate-an-er-format) во время разработки. Во время этой проверки выполняется проверка целостности, которая позволяет предотвратить возможные проблемы среды выполнения, такие как ошибки выполнения и снижение производительности. Для каждой найденной проблемы предоставляется путь проблемного элемента. Для некоторых проблем доступно автоматическое исправление.

По умолчанию проверка применяется автоматически в следующих случаях для конфигурации электронной отчетности, которая содержит ранее упомянутые компоненты электронной отчетности:

- Выполняется [импорт](general-electronic-reporting.md#importing-an-er-component-from-lcs-to-use-it-internally) новой [версии](general-electronic-reporting.md#component-versioning) конфигурации электронной отчетности в экземпляр Microsoft Dynamics 365 Finance.
- Вы изменяете [статус](general-electronic-reporting.md#component-versioning) редактируемой конфигурации электронной отчетности с **Черновик** на **Завершено**.
- Вы [перебазируете](general-electronic-reporting.md#upgrading-a-format-selecting-a-new-version-of-base-format-rebase) редактируемую конфигурацию электронной отчетности, применяя новую базовую версию.

Эту проверку можно выполнить явно. Выберите один из следующих трех параметров и выполните следующие предусмотренные шаги:

- Вариант 1:

    1. Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.
    2. В дереве конфигурации в левой области выберите нужную конфигурацию электронной отчетности, которая содержит формат электронной отчетности или компонент сопоставления модели электронной отчетности.
    3. На экспресс-вкладке **Версии** выберите желаемую версию выбранной конфигурации электронной отчетности.
    4. На панели операций выберите **Проверить**.

- Вариант 2 для формата электронной отчетности:

    1. Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.
    2. В дереве конфигурации в левой области выберите нужную конфигурацию электронной отчетности, которая содержит компонент формата электронной отчетности.
    3. На экспресс-вкладке **Версии** выберите желаемую версию выбранной конфигурации электронной отчетности.
    4. В области действий выберите **Конструктор**.
    5. На странице **Конструктор форматов** в области действий выберите **Проверить**.

- Вариант 3 для сопоставления модели электронной отчетности:

    1. Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.
    2. В дереве конфигурации в левой области выберите нужную конфигурацию электронной отчетности, которая содержит компонент сопоставления модели электронной отчетности.
    3. На экспресс-вкладке **Версии** выберите желаемую версию выбранной конфигурации электронной отчетности.
    4. В области действий выберите **Конструктор**.
    5. На странице **Сопоставление модели и источника данных** в области действий выберите **Конструктор**.
    6. На странице **Конструктор сопоставлений моделей** в области действий выберите **Проверить**.

Чтобы пропустить проверку при импорте конфигурации, выполните следующие действия.

1. Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Установите для параметра **Проверить конфигурацию после импорта** значение **Нет**.

Чтобы пропустить проверку, когда статус версии изменится или выполнено изменение базы, выполните следующие действия.

1. Перейдите в раздел **Управление организацией \> Электронная отчетность \> Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Задайте для параметра **Пропустить проверку при изменении статуса конфигурации и изменении базы** значение **Да**.

Электронная отчетность использует следующие категории для группировки инспекций проверок согласованности:

- **Выполнимость** — проверки, которые определяют критические проблемы, которые могут произойти во время выполнения. Эти проблемы обычно имеют уровень **Ошибка**. 
- **Производительность** — проверки, которые определяют, какие проблемы могут привести к неэффективному выполнению настроенных компонентов электронной отчетности. Эти проблемы обычно имеют уровень **Предупреждение**.
- **Целостность данных** — проверки, которые определяют проблемы, которые могут привести к потере данных или проблемам во время выполнения. Эти проблемы обычно имеют уровень **Предупреждение**.

## <a name="list-of-inspections"></a>Список инспекций

В следующей таблице приводится обзор инспекций, предоставляемых электронной отчетностью. Для получения дополнительных сведений об этих проверках воспользуйтесь ссылками в первом столбце, чтобы перейти к соответствующим разделам данной темы. В этих разделах описываются типы компонентов, для которых электронная отчетность предоставляет проверки, а также способы изменения конфигурации компонентов аварийной отчетности, которые помогают предотвратить проблемы.

<table>
<thead>
<tr>
<th>Наименование</th>
<th>Категория</th>
<th>Уровень</th>
<th>Сообщение</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href='#i1'>Преобразование типов</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Невозможно преобразовать выражение типа &lt;тип&gt; в поле типа &lt;тип&gt;.</p>
<p><b>Ошибка выполнения:</b> исключение типа</p>
</td>
</tr>
<tr>
<td><a href='#i2'>Совместимость типов</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Настроенное выражение не может использоваться в качестве привязки элемента текущего формата к источнику данных, так как это выражение возвращает значение типа данных &lt;тип&gt;, которое находится за пределами диапазона типов данных, поддерживаемых текущим элементом форматирования типа &lt;тип&gt;.</p>
<p><b>Ошибка выполнения:</b> исключение типа</p>
</td>
</tr>
<tr>
<td><a href='#i3'>Отсутствует элемент конфигурации</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Путь не найден &lt;путь&gt;.</p>
<p><b>Ошибка выполнения:</b> элемент конфигурации &lt;путь&gt; не найден</p>
</td>
</tr>
<tr>
<td><a href='#i4'>Выполнимость выражения с функцией FILTER</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Выражение списка функции FILTER недоступно для запросов.</p>
<p><b>Ошибка выполнения:</b> фильтрация не поддерживается. Проверьте конфигурацию для получения дополнительных сведений об этом.</p>
</td>
</tr>
<tr>
<td rowspan='2'><a href='#i5'>Выполнимость источника данных GROUPBY</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>Путь &lt;путь&gt; не поддерживает запросы.</td>
</tr>
<tr>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Функция "группировка по" не может быть выполнена с запросом.</p>
<p><b>Ошибка выполнения:</b> функция "группировка по" не может быть выполнена с запросом.</p>
</td>
</tr>
<tr>
<td><a href='#i6'>Выполнимость источника данных JOIN</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Невозможно объединить &lt;путь&gt; списка, который не является фильтром в запросе.</p>
<p><b>Ошибка выполнения:</b> функция "Объединенный источник данных должен быть вычисленным полем выражения фильтра" была неправильно вызвана.</p>
</td>
</tr>
<tr>
<td><a href='#i7'>Предпочтительность функции FILTER по сравнению с WHERE</a></td>
<td>Производительность</td>
<td>Предупреждение</td>
<td>Использование функции FILTER для выражения предпочтительнее, чем WHERE с точки зрения производительности. Выберите исправление, чтобы заменить это автоматически.</td>
</tr>
<tr>
<td><a href='#i8'>Предпочтительность функции ALLITEMSQUERY по сравнению с ALLITEMS</a></td>
<td>Производительность</td>
<td>Предупреждение</td>
<td>Использование функции ALLITEMSQUERY для выражения предпочтительнее, чем ALLITEMS с точки зрения производительности. Выберите исправление, чтобы заменить это автоматически.</td>
</tr>
<tr>
<td><a href='#i9'>Рассмотрение пустых вариантов списка</a></td>
<td>Выполнимость</td>
<td>Предупреждение</td>
<td>
<p>&lt;Путь&gt; списка не имеет никакой проверки на пустой вариант списка, что может привести к ошибке во время выполнения. Добавьте проверку для пустого варианта списка.</p>
<p><b>Ошибка выполнения:</b> список пуст по &lt;пути&gt;</p>
<p><b><a href='#i9a'>Потенциальная проблема</a>:</b> строка заполняется один раз, а источник данных, из которого она заполняется, содержится несколько записей</p>
</td>
</tr>
<tr>
<td><a href='#i10'>Выполнимость выражения с функцией FILTER (кэширование)</a></td>
<td>Выполнимость</td>
<td>Ошибка</td>
<td>
<p>Функция FILTER не может применяться к выбранному типу источника данных. Источник данных типа табличных записей применяется только в том случае, если он не кэширован и не содержит вложенных источников данных, добавленных вручную.</p>
<p><b>Ошибка выполнения:</b> фильтрация не поддерживается. Проверьте конфигурацию для получения дополнительных сведений об этом.</p>
</td>
</tr>
<tr>
<td><a href='#i11'>Отсутствует привязка</a></td>
<td>Выполнимость</td>
<td>Предупреждение</td>
<td>
<p>Путь &lt;путь&gt; не имеет привязки к источнику данных в использовании сопоставления модели.</p>
<p><b>Ошибка выполнения:</b> путь &lt;путь&gt; не привязан</p>
</td>
</tr>
<tr>
<td><a href='#i12'>Несвязанный шаблон</a></td>
<td>Целостность данных</td>
<td>Предупреждение</td>
<td>Файл &lt;имя&gt; связан с компонентами, не являющимися файлом, и будет удален после изменения статуса версии конфигурации.</td>
</tr>
<tr>
<td><a href='#i13'>Несинхронизированный формат</a></td>
<td>Целостность данных</td>
<td>Предупреждение</td>
<td>Определенное имя &lt;имя компонента&gt; не существует в &lt;имени листа&gt; листов Excel</td>
</tr>
</tbody>
</table>

## <a name="type-conversion"></a><a id="i1"></a>Преобразование типов

Электронная отчетность проверяет, совместим ли тип данных поля модели данных с типом данных выражения, настроенного в качестве привязки этого поля. Если типы данных несовместимы, в конструкторе сопоставления модели электронной отчетности возникает ошибка проверки. В сообщении, которое вы получаете, говориться, что электронная отчетность не может преобразовать выражение типа A в поле типа B.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настраивать модель данных электронной отчетности и компоненты сопоставления модели электронной отчетности одновременно.
2. В дереве модели данных добавьте поле с именем **X** и выберите **Integer** в качестве типа данных.

    ![Поле X и тип данных "целое число" добавлены в дерево режима данных на странице модели данных](./media/er-components-inspections-01.png)

3. В области источников данных сопоставления модели добавьте источник данных типа **Вычисляемое поле**.
4. Назовите новый источник данных **Y** и настройте его так, чтобы он содержал выражение `INTVALUE(100)`.
5. Выполните привязку **X** к **Y**.
6. В конструкторе моделей данных измените тип данных поля **X** с **Integer** на **Int64**.
7. Выберите **Проверить**, чтобы проверить редактируемый компонент сопоставления моделей на странице **Конструктор сопоставления моделей**.

    ![Проверка редактируемого компонента сопоставления моделей на странице конструктора сопоставления моделей](./media/er-components-inspections-01.gif)

8. Выберите **Проверить**, чтобы проверить компонент сопоставления моделей выбранной конфигурации электронной отчетности на странице **Конфигурации**.

    ![Проверьте, чтобы проверить компонент сопоставления моделей на странице конфигураций](./media/er-components-inspections-01a.png)

9. Обратите внимание, что происходит ошибка проверки. В сообщении говорится, что значение типа **Integer**, возвращаемое выражением `INTVALUE(100)` источника данных **Y**, не может быть сохранено в поле модели данных **X** типа **Int64**.

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат, настроенный для использования сопоставления модели.

![Ошибки среды выполнения на странице конструктора форматов](./media/er-components-inspections-01b.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Обновите структуру модели данных, изменив тип данных поля модели данных таким образом, чтобы он соответствовал типу данных выражения, которое настроено для привязки этого поля. В предыдущем примере тип данных поля **X** должен быть изменен обратно на целое число **Integer**.

#### <a name="option-2"></a>Параметр 2

Обновите сопоставление модели путем изменения выражения источника данных, связанного с полем модели данных. Для предыдущего примера выражение источника данных **Y** должно быть изменено на `INT64VALUE(100)`.

## <a name="type-compatibility"></a><a id="i2"></a>Совместимость типов

Электронная отчетность проверяет, совместим ли тип данных элемента формата с типом данных выражения, настроенного в качестве привязки этого элемента формата. Если типы данных несовместимы, в конструкторе операций электронной отчетности возникает ошибка проверки. В получаемом вами сообщении говорится, что настроенное выражение не может использоваться в качестве привязки элемента текущего формата к источнику данных, так как это выражение возвращает значение типа данных A, которое находится за пределами области типов данных, поддерживаемых текущим элементом форматирования типа B.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настраивать модель данных электронной отчетности и компоненты формата электронной отчетности одновременно.
2. В дереве модели данных добавьте поле с именем **X** и выберите **Integer** в качестве типа данных.
3. В дереве структуры формата добавьте элемент формата типа **Числовой**.
4. Присвойте имя новому элементу форматирования **Y**. В поле **Числовой тип** выберите **Integer** в качестве типа данных.
5. Выполните привязку **X** к **Y**.
6. В дереве структуры формата измените тип данных элемента формата **Y** с **Integer** на **Int64**.
7. Выберите **Проверить**, чтобы проверить редактируемый компонент формата на странице **Конструктор формата**.

    ![Проверка совместимости типов на странице конструктора формата](./media/er-components-inspections-02.gif)

8. Обратите внимание, что происходит ошибка проверки. В сообщении говорится, что настроенное выражение может принимать только значения **Int64**. Таким образом, значение поля модели данных **X** типа **Integer** не может быть введено в элемент формата **Y**.

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Обновите структуру формата, изменив тип данных элемента формата **Числовой** таким образом, чтобы он соответствовал типу данных выражения, которое настроено для привязки этого элемента. В предыдущем примере значение **Числовой тип** элемента формата **X** должен быть изменен обратно на целое число **Integer**.

#### <a name="option-2"></a>Параметр 2

Обновите сопоставление формата элемента формата **X**, изменив выражение с `model.X` на `INT64VALUE(model.X)`.

## <a name="missing-configuration-element"></a><a id="i3"></a>Отсутствует элемент конфигурации

Электронная отчетность проверяет, содержат ли выражения привязки только те источники данных, которые настроены в редактируемом компоненте электронной отчетности. Для каждой привязки, содержащей источник данных, отсутствующий в редактируемом компоненте электронной отчетности, в конструкторе операций электронной отчетности или в конструкторе сопоставления моделей электронной отчетности возникает ошибка проверки.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настраивать модель данных электронной отчетности и компоненты сопоставления модели электронной отчетности одновременно.
2. В дереве модели данных добавьте поле с именем **X** и выберите **Integer** в качестве типа данных.

    ![Дерево модели данных с полем X и типом данных Integer на странице модели данных](./media/er-components-inspections-01.png)

3. В области источников данных сопоставления модели добавьте источник данных типа **Вычисляемое поле**.
4. Назовите новый источник данных **Y** и настройте его так, чтобы он содержал выражение `INTVALUE(100)`.
5. Выполните привязку **X** к **Y**.
6. В конструкторе сопоставления моделей в области источников данных удалите источник данных **Y**.
7. Выберите **Проверить**, чтобы проверить редактируемый компонент сопоставления моделей на странице **Конструктор сопоставления моделей**.

    ![Проверка редактируемого компонента сопоставления моделей электронной отчетности на странице конструктора сопоставления моделей](./media/er-components-inspections-03.gif)

8. Обратите внимание, что происходит ошибка проверки. В сообщении говорится, что привязка поля модель данных **X** содержит путь, относящийся к источнику данных **Y**, но этот источник данных не найден.

### <a name="automatic-resolution"></a>Автоматическое разрешение

Выберите **Отменить связь**, чтобы устранить эту проблему автоматически, удалив отсутствующую привязку источника данных.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Отмените привязку поля модели данных **X** для прекращения связи с несуществующим источником данных **Y**.

#### <a name="option-2"></a>Параметр 2

В области источников данных конструктора сопоставления моделей электронной отчетности снова добавьте источник данных **Y**.

## <a name="executability-of-an-expression-with-filter-function"></a><a id="i4"></a>Выполнимость выражения с функцией FILTER

Встроенная функция электронной отчетности [FILTER](er-functions-list-filter.md) используется для доступа к таблицам приложений, представлениям или сущностям данных путем помещения одного вызова SQL для получения необходимых данных в виде списка записей. Источник данных типа **Список записей** используется в качестве аргумента данной функции и определяет источник приложения для вызова. Электронная отчетность проверяет, можно ли установить прямой SQL-запрос для источника данных, на который имеется ссылка в функции `FILTER`. Если невозможно установить прямой запрос, в конструкторе сопоставления моделей электронной отчетности возникает ошибка проверки. Выводится сообщение о том, что выражение электронной отчетности, включающее функцию `FILTER`, не может быть выполнено во время выполнения. 

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
4. Добавьте источник данных типа **Вычисляемое поле**.
5. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `FILTER(Vendor, Vendor.AccountNum="US-101")`.
6. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить выражение `FILTER(Vendor, Vendor.AccountNum="US-101")` в источнике данных **Vendor**.
7. Измените источник данных **Vendor**, добавив вложенное поле типа **Вычисляемое поле** для того, чтобы получить номер счета поставщика с удаленными начальными и конечными лишними символами.
8. Назовите новое вложенное поле **$AccNumber** и настройте его так, чтобы оно содержало выражение `TRIM(Vendor.AccountNum)`.
9. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить выражение `FILTER(Vendor, Vendor.AccountNum="US-101")` в источнике данных **Vendor**.

    ![Проверка возможности запроса выражения на странице конструктора сопоставления моделей](./media/er-components-inspections-04.gif)

10. Обратите внимание, что возникает ошибка проверки, так как источник данных **Vendor** содержит вложенное поле типа **Вычисляемое поле**, которое не позволяет преобразовать выражение источника данных **FilteredVendor** в прямую инструкцию SQL.

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат, настроенный для использования сопоставления модели.

![Ошибки времени выполнения, которые возникают при выполнении редактируемого формата на странице конструктора формата](./media/er-components-inspections-04a.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Вместо добавления вложенного поля типа **Вычисляемое поле** к источнику данных **Vendor** добавьте вложенное поле **$AccNumber** в источник данных **FilteredVendor** и настройте его так, чтобы оно содержало выражение `TRIM(FilteredVendor.AccountNum)`. Таким образом, выражение `FILTER(Vendor, Vendor.AccountNum="US-101")` можно выполнить на уровне SQL и рассчитать вложенное поле **$AccNumber** позже.

#### <a name="option-2"></a>Параметр 2

Измените выражение источника данных **FilteredVendor** с `FILTER(Vendor, Vendor.AccountNum="US-101")` на `WHERE(Vendor, Vendor.AccountNum="US-101")`. Мы не рекомендуем изменять выражение для таблицы, которая имеет большой объем данных (таблица проводок), так как все записи будут получены, и выбор необходимых записей будет выполнен в памяти. Таким образом, такой подход может привести к снижению производительности. Дополнительные сведения см. в разделе [Функция электронной отчетности WHERE](er-functions-list-where.md).

## <a name="executability-of-a-groupby-data-source"></a><a id="i5"></a>Выполнимость источника данных GROUPBY

Источник данных **GROUPBY** разделяет результат запроса на группы записей, обычно в целях выполнения одной или нескольких агрегаций в каждой группе. Каждый источник данных **GROUPBY** можно настроить таким образом, чтобы он выполнялся либо на уровне базы данных, либо в памяти. Если источник данных **GROUPBY** настроен таким образом, что он выполняется на уровне базы данных, то модуль электронной отчетности проверяет, можно ли установить прямой SQL-запрос для источника данных, на который ссылается этот источник данных. Если невозможно установить прямой запрос, в конструкторе сопоставления моделей электронной отчетности возникает ошибка проверки. Выводится сообщение о том, что настроенный источник данных **GROUPBY** невозможно выполнить во время выполнения.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Trans**. В поле **Таблица** выберите **VendTrans**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTrans.
4. Добавьте источник данных типа **Группировать по**.
5. Назовите новый источник данных **GroupedTrans** и настройте его следующим образом:

    - Выберите источник данных **Trans** в качестве источника записей, которые должны быть сгруппированы.
    - В поле **Расположение выполнения** выберите **Запрос**, чтобы указать, что этот источник данных должен запускаться на уровне базы данных.

    ![Настройка источника данных на странице изменения параметров "Группировать по"](./media/er-components-inspections-05a.gif)

6. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить настроенный источник данных **GroupedTrans**.
7. Измените источник данных **Trans**, добавив вложенное поле типа **Вычисляемое поле** для того, чтобы получить номер счета поставщика с удаленными начальными и конечными лишними символами.
8. Назовите новый источник данных **$AccNumber** и настройте его так, чтобы он содержал выражение `TRIM(Trans.AccountNum)`.

    ![Настройка источника данных на странице конструктора сопоставления модели](./media/er-components-inspections-05a.png)

9. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить настроенный источник данных **GroupedTrans**.

    ![Проверьте компонент сопоставления моделей электронной отчетности и убедитесь, что настроенный источник данных GroupedTrans можно запросить на странице конструктора сопоставления моделей](./media/er-components-inspections-05b.png)

10. Обратите внимание, что возникает ошибка проверки, так как источник данных **Trans** содержит вложенное поле типа **Вычисляемое поле**, которое не позволяет преобразовать вызов источника данных **GroupedTrans** в прямую инструкцию SQL.

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат, настроенный для использования сопоставления модели.

![Ошибки времени выполнения, которые возникают при игнорировании предупреждения на странице конструктора формата](./media/er-components-inspections-05c.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Вместо добавления вложенного поля типа **Вычисляемое поле** к источнику данных **Trans** добавьте вложенное поле **$AccNumber** для элемента **GroupedTrans.lines** источника данных **GroupedTrans** и настройте его так, чтобы оно содержало выражение `TRIM(GroupedTrans.lines.AccountNum)`. Таким образом, источник данных **GroupedTrans** можно выполнить на уровне SQL и рассчитать вложенное поле **$AccNumber** позже.

#### <a name="option-2"></a>Параметр 2

Измените значение поля **Расположение выполнения** для источника данных **GroupedTrans** с **Запрос** на **В памяти**. Мы не рекомендуем изменять значение для таблицы, которая имеет большой объем данных (таблица проводок), так как все записи будут получены, и группирование и агрегирование будут выполнены в памяти. Таким образом, такой подход может привести к снижению производительности.

## <a name="executability-of-a-join-data-source"></a><a id="i6"></a>Выполнимость источника данных JOIN

Источник данных [JOIN](er-join-data-sources.md) объединяет записи из двух или более таблиц базы данных на основе соответствующих полей. Каждый источник данных **JOIN** можно настроить таким образом, чтобы он выполнялся либо на уровне базы данных, либо в памяти. Если источник данных **JOIN** настроен таким образом, что он выполняется на уровне базы данных, то модуль электронной отчетности проверяет, можно ли установить прямой SQL-запрос к источникам данных, на которые ссылается этот источник данных. Если невозможно установить прямой SQL-запрос по крайней мере с одним указанным источником данных, в конструкторе сопоставления моделей электронной отчетности возникает ошибка проверки. Выводится сообщение о том, что настроенный источник данных **JOIN** невозможно выполнить во время выполнения.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
4. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
5. Назовите новый источник данных **Trans**. В поле **Таблица** выберите **VendTrans**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTrans.
6. Добавьте источник данных типа **Вычисляемое поле** в качестве вложенного поля источника данных **Vendor**.
7. Назовите новый источник данных **FilteredTrans** и настройте его так, чтобы он содержал выражение `FILTER(Trans, Trans.AccountNum=Vendor.AccountNum)`.
8. Добавьте источник данных типа **Присоединить**.
9. Назовите новый источник данных **JoinedList** и настройте его следующим образом:

    1. Добавьте источник данных **Vendor** в качестве первого набора соединяемых записей.
    2. Добавьте источник данных **Vendor.FilteredTrans** в качестве второго набора соединяемых записей. Выберите **INNER** как тип.
    3. В поле **Выполнить** выберите **Запрос**, чтобы указать, что этот источник данных должен запускаться на уровне базы данных.

    ![Настройка источника данных на странице конструктора присоединения](./media/er-components-inspections-06a.gif)

10. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить настроенный источник данных **JoinedList**.
11. Измените выражение источника данных **Vendor.FilteredTrans** с `FILTER(Trans, Trans.AccountNum=Vendor.AccountNum)` на `WHERE(Trans, Trans.AccountNum=Vendor.AccountNum)`.
12. Выберите **Проверить** для проверки редактируемого компонента сопоставления моделей на странице **Конструктор сопоставления моделей** и убедитесь, что можно запросить настроенный источник данных **JoinedList**.

    ![Выберите редактируемый компонент сопоставления моделей и убедитесь, что можно запросить источник данных JoinedList в конструкторе сопоставления моделей.](./media/er-components-inspections-06b.png)

13. Обратите внимание, что происходит ошибка проверки, так как выражение источника данных **Vendor.FilteredTrans** не может быть преобразовано в прямой вызов SQL. Кроме того, прямой вызов SQL не позволяет преобразовать вызов источника данных **JoinedList** в прямую инструкцию SQL.

    ![Ошибки времени выполнения из-за непрошедшей проверки источника данных JoinedList на странице конструктора сопоставления моделей](./media/er-components-inspections-06c.png)

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат, настроенный для использования сопоставления модели.

![Выполнение редактируемого формата на странице конструктора форматов](./media/er-components-inspections-06e.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Измените выражение источника данных **Vendor.FilteredTrans** с `WHERE(Trans, Trans.AccountNum=Vendor.AccountNum)` обратно на `FILTER(Trans, Trans.AccountNum=Vendor.AccountNum)`, как рекомендуется в предупреждении.

![Обновленное выражение источника данных на странице конструктора сопоставления модели](./media/er-components-inspections-06d.png)

#### <a name="option-2"></a>Параметр 2

Измените значение поля **Выполнить** для источника данных **JoinedList** с **Запрос** на **В памяти**. Мы не рекомендуем изменять значение для таблицы, которая имеет большой объем данных (таблица проводок), так как все записи будут получены, и присоединение будет выполнено в памяти. Таким образом, такой подход может привести к снижению производительности. Для информирования об этом риске отображается предупреждение проверки.

## <a name="preferability-of-filter-vs-where-function"></a><a id="i7"></a>Предпочтительность функции FILTER по сравнению с WHERE

Встроенная функция электронной отчетности [FILTER](er-functions-list-filter.md) используется для доступа к таблицам приложений, представлениям или сущностям данных путем помещения одного вызова SQL для получения необходимых данных в виде списка записей. Функция [WHERE](er-functions-list-where.md) извлекает все записи из данного источника и выполняет выбор записей в памяти. Источник данных типа **Список записей** используется в качестве аргумента обеих функций и определяет источник получения записей. Электронная отчетность проверяет, возможно ли установление прямого вызова SQL к источнику данных, на который имеется ссылка в функции **WHERE**. Если невозможно установить прямой вызов, в конструкторе сопоставления моделей электронной отчетности возникает предупреждение проверки. Полученное сообщение рекомендует использовать функцию **FILTER** вместо функции **WHERE** для повышения эффективности.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Trans**. В поле **Таблица** выберите **VendTrans**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTrans.
4. Добавьте источник данных типа **Вычисляемое поле** в качестве вложенного поля источника данных **Vendor**.
5. Назовите новый источник данных **FilteredTrans** и настройте его так, чтобы он содержал выражение `WHERE(Trans, Trans.AccountNum="US-101")`.
6. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
7. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
8. Добавьте источник данных типа **Вычисляемое поле**.
9. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `WHERE(Vendor, Vendor.AccountNum="US-101")`.
10. Выберите **Проверить**, чтобы проверить редактируемый компонент сопоставления моделей на странице **Конструктор сопоставления моделей**.

    ![Проверить, чтобы проверить редактируемый компонент сопоставления моделей на странице конструктора сопоставления моделей](./media/er-components-inspections-07a.png)

11. Обратите внимание, что предупреждения проверки рекомендуют использовать функцию **FILTER** вместо функции **WHERE** для источников данных **FilteredVendor** и **FilteredTrans**.

    ![Предупреждения проверки, рекомендующие использовать функцию FILTER вместо функции WHERE на странице конструктора сопоставления моделей](./media/er-components-inspections-07b.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Выберите **Исправить**, чтобы автоматически заменить функцию **WHERE** функцией **FILTER** в выражениях всех источников данных, которые отображаются в сетке на вкладке **Предупреждения** для данного типа проверки.

Вместо этого можно выбрать строку для одного предупреждения в сетке, а затем выбрать **Исправить выбранное**. В этом случае выражение автоматически изменяется только в источнике данных, который упоминается в выбранном предупреждении.

![Выберите "Исправить" для автоматической замены функции WHERE функцией FILTER на странице конструктор сопоставления моделей](./media/er-components-inspections-07c.png)

### <a name="manual-resolution"></a>Разрешение вручную

Можно вручную настроить выражения всех источников данных, упоминаемых в сетке проверки, заменив функцию **WHERE** функцией **FILTER**.

## <a name="preferability-of-allitemsquery-vs-allitems-function"></a><a id="i8"></a>Предпочтительность функции ALLITEMSQUERY по сравнению с ALLITEMS

Встроенные функции электронной отчетности [ALLITEMS](er-functions-list-allitems.md) и [ALLITEMSQUERY](er-functions-list-allitemsquery.md) используются для того, чтобы получить плоское значение **Список записей**, состоящее из списка записей, представляющих все элементы, которые соответствуют указанному пути. Электронная отчетность проверяет, возможно ли установление прямого вызова SQL к источнику данных, на который имеется ссылка в функции **ALLITEMS**. Если невозможно установить прямой вызов, в конструкторе сопоставления моделей электронной отчетности возникает предупреждение проверки. Полученное сообщение рекомендует использовать функцию **ALLITEMSQUERY** вместо функции **ALLITEMS** для повышения эффективности.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
4. Добавьте источник данных типа **Вычисляемое поле**, чтобы получить записи для нескольких поставщиков.
5. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `FILTER(Vendor, OR(Vendor.AccountNum="US-101",Vendor.AccountNum="US-102"))`.
6. Добавьте источник данных типа **Вычисляемое поле**, чтобы получить проводки для всех отфильтрованных поставщиков.
7. Назовите новый источник данных **FilteredVendorTrans** и настройте его так, чтобы он содержал выражение `ALLITEMS(FilteredVendor.'<Relations'.'VendTrans.VendTable_AccountNum')`.
8. Выберите **Проверить**, чтобы проверить редактируемый компонент сопоставления моделей на странице **Конструктор сопоставления моделей**.

    ![Страница конструктора сопоставления моделей, кнопка "Проверить"](./media/er-components-inspections-08a.png)

9. Обратите внимание, что происходит предупреждение проверки. Сообщение рекомендует использовать функцию **ALLITEMSQUERY** вместо функции **ALLITEMS** для источника данных **FilteredVendorTrans**.

    ![Предупреждение проверки для использования функции ALLITEMSQUERY вместо функции ALLITEMS в компоненте сопоставления модели электронной отчетности на странице конструктора сопоставления моделей](./media/er-components-inspections-08b.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Выберите **Исправить**, чтобы автоматически заменить функцию **ALLITEMS** функцией **ALLITEMSQUERY** в выражениях всех источников данных, которые отображаются в сетке на вкладке **Предупреждения** для данного типа проверки.

Вместо этого можно выбрать строку для одного предупреждения в сетке, а затем выбрать **Исправить выбранное**. В этом случае выражение автоматически изменяется только в источнике данных, который упоминается в выбранном предупреждении.

![Страница конструктора сопоставления моделей, выберите "Исправить выбранное"](./media/er-components-inspections-08c.png)

### <a name="manual-resolution"></a>Разрешение вручную

Можно вручную настроить выражения всех источников данных, упоминаемых в сетке проверки, заменив функцию **ALLITEMS** функцией **ALLITEMSQUERY**.

## <a name="consideration-of-empty-list-cases"></a><a id="i9"></a>Рассмотрение пустых вариантов списка

Можно настроить компонент сопоставления моделей или формата электронной отчетности, чтобы получить значение поля источника данных типа **Список записей**. Модуль электронной отчетности проверяет, учитывает ли ваш дизайн ситуацию, когда источник данных, который вызывается, не содержит записей (то есть, он пуст), чтобы предотвратить возникновение ошибок времени выполнения, когда значение извлекается из поля несуществующей записи.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настраивать модель данных электронной отчетности, компоненты сопоставления модели электронной отчетности и компоненты формата электронной отчетности одновременно.
2. В дереве модели данных добавьте корневой элемент с именем **Root3**.
3. Измените элемент **Root3**, добавив вложенный элемент типа **Список записей**.
4. Назовите новый вложенный элемент **Vendor**.
5. Измените элемент **Vendor** следующим образом:

    - Добавьте вложенное поле типа **Строка** и назовите его **Name**.
    - Добавьте вложенное поле типа **Строка** и назовите его **AccountNumber**.

    ![Добавление вложенных полей на странице модели данных](./media/er-components-inspections-09a.png)

6. В области источников данных сопоставления модели добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
7. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
8. Добавьте источник данных типа **Общее \\ Параметр ввода пользователя** для поиска счета поставщика в диалоговом окне времени выполнения.
9. Назовите новый источник данных **RequestedAccountNum**. В поле **Подпись** введите **Номер банковского счета поставщика**. В поле **Имя типа данных операций** оставьте значение по умолчанию — **Описание**.
10. Добавьте источник данных типа **Вычисляемое поле**, чтобы отфильтровать поставщика, о котором выполняется запрос.
11. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `FILTER(Vendor, Vendor.AccountNum=RequestedAccountNum)`.
12. Привяжите элементы модели данных к настроенным источникам данных следующим образом:

    - Привяжите **FilteredVendor** к **Vendor**.
    - Привяжите **FilteredVendor.AccountNum** к **Vendor.AccountNumber**.
    - Привяжите **FilteredVendor.'name()'** к **Vendor.Name**.

    ![Привязка элементов модели данных на странице конструктора сопоставления модели](./media/er-components-inspections-09b.png)

13. В дереве структуры формата добавьте следующие элементы для создания исходящего документа в формате XML, содержащего сведения о поставщике:

    1. Добавьте корневой XML-элемент **Statement**.
    2. Для XML-элемента **Statement** добавьте вложенный XML-элемент **Party**.
    3. Для XML-элемента **Party** добавьте следующие вложенные XML-атрибуты.

        - Наименование
        - AccountNum

14. Привяжите элементы формата к предоставленным источникам данных следующим образом:

    - Привяжите элемент формата **Statement\\Party\\Name** к полю источника данных **model.Vendor.Name**.
    - Привяжите элемент формата **Statement\\Party\\AccountNum** к полю источника данных **model.Vendor.AccountNumber**.

15. Выберите **Проверить**, чтобы проверить редактируемый компонент формата на странице **Конструктор формата**.

    ![Проверьте элементы формата, привязанные к источникам данных на странице конструктора формата](./media/er-components-inspections-09c.png)

16. Обратите внимание, что происходят ошибки проверки. В сообщении говорится, что может выдаваться ошибка для настроенных компонентов формата **Statement\\Party\\Name** и **Statement\\Party\\AccountNum** во время выполнения, если список **model.Vendor** пуст.

    ![Ошибка проверки, которая сообщает о потенциальной ошибке для компонентов настроенного формата](./media/er-components-inspections-09d.png)

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение, выберите команду **Выполнить**, чтобы выполнить формат, и выберите номер счета несуществующего поставщика. Так как запрошенный поставщик не существует, список **model.Vendor** будет пустым (то есть, он не будет содержать записей).

![Ошибки времени выполнения, так как произошли во время выполнения сопоставления формата](./media/er-components-inspections-09e.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Для строки, выбранной в сетке на вкладке **Предупреждения**, можно выбрать **Отменить привязку**. Привязка, на которую указывает указатель в столбце **Путь**, автоматически удаляется из элементов форматирования.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Вы можете привязать элемент формата **Statement\\Party\\Name** к элементу источника данных **model.Vendor**. Во время выполнения эта привязка вызывает сначала источник данных **model.Vendor**. Когда **model.Vendor** возвращает пустой список записей, вложенные элементы формата не будут выполнены. Поэтому для данной конфигурации формата предупреждения проверки не возникают.

![Привяжите элемент формата к элементу источника данных на странице конструктора формата](./media/er-components-inspections-09e.gif)

#### <a name="option-2"></a>Параметр 2

Измените привязку элемента формата **Statement\\Party\\Name** с `model.Vendor.Name` на `FIRSTORNULL(model.Vendor).Name`. Обновленная привязка условно преобразует первую запись источника данных **model.Vendor** типа **Список записей** в новый источник данных типа **Запись**. Этот новый источник данных содержит такой же набор полей.

- Если имеется хотя бы одна запись в источнике данных **model.Vendor**, поля этой записи заполняются значениями полей первой записи источника данных **model.Vendor**. В этом случае обновленная привязка возвращает имя поставщика.
- В противном случае каждое поле создаваемой записи заполняются значением по умолчанию для типа данных этого поля. В этом случае пустая строка возвращается в качестве значения по умолчанию для типа данных **Строка**.

Таким образом, не происходит предупреждений проверки для элемента формата **Statement\\Party\\Name**, когда он привязан к выражению `FIRSTORNULL(model.Vendor).Name`.

![Изменение привязки устарняет предупреждения проверки на странице конструктора форматов](./media/er-components-inspections-09f.gif)

#### <a name="option-3"></a>Параметр 3

Если вы хотите явно указать данные, вводимые в созданный документ, когда источник данных **model.Vendor** типа **Список записей** не возвращает записей (текст **Недоступно** в этом примере), измените привязку элемента формата **Statement\\Party\\Name** с `model.Vendor.Name` на `IF(NOT(ISEMPTY(model.Vendor)), model.Vendor.Name, "Not available")`. Также можно использовать выражение `IF(COUNT(model.Vendor)=0, model.Vendor.Name, "Not available")`.

### <a name="additional-consideration"></a><a id="i9a"></a>Дополнительные соображения

Кроме того, в ходе проверки выводится предупреждение о другой потенциальной проблеме. По умолчанию, при привязке элементов формата **Statement\\Party\\Name** и **Statement\\Party\\AccountNum** к соответствующим полям источника данных **model.Vendor** типа **Список записей**, эти привязки будут выполняться и будут получать значения соответствующих полей первой записи источника данных **model.Vendor**, если этот список не пуст.

Так как элемент формата **Statement\\Party** не привязан к источнику данных **model.Vendor**, элемент **Statement\\Party** не будет перебираться для каждой записи источника данных **model.Vendor** во время выполнения формата. Вместо этого созданный документ будет заполнен данными только из первой записи списка записей, если этот список содержит несколько записей. Таким образом, может возникнуть проблема, если формат предназначен для заполнения созданного документа сведениями обо всех поставщиках из источника данных **model.Vendor**. Чтобы устранить эту проблему, свяжите элемент **Statement\\Party** с источником данных **model.Vendor**.

## <a name="executability-of-an-expression-with-filter-function-caching"></a><a id="i10"></a>Выполнимость выражения с функцией FILTER (кэширование)

Несколько встроенных функций электронной отчетности, включая [FILTER](er-functions-list-filter.md) и [ALLITEMSQUERY](er-functions-list-allitemsquery.md), используются для доступа к таблицам приложений, представлениям или сущностям данных путем помещения одного вызова SQL для получения необходимых данных в виде списка записей. Источник данных типа **Список записей** используется в качестве аргумента каждой из этих функций и определяет источник приложения для вызова. Электронная отчетность проверяет, возможно ли установление прямого вызова SQL к источнику данных, на который имеется ссылка в одной из этих функций. Если невозможно установить прямой вызов, так как источник данных был помечен как [кэшированный](trace-execution-er-troubleshoot-perf.md#improve-the-model-mapping-based-on-information-from-the-execution-trace), в конструкторе сопоставления моделей электронной отчетности возникает ошибка проверки. Выводится сообщение о том, что выражение электронной отчетности, содержащее одну из этих функций, не может быть выполнено во время выполнения.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента сопоставления модели электронной отчетности.
2. Добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
3. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
4. Добавьте источник данных типа **Общее \\ Параметр ввода пользователя** для поиска счета поставщика в диалоговом окне времени выполнения.
5. Назовите новый источник данных **RequestedAccountNum**. В поле **Подпись** введите **Номер банковского счета поставщика**. В поле **Имя типа данных операций** оставьте значение по умолчанию — **Описание**.
6. Добавьте источник данных типа **Вычисляемое поле**, чтобы отфильтровать поставщика, о котором выполняется запрос.
7. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `FILTER(Vendor, Vendor.AccountNum=RequestedAccountNum)`.
8. Пометьте настроенный источник данных **Vendor** как кэшированный.

    ![Настройка компонента сопоставления моделей на странице конструктора сопоставления моделей](./media/er-components-inspections-10a.gif)

9. Выберите **Проверить**, чтобы проверить редактируемый компонент сопоставления моделей на странице **Конструктор сопоставления моделей**.

    ![Проверка функции filter, применяемой к кэшированному источнику данных поставщика, на странице конструктора сопоставления моделей](./media/er-components-inspections-10a.png)

10. Обратите внимание, что происходит ошибка проверки. В сообщении говорится, что функция **FILTER** не может применяться к кэшированному источнику данных **Vendor**.

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат.

![Ошибка времени выполнения, которая возникает при выполнении сопоставления формата на странице конструктора формата](./media/er-components-inspections-10b.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Удалите флаг **Кэш** из источника данных **Vendor**. Источник данных **FilteredVendor** затем становится исполняемым, но обращение к источнику данных **Vendor**, на который есть ссылка в таблице VendTable, будет выполняться при каждом вызове источника данных **FilteredVendor**.

#### <a name="option-2"></a>Параметр 2

Измените выражение источника данных **FilteredVendor** с `FILTER(Vendor, Vendor.AccountNum="US-101")` на `WHERE(Vendor, Vendor.AccountNum="US-101")`. В этом случае обращение к источнику данных **Vendor**, на который есть ссылка в таблице VendTable, будет производиться только при первом вызове источника данных **Vendor**. Однако выбор записей будет выполнен в памяти. Таким образом, такой подход может привести к снижению производительности.

## <a name="missing-binding"></a><a id="i11"></a>Отсутствует привязка

При настройке компонента формата электронной отчетности базовая модель данных электронной отчетности предлагается как источник данных по умолчанию для формата электронной отчетности. При выполнении настроенного формата электронной отчетности [сопоставление модели по умолчанию](er-country-dependent-model-mapping.md) для базовой модели используется для заполнения модели данных данными приложения. Конструктор формата электронной отчетности показывает предупреждение, если вы связываете элемент формата с элементом модели данных, который не связан ни с одним источником данных в сопоставлении модели, которая выбрана в настоящее время в качестве сопоставления модели по умолчанию для редактируемого формата. Этот тип привязки не может выполняться во время выполнения, так как формат, который выполняется, не может заполнять связанный элемент данными приложения. Таким образом, ошибка возникает во время выполнения.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настраивать модель данных электронной отчетности, компоненты сопоставления модели электронной отчетности и компоненты формата электронной отчетности одновременно.
2. В дереве модели данных добавьте корневой элемент с именем **Root3**.
3. Измените элемент **Root3**, добавив новый вложенный элемент типа **Список записей**.
4. Назовите новый вложенный элемент **Vendor**.
5. Измените элемент **Vendor** следующим образом:

    - Добавьте вложенное поле типа **Строка** и назовите его **Name**.
    - Добавьте вложенное поле типа **Строка** и назовите его **AccountNumber**.

    ![Добавление вложенных полей к элементу поставщика на странице модели данных](./media/er-components-inspections-11a.png)

6. В области источников данных сопоставления модели добавьте источник данных типа **Dynamics 365 for Operations \\ Записи таблицы**.
7. Назовите новый источник данных **Vendor**. В поле **Таблица** выберите **VendTable**, чтобы указать, что этот источник данных будет запрашивать таблицу VendTable.
8. Добавьте источник данных типа **Общее \\ Параметр ввода пользователя** для запроса счета поставщика в диалоговом окне времени выполнения.
9 Назовите новый источник данных **RequestedAccountNum**. В поле **Подпись** введите **Номер банковского счета поставщика**. В поле **Имя типа данных операций** оставьте значение по умолчанию — **Описание**.
10. Добавьте источник данных типа **Вычисляемое поле**, чтобы отфильтровать поставщика, о котором выполняется запрос.
11. Назовите новый источник данных **FilteredVendor** и настройте его так, чтобы он содержал выражение `FILTER(Vendor, Vendor.AccountNum=RequestedAccountNum)`.
12. Привяжите элементы модели данных к настроенным источникам данных следующим образом:

    - Привяжите **FilteredVendor** к **Vendor**.
    - Привяжите **FilteredVendor.AccountNum** к **Vendor.AccountNumber**.

    > [!NOTE]
    > Поле модели данных **Vendor.Name** остается несвязанным.

    ![Элементы модели данных, привязанные к настроенным источникам данных, и элемент режима данных, который остается, на странице конструктора сопоставления моделей](./media/er-components-inspections-11b.png)

13. В дереве структуры формата добавьте следующие элементы для создания исходящего документа в формате XML, содержащего сведения о поставщиках, о которых производится запрос:

    1. Добавьте корневой XML-элемент **Statement**.
    2. Для XML-элемента **Statement** добавьте вложенный XML-элемент **Party**.
    3. Для XML-элемента **Party** добавьте следующие вложенные XML-атрибуты.

        - Наименование
        - AccountNum

14. Привяжите элементы формата к предоставленным источникам данных следующим образом:

    - Привяжите элемент формата **Statement\\Party** к элементу источника данных **model.Vendor**.
    - Привяжите элемент формата **Statement\\Party\\Name** к полю источника данных **model.Vendor.Name**.
    - Привяжите элемент формата **Statement\\Party\\AccountNum** к полю источника данных **model.Vendor.AccountNumber**.

15. Выберите **Проверить**, чтобы проверить редактируемый компонент формата на странице **Конструктор формата**.

    ![Проверка компонента формата электронной отчетности на странице конструктора форматов](./media/er-components-inspections-11c.png)

16. Обратите внимание, что происходит предупреждение проверки. В сообщении говорится, что поле источника данных **model.Vendor.Name** не привязано ни к какому источнику данных в сопоставлении моделей, настроенных для использования этим форматом. Таким образом, элемент формата **Statement\\Party\\Name** может не заполняться во время выполнения, и может возникнуть исключение времени выполнения.

    ![Проверка компонента формата электронной отчетности на странице конструктора форматов](./media/er-components-inspections-11d.png)

На следующем рисунке показана ошибка среды выполнения, которая происходит, если вы проигнорируете предупреждение и выберите команду **Выполнить**, чтобы выполнить формат.

![Выполните редактируемый формат на странице конструктора форматов](./media/er-components-inspections-11e.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Измените настроенное сопоставление модели, добавив привязку для поля источника данных **model.Vendor.Name**.

#### <a name="option-2"></a>Параметр 2

Измените настроенный формат, удалив привязку для элемента формата **Statement\\Party\\Name**.

## <a name="not-linked-template"></a><a id="i12"></a>Несвязанный шаблон

Когда вы [вручную](er-fillable-excel.md#manual-entry) настраиваете компонент формата электронной отчетности для использования шаблона для создания исходящего документа, необходимо вручную добавить элемент **Excel\\File**, добавить нужный шаблон в качестве вложения редактируемого компонента и выбрать это вложение в добавленном элементе **Excel\\File**. Таким образом, вы указываете, что добавленный элемент будет заполнять выбранный шаблон во время выполнения. При настройке версии компонента формата в [статусе](general-electronic-reporting.md#component-versioning) **Черновик** можно добавить несколько шаблонов к редактируемому компоненту, а затем выбрать каждый шаблон в элементе **Excel\\File**, чтобы выполнить формат электронной отчетности. Таким образом, можно увидеть, как другие шаблоны заполняются во время выполнения. Если имеются шаблоны, которые не выбраны ни в одном элементе **Excel\\File**, конструктор формата электронной отчетности выводит предупреждение о том, что эти шаблоны будут удалены из редактируемой версии компонента формата электронной отчетности, когда его состояние изменится с **Черновик** на **Завершено**.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента формата электронной отчетности.
2. В дереве структуры формата добавьте элемент **Excel\\File**.
3. Для элемента **Excel\\File**, который вы только что добавили, добавьте файл книги Excel **A.xlsx** в качестве вложения. Для указания хранилища шаблонов формата электронной отчетности используется тип документа, настроенный в [параметрах электронной отчетности](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents).
4. Для элемента **Excel\\File** добавьте другой файл книги Excel **B.xlsx** в качестве вложения. Используйте тот же тип документа, который используется для файла книги A.
5. В элементе **Excel\\File** выберите файл книги A.
6. Выберите **Проверить**, чтобы проверить редактируемый компонент формата на странице **Конструктор формата**.

    ![Проверка редактируемого компонента формата файла книги на странице конструктора формата](./media/er-components-inspections-12a.gif)

7. Обратите внимание, что происходит предупреждение проверки. В сообщении говорится, что файл книги **B. xlsx** не связан ни с какими компонентами, и что он будет удален после изменения состояния версии конфигурации.

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

Измените настроенный формат, удалив все шаблоны, не связанные ни с одним элементом **Excel\\File**.

## <a name="not-synced-format"></a><a id="i13"></a>Несинхронизированный формат

Когда вы [настраиваете](er-fillable-excel.md) компонент формата электронной отчетности для использования шаблона Excel для создания исходящего документа, можно вручную добавить элемент **Excel\\File**, добавить нужный шаблон в качестве вложения редактируемого компонента и выбрать это вложение в добавленном элементе **Excel\\File**. Таким образом, вы указываете, что добавленный элемент будет заполнять выбранный шаблон во время выполнения. Так как добавленный шаблон Excel спроектирован как внешний, редактируемый формат электронной отчетности может содержать имена Excel, отсутствующие в добавленном шаблоне. В конструкторе формата электронной отчетности выводится предупреждение о любых несоответствиях свойств элементов формата электронной отчетности, которые ссылаются на имена, не включенные в добавленный шаблон Excel.

Следующие шаги показывают, как может произойти эта проблема.

1. Начните настройку компонента формата электронной отчетности.
2. В дереве структуры формата добавьте элемент **Excel\\File** **Отчет**.
3. Для элемента **Excel\\File**, который вы только что добавили, добавьте файл книги Excel **A.xlsx** в качестве вложения. Для указания хранилища шаблонов формата электронной отчетности используется тип документа, настроенный в [параметрах электронной отчетности](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents).

    > [!IMPORTANT]
    > Убедитесь, что добавленная книга Excel не содержит имени **ReportTitle**.

4. Добавьте следующий элемента **Excel\\Cell** **Заголовок** в качестве вложенного элемента для элемента **Отчет**. В поле **Диапазон Excel** введите **ReportTitle**.
5. Выберите **Проверить**, чтобы проверить редактируемый компонент формата на странице **Конструктор формата**.

    ![Проверка вложенных элементов и полей на странице конструктора формата](./media/er-components-inspections-13a.png)

6. Обратите внимание, что происходит предупреждение проверки. В сообщении говорится, что имя **ReportTitle** не существует на листе **Лист1** шаблона Excel, который вы используете.

    ![Предупреждение проверки о том, что имя ReportTitle не существует на листе "Лист1" шаблона Excel](./media/er-components-inspections-13b.png)

### <a name="automatic-resolution"></a>Автоматическое разрешение

Нет параметров для автоматического исправления этой проблемы.

### <a name="manual-resolution"></a>Разрешение вручную

#### <a name="option-1"></a>Параметр 1

Измените настроенный формат, удалив все элементы, которые ссылаются на имена Excel, отсутствующие в шаблоне.

#### <a name="option-2"></a>Параметр 2

[Обновите](er-fillable-excel.md#template-import) редактируемый формат электронной отчетности путем импорта шаблона Excel. Структура редактируемого формата электронной отчетности будет [синхронизирована](modify-electronic-reporting-format-reapply-excel-template.md) со структурой импортированного шаблона Excel.

### <a name="additional-consideration"></a>Дополнительные соображения

Сведения о том, как можно синхронизировать структуру формата с шаблоном электронной отчетности в редакторе шаблонов [управления бизнес-документами](er-business-document-management.md), см. в разделе [Обновление структуры шаблона бизнес-документа](er-bdm-update-structure.md).

## <a name="additional-resources"></a>Дополнительные ресурсы

[Функция ER ALLITEMS](er-functions-list-allitems.md)

[Функция ER ALLITEMSQUERY](er-functions-list-allitemsquery.md)

[Функция ER INT64VALUE](er-functions-conversion-int64value.md)

[Функция ER INTVALUE](er-functions-conversion-intvalue.md)

[Функция ER FILTER](er-functions-list-filter.md)

[Функция ER WHERE](er-functions-list-where.md)

[Использование источников данных JOIN для извлечения данных из нескольких таблиц приложений в сопоставлениях моделей электронной отчетности](er-join-data-sources.md)

[Трассировка выполнения форматов электронной отчетности для устранения неполадок, связанных с производительностью](trace-execution-er-troubleshoot-perf.md)

[Обзор управления бизнес-документами](er-business-document-management.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]