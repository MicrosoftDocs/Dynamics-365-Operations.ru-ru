---
title: Отладка источников данных для выполняемого формата электронной отчетности для анализа потока и преобразования данных
description: В этой теме объясняется, как можно отлаживать источники данных выполняемого формата электронной отчетности, чтобы лучше понимать настроенные поток и преобразование данных.
author: NickSelin
manager: AnnBe
ms.date: 04/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERSolutionTable, EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-04-01
ms.dyn365.ops.version: Release 10.0.11
ms.openlocfilehash: 3a486800f37dda7829aeeaa56a30285a92a61b9d
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2020
ms.locfileid: "4680790"
---
# <a name="debug-data-sources-of-an-executed-er-format-to-analyze-data-flow-and-transformation"></a>Отладка источников данных для выполняемого формата электронной отчетности для анализа потока и преобразования данных

[!include[banner](../includes/banner.md)]

[!include[banner](../includes/preview-banner.md)]

В процессе [настройки](tasks/er-format-configuration-2016-11.md) решения электронной отчетности (ER) для создания исходящих электронных документов определяются методы, используемые для извлечения данных из приложения и их ввода в формируемые выходные данные. Чтобы обеспечить более эффективную поддержку жизненного цикла решения ER, решение должно состоять из [модели данных](general-electronic-reporting.md#DataModelComponent) ER и [сопоставления](general-electronic-reporting.md#ModelMappingComponent) компонентов, а также [формата](general-electronic-reporting.md#FormatComponentOutbound) ER и компонентов сопоставления, чтобы сопоставление моделей было привязано к приложению, в то время как другие компоненты остаются независимыми от приложения. Поэтому некоторые компоненты ER могут [влиять](general-electronic-reporting.md#FormatComponentOutbound) на процесс ввода данных в формируемые выходные данные.

Иногда выходные данные выглядят иначе, чем те же данные в базе данных приложения. В этих случаях нужно определить, какой компонент ER отвечает за преобразование данных. Функция отладчика источника данных ER значительно сокращает время и затраты, связанные с таким исследованием. Вы можете прервать выполнение формата ER и открыть интерфейс отладчика источника данных. В нем можно посмотреть доступные источники данных и выбрать отдельный источник данных для выполнения. Такое выполнение вручную имитирует выполнение источника данных во время фактического выполнения формата ER. Результат представляется на странице, где можно проанализировать полученные данные.

Чтобы включить функцию отладки источников данных, установите для параметра **Включить отладку данных при выполнении формата** значение **Да** в пользовательских параметрах ER. Затем можно запустить отладку источника данных во время выполнения формата ER для создания исходящих документов. Вы также можете использовать параметр **Начать отладку**, чтобы начать отладку источника данных для формата ER, который настроен в [конструкторе операций ER](./tasks/er-format-configuration-2016-11.md#design-the-format-of-an-electronic-document).

В этом разделе приводятся рекомендации по запуску отладки источников данных для выполняемых форматов ER. В нем объясняется, как эти сведения могут помочь в понимании потока данных и преобразования данных. В примерах этого раздела используется бизнес-процесс обработки платежей поставщикам.

## <a name="limitations"></a>Ограничения

Отладчик источников данных может использоваться для доступа к источникам данных, которые используются в форматах ER, которые запускаются для формирования исходящих документов. Его нельзя использовать для отладки источников данных форматов ER, предназначенных для анализа входящих документов.

Следующие параметры форматов ER в настоящее время недоступны при отладки источников данных:

- Преобразования форматов
- Правила проверки форматов и сопоставления
- Вспомогательные выражения
- Сведения о сборе данных в памяти

## <a name="prerequisites"></a>Необходимые условия

- Чтобы выполнить примеры в этом разделе, необходимо иметь доступ к одной из следующих [ролей](../sysadmin/tasks/assign-users-security-roles.md):

    - Разработчик электронной отчетности
    - Консультант по функциональным возможностям электронной отчетности
    - Системный администратор

- Компания должна иметь значение **DEMF**.

- Выполните действия в [Приложении 1](#appendix1) этого раздела, чтобы загрузить компоненты решения Microsoft ER, необходимые для обработки платежей поставщикам.
- Выполните действия в [Приложении 2](#appendix2) этого раздела, чтобы подготовить расчеты с поставщиками для обработки платежей поставщика с помощью решения ER, которое необходимо загрузить.

## <a name="process-a-vendor-payment-to-get-a-payment-file"></a>Обработка платежа поставщику для получения файла платежа

1. Выполните действия в [Приложении 3](#appendix3) этого раздела, чтобы обработать платежи поставщикам.

    ![Выполняется обработка платежа поставщику](./media/er-data-debugger-process-payment.png)

2. Загрузите и сохраните файл ZIP на локальном компьютере.
3. Извлеките файл платежа **ISO20022 Credit transfer.xml** из ZIP-файла.
4. Откройте извлеченный файл платежа с помощью средства просмотра файлов XML.

    В файле платежа код IBAN (International Bank Account Number) банковского счета поставщика указан без пробелов. Поэтому он отличается от значения, [введенного](#enteredIBANcode) на странице **Банковские счета**.

    ![Код IBAN без пробелов](./media/er-data-debugger-payment-file.png)

    С помощью отладчика источников данных ER можно узнать, какой компонент решения ER используется для удаления пробелов из кода IBAN.

## <a name="turn-on-data-source-debugging"></a>Включение отладки источников данных

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
3. Для параметра **Включить отладку данных при выполнении формата** установите значение **Да**.

    > [!NOTE]
    > Этот параметр используется отдельно для пользователя и для компании.

    ![Диалоговое окно параметров пользователя](./media/er-data-debugger-user-parameters.png)

## <a name="process-a-vendor-payment-for-debugging"></a>Обработка платежа поставщику для отладки

1. Выполните действия в [Приложении 3](#appendix3) этого раздела, чтобы обработать платежи поставщикам.
2. В окне сообщения выберите **Да** для подтверждения того, что требуется прервать обработку платежей поставщика, а вместо этого запустить отладку источника данных на странице **Отладка источников данных**.

    ![Окно сообщения о подтверждении](./media/er-data-debugger-start-debugging.png)

## <a name="debug-data-sources-that-are-used-in-payment-processing"></a>Отладка источников данных, используемых в обработке платежей

### <a name="debug-the-model-mapping"></a>Отладка сопоставления моделей

1. На странице **Отладка источников данных** в области действий выберите **Сопоставление моделей**, чтобы начать отладку из этого компонента ER.
2. На панели источников данных слева выберите **\$notSentTransactions**, а затем выберите **Читать все записи**.

    Можно выбрать **Читать 1 запись**, **Читать 10 записей**, **Читать 100 записей** или **Читать все записи**, чтобы получить нужное количество записей из выбранного источника данных. Таким образом можно смоделировать доступ к источнику данных из выполняемого формата ER.

3. В области данных справа выберите **Развернуть все**.

    Можно увидеть, что выбранный источник данных типа **Список записей** содержит одну запись.

4. Разверните источник данных **\$notSentTransactions** и выберите вложенный метод **vendBankAccountInTransactionCompany()**.
5. Разверните метод **vendBankAccountInTransactionCompany()** и выберите вложенное поле **IBAN**.
6. Выберите **Получить значение**.

    Можно выбрать **Получить значение**, чтобы считать значение выбранного поля из выбранного источника данных. Таким образом можно смоделировать доступ к этому полю из выполняемого формата ER.

7. Выберите **Развернуть все**.

    ![Значение поля IBAN в сопоставлении моделей](./media/er-data-debugger-debugging-model-mapping.png)

    Как можно видеть, сопоставление моделей не имеет отношения к удалению пробелов, так как код IBAN, возвращаемый для банковского счета поставщика, содержит пробелы. Поэтому необходимо продолжить отладку источника данных.

### <a name="debug-the-format-mapping"></a>Отладка сопоставления формата

1. На странице **Отладка источников данных** в области действий выберите **Сопоставление формата**, чтобы продолжить отладку из этого компонента ER.
2. Выберите источник **\$PaymentByDebtor**, а затем выберите **Читать все записи**.
3. Разверните **\$PaymentByDebtor**.
4. Разверните **\$PaymentByDebtor.Lines**, а затем выберите **Читать все записи**.
5. Разверните **\$PaymentByDebtor.Lines.CreditorAccount**.
6. Разверните **\$PaymentByDebtor.Lines.CreditorAccount.Identification**, а затем выберите **\$PaymentByDebtor.Lines.CreditorAccount.Identification.IBAN**.
7. Выберите **Получить значение**.
8. Выберите **Развернуть все**.

    ![Значение поля IBAN в сопоставлении формата](./media/er-data-debugger-debugging-format-mapping.png)

    Как можно видеть, источники данных сопоставления формата не имеют отношения к удалению пробелов, так как код IBAN, возвращаемый ими для банковского счета поставщика, содержит пробелы. Поэтому необходимо продолжить отладку источника данных.

### <a name="debug-the-format"></a>Отладка формата

1. На странице **Отладка источников данных** в области действий выберите **Формат**, чтобы продолжить отладку из этого компонента ER.
2. Разверните элементы формата и выберите **ISO20022CTReports** \> **XMLHeader** \> **Document** \> **CstmrCdtTrfInitn** \> **PmtInf**, а затем выберите **Читать все записи**.
3. Разверните элементы формата и выберите **ISO20022CTReports** \> **XMLHeader** \> **Document** \> **CstmrCdtTrfInitn** \> **PmtInf** \> **CdtTrfTxInf**, а затем выберите **Читать все записи**.
4. Разверните элементы формата и выберите **ISO20022CTReports** \> **XMLHeader** \> **Document** \> **CstmrCdtTrfInitn** \> **PmtInf** \> **CdtTrfTxInf** \> **CdtrAcct** \> **Id** \> **IBAN** \> **BankIBAN**, а затем выберите **Получить значение**.
5. Выберите **Развернуть все**.

    ![Значение поля IBAN в формате](./media/er-data-debugger-debugging-format.png)

   Как можно видеть, привязка формата не имеет отношения к удалению пробелов, так как код IBAN, возвращаемый для банковского счета поставщика, содержит пробелы. Таким образом, элемент **BankIBAN** настроен на использование преобразования формата, которое удаляет пробелы.

6. Закройте отладчик источника данных.

### <a name="review-the-format-transformations"></a>Просмотр преобразований формата

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** выберите **Модель платежа** \> **Перенос кредита ISO20022**.
3. Выберите **Конструктор**, а затем разверните элементы и выберите **Document** \> **CstmrCdtTrfInitn** \> **PmtInf** \> **CdtTrfTxInf** \> **CdtrAcct** \> **Id** \> **IBAN** \> **BankIBAN**.

    ![Элемент BankIBAN на странице конструктора формата](./media/er-data-debugger-referred-transformation.png)

    Как можно видеть, элемент **BankIBAN** сконфигурирован для использования преобразования **удалить не буквенно-цифровые символы**.

4. Выберите вкладку **Преобразования**.

    ![Вкладка "преобразования" для элемента BankIBAN](./media/er-data-debugger-transformation.png)

    Как можно видеть, преобразование **удалить не буквенно-цифровые символы** настроено для использования выражения, которое удаляет пробелы из введенной текстовой строки.

## <a name="start-to-debug-in-the-operation-designer"></a>Начало отладки в конструкторе операций

При настройке черновой версии формата ER, которая может быть запущена непосредственно из конструктора операций, можно получить доступ к отладчику источников данных, выбрав команду **Начать отладку** в области действий.

![Кнопка "Начать отладку" на странице "Конструктор форматов"](./media/er-data-debugger-run-from-designer.png)

Редактируемые в формате ER компоненты форматирования и преобразования доступны для отладки.

## <a name="start-to-debug-in-the-model-mapping-designer"></a>Начало отладки в конструкторе сопоставления моделей

При настройке сопоставления моделей ER, которое может быть запущено непосредственно со страницы **Сопоставление моделей**, можно получить доступ к отладчику источников данных, выбрав команду **Начать отладку** в области действий.

![Кнопка "Начать отладку" на странице "Конструктор сопоставлений моделей"](./media/er-data-debugger-run-from-designer-mapping.png)

Изменяемый компонент сопоставления моделей в сопоставлении ER доступен для отладки.

## <a name="appendix-1-get-an-er-solution"></a><a name="appendix1"></a>Приложение 1. Получение решения ER

### <a name="download-an-er-solution"></a>Загрузка решения ER

Если необходимо использовать решение ER для создания файла электронного платежа для обрабатываемого платежа поставщику, можно [загрузить](download-electronic-reporting-configuration-lcs.md) формат платежей ER **Перенос кредита ISO20022**, доступный в библиотеки общих ресурсов в Microsoft Dynamics Lifecycle Services (LCS) или в глобальном репозитории.

![Импорт формата платежей ER на странице "Репозиторий конфигураций"](./media/er-data-debugger-import-from-repo.png)

В дополнение к выбранному формату ER следующие [конфигурации](general-electronic-reporting.md#Configuration) должны быть автоматически импортированы в экземпляр Microsoft Dynamics 365 Finance в рамках решения **Перенос кредита ISO20022**:

- **Модель платежа** [Конфигурация модели данных ER](general-electronic-reporting.md#DataModelComponent)
- **Перенос кредита ISO20022** [Конфигурация формата ER](general-electronic-reporting.md#FormatComponentOutbound)
- **Сопоставление модели платежей 1611** [Конфигурация сопоставления моделей ER](general-electronic-reporting.md#ModelMappingComponent)
- **Сопоставление модели платежей назначению ISO20022** Конфигурация сопоставления моделей ER

Эти конфигурации можно найти на странице **Конфигурации** среды ER (**Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**).

![Конфигурации, импортированные на странице конфигурации](./media/er-data-debugger-configurations.png)

Если ранее указанные конфигурации отсутствуют в дереве конфигураций, необходимо вручную загрузить их из библиотеки общих ресурсов LCS так же, как вы загрузили формат платежей ER **Перенос кредита ISO20022**.

### <a name="analyze-the-downloaded-er-solution"></a>Анализ загруженного решения ER

#### <a name="review-the-model-mapping"></a>Просмотр сопоставления моделей

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. Выберите **Модель платежа** \> **Сопоставление модели платежей 1611**.
3. Выберите **Конструктор**.
4. Выберите запись сопоставления **Сопоставление модели платежей ISO20022 CT**.
5. Выберите **Конструктор**, а затем проверьте открытое сопоставление модели.

    Обратите внимание, что поле **Платежи** модели данных привязано к источнику данных **\$notSentTransactions**, который возвращает список обрабатываемых строк платежа поставщику.

    ![Поле платежей на странице конструктора сопоставления моделей](./media/er-data-debugger-model-mapping.png)

#### <a name="review-the-format-mapping"></a>Просмотр сопоставления формата

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. Выберите **Модель платежей** \> **Перенос кредита ISO20022**.
3. Выберите **Конструктор**.
4. На вкладке **Сопоставление** проверьте открытое сопоставление формата.

    Обратите внимание, что элемент **Document** \> **CstmrCdtTrfInitn** \> **PmtInf** файла **ISO20022CTReports** \> **XMLHeader** связан с источником данных **\$PaymentByDebtor**, который настроен на группировку записей в поле **Платежи** модели данных.

    ![Элемент PmtInf на странице конструктора формата](./media/er-data-debugger-format-mapping.png)

#### <a name="review-the-format"></a>Просмотр формата

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. Выберите **Модель платежей** \> **Перенос кредита ISO20022**.
3. Выберите **Конструктор**, а затем проверьте открытый формат.

    Обратите внимание, что элемент **Document** \> **CstmrCdtTrfInitn** \> **PmtInf** \> **CdtTrfTxInf** \> **CdtrAcct** \> **Id** \> **IBAN** \> **BankIBAN** настроен на ввод кода IBAN счета поставщика в файле платежа.

    ![Элемент BankIBAN на странице конструктора формата](./media/er-data-debugger-format.png)

## <a name="appendix-2-configure-accounts-payable"></a><a name="appendix2"></a>Приложение 2. Настройка модуля "Расчеты с поставщиками"

### <a name="modify-a-vendor-property"></a>Изменение свойства поставщика

1. Перейдите в раздел **Расчеты с поставщиками** \> **Поставщики** \> **Все поставщики**.
2. Выберите поставщика **DE-01002**, а затем в области действий на вкладке **Поставщик** в группе **Настройка** выберите **Банковские счета**.
3. На экспресс-вкладке **Идентификация** в поле **IBAN** <a name="enteredIBANcode"></a>введите **GB33 BUKB 2020 1555 5555 55**.
4. Нажмите **Сохранить**.

![Поле IBAN на странице банковских счетов поставщика](./media/er-data-debugger-iban.png)

### <a name="set-up-a-method-of-payment"></a>Настройка способа оплаты

1. Перейдите в раздел **Расчеты с поставщиками** \> **Настройка платежей** \> **Способы оплаты**.
2. Выберите способ оплаты **SEPA CT**.
3. На экспресс-вкладке **Форматы файлов** в разделе **Форматы файлов** установите для параметра **Универсальный электронный формат экспорта** значение **Да**.
4. В поле **Экспорт конфигурации формата** выберите формат ER **Перенос кредита ISO20022**.
5. Нажмите **Сохранить**.

![Настройки формата файлов на странице способов оплаты](./media/er-data-debugger-payment-method.png)

### <a name="add-a-vendor-payment"></a>Добавление платежа поставщику

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. Добавьте новый журнал платежей.
3. Выберите **Строки** и добавьте новую строку платежа.
4. В поле **Счет** выберите поставщика **DE-01002**.
5. В поле **Дебет** введите значение.
6. В поле **Способ оплаты** выберите **SEPA CT**.
7. Нажмите **Сохранить**.

![Платеж поставщику добавлен на странице оплаты поставщику](./media/er-data-debugger-payment-journal.png)

## <a name="appendix-3-process-a-vendor-payment"></a><a name="appendix3"></a>Приложение 3. Обработка платежа поставщику

1. Перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей поставщикам**.
2. На странице **Журнал платежей поставщику** выберите созданный ранее журнал платежей, а затем выберите **Строки**.
3. Выберите строку платежа, затем выберите **Статус платежа** \> **Нет**.
4. Выберите **Создать платежи**.
5. В поле **Способ оплаты** выберите **SEPA CT**.
6. В поле **Банковский счет** выберите **DEMF OPER**.
7. В диалоговом окне **Создать платежи** выберите **OK**.
8. В диалоговом окне **Параметры электронной отчетности** выберите **ОК**.


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]