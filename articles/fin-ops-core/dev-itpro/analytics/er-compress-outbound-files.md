---
title: Сжатие больших документов, созданных в электронной отчетности
description: В этой теме объясняется, как сжимать крупные документы, созданные форматом электронной отчетности (ER).
author: NickSelin
manager: kfend
ms.date: 09/11/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERFormatDestinationTable
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: AX 10.0.9
ms.openlocfilehash: 8a8f55b33624b057a6abf9af5084209ac6a0c778
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5562342"
---
# <a name="compress-large-documents-that-are-generated-in-electronic-reporting"></a><span data-ttu-id="d3947-103">Сжатие больших документов, созданных в электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="d3947-103">Compress large documents that are generated in Electronic reporting</span></span> 

[!include [banner](../includes/banner.md)]

<span data-ttu-id="d3947-104">Можно использовать [платформу электронной отчетности (ER)](general-electronic-reporting.md) для настройки решения, которое извлекает данные проводок для создания исходящего документа.</span><span class="sxs-lookup"><span data-stu-id="d3947-104">You can use the [Electronic reporting (ER) framework](general-electronic-reporting.md) to configure a solution that fetches transactional data to generate an outbound document.</span></span> <span data-ttu-id="d3947-105">Созданный документ может быть довольно большим.</span><span class="sxs-lookup"><span data-stu-id="d3947-105">This generated document might be quite large.</span></span> <span data-ttu-id="d3947-106">При создании документа этого типа для его хранения используется память сервера [Application Object Server (AOS)](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#location-of-packages-source-code-and-other-aos-configurations).</span><span class="sxs-lookup"><span data-stu-id="d3947-106">When this type of document is generated, the [Application Object Server (AOS)](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#location-of-packages-source-code-and-other-aos-configurations) memory is used to hold it.</span></span> <span data-ttu-id="d3947-107">В какой-то момент документ необходимо загрузить из приложения Microsoft Dynamics 365 Finance.</span><span class="sxs-lookup"><span data-stu-id="d3947-107">At some point, the document must then be downloaded from your Microsoft Dynamics 365 Finance application.</span></span> <span data-ttu-id="d3947-108">В настоящее время максимальный размер одного документа, созданного в электронной отчетности, не должен превышать 2 гигабайт (ГБ).</span><span class="sxs-lookup"><span data-stu-id="d3947-108">Currently, the maximum size of a single document that is generated in ER is limited to 2 gigabytes (GB).</span></span> <span data-ttu-id="d3947-109">Кроме того, в Finance в настоящее время размер загруженного файла [ограничивается](https://fix.lcs.dynamics.com/Issue/Details?kb=4569432&bugId=453907&dbType=3) значением 1 ГБ.</span><span class="sxs-lookup"><span data-stu-id="d3947-109">Additionally, Finance currently [limits](https://fix.lcs.dynamics.com/Issue/Details?kb=4569432&bugId=453907&dbType=3) the size of a downloaded file to 1 GB.</span></span> <span data-ttu-id="d3947-110">Таким образом, необходимо настроить решение электронной отчетности, чтобы уменьшить вероятность того, что эти ограничения будут превышены, и вы будете получать исключение **Превышена допустимая длина потока** или **Переполнение или потеря точности в арифметической операции**.</span><span class="sxs-lookup"><span data-stu-id="d3947-110">Therefore, you must configure an ER solution that reduces the likelihood that these limitations will be exceeded, and that you will receive a **Stream was too long** or **Overflow or underflow in the arithmetic operation** exception.</span></span>

<span data-ttu-id="d3947-111">При настройке решения можно изменить формат электронной отчетности в конструкторе операций, добавив корневой элемент типа **Папка** для сжатия содержимого, создаваемого любым из его вложенных элементов.</span><span class="sxs-lookup"><span data-stu-id="d3947-111">When you configure a solution, you can adjust your ER format in the Operations designer by adding a root element of the **Folder** type to compress the content that is generated by any of its nested elements.</span></span> <span data-ttu-id="d3947-112">Сжатие работает в режиме "точно во время", что позволяет уменьшить пиковое потребление памяти и размер файла, который будет загружен.</span><span class="sxs-lookup"><span data-stu-id="d3947-112">Compression works "just in time," so that peak memory usage and the size of the file that will be downloaded can be reduced.</span></span>

> [!NOTE]
> <span data-ttu-id="d3947-113">Сжатие файлов занимает дополнительный процент загрузки ЦП.</span><span class="sxs-lookup"><span data-stu-id="d3947-113">File compression takes an additional percentage of CPU usage.</span></span>

<span data-ttu-id="d3947-114">Чтобы получить дополнительные сведения об этом подходе, выполните пример в этой теме.</span><span class="sxs-lookup"><span data-stu-id="d3947-114">For more information about this approach, complete the example in this topic.</span></span>

## <a name="example-compress-an-outbound-document"></a><span data-ttu-id="d3947-115">Пример: сжатие исходящего документа</span><span class="sxs-lookup"><span data-stu-id="d3947-115">Example: Compress an outbound document</span></span>

<span data-ttu-id="d3947-116">В этом примере показано, как пользователь, назначенный для роли **Системный администратор** или **Функциональный консультант электронной отчетности**, может настроить формат электронной отчетности для сжатия созданного документа.</span><span class="sxs-lookup"><span data-stu-id="d3947-116">This example shows how a user who is assigned to the **System administrator** or **Electronic reporting functional consultant** role can configure an ER format to compress a generated document.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="d3947-117">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="d3947-117">Prerequisites</span></span>

<span data-ttu-id="d3947-118">Перед окончанием выполнения процедур данного раздела необходимо выполнить указанные ниже шаги.</span><span class="sxs-lookup"><span data-stu-id="d3947-118">Before you complete the procedures in this topic, the following steps must be completed.</span></span>

1. <span data-ttu-id="d3947-119">[Активация поставщика конфигураций](er-defer-xml-element.md#activate-a-configuration-provider).</span><span class="sxs-lookup"><span data-stu-id="d3947-119">[Activate a configuration provider](er-defer-xml-element.md#activate-a-configuration-provider).</span></span>
2. <span data-ttu-id="d3947-120">[Импорт примера конфигураций электронной отчетности](er-defer-xml-element.md#import-the-sample-er-configurations).</span><span class="sxs-lookup"><span data-stu-id="d3947-120">[Import the sample ER configurations](er-defer-xml-element.md#import-the-sample-er-configurations).</span></span>
3. <span data-ttu-id="d3947-121">[Просмотр импортированного формата](er-defer-xml-element.md#review-the-imported-format).</span><span class="sxs-lookup"><span data-stu-id="d3947-121">[Review the imported format](er-defer-xml-element.md#review-the-imported-format).</span></span>

> [!NOTE]
> <span data-ttu-id="d3947-122">В настоящее время структура формата начинается с элемента **Отчет** типа **Файл** и содержит XML-элементы.</span><span class="sxs-lookup"><span data-stu-id="d3947-122">Currently, the format structure starts from the **Report** element of the **File** type and contains XML elements.</span></span> <span data-ttu-id="d3947-123">Таким образом, исходящий документ будет создан в формате XML, и сжатие использоваться не будет.</span><span class="sxs-lookup"><span data-stu-id="d3947-123">Therefore, an outbound document will be generated in XML format, and no compression will be used.</span></span>

### <a name="generate-an-er-format-to-get-an-uncompressed-document"></a><span data-ttu-id="d3947-124">Создание формата электронной отчетности для получения несжатого документа</span><span class="sxs-lookup"><span data-stu-id="d3947-124">Generate an ER format to get an uncompressed document</span></span>

1. <span data-ttu-id="d3947-125">[Запустите импортированный формат](er-defer-xml-element.md#run-the-imported-format).</span><span class="sxs-lookup"><span data-stu-id="d3947-125">[Run the imported format](er-defer-xml-element.md#run-the-imported-format).</span></span>
2. <span data-ttu-id="d3947-126">Обратите внимание, что размер создаваемого документа в формате XML составляет 3 килобайта (КБ).</span><span class="sxs-lookup"><span data-stu-id="d3947-126">Notice that the size of the generated document in XML format is 3 kilobytes (KB).</span></span>

    ![Предварительный просмотр несжатого исходящего документа](./media/er-compress-outbound-files1.png)

### <a name="modify-the-format-to-compress-the-generated-output"></a><span data-ttu-id="d3947-128">Изменение формата для сжатия созданных выходных данных</span><span class="sxs-lookup"><span data-stu-id="d3947-128">Modify the format to compress the generated output</span></span>

1. <span data-ttu-id="d3947-129">Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="d3947-129">Go to **Organization administration** \> **Electronic reporting** \> **Configurations**.</span></span>
2. <span data-ttu-id="d3947-130">На странице **Конфигурации** в дереве конфигураций разверните **Модель для изучения отложенных элементов**.</span><span class="sxs-lookup"><span data-stu-id="d3947-130">On the **Configurations** page, in the configuration tree, expand **Model to learn deferred elements**.</span></span>
3. <span data-ttu-id="d3947-131">Выберите конфигурацию **Формат для изучения отложенных элементов XML**.</span><span class="sxs-lookup"><span data-stu-id="d3947-131">Select the **Format to learn deferred XML elements** configuration.</span></span>
4. <span data-ttu-id="d3947-132">Выберите **Конструктор**, чтобы изменить структуру формата.</span><span class="sxs-lookup"><span data-stu-id="d3947-132">Select **Designer** to modify the format structure.</span></span>
5. <span data-ttu-id="d3947-133">На странице **Конструктор форматов** на вкладке **Формат** выберите **Добавить корень**, чтобы добавить корневой элемент формата.</span><span class="sxs-lookup"><span data-stu-id="d3947-133">On the **Format designer** page, on the **Format** tab, select **Add root** to add a root format element.</span></span>
6. <span data-ttu-id="d3947-134">В диалоговом окне **Добавление** выберите **Общая\\папка**.</span><span class="sxs-lookup"><span data-stu-id="d3947-134">In the **Add** dialog box, select **Common\\Folder**.</span></span>
7. <span data-ttu-id="d3947-135">Выберите **ОК**, чтобы подтвердить добавление нового корневого элемента.</span><span class="sxs-lookup"><span data-stu-id="d3947-135">Select **OK** to confirm the addition of the new root element.</span></span>
8. <span data-ttu-id="d3947-136">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d3947-136">Select **Save**.</span></span>

> [!NOTE]
> <span data-ttu-id="d3947-137">Структура формата начинается с элемента типа **Папка**.</span><span class="sxs-lookup"><span data-stu-id="d3947-137">The format structure starts from the element of the **Folder** type.</span></span> <span data-ttu-id="d3947-138">Этот элемент будет создавать выходные данные в виде сжатого ZIP-файла.</span><span class="sxs-lookup"><span data-stu-id="d3947-138">This element will generate output as a compressed (zip) file.</span></span> <span data-ttu-id="d3947-139">Когда документ, созданный элементом **Отчет**, помещается в исходящий ZIP-файл, его содержимое будет сжиматься для уменьшения размера исходящего файла.</span><span class="sxs-lookup"><span data-stu-id="d3947-139">When a document that is generated by the **Report** element is put in an outbound zip file, its content will be compressed to reduce the size of the outbound file.</span></span>

### <a name="generate-an-er-format-to-get-a-compressed-document"></a><span data-ttu-id="d3947-140">Создание формата электронной отчетности для получения сжатого документа</span><span class="sxs-lookup"><span data-stu-id="d3947-140">Generate an ER format to get a compressed document</span></span>

1. <span data-ttu-id="d3947-141">На странице **Конструктор формата** выберите **Выполнить**.</span><span class="sxs-lookup"><span data-stu-id="d3947-141">On the **Format designer** page, select **Run**.</span></span>
2. <span data-ttu-id="d3947-142">Загрузите ZIP-файл, предлагаемый веб-браузером, и откройте его для просмотра.</span><span class="sxs-lookup"><span data-stu-id="d3947-142">Download the zip file that the web browser offers, and open it for review.</span></span>
3. <span data-ttu-id="d3947-143">Обратите внимание, что размер создаваемого документа в формате ZIP составляет 1 КБ.</span><span class="sxs-lookup"><span data-stu-id="d3947-143">Notice that the size of the generated document in ZIP format is 1 KB.</span></span>

    > [!NOTE] 
    > <span data-ttu-id="d3947-144">Коэффициент сжатия файла XML, хранящегося в этом ZIP-файле, составляет 87 процентов.</span><span class="sxs-lookup"><span data-stu-id="d3947-144">The compression ratio of the XML file that this zip file holds is 87 percent.</span></span> <span data-ttu-id="d3947-145">Коэффициент сжатия зависит от данных, которые сжимаются.</span><span class="sxs-lookup"><span data-stu-id="d3947-145">The compression ratio depends on the data that is being compressed.</span></span>

    ![Предварительный просмотр сжатого исходящего документа](./media/er-compress-outbound-files2.png)

> [!NOTE]
> <span data-ttu-id="d3947-147">Если [пункт назначения](electronic-reporting-destinations.md) электронной отчетности настроен для элемента формата, который создает выходные данные (элемент **Отчет** в этом примере), сжатие выходных данных будет пропущено.</span><span class="sxs-lookup"><span data-stu-id="d3947-147">If the ER [destination](electronic-reporting-destinations.md) is configured for the format element that generates output (the **Report** element in this example), compression of the output will be bypassed.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="d3947-148">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="d3947-148">Additional resources</span></span>

[<span data-ttu-id="d3947-149">Обзор электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="d3947-149">Electronic reporting (ER) overview</span></span>](general-electronic-reporting.md)

[<span data-ttu-id="d3947-150">Места назначения электронной отчетности (ER)</span><span class="sxs-lookup"><span data-stu-id="d3947-150">Electronic reporting (ER) destinations</span></span>](electronic-reporting-destinations.md)

[<span data-ttu-id="d3947-151">Отложенное выполнение элементов XML в форматах электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="d3947-151">Defer the execution of XML elements in ER formats</span></span>](er-defer-xml-element.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]