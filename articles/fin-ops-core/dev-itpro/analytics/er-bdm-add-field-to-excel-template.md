---
title: Добавление новых полей в шаблон бизнес-документа в Microsoft Excel
description: В этой статье представлена информация о том, как добавить новые поля в шаблон бизнес-документа в Microsoft Excel с помощью функции управления бизнес-документами.
author: NickSelin
ms.date: 11/15/2019
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERBDWorkspace, ERBDParameters, ERBDTemplateEditor
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-10-01
ms.dyn365.ops.version: 10.0.7
ms.openlocfilehash: 8395a87e88ebbd1942c87da0cecebe6d25bdf625
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2022
ms.locfileid: "8869412"
---
# <a name="add-new-fields-to-a-business-document-template-in-microsoft-excel"></a>Добавление новых полей в шаблон бизнес-документа в Microsoft Excel

[!include[banner](../includes/banner.md)]

В шаблон можно добавлять новые поля, используемые для создания бизнес-документов в формате Microsoft Excel. Эти поля могут быть добавлены в качестве заполнителей, используемых для заполнения созданных документов необходимыми сведениями из приложения. Для каждого добавляемого поля можно также задать привязку к источникам данных, чтобы указать, какие данные приложения будут вводиться в поле при использовании шаблона для создания бизнес-документов.

Чтобы получить дополнительные сведения об этой функции, выполните пример в этой статье. В этом примере показано, как обновить шаблон, чтобы заполнить поля в создаваемых формах накладных с произвольным текстом.

## <a name="configure-business-document-management-to-edit-templates"></a>Настройка управления бизнес-документами для редактирования шаблонов

Так как управление бизнес-документами (BDM) основано на верхней части [Обзор электронной отчетности (ER)](general-electronic-reporting.md), необходимо настроить необходимые параметры ER и BDM, прежде чем можно будет начать работать с BDM.

1.  Выполните вход в экземпляр Microsoft Dynamics 365 Finance в качестве системного администратора.
2.  Выполните следующие шаги примера в статье [Обзор управления бизнес-документами](er-business-document-management.md):

    1.  Настройте параметры ER.
    2.  Включите BDM.

Теперь можно приступить к использованию БДМ для редактирования шаблонов бизнес-документов.

## <a name="import-er-solutions-that-contain-a-template"></a>Импорт решений ER, содержащих шаблон

В примере в этой процедуре используется официально опубликованное решение ER. Необходимо импортировать конфигурации ER данного решения в текущий экземпляр Finance.

Конфигурация формата ER **Накладная с произвольным текстом (Excel)** для этого решения содержит шаблон бизнес-документа в формате Excel, который можно редактировать с помощью BDM. Импортируйте последнюю версию конфигурации формата ER Microsoft Dynamics Lifecycle Service (LCS). Соответствующая модель данных ER и конфигурации сопоставления модели ER будут импортированы автоматически.

Дополнительные сведения о способе импорта конфигураций ER см. в разделе [Управление жизненным циклом конфигурации ER](general-electronic-reporting-manage-configuration-lifecycle.md).

![Страница общей библиотеки активов LCS.](./media/BDM-AddFldExcel-LCS.png)

### <a name="edit-the-er-solution-template"></a>Редактирование шаблона решения ER

1.  Выполните вход как пользователь, имеющий доступ к рабочей области **Управление бизнес-документами**.
2.  Откройте рабочую область **Управление бизнес-документами**.

    ![Рабочая область управления бизнес-документами.](./media/BDM-AddFldExcel-Workspace.png)

3.  В сетке выберите шаблон накладной с **Накладная с произвольным текстом (Excel)**.
4.  В правой области выберите **Создать шаблон**, чтобы создать шаблон, основанный на выбранном шаблоне.
5.  В поле **Название** введите в качестве названия нового шаблона **Накладная с произвольным текстом (Excel) Contoso**.
6.  Выберите **ОК**, чтобы подтвердить начало процесса редактирования.

Появится страница редактора шаблонов BDM. Можно использовать Microsoft 365 для редактирования выбранного шаблона в интерактивном режиме во встроенном элементе управления.

![Страница редактора шаблонов BDM.](./media/BDM-AddFldExcel-EditableTemplate.png)

### <a name="add-the-label-for-a-new-field-to-the-template"></a>Добавление метки для нового поля в шаблон

1.  На странице редактора шаблонов BDM в ленте Excel на вкладке **Вид** установите флажки **Заголовки и линии сетки** для редактируемого шаблона Excel.

    ![Установлены флажки заголовков и линий сетки.](./media/BDM-AddFldExcel-EditableTemplate2.png)

2.  Выберите ячейки **E8:F8**.
3.  В ленте Excel на вкладке **Главная** выберите **Объединить и выровнять по центру**, чтобы объединить выбранные ячейки в новую объединенную ячейку **E8:F8**.
4.  В объединенной ячейке **E8:F8** введите **URL-адрес**.
5.  Выберите объединенную ячейку **E7:F7**, выберите **Форматирование по образцу**, а затем выберите объединенную ячейку **E8:F8**, чтобы отформатировать ее так же, как и объединенную ячейку **E7: F7**.

    ![Добавление метки нового поля в шаблон.](./media/BDM-AddFldExcel-EditableTemplate3.png)

### <a name="format-the-template-to-reserve-space-for-a-new-field"></a>Форматирование шаблона для резервирования пространства для нового поля

1.  На странице редактора шаблонов BDM выберите объединенную ячейку **G8:H8**.
2.  В ленте Excel на вкладке **Главная** выберите **Объединить и выровнять по центру**, чтобы объединить выбранные ячейки в новую объединенную ячейку **G8:H8**.
3.  Выберите объединенную ячейку **G7:H7**, выберите **Форматирование по образцу**, а затем выберите объединенную ячейку **G8:H8**, чтобы отформатировать ее так же, как и объединенную ячейку **G7: H7**.

    ![Пространство, зарезервированное для нового поля.](./media/BDM-AddFldExcel-EditableTemplate4.png)

4.  В поле **Имя** выберите **CompanyInfo**.

    Диапазон **CompanyInfo** текущего шаблона Excel содержит все поля, используемые для заполнения заголовка созданного отчета сведениями о текущей компании в качестве стороны продавца.

    ![Выбран диапазон CompanyInfo.](./media/BDM-AddFldExcel-SelectCompanyInfoRange.png)

### <a name="add-a-new-field-to-the-template"></a>Добавление нового поля в шаблон

1.  На странице **редактора шаблонов BDM** в области действий выберите **Показать формат**.
2.  В области **Структура шаблона** выберите **Добавить**.

    > [!NOTE]
    > Необходимо откорректировать раздел шаблона, который будет использоваться в качестве нового поля. Эта корректировка уже была выполнена путем форматирования объединенной ячейки **G8:H8**.

    ![Добавление нового поля в шаблон.](./media/BDM-AddFldExcel-AddCell.png)

3.  Выберите **Excel\Ячейка**, чтобы добавить новое поле в качестве ячейки в шаблоне.

    Можно выбрать **Excel\Диапазон**, если необходимо добавить новый диапазон в шаблон. Введенный диапазон может содержать несколько ячеек. Эти ячейки можно будет добавить позже.
    
    Обратите внимание, что компонент шаблона **CompanyInfo** автоматически выбирается в области **Структура шаблона**, поскольку он является наиболее подходящим родительским компонентом в текущей структуре шаблона для добавляемого поля.
    
4.  В поле **Диапазон Excel** введите **CompanyURL_Value**.
5.  Нажмите **ОК**.

    ![Поле CompanyURL_Value добавляется в структуру шаблона.](./media/BDM-AddFldExcel-EditableTemplate5.png)

6.  В области **Структура шаблона** выберите кнопку с многоточием (...), а затем выберите **Показать привязки**.

    ![Отображение выбранных привязок.](./media/BDM-AddFldExcel-ShowBindings.png)

    В области **Структура шаблона** теперь отображаются источники данных, доступные в основном формате ER.

7.  Выберите **CompanyInfo_Value** как поле, которое планируется привязать к источнику данных в основном формате ER.
8.  В разделе **Источники данных** панели **Структура шаблона** раскройте **Модель \> InvoiceBase \> CompanyInfo**.
9.  В области **CompanyInfo** выберите элемент **WebsiteURI**.

    ![Выбран элемент WebsiteURI.](./media/BDM-AddFldExcel-BindURL.png)

10. Выберите **Связать**.
11. В области **Структура шаблона** выберите **Сохранить** и закройте страницу редактора шаблонов BDM.

В рабочей области **Управление бизнес-документами** на вкладке **Шаблон** в правой области отображается обновленный шаблон. Обратите внимание, что в сетке поле **Статус** для измененного шаблона изменено на **Черновик**, а поле **Версия** больше не пустое. Такие изменения означают, что процесс редактирования этого шаблона был запущен.

![Измененный шаблон в рабочей области управления бизнес-документами.](./media/BDM-AddFldExcel-Workspace2.png)

## <a name="review-company-settings"></a>Просмотр настроек компании

1.  Перейдите в раздел **Управление организацией \> Организации \> Юридические лица**.
2.  Убедитесь, что URL-адрес компании введен на экспресс-вкладке **Контактная информация**.

![URL-адрес компании, введенный на странице юридических лиц.](./media/BDM-AddFldExcel-CompanyInfo.png)

## <a name="generate-business-documents-to-test-the-updated-template"></a>Создание бизнес-документов для тестирования обновленного шаблона

1.  В приложении измените компанию на **USMF** и перейдите **Расчеты с клиентами \> Накладные \> Все накладные с произвольным текстом**.
2.  Выберите накладную **FTI-00000002**, затем выберите **Управление печатью**.
3.  В левой области раскройте **Модуль — Расчеты с клиентами \> Документы \> Накладная с произвольным текстом**.
4.  В **Накладная с произвольным текстом** выберите уровень **Исходный документ**, чтобы задать область накладных для обработки.
5.  В правой области в поле **Формат отчета** выберите шаблон **Накладная с произвольным текстом (Excel) Contoso** для указанного уровня документа.

    ![Выбранный шаблон "Накладная с произвольным текстом (Excel) Contoso".](./media/BDM-AddFldExcel-PrintMngtSetting.png)

6.  Нажмите клавишу **Esc**, чтобы закрыть текущую страницу.
7.  Выберите **Печать \> Выбранное**.
8.  Загрузите созданный документ и откройте его в Excel.

    ![Накладная с произвольным текстом в Excel.](./media/BDM-AddFldExcel-PreviewReport.png)

Измененный шаблон используется для создания отчета по накладной с произвольным текстом для выбранной номенклатуры. Чтобы проанализировать влияние изменений, введенных в шаблон, на этот отчет, можно выполнить этот отчет в одном сеансе приложения сразу после того, как был изменен шаблон в другом сеансе приложения.

## <a name="related-links"></a>Связанные ссылки

[Обзор электронной отчетности (ER)](general-electronic-reporting.md)

[Обзор управления бизнес-документами](er-business-document-management.md)

[Разработка конфигурации для создания отчетов в формате OPENXML](tasks/er-design-reports-openxml-2016-11.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]