---
title: Разработка новых конфигураций электронной отчетности для создания отчетов в формате Word
description: В этой теме объясняется как пользователи могут настроить новый формат электронной отчетности (ER) для создания отчетов в виде документов Microsoft Word.
author: NickSelin
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 4885caf017fa0f9d36d293fa32aad53c21d3f162
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753584"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="5e391-103">Разработка новых конфигураций электронной отчетности для создания отчетов в формате Word</span><span class="sxs-lookup"><span data-stu-id="5e391-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="5e391-104">Для создания отчетов в виде документов Microsoft Word необходимо разработать шаблон для отчетов, используя, например, классическое приложение Word.</span><span class="sxs-lookup"><span data-stu-id="5e391-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="5e391-105">На следующем рисунке показан образец шаблона для контрольного отчета, который может быть создан для отображения сведений об обработанных платежах поставщикам.</span><span class="sxs-lookup"><span data-stu-id="5e391-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Образец шаблона для контрольного отчета в классическом приложении Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="5e391-107">Чтобы использовать документ Word в качестве шаблона для отчетов в формате Word, можно настроить новое [решение](er-quick-start1-new-solution.md) [электронной отчетности (ER)](general-electronic-reporting.md).</span><span class="sxs-lookup"><span data-stu-id="5e391-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="5e391-108">Это решение должно включать [конфигурацию](general-electronic-reporting.md#Configuration) электронной отчетности, которая содержит компонент [формата](general-electronic-reporting.md#FormatComponentOutbound) электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="5e391-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="5e391-109">При создании новой конфигурации формата электронной отчености для создания отчетов в формате Word необходимо либо выбрать **Word** в качестве типа формата в раскрывающемся диалоговом окне **Создать конфигурацию**, либо оставить поле **Тип формата** пустым.</span><span class="sxs-lookup"><span data-stu-id="5e391-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Создание конфигурации формата на странице конфигураций](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="5e391-111">Компонент формата электронной отчетности решения должен содержать элемент формата **Excel\\File**, и этот элемент формата должен быть связан с документом Word, который будет использоваться в качестве шаблона для созданных отчетов во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e391-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="5e391-112">Чтобы настроить компонент формата электронной отчетности, необходимо открыть [черновую](general-electronic-reporting.md#component-versioning) версию созданной конфигурации электронной отчетности в конструкторе форматов электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="5e391-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="5e391-113">Затем добавьте элемент **Excel\\File**, вложите шаблон Word в редактируемый формат электронной отчетности и свяжите этот шаблон с добавленным элементом **Excel\\File**.</span><span class="sxs-lookup"><span data-stu-id="5e391-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="5e391-114">При присоединении шаблона необходимо использовать [тип документа](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types), который был ранее [настроен](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) в параметрах электронной отчетности для хранения шаблонов в форматах электронной отчетности.</span><span class="sxs-lookup"><span data-stu-id="5e391-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Присоединение шаблона к странице конструктора форматов](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="5e391-116">Можно добавлять вложенные элементы **Excel\\Range** и **Excel\\Cell** для элемента **Excel\\File**, чтобы указать структуру данных, которые будут введены в создаваемые отчеты во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e391-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="5e391-117">После этого эти элементы необходимо связать с источниками данных редактируемого формата электронной отчетности, чтобы указать фактические данные, которые будут введены в создаваемые отчеты во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e391-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Добавление вложенных элементов на странице конструктора форматов](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="5e391-119">При сохранении изменений в формате электронной отчетности во время разработки иерархическая структура формата хранится в прикрепленном шаблоне Word в виде [пользовательской XML-части](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) с именем **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="5e391-120">Необходимо получить доступ к измененному шаблону, загрузить его из Finance, сохранить локально и открыть в классическом приложении Word.</span><span class="sxs-lookup"><span data-stu-id="5e391-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="5e391-121">На следующем рисунке показан образец шаблона, сохраненного локально для контрольного отчета, который содержит пользовательскую XML-часть **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Предварительный просмотр примера шаблона отчета в классическом приложении Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="5e391-123">Когда привязки элементов формата **Excel\\Range** и **Excel\\Cell** выполняются во время выполнения, данные, обеспечиваемые каждой привязкой, поступают в созданный документ Word как отдельное поле пользовательской XML-части **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="5e391-124">Для ввода значений из полей пользовательской XML-части в созданный документ необходимо добавить соответствующие [элементы управления содержимым](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) Word в ваше шаблон Word, чтобы служить местозаполнителями для данных, которые будут заполнены во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e391-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="5e391-125">Чтобы указать, как заполняются элементы управления содержимым, сопоставьте каждый элемент управления содержимым соответствующему полю пользовательской XML-части **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Добавление и сопоставление элементов управления содержимым в классическом приложении Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="5e391-127">Затем необходимо заменить исходный шаблон Word редактируемого формата электронной отчетности на измененный шаблон, который теперь содержит элементы управления содержимым Word, сопоставленные полям пользовательской XML-части **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Замена шаблона на странице конструктора форматов](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="5e391-129">При выполнении настроенного формата электронной отчетности для создания нового отчета используется прикрепленный шаблон Word.</span><span class="sxs-lookup"><span data-stu-id="5e391-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="5e391-130">Фактические данные хранятся в отчете Word как пользовательская XML-часть с именем **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="5e391-131">При открытии созданного отчета элементы управления содержимым Word заполняются данными из пользовательской XML-части **Отчет**.</span><span class="sxs-lookup"><span data-stu-id="5e391-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="5e391-132">Вопросы и ответы</span><span class="sxs-lookup"><span data-stu-id="5e391-132">Frequently asked questions</span></span>

<span data-ttu-id="5e391-133">**Вопрос:** я настроил формат электронной отчетности для печати документа Word, содержащего адрес компании.</span><span class="sxs-lookup"><span data-stu-id="5e391-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="5e391-134">В шаблоне Word для этого формата электронной отчетности я вставил элемент управления содержимым в формате RTF, чтобы представить адрес компании.</span><span class="sxs-lookup"><span data-stu-id="5e391-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="5e391-135">В Finance я ввел адрес компании в виде многострочного текста и выбрал **Ввод** для добавления возврата каретки для каждой введенной строки.</span><span class="sxs-lookup"><span data-stu-id="5e391-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="5e391-136">Поэтому я ожидал, что адрес компании появится в виде многострочного текста в созданных документах.</span><span class="sxs-lookup"><span data-stu-id="5e391-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="5e391-137">Однако адрес отображается в виде одной строки текста, которая содержит специальные символы вместо возврата каретки.</span><span class="sxs-lookup"><span data-stu-id="5e391-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="5e391-138">Что неправильно с моими настройками?</span><span class="sxs-lookup"><span data-stu-id="5e391-138">What is wrong with my settings?</span></span>

<span data-ttu-id="5e391-139">**Ответ.** Вместо использования элемента управления содержимым в формате RTF необходимо использовать элемент управления содержимым в формате обычного текста и установить флажок **Разрешить возвраты каретки (несколько абзацев)** в свойствах данного элемента управления.</span><span class="sxs-lookup"><span data-stu-id="5e391-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="5e391-140">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="5e391-140">Additional resources</span></span>

- [<span data-ttu-id="5e391-141">Повторное использование конфигураций электронной отчетности с шаблонами Excel для формирования отчетов в формате Word</span><span class="sxs-lookup"><span data-stu-id="5e391-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="5e391-142">Внедрение изображений и фигур в документы, создаваемые с помощью электронной отчетности</span><span class="sxs-lookup"><span data-stu-id="5e391-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]