---
title: Повторное использование конфигураций электронной отчетности с шаблонами Excel для формирования отчетов в формате Word
description: В этой теме описывается, как форматы отчетов, предназначенные для создания отчетов в виде рабочих книг Excel, можно настроить для создания отчетов в виде документов Word.
author: NickSelin
ms.date: 04/23/2021
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner, LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: d152449b55ab111cf5bac363b38d32c3658a56e3
ms.sourcegitcommit: c08a9d19eed1df03f32442ddb65a2adf1473d3b6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2021
ms.locfileid: "6359419"
---
# <a name="reuse-er-configurations-with-excel-templates-to-generate-reports-in-word-format"></a>Повторное использование конфигураций электронной отчетности с шаблонами Excel для формирования отчетов в формате Word

[!include [banner](../../includes/banner.md)]

Для создания отчетов в виде документов Microsoft Word можно [настроить](../er-design-configuration-word.md) новый [формат](../general-electronic-reporting.md#FormatComponentOutbound) [электронной отчетности (ER)](../general-electronic-reporting.md). Кроме того, можно повторно использовать формат электронной отчетности, который изначально был создан для создания отчетов в виде книг Excel. В этом случае шаблон Excel необходимо заменить шаблоном Word.

Следующие процедуры показывают, как пользователь в роли системного администратора или роли разработчика электронной отчетности может настроить формат электронной отчетности для создания отчетов в виде файлов Word путем повторного использования формата электронной отчетности, созданного для формирования отчетов в виде файлов Excel.

Эти процедуры можно выполнить в компании GBSI.

## <a name="prerequisites"></a>Необходимые условия

Для выполнения этих процедур необходимо сначала выполнить шаги из руководства по задаче [Разработка конфигурации для создания отчетов в формате OPENXML](er-design-reports-openxml-2016-11.md).

Необходимо также загрузить и локально сохранить следующие шаблоны для примера отчета:

- [Шаблон отчета платежей (SampleVendPaymDocReport.docx)](https://download.microsoft.com/download/0/d/e/0de5a87c-95fc-4dfa-958f-285cb28b5b2b/SampleVendPaymDocReport.docx)
- [Связанный шаблон отчета о платежах (SampleVendPaymDocReportBounded.docx)](https://download.microsoft.com/download/a/1/2/a126cb43-6281-4f7b-bde0-25e03ff9bc1e/SampleVendPaymDocReportBounded.docx)

Эти процедуры предназначены для функции, которая была добавлена в Dynamics 365 for Operations версии 1611 (ноябрь 2016 года).

## <a name="select-the-existing-er-report-configuration"></a>Выбор существующей конфигурации отчета электронной отчетности

1. В Dynamics 365 Finance перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. Убедитесь, что поставщик конфигураций **Litware, Inc.** выбран как **Активный**. Если это не так, выполните шаги, указанные в разделе [Создание поставщиков конфигураций и пометка их как активных](er-configuration-provider-mark-it-active-2016-11.md).
3. Выберите **Конфигурации отчетности**. Вы будете повторно использовать существующую конфигурацию электронной отчетности, которая была создана для создания выходных данных отчета в формате OPENXML.
4. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель платежа**, затем выберите **Пример отчета о листе**.

    > [!NOTE]
    > Черновую версию выбранного формата электронной отчетности можно редактировать на экспресс-вкладке **Версии**.

5. Выберите **Конструктор**.
6. На странице **Конструктор форматов** обратите внимание, что заголовок корневого элемента формата показывает, что в данный момент используется шаблон Excel.

![Выбор существующей конфигурации.](../media/er-design-configuration-word-2016-11-image01.gif)

## <a name="review-the-downloaded-word-template"></a>Проверка загруженного шаблона Word

1. В классическом приложении Word откройте файл шаблона **SampleVendPaymDocReport.docx**, который был загружен ранее.
2. Проверьте, что шаблон содержит только макет документа, который требуется создать как выходные данные электронной отчетности.

![Макет шаблона Word в классическом приложении.](../media/er-design-configuration-word-2016-11-image02.png)

## <a name="replace-the-excel-template-with-the-word-template-and-add-a-custom-xml-part"></a>Замена шаблона Excel шаблоном Word и добавление пользовательской XML-части

В настоящее время документ Excel используется как шаблон для создания выходных данных в формате OPENXML. Вы замените этот шаблон файлом шаблоном Word SampleVendPaymDocReport.docx, который загрузили ранее. Вы также расширите шаблон Word путем добавления пользовательской XML-части.

1. В Finance на странице **Конструктор форматов** на вкладке **Формат** выберите **Вложения**.
2. На странице **Вложения** выберите **Удалить**, чтобы удалить существующий шаблон Excel. Выберите **Да**, чтобы подтвердить изменение.
3. Выберите **Создать** \> **Файл**.

    > [!NOTE]
    > Необходимо выбрать тип документа, который был [настроен](../electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) в параметрах электронной отчетности для хранения шаблонов форматов электронной отчетности.

4. Выберите **Обзор**, затем найдите и выберите файл **SampleVendPaymDocReport.docx**, загруженный ранее.
5. Нажмите **ОК**.
6. Закройте страницу **Вложения**.
7. На странице **Конструктор форматов** в поле **Шаблон** введите или выберите файл **SampleVendPaymDocReport.docx**, который будет использоваться для шаблона Word вместо шаблона Excel, который использовался ранее.
8. Нажмите **Сохранить**.

    В дополнение к сохранению изменений конфигурации действие **Сохранить** также обновит присоединенный шаблон Word. Иерархическая структура созданного формата добавляется в приложенный документ Word в качестве новой пользовательской XML-части с именем **Отчет**. Присоединенный шаблон Word содержит макет документа, который будет создаваться как выходные данные электронной отчетности, и структуру данных, которую электронная отчетность введет в этот шаблон во время выполнения.

9. Обратите внимание, что заголовок корневого элемента формата показывает, что в данный момент используется шаблон Word.

    ![Замена шаблона Excel шаблоном Word и добавление пользовательской XML-части.](../media/er-design-configuration-word-2016-11-image03.gif)

10. На вкладке **Формат** выберите **Вложения**.

Теперь можно сопоставать элементы пользовательской XML-части **Отчет** с элементами управления содержимым документа Word.

Если вы знакомы с процессом разработки документов Word в виде форм, которые содержат [элементы управления содержимым](/office/client-developer/word/content-controls-in-word), сопоставленные с элементами [пользовательских XML-частей](/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019), выполните все шаги в следующей процедуре для создания документа. Дополнительные сведения см. в разделе [Создание форм, которые пользователи заполняют или печатают в Word](https://support.office.com/article/Create-forms-that-users-complete-or-print-in-Word-040c5cc1-e309-445b-94ac-542f732c8c8b). В противном случае пропустите следующую процедуру.

## <a name="get-a-word-document-that-has-a-custom-xml-part-and-do-data-mapping"></a><a id='get-word-doc'></a>Получение документа Word с пользовательской XML-частью и сопоставление данных

1. В Finance на странице **Вложения** выберите **Открыть**, чтобы загрузить выбранный шаблон из Finance и сохранить его локально как документ Word.
3. В классическом приложении Word откройте только что загруженный документ.
4. На вкладке **Разработчик** выберите **Область сопоставления XML**.

    > [!NOTE]
    > Если вкладка **Разработчик** не отображается на ленте, настройте ленту для ее добавления.

5. В области **Сопоставление XML** в поле **Пользовательская XML-часть** выберите пользовательскую XML-часть **Отчет**.
6. Сопоставьте элементы выбранной пользовательской XML-части **Отчет** с элементами управления содержимым документа Word.
7. Сохраните обновленный документ Word локально как **SampleVendPaymDocReportBounded.docx**.

## <a name="review-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls"></a>Просмотр шаблона Word, где пользовательская XML-часть сопоставлена с элементами управления содержимым

1. В классическом приложении Word откройте файл шаблона **SampleVendPaymDocReportBounded.docx**.
2. Проверьте, что шаблон содержит макет документа, который требуется создать как выходные данные электронной отчетности. Элементы управления содержимым, которые используются в качестве заполнителей для данных, которые будут введены электронной отчетностью в этот шаблон в ходе выполнения, основаны на сопоставлениях, настроенных между элементами пользовательской XML-части **Отчет** и элементами управления содержимым документа Word.

![Предварительный просмотр шаблона Word в классическом приложении.](../media/er-design-configuration-word-2016-11-image04.png)

## <a name="upload-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls"></a>Отправка шаблона Word, где пользовательская XML-часть сопоставлена с элементами управления содержимым

1. В Finance на странице **Вложения** выберите **Удалить**, чтобы удалить шаблон Word, который не содержит сопоставлений между элементами пользовательской XML-части **Отчет** и элементами управления содержимым. Выберите **Да**, чтобы подтвердить изменение.
2. Выберите **Создать** \> **Файл**, чтобы добавить новый файл шаблона, содержащий сопоставления между элементами пользовательской XML-части **Отчет** и элементами управления содержимым.

    > [!NOTE]
    > Необходимо выбрать тип документа, который был [настроен](../electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) в параметрах электронной отчетности для хранения шаблонов форматов электронной отчетности.

3. Выберите **Обзор**, затем найдите и выберите файл **SampleVendPaymDocReportBounded.docx**, который вы загрузили или подготовили, выполнив процедуру, описанную в разделе [Получение документа Word с пользовательской XML-частью и сопоставление данных](#get-word-doc).
4. Нажмите **ОК**.
5. Закройте страницу **Вложения**.
6. На странице **Конструктор форматов** в поле **Шаблон** выберите только что загруженный документ.
7. Нажмите **Сохранить**.
8. Закройте страницу **Конструктор форматов**.

## <a name="mark-the-configured-format-as-runnable"></a>Отметка настроенного формата как готового к запуску

Чтобы выполнить черновую версию редактируемого формата, необходимо сделать ее [пригодной к запуску](../er-quick-start2-customize-report.md#MarkFormatRunnable).

1. В Finance на странице **Конфигурации** в области действий на вкладке **Конфигурации** в группе **Дополнительные параметры** выберите **Параметры пользователя**.
2. В диалоговом окне **Параметры пользователя** установите для параметра **Параметры выполнения** значение **Да**, затем выберите **ОК**.
3. При необходимости выберите **Правка**, чтобы сделать текущую страницу редактируемой.
4. Для текущей выбранной конфигурации **Пример отчета о листе**, установите для параметра **Выполнить черновик** значение **Да**.
5. Нажмите **Сохранить**.

## <a name="run-the-format-to-create-output-in-word-format"></a>Выполнение формата для создания выходных данных в формате Word

1. В Finance перейдите в раздел **Расчеты с поставщиками** \> **Платежи** \> **Журнал платежей**.
2. В журнале платежей, который был введен ранее, выберите **Строки**.
3. На странице **Платежи поставщикам** выберите все строки в сетке.
4. Выберите **Статус платежа** \> **Нет**.

    ![Платежи для обработки на странице платежей поставщикам.](../media/er-design-configuration-word-2016-11-image05.png)

5. На панели операций выберите **Создать платежи**.
6. В появившемся диалоговом окне выполните следующие действия:

    1. В поле **Способ оплаты** выберите **Электронный**.
    2. В поле **Банковский счет** выберите **GBSI OPER**.
    3. Нажмите **ОК**.

7. В диалоговом окне **Параметры электронной отчетности** выберите **ОК**.
8. Созданные выходные данные представлены в формате Word и содержат сведения об обработанных платежах. Проанализируйте созданные выходные данные.

    ![Созданные выходные данные в формате Word.](../media/er-design-configuration-word-2016-11-image06.png)

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Разработка конфигураций электронной отчетности для создания отчетов в формате Word](../er-design-configuration-word.md)
- [Внедрение изображений и фигур в документы, создаваемые с помощью электронной отчетности](../electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]
