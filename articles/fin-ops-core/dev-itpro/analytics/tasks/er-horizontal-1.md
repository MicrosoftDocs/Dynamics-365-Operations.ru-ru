---
title: Электронная отчетность — Использование горизонтально разворачивающихся диапазонов для динамического добавления столбцов в отчеты Excel (Часть 1. Разработка формата)
description: В этой теме описывается, как настроить формат электронной отчетности (ER) для создания отчетов в виде файлов электронных таблиц OPENXML (Excel). (Часть 1)
author: NickSelin
manager: AnnBe
ms.date: 08/29/2018
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, ERSolutionCreateDropDialog, EROperationDesigner, ERComponentTypeDropDialog
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: a5119255b119a99f3809d2d75bbfdc7b3bad9932
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5569565"
---
# <a name="er-use-horizontally-expandable-ranges-to-dynamically-add-columns-in-excel-reports-part-1---design-format"></a>Электронная отчетность — Использование горизонтально разворачивающихся диапазонов для динамического добавления столбцов в отчеты Excel (Часть 1. Разработка формата)

[!include [banner](../../includes/banner.md)]

Следующие шаги описывают, как пользователь, которому назначена роль системного администратора или разработчика электронной отчетности, может настроить формат электронной отчетности (ER) для создания отчетов в виде файлов листов OPENXML (Excel), в которых необходимые столбцы можно создавать динамически как горизонтально расширяемые диапазоны. Эти шаги можно выполнить в любой компании.

Для выполнения этих действий необходимо сначала выполнить следующие три проводника по задачам: 

"Электронная отчетность — Создание поставщика конфигурации и пометка его как активного"

"Электронная отчетность — Использование финансовых аналитик как источника данных (Часть 1. Модель проектных данных)"

"Электронная отчетность — Использование финансовых аналитик как источника данных (Часть 2. Сопоставление модели)"

Необходимо также загрузить и сохранить локальную копию шаблона с примером отчета, который находится здесь: [Sample Financial Dimensions Web Service Report](https://go.microsoft.com/fwlink/?linkid=862266).

Эта процедура для функции, которая была добавлена в версии 1611 Dynamics 365 for Operations.


## <a name="create-a-new-report-configuration"></a>Создание новой конфигурации отчета
1. Перейдите в раздел "Управление организацией" > "Электронная отчетность" > "Конфигурации".
2. В дереве выберите "Пример модели финансовых аналитик".
3. Щелкните "Создать конфигурацию", чтобы открыть ниспадающее диалоговое окно.
4. В поле "Создать" введите "Формат, основанный на модели данных примера модели финансовых аналитик".
    * Используйте модель, заранее созданную как источник данных для нового отчета.  
5. В поле "Имя" введите "Пример отчета с горизонтально расширяемыми диапазонами".
    * Пример отчета с горизонтально расширяемыми диапазонами  
6. В поле "Описание" введите "Создание выходных данных Excel с динамическим добавлением столбцов".
    * Создание выходных данных Excel с динамическим добавлением столбцов  
7. В поле "Определение модели данных" выберите "Запись".
8. Нажмите Создать конфигурацию.

## <a name="design-the-report-format"></a>Разработка формата отчета
1. Выберите Конструктор.
2. Включите кнопку-переключатель "Показать сведения".
3. В области действий щелкните "Импорт".
4. Щелкните "Импорт из Excel".
5. Нажмите кнопку Вложения.
    * Импортируйте шаблон отчета. Используйте файла Excel, загруженный для этого.  
6. Нажмите Создать.
7. Щелкните "Файл".
8. Закройте страницу.
9. В поле "Шаблон" введите или выберите значение.
    * Выберите загруженный шаблон.  
10. Нажмите кнопку "OК".
    * Добавьте новый диапазон для динамического создания выходных данных Excel с тем количеством столбцов, которое вы выбрали (в форме пользовательского диалогового окна) для финансовых аналитик. Каждая ячейка для каждого столбца представляет имя одной финансовой аналитики.  
11. Щелкните "Добавить", чтобы открыть раскрывающееся диалоговое окно.
12. В дереве выберите "Excel\Диапазон".
13. В поле "Диапазон Excel" введите "DimNames".
    * DimNames  
14. В поле "Направление репликации" выберите "Горизонтальная".
15. Нажмите кнопку OK.
16. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<DimNames>: Горизонтальная".
17. Щелкните "Переместить вверх".
18. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Ячейка<DimNames>".
19. Щелкните "Вырезать".
20. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<DimNames>: Горизонтальная".
21. Щелкните "Вставить".
22. В дереве разверните узел "Excel = "SampleFinDimWsReport"\Диапазон<DimNames>: Горизонтальная".
23. В дереве разверните узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная".
24. В дереве разверните узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>Вертикальная\Диапазон<TransactionLine>: Вертикальная".
25. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>Вертикальная\Диапазон<TransactionLine>: Вертикальная".
    * Добавьте новый диапазон для динамического создания выходных данных Excel с тем количеством столбцов, которое вы выбрали (в форме пользовательского диалогового окна) для финансовых аналитик. Каждая ячейка для каждого столбца представляет значение одной финансовой аналитики для каждой проводки в отчете.  
26. Щелкните "Добавить диапазон".
27. В поле "Диапазон Excel" введите "DimValues".
    * DimValues  
28. В поле "Направление репликации" выберите "Горизонтальная".
29. Нажмите кнопку OK.
30. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<DimValues>".
31. Щелкните "Вырезать".
32. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Диапазон<DimValues>: Горизонтальная".
33. Щелкните "Вставить".
34. В дереве разверните узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Диапазон<DimValues>: Горизонтальная".

## <a name="map-format-elements-to-data-sources"></a>Сопоставление элементов формата с источниками данных
1. Перейдите на вкладку "Сопоставление".
2. В дереве разверните узел "модель: модель данных примера модели финансовых аналитик".
3. В дереве разверните узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей".
4. В дереве разверните узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей".
5. В дереве разверните узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Данные аналитик: список записей".
6. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Диапазон<DimValues>: Горизонтальная\Ячейка<DimValues>".
7. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Данные аналитик: список записей\Код: строка".
8. Щелкните "Связать".
9. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Диапазон<DimValues>: Горизонтальная".
10. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Данные аналитик: список записей".
11. Щелкните "Связать".
12. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<Credit>".
13. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Кредит: вещественное число".
14. Щелкните "Связать".
15. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<Debit>".
16. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Дебет: вещественное число".
17. Щелкните "Связать".
18. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<Currency>".
19. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Валюта: строка".
20. Щелкните "Связать".
21. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<TransDate>".
22. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Дата: дата".
23. Щелкните "Связать".
24. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<TransVoucher>".
25. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей\Ваучер: строка".
26. Щелкните "Связать".
27. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная\Диапазон<TransactionLine>: Вертикальная\Ячейка<TransBatch>".
28. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Партия: строка".
29. Щелкните "Связать".
30. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>Вертикальная\Диапазон<TransactionLine>: Вертикальная".
31. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Проводка: список записей".
32. Щелкните "Связать".
33. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальнаяl\Ячейка<Batch>".
34. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей\Партия: строка".
35. Щелкните "Связать".
36. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<JournalLine>: Вертикальная".
37. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Журнал: список записей".
38. Щелкните "Связать".
39. В дереве разверните узел "модель: модель данных примера модели финансовых аналитик\Настройка аналитик: список записей".
40. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Настройка аналитик: список записей\Код: строка".
41. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<DimNames>: Горизонтальная\Ячейка<DimNames>".
42. Щелкните "Связать".
43. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Настройка аналитик: список записей".
44. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Диапазон<DimNames>: Горизонтальная".
45. Щелкните "Связать".
46. В дереве выберите узел "Excel = "SampleFinDimWsReport"\Ячейка<CompanyName>".
47. В дереве выберите узел "модель: модель данных примера модели финансовых аналитик\Компания: строка".
48. Щелкните "Связать".
49. Нажмите кнопку "Сохранить".
50. Закройте страницу.



[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]