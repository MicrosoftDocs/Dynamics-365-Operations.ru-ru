---
title: Электронная отчетность — Разработка конфигурации для создания отчетов в формате OPENXML (ноябрь 2016 г.)
description: В этой теме описывается, как создать новую конфигурацию электронной отчетности, которая содержит шаблон для создания электронных документов в формате OPENXML.
author: NickSelin
manager: AnnBe
ms.date: 08/12/2019
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERVendorPart, ERSolutionRepositoryTable, ERSolutionRepositoryCreateDropDialog, ERSolutionImport,  ERSolutionTable, ERSolutionCreateDropDialog, EROperationDesigner, ERDataSourceAddDropDialog, ERModelGroupByFunctionEditor, VendPaymMode, LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 3fac102f760de9c3e99bd69863570e6503620567
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5567795"
---
# <a name="er-design-a-configuration-for-generating-reports-in-openxml-format-november-2016"></a>Электронная отчетность — Разработка конфигурации для создания отчетов в формате OPENXML (ноябрь 2016 г.)

[!include [banner](../../includes/banner.md)]

В это теме поясняется, как пользователь с ролью "Системный администратор" или "Разработчик электронной отчетности" может создать новую конфигурацию электронной отчетности, содержащую шаблон для создания электронных документов в формате OPENXML. Эта конфигурация будет использоваться для обработки платежей поставщикам.

В этом примере вам предстоит создать поставщика конфигурации для примера компании Litware, Inc. Эти шаги можно выполнить в компании GBSI.

Для выполнения этих шагов необходимо сначала выполнить шаги в процедуре "Создание поставщика конфигурации и установка его в качестве активного". Также необходимо иметь файл Excel, который будет импортирован при создании шаблона. Этот файл можно взять из [Template of Payment Report](https://go.microsoft.com/fwlink/?linkid=862266).


## <a name="upload-the-payments-data-model-configuration"></a>Отправка конфигурации модели данных платежей
1. В области переходов выберите **Модули > Администрирование организации > Рабочие области > Электронная отчетность**.
2. В списке отметьте поставщика конфигурации для демонстрационной компании Litware, Inc. Если вы не видите этого поставщика конфигурации, необходимо сначала выполнить шаги в процедуре [Создание поставщиков конфигурации и пометка их как активных](er-configuration-provider-mark-it-active-2016-11.md).
3. Выберите **Установить активные**.
4. Выберите **Репозитории**. Выберите репозиторий для типа "Операционные ресурсы", если он имеется. Если он доступен, пропустите следующие шаги по созданию нового репозитория.  
5. Выберите **Добавить**, чтобы открыть раскрывающееся диалоговое окно.
6. В поле **Тип репозитория конфигурации** введите `Operations resourcesdd`.
7. Выберите **Создать репозиторий**.
8. Нажмите **ОК**.
9. Выберите **Открыть**.
10. В дереве выберите **Модель платежа**.
11. Выберите **Импорт**. Импортируйте эту модель данных. Она будет использоваться в качестве источника данных в новой конфигурации формата. Пропустите этот шаг, если эта конфигурация уже была импортирована.  
12. Выберите **Да**.
13. Закройте страницы, пока не вернетесь на страницу "Электронная отчетность".

## <a name="create-a-new-format-configuration"></a>Создание новой конфигурации формата
1. Выберите **Конфигурации отчетности**.
2. В дереве выберите **Модель платежа**.
3. Выберите **Создать конфигурацию**, чтобы открыть ниспадающее диалоговое окно.
4. В поле **Создать** введите `Format based on data model PaymentModel`'. Создайте формат, основанный на модели данных PaymentModel.
5. В поле **Имя** введите `Sample worksheet report`. Пример отчета о листе  
6. В поле **Описание** введите `Sample worksheet report for vendors' payments`. Пример отчета о листе для платежей поставщиков.  
7. В поле **Определение модели данных** введите или выберите значение. Выберите определение **CustomerCreditTransferInitiation**.  
8. Выберите **Создать конфигурацию**.

## <a name="design-a-new-document-in-openxml-worksheet-format"></a>Разработка нового документа в формате листа OPENXML
1. В дереве выберите **Модель платежа\Пример отчета о листе**.
2. Выберите **Конструктор**.
3. На панели операций выберите **Импорт**.
4. Выберите **Импорт из Excel**.
5. Выберите **Вложения**. Вложите существующий документ Excel как шаблон.  
6. Выберите **Создать**.
7. Выберите **Файл**. Укажите на существующий файл Excel.  
8. Закройте страницу.
9. В поле **Шаблон** введите или выберите значение. Выберите вложенный файл Excel для использования в качестве шаблона.  
10. Нажмите **ОК**. Обратите внимание, что компоненты формата электронной отчетности были созданы в формате создания, основанном на структуре ссылочного документа MS Excel (с именем "диапазоны").  

## <a name="create-a-new-data-source-to-calculate-totals-by-currency-codes"></a>Создание нового источника данных для расчета итогов по кодам валюты
1. Выберите вкладку **Соответствие**.
2. Выберите **Добавить корень**, чтобы открыть раскрывающееся диалоговое окно.
3. В дереве выберите **Функции\Группировка по**.
4. В поле **Имя** введите `PaymentByCurrency`.
5. Выберите **Изменить группу по**.
6. В дереве разверните **модель**, затем выберите **модель\Платежи**.
7. Выберите **Добавить поле в**.
8. Выберите **Элементы для группировки**.
9. В дереве разверните **модель\Платежи**, затем выберите **модель\Платежи\Валюта**.
10. Выберите **Добавить поле в**.
11. Выберите **Сгруппированные поля**.
12. В дереве выберите **модель\Платежи\Начальная сумма платежного поручения(InstructedAmount)**.
13. Выберите **Добавить поле в**, затем выберите **Поля агрегирования**.
14. В поле **Метод** выберите вариант. Выберите функцию **Агрегирование SUM**.  
15. В поле **Имя** введите `TotalInstructuredAmount`.
16. Нажмите **Сохранить**.
17. Закройте страницу.
18. Нажмите **ОК**.

## <a name="map-format-components-to-data-sources"></a>Сопоставление компонентов формата с источниками данных
1. В дереве выберите **модель\Платежи\Инициирующий субъект(InitiatingParty)\Имя** и **Excel\ReportHeader\CompanyName**.
2. Выберите **Связать**.
3. В дереве выберите **модель\Платежи\Кредитор\Идентификация\Код источника(SourceID)** и **Excel\PaymLines\VendAccountName**.
4. Выберите **Связать**.
5. В дереве выберите **модель\Платежи\Кредитор\Имя** и **Excel\PaymLines\VendName**.
6. Выберите **Связать**.
7. В дереве выберите **модель\Платежи\Агент кредитора(CreditorAgent)\Имя** и **Excel\PaymLines\Bank**.
8. Выберите **Связать**.
9. В дереве выберите **модель\Платежи\Агент кредитора(CreditorAgent)\Код банка(RoutingNumber)** и **Excel\PaymLines\Bank**.
10. Выберите **Связать**.
11. В дереве выберите **модель\Платежи\Счет кредитора(CreditorAccount)\Идентификация\Номер** и **Excel\PaymLines\AccountNumber**.
12. Выберите **Связать**.
13. В дереве выберите **модель\Платежи\Начальная сумма платежного поручения(InstructedAmount)** и **Excel\PaymLines\Debit**.
14. Выберите **Связать**.
15. В дереве выберите **модель\Платежи\Валюта** и **Excel\PaymLines\Currency**.
16. Выберите **Связать**.
17. В дереве выберите **PaymentByCurrency\grouped\Currency** и **Excel\SummaryLines\SummaryCurrency**.
18. Выберите **Связать**.
19. В дереве выберите **PaymentByCurrency\aggregated\TotalInstructuredAmount** и **Excel\SummaryLines\SummaryAmount**.
20. Выберите **Связать**.
21. В дереве выберите **PaymentByCurrency** и **Excel\SummaryLines**.
22. Выберите **Связать**.
23. В дереве выберите **модель\Платежи** и **Excel\PaymLines**.
24. Выберите **Связать**.
25. Выберите **Сохранить**, затем закройте страницу.

## <a name="use-the-created-configuration-for-payments-processing"></a>Использование созданной конфигурации для обработки платежей
1. Выберите **Изменить статус**.
2. Выберите **Завершено**.
3. Нажмите **ОК**.
4. В области переходов выберите **Модули > Расчеты с поставщиками > Настройка платежей > Способы оплаты**.
5. Используйте экспресс-фильтр для фильтрации поля **Способ оплаты** со значением **'Электронно**.
6. Выберите **Правка**.
7. Разверните раздел **Форматы файлов**.
8. В поле **Общая электронная отчетность** выберите значение **Да**.
9. В поле **Экспорт конфигурации формата** введите или выберите значение. Выберите конфигурацию **Пример отчета о листе**.  
10. Нажмите **Сохранить**.
11. Закройте страницу.

## <a name="use-the-created-configuration-for-testing-of-payment-journals-processing"></a>Использование созданной конфигурации для тестирования обработки журналов платежей
1. В области переходов выберите **Модули > Расчеты с поставщиками > Платежи > Журнал платежей**.
2. Выберите **Создать** для создания нового журнала платежей.
3. В поле **Имя** введите **VendPay**.
4. Выберите **Строки**.
5. В поле **Счет** укажите значения `GB_SI_000001`.
6. Установите для параметра **Дебет** значение `1000`.
7. Выберите **Создать**.
8. В поле **Счет** укажите значения `GB_SI_000005`.
9. Установите для параметра **Дебет** значение `2000`.
10. В поле **Валюта** введите значение `EUR`.
11. В поле **Корр.счет** укажите значения `GBSI OPER`.
12. В поле **Способ оплаты** введите `Electronic`.
13. Нажмите **Сохранить**.
14. Выберите **Создать платежи**.
15. В поле **Способ оплаты** введите `Electronic`.
16. В поле **Имя файла** введите `Payments`.
17. В поле **Банковский счет** введите `GBSI OPER`.
18. Выберите **ОК**, затем снова выберите **ОК**. Просмотрите созданный лист, включая сведения строк платежа, а так же итоги для каждого кода валюты, используемого в этом сообщении платежа.  



[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]