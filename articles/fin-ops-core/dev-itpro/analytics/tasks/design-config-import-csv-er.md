---
title: Разработка конфигураций электронной отчетности для импорта данных из внешних файлов в формате CSV
description: Используйте эту процедуру для разработка конфигураций электронной отчетности для импорта данных в приложение Finance and Operations из внешнего файла в формате CSV.
author: NickSelin
ms.date: 12/12/2017
ms.topic: business-process
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: b42f0cf8c7260c85d405a5dfdcd50323ffee4d4528b982997a802b859ab8327b
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "6747279"
---
# <a name="design-er-configurations-to-import-data-from-external-csv-files"></a>Разработка конфигураций электронной отчетности для импорта данных из внешних файлов в формате CSV

[!include [banner](../../includes/banner.md)]

Используйте эту процедуру для разработка конфигураций электронной отчетности (ER) для импорта данных в приложение из внешнего файла в формате CSV. В этой процедуре вам предстоит создать необходимые конфигурации ER для примера компании Litware, Inc. Чтобы выполнить следующие шаги, вам необходимо выполнить шаги в процедуре "Электронная отчетность — Создание поставщика конфигурации и пометка его как активного".

Эта процедура предназначена для пользователей, которым назначена роль "Системный администратор" или "Разработчик электронной отчетности". Эти шеги можно выполнить с использованием набора данных USMF.

Необходимо также загрузить и сохранить локально следующие файлы: [Примеры электронной отчетности Dynamics 365 Finance](https://go.microsoft.com/fwlink/?linkid=862266): 1099model.xml, 1099formatcsv.xml, 1099entriescsv.csv.

1. Перейдите в раздел "Управление организацией" > "Рабочие области" > "Электронная отчетность".
    * Можно настроить процесс для импорта внешних файлов в формате XML, TXT или CSV в таблицы в приложении. Во-первых, необходимо создать абстрактную модель данных для представления импортированных данных с точки зрения бизнеса — для этого создается конфигурация модели данных ER. Затем определите структуру импортированного файла, которая сопоставляет разработанную модель данных как способ портирования данных из файла в абстрактную модель данных — для этого создается конфигурации формата ER. После этого необходимо расширить конфигурацию модели данных ER, добавив новое сопоставление модели, которое описывает, как данные из импортированного файла и постоянные данные из абстрактной модели данных используются для обновления таблиц приложения или информационных объектов.
    * В следующих шагах описывается, как импортировать проводки поставщиков, которые отслеживаются извне, из внешнего CSV-файла для последующего использования в сопоставлении поставщика по форме 1099.
    * Убедитесь, что поставщик конфигурации для примера компании Litware, Inc. доступен и помечен как активный. Если вы не видите этого поставщика конфигурации, необходимо сначала выполнить шаги в процедуре "Электронная отчетность — создание поставщика конфигурации и пометка его как активного".
2. Щелкните "Конфигурации отчетности".
3. Примените фильтр "Модель платежей по форме 1099". Если вы уже закончили процедуру "Электронная отчетность — Создание необходимых конфигураций для импорта данных из внешнего файла для электронной отчетности" и конфигурация "Модель платежей по форме 1099" доступна в дереве конфигурации, пропустите все шаги, приведенные в следующей подзадаче.

## <a name="add-a-new-er-model-configuration"></a>Добавление новой конфигурации модели ER

1. Вместо того чтобы создавать новую модель для поддержки импорта данных, загрузите файл 1099model.xml, загруженный ранее. Этот файл содержит модель пользовательских данных проводок по поставщику. Эта модель данных уже сопоставлена с необходимыми компонентами данных.
2. Щелкните "Обменять".
3. Щелкните "Загрузить из XML-файла".
4. Нажмите кнопку "Обзор" и перейдите к ранее загруженному файлу 1099model.xml.
5. Нажмите кнопку "OК".

## <a name="add-a-new-er-format-configuration-that-supports-data-import"></a>Добавление новой конфигурации формата ER, поддерживающей импорт данных

1. В дереве выберите "Модель платежей по форме 1099".
2. Щелкните "Создать конфигурацию", чтобы открыть ниспадающее диалоговое окно.
3. В поле "Создать" введите «Формат, основанный на модели данных "Модель платежей по форме 1099"».
4. Выберите "Да" в поле "Поддерживает импорт данных".
5. Нажмите клавишу ESC, чтобы закрыть эту страницу.
    * Вместо того чтобы создавать новый формат ER для поддержки импорта данных, загрузите файл 1099formatcsv.xml, загруженный ранее. Этот файл содержит требуемый формат ER, который определяет структуру входящего CSV-файла и соответствие этой структуры модели данных проводок поставщиков.
6. Щелкните "Обменять".
7. Щелкните "Загрузить из XML-файла".
    * Нажмите кнопку "Обзор" и перейдите к ранее загруженному файлу 1099formatcsv.xml.
8. Нажмите кнопку "OК".
9. В дереве разверните узел "Модель платежей по форме 1099".
10. В дереве выберите "Модель платежей по форме 1099\Для импорта проводок поставщиков (CSV)".

## <a name="review-format-settings"></a>Проверка параметров формата

1. Выберите Конструктор.
2. Щелкните "Развернуть/свернуть".
3. Установите переключатель "Показать сведения" в положение "Вкл.".
    * Созданный формат представляет ожидаемую структуру внешнего файла в формате CSV.
4. В дереве выберите "Входящие: файл\Корень: последовательность".
    * Для элемента "Корень" типа SEQUENCE в поле "Специальные символы" выбран параметр "Создать строку — Windows (CR LF)". На основании этого параметра каждая строка в файле анализа должна рассматриваться как отдельная запись.
5. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..*`.
    * Для элемента "Корень\Строка" типа SEQUENCE в поле "Кратность" выбран параметр "Один — много". На основании этого параметра по крайней мере одна строка будет представлена в файле анализа.
6. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case`.
    * Обратите внимание, что элемент "Корень\Строка\Типы" типа CASE был добавлен в качестве вложенного элемента последовательности "Корень\Строка". Поскольку этот элемент CASE содержит 3 вложенных элемента последовательности, этот параметр предполагает, что ожидается 3 различных типа строки в файле анализа.
7. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Header: Sequence 1..1`.
    * Элемент "Корень\Строка\Типы\Заголовок" типа SEQUENCE содержит вложенный элемент STRING, значение которого определено как фиксированное строковое значение. Эта последовательность будет анализировать строку заголовка файла анализа.
8. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Record: Sequence 1..1 (,)`.
    * Элемент "Корень\Строка\Типы\Запись" типа SEQUENCE настроен для анализа строк проводки. Обратите внимание, что для параметра символа "Пользовательский разделитель" задана запятая. Это означает, что запятая будет использоваться в качестве разделителя полей для этого типа строки в файле анализа.
    * Обратите внимание, что несколько вложенных элементов различных типов данных были добавлены к элементу "Корень\Строка\Типы\Запись" для анализа строк проводки как разделенных полей. Обратите внимание, что для параметра "Заявление на предложение" задано значение "Нет". Это означает, что в файле анализа все поля этого типа будут учитываться как не имеющие вложенных символов.
9. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Record: Sequence 1..1 (,)\TransactionDate: DateTime`.
    * Например, элемент "Корень\Строка\Типы\Запись\Дата проводки" типа DATETIME настроен для получения значения даты и времени проводки из файла анализа в формате "ММ/дд/гггг".
10. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Record: Sequence 1..1 (,)\CountryCode: String 0..1`.
    * Обратите внимание, что для элемента "Корень\Строка\Типы\Запись\Код страны" типа STRING в поле "Кратность" задано значение "Ноль — один". Этот параметр рассматривает значение поля "Код страны" в строке анализа как необязательное.
11. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Record: Sequence 1..1 (,)\Remark: Sequence 1..1 (,)`.
    * Обратите внимание, что для параметра "Корень\Строка\Типы\Запись\Примечание" типа SEQUENCE в поле "Заявление на предложение" задано значение "Все" и в поле "Кавычка" используется символ двойных кавычек. Это означает, что все поля этого типа строк в файле анализа (описываемые вложенными элементами: текст типа STRING) будут рассматриваться как заключенные в символы двойных кавычек.
12. В дереве выберите узел `Incoming: File\Root: Sequence\Line: Sequence 1..* \Types: Case\Unparsed: Sequence 1..1`.
    * Элемент "Корень\Строка\Типы\Не проанализировано" типа SEQUENCE настроен для анализа строк проводки для структуры, которая не соответствует структуре, описанной выше в родительском элементе CASE.

## <a name="review-the-setting-of-the-format-mapping-to-the-data-model"></a>Проверка параметра сопоставления формата с моделью данных

1. Щелкните "Сопоставить формат модели".
    * Сопоставление модели "Сопоставление с моделью из формата CSV" описывает поток данных в передаче данных из входящего CSV-файла в модель данных.
2. Выберите Конструктор.
3. В дереве разверните "формат".
    * Обратите внимание, что созданный формат представляется как компонент источника данных.
4. В дереве разверните "формат\Входящие: Файл(входящий)".
5. В дереве разверните "формат\Входящие: Файл(входящий)\Корень: Последовательность(корень)".
6. В дереве разверните узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)`.
7. В дереве разверните узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)\Types: Case(Types)`.
8. В дереве разверните узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)\Types: Case(Types)\Record: Sequence 1..1 (,)(Record)`.
9. В дереве разверните узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)\Types: Case(Types)\Record: Sequence 1..1 (,)(Record)\Data`.
10. В дереве разверните узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)\Types: Case(Types)\Record: Sequence 1..1 (,)(Record)\Data\CountryCode: String 0..1 (CountryCode)`.
11. В дереве выберите узел `format\Incoming: File(Incoming)\Root: Sequence(Root)\Line: Sequence 1..* (Line)\Types: Case(Types)\Record: Sequence 1..1 (,)(Record)\Data\TransactionDate: DateTime(TransactionDate)`.
    * Обратите внимание, что обязательные и необязательные элементы формата, например "Дата проводки" и "Код страны", выглядят по-другому в предопределенном компоненте источника данных "формат".
12. В дереве разверните "Проводки = $both".
    * Обратите внимание, что элементы формата, который определяет структуру импортированного файла, привязаны к элементам модели данных. На основании этих привязок содержимое импортированного CSV-файла будет храниться во время выполнения в существующей модели данных. Обратите внимание на привязку элемента "Страна/регион". Для любого элемента проводки во входящем файле, для которого не указано значение кода страны, в модели данных будет заполнен код страны по умолчанию "США".
13. Установите переключатель "Показать сведения" в положение "Вкл.".
14. Перейдите на вкладку "Проверки".
15. Щелкните "Поиск".
16. В поле "Поиск" введите "поставщик".
17. Нажмите кнопку "Найти далее".
    * Это сопоставление формата может содержать пользовательскую логику для проверки точности импортируемых данных с точки зрения бизнеса. Например, на основе параметра для любой строки импортируемого файла, структура которого не соответствует ни структуре строки заголовка, ни строке проводки, создается предупреждающее сообщение в информационном журнале, сообщающее пользователю об этом и указывающее порядковый номер проводки в файле.
18. Закройте страницу.

## <a name="run-the-format-mapping"></a>Выполнение сопоставления формата

В целях тестирования выполните сопоставление формата с помощью ранее загруженного файла 1099entriescsv.csv. Созданные выходные данные будут представлять данные, импортируемые из выбранного CSV-файла и заполняющие модель пользовательских данных в реальном импорте.

1. Щелкните "Выполнить".
    * Нажмите кнопку "Обзор" и перейдите к ранее загруженному файлу 1099entriescsv.csv.
2. Нажмите кнопку "OК".
    * Обратите внимание на предупреждающие сообщения о строках, которые не приняты. Строка 4 содержит значение дохода, представленное в недопустимом формате, в то время как строка 7 не содержит текст примечания проводки в двойных кавычках.
    * Просмотрите выходные данные в формате XML, представляющем данные, которые были импортированы из выбранного файла, а затем перенесены в модель данных. Обратите внимание, что были обработаны все 7 строк импортированного CSV-файла. Заголовки содержащих полей в строке 1 пропущены, 4 проводки проанализированы верно, а 2 проводки распознаны как недопустимые.
3. Закройте страницу.
4. Закройте страницу.


[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]