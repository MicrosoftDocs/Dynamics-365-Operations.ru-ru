---
title: Настройка конфигураций электронной отчетности для создания электронного документа
description: В этой теме объясняется, как настроить конфигурации поставляемой корпорацией Майкрософт электронной отчетности (ER), которые используются для создания пользовательского электронного документа.
author: NickSelin
manager: AnnBe
ms.date: 10/21/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, ERParameters, ERDataModelDesigner, ERModelMappingTable, ERModelMappingDesigner, EROperationDesigner, ERVendorTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 2a0cc308e2e3c7f42295a6170c4f709a835c5c84
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "5566134"
---
# <a name="customize-electronic-reporting-configurations-to-generate-an-electronic-document"></a>Настройка конфигураций электронной отчетности для создания электронного документа

[!include[banner](../includes/banner.md)]

[Платформа электронной отчетности (ER)](general-electronic-reporting.md) позволяет отправить [конфигурации](general-electronic-reporting.md#Configuration) электронной отчетности, которые корпорация Майкрософт предоставляет в экземпляре Microsoft Dynamics 365 Finance. Таким образом, предоставляемые корпорацией Майкрософт конфигурации могут использоваться в качестве решения электронной отчетности, используемого для создания электронных накладных клиентов (электронные счета). Можно использовать это решение электронной отчетности для настройки пользовательского решения электронной отчетности для получения доступа к пользовательским полям базы данных и создания электронных накладных, соответствующих вашим специальным требованиям, без необходимости редактирования исходного кода.

## <a name="overview"></a>Обзор

В примере данного раздела необходимо указать код плательщика федерального налога в качестве нового настраиваемого атрибута для каждого клиента, для которого выставлена электронная накладная. Поэтому необходимо настроить структуру накладной, которая в настоящее время используется, путем добавления нового пункта, который должен быть заполнен налоговым кодом в каждой создаваемой электронной накладной.

Процедуры данного раздела объясняют, как пользователь с ролью системного администратора, разработчика электронной отчетности или функционального консультанта по электронной отчетности может выполнять следующие задачи с экземпляре Finance:

- [Настройка минимального набора параметров электронной отчетности, необходимых для начала использования платформы электронной отчетности](#ConfigureER).
- [Импорт исходных версий стандартных конфигураций электронной отчетности, которые предоставляются для создания электронных накладных](#ImportERConfigurations1).
- [Настройка параметров модуля расчетов с клиентами, чтобы начать использовать стандартные конфигурации электронной отчетности](#ConfigureAR1).
- [Настройка параметров юридического лица для выставления счетов клиентам](#ConfigureLE).
- [Подготовка записи клиента для выставления электронных накладных](#ConfigureCustomer1).
- [Добавление, разноска и отправка накладной клиента с использованием стандартных конфигураций электронной отчетности](#ProcessInvoice1).
- [Добавление настраиваемого поля базы данных для управления кодом плательщика федерального налога для клиентов](#AddCustomField).
- [Обновление метаданных электронной отчетности для включения изменений базы данных для конструктора сопоставления моделей электронной отчетности](#RefreshERMetadata).
- [Создание настраиваемых конфигураций электронной отчетности, чтобы создать электронные накладные, содержащие новый налоговый код](#DesignCustomERConfigurations).
- [Настройка параметров модуля расчетов с клиентами, чтобы начать использовать пользовательские конфигурации электронной отчетности](#ConfigureAR2).
- [Обновление записи клиента для выставления электронных накладных](#ConfigureCustomer2).
- [Добавление, разноска и отправка накладной клиента с использованием пользовательских конфигураций электронной отчетности](#ProcessInvoice2).
- [Импорт новых версий стандартных конфигураций электронной отчетности, которые предоставляются для создания электронных накладных](#ImportERConfigurations2).
- [Адаптация изменений в новых версиях стандартных конфигураций электронной отчетности в ваших пользовательских конфигурациях электронной отчетности](#RebaseCustomERConfigurations).
- [Добавление, разноска и отправка накладной клиента с использованием новых версий пользовательских конфигураций электронной отчетности](#ProcessInvoice3).

Все эти процедуры можно выполнить в компании **DEMF**.

## <a name="configure-the-er-framework"></a><a name="ConfigureER"></a>Настройка платформы электронной отчетности

В качестве пользователя в роли функционального консультанта по электронной отчетности или разработчика электронной отчетности, вы должны настроить минимальный набор параметров электронной отчетности. Затем можно начать использовать платформу электронной отчетности для разработки пользовательских версий стандартных конфигураций решения электронной отчетности, которые используются для формирования электронной накладных.

### <a name="configure-er-parameters"></a>Настройка параметров ER

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Параметры электронной отчетности**.
3. На странице **Параметры электронной отчетности** на вкладке **Общие сведения** задайте для параметра **Включить режим конструктора** значение **Да**.
4. На вкладке **Вложения** в поле **Конфигурации** выберите **Файл**.
5. В полях **Архив заданий**, **Временная**, **Базовый** и **Другие** выберите тип **Файл**.

Дополнительные сведения о настройке параметров электронной отчетности см. в разделе [Настройка платформы электронной отчетности](electronic-reporting-er-configure-parameters.md).

### <a name="activate-an-er-configuration-provider"></a>Активация поставщика конфигураций электронной отчетности

Каждая добавленная конфигурация электронной отчетности помечается как принадлежащая поставщику конфигурации электронной отчетности. Для этой цели используется поставщик конфигурации электронной отчетности, который активирован в рабочей области **Электронная отчетность**. Поэтому перед началом добавления или изменения конфигураций электронной отчетности необходимо активировать поставщика конфигурации электронной отчетности в рабочей области **Электронная отчетность**.

> [!NOTE]
> Только владелец конфигурации электронной отчетности может редактировать ее. Поэтому перед редактированием конфигурации электронной отчетности необходимо активировать соответствующего поставщика конфигурации электронной отчетности в рабочей области **Электронная отчетность**.

#### <a name="review-the-list-of-er-configuration-providers"></a>Просмотр списка поставщиков конфигурации электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Поставщики конфигураций**.
3. На странице **Таблица поставщиков конфигураций** каждая запись поставщика имеет уникальное имя и URL-адрес. Проверьте содержимое данной страницы. Если запись для **Litware, Inc.** (`https://www.litware.com`) уже существует, пропустите следующую процедуру, [Добавление нового поставщика конфигурации электронной отчетности](#AddProvider).

#### <a name="add-a-new-er-configuration-provider"></a><a id="AddProvider"></a>Добавление нового поставщика конфигурации электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Связанные ссылки** выберите **Поставщики конфигураций**.
3. На странице **Поставщики конфигураций** выберите **Создать**.
4. В поле **Имя** введите **Litware, Inc.**
5. В поле **Интернет-адрес** введите `https://www.litware.com`.
6. Нажмите **Сохранить**.

#### <a name="activate-an-er-configuration-provider"></a>Активация поставщика конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Litware, Inc.**, затем выберите **Установить активные**.

Дополнительные сведения о поставщиках конфигурации электронной отчетности см. в разделе [Создание поставщиков конфигураций и пометка их как активных](tasks/er-configuration-provider-mark-it-active-2016-11.md).

## <a name="import-the-initial-versions-of-standard-er-configurations"></a><a name="ImportERConfigurations1"></a>Импорт исходных версий стандартных конфигураций электронной отчетности

Чтобы добавить стандартные конфигурации электронной отчетности в текущий экземпляр Finance, необходимо импортировать их из [репозитория](general-electronic-reporting.md#Repository) электронной отчетности, который был настроен для этого экземпляра.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Майкрософт**, затем выберите **Репозитории**, чтобы просмотреть список репозиториев для поставщика Майкрософт.
3. На странице **Репозитории конфигураций** выберите репозиторий типа **Глобальный**, затем выберите **Открыть**. Если будет предложено выполнить проверку подлинности для подключения к службе Regulatory Configuration Service, следуйте инструкциям по проверке подлинности.
4. На странице **Репозиторий конфигураций** в дереве конфигураций на левой панели выберите конфигурацию формата **Накладная по продаже PEPPOL**.
5. На экспресс-вкладке **Версии** выберите версию **11.2.2**.
6. Выберите **Импорт** для загрузки выбранной версии из глобального репозитория.

![Страница репозитория конфигурации](./media/er-quick-start3-import-solution1.png)

> [!TIP]
> При возникновении проблем с доступом к [глобальному репозиторию](er-download-configurations-global-repo.md) можно вместо этого [загрузить конфигурации](download-electronic-reporting-configuration-lcs.md) из служб Microsoft Dynamics Lifecycle Services (LCS).

### <a name="review-the-imported-er-configurations"></a>Проверка импортированных конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. На странице **Конфигурации** разверните экспресс-вкладку **Компоненты конфигурации**.
4. В дереве конфигураций в левой области разверните **Модель накладных**, затем раскройте **Накладная продажи UBL**.

Обратите внимание, что в дополнение к выбранному формату электронной отчетности **Накладная продажи PEPPOL** были импортированы другие необходимые конфигурации электронной отчетности. Поскольку новые версии конфигураций электронной отчетности постоянно публикуются в глобальном репозитории и LCS для обеспечения соответствия соответствующих решений новым требованиям, были импортированы последние версии необходимой конфигурации [модели данных](general-electronic-reporting.md#data-model-and-model-mapping-components) и ее конфигураций [сопоставления моделей](general-electronic-reporting.md#data-model-and-model-mapping-components).

![Страница конфигураций](./media/er-quick-start3-imported-solution1a.png)

Чтобы смоделировать состояние, в котором использовались бы конфигурации электронной отчетности в текущем экземпляре Finance, если импортировать версию **11.2.2** формата электронной отчетности **Накладная по продаже PEPPOL** в прошлом (например, на 7 августа 2019 года), выполните следующие действия.

- На панели действий выберите **Удалить**, чтобы удалить все конфигурации электронной отчетности, опубликованные после 7 августа 2019 года. Должны остаться только конфигурации **Модель накладных**, **Сопоставление модели накладных** (первоначально именуемое **Сопоставление модели накладных клиента**), **Накладная по продаже UBL** и **Накладная по продаже PEPPOL**.
- Для оставшихся конфигураций электронной отчетности на экспресс-вкладке **Версии** выберите **Удалить** для удаления всех конфигураций электронной отчетности, опубликованных после 7 августа 2019 года.

Затем проверьте, что в дереве конфигураций доступны следующие конфигурации:

- Конфигурация модели данных электронной отчетности **Модель накладных** (первоначально называлась **Модель накладных клиентов**):

    - Версия 11 содержит версию 10 компонента [модели данных](general-electronic-reporting.md#data-model-and-model-mapping-components) электронной отчетности, представляющую структуру данных бизнес-домена выставления накладных. Эта конфигурация электронной отчетности была импортирована в качестве предка формата **Накладная по продаже PEPPOL**, который был выбран для импорта.
    - Версия 50 содержит версию 31 компонента модели данных электронной отчетности. Эта конфигурация электронной отчетности была импортирована в качестве предка версии от 7 августа 2019 года конфигурации сопоставления модели электронной отчетности **Сопоставление модели накладных**.

    ![Конфигурация модели электронной отчетности модели накладных на странице конфигураций](./media/er-quick-start3-imported-solution1b1.png)

    > [!TIP]
    > Если вы не видите версию 50 этой модели данных, откройте глобальный репозиторий и импортируйте версию 50.19 конфигурации электронной отчетности **Сопоставление модели накладных**.

- Конфигурация сопоставления модели электронной отчетности **Сопоставление модели накладных** (первоначально называлась **Сопоставление модели накладных клиентов**):

    - Версия 50.19 была импортирована в качестве последней реализации версии 50 конфигурации модели данных электронной отчетности **Модель накладных**. Она содержит два компонента электронной отчетности [сопоставления моделей](general-electronic-reporting.md#data-model-and-model-mapping-components), в которых описывается заполнение модели данных данными приложения во время выполнения.

    ![Конфигурация сопоставления модели электронной отчетности "Сопоставление модели накладных" на странице конфигураций](./media/er-quick-start3-imported-solution1b2.png)

    > [!TIP]
    > Если вы не видите версию 50.19 этого сопоставления модели, откройте глобальный репозиторий и импортируйте версию 50.19 конфигурации электронной отчетности **Сопоставление модели накладных**.

- Конфигурации формата электронной отчетности **Накладная по продаже UBL**:

    - Версия 11.2 содержит [формат](general-electronic-reporting.md#FormatComponentOutbound) и компоненты сопоставления форматов электронной отчетности. Компонент формата определяет макет отчета. Компонент сопоставления формата содержит источник данных модели и определяет, как источник данных используется для заполнения макет отчета во время выполнения. Этот формат электронной отчетности был настроен на генерирование электронных накладных в формате Universal Business Language (UBL). Он был импортирована в качестве родителя формата **Накладная по продаже PEPPOL**, который был выбран для импорта.

- Конфигурации формата электронной отчетности **Накладная по продаже PEPPOL**:

    - Версия 11.2.2 содержит компоненты формата и сопоставления формата электронной отчетности, которые были настроены для создания электронных накладных в формате Pan-European Public Procurement OnLine (PEPPOL).

    ![Конфигурация формата электронной отчетности "Накладная по продаже PEPPOL" на странице конфигураций](./media/er-quick-start3-imported-solution1b3.png)

## <a name="configure-the-accounts-receivable-parameters"></a><a name="ConfigureAR1"></a>Настройка параметров расчетов с клиентами

1. Перейдите в раздел **Расчеты с клиентами** \> **Настройка** \> **Параметры модуля расчетов с клиентами**.
2. На вкладке **Электронные документы** на экспресс-вкладке **Электронная отчетность** в поле **Накладная по продаже и с произвольным текстом** выберите **Накладная по продаже PEPPOL**.
3. Нажмите **Сохранить**.

![Вкладка электронных документов на странице параметров модуля "расчеты с клиентами"](./media/er-quick-start3-configure-ar1.png)

## <a name="configure-the-legal-entity-parameters"></a><a name="ConfigureLE"></a>Настройка параметров юридического лица

1. Перейдите в раздел **Управление организацией** \> **Организации** \> **Юридические лица**.
2. Для выбранной компании **DEMF** на экспресс-вкладке **Сведения о банковском счете** в поле **Код банка** введите **1234**.
3. Нажмите **Сохранить**.
4. Закройте страницу **Юридические лица**.

## <a name="prepare-a-customer-record"></a><a name="ConfigureCustomer1"></a>Подготовка записи клиента

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. На странице **Все клиенты** выберите ссылку на счет клиента **DE-014**.

### <a name="add-a-customer-contact"></a>Добавление контактных данных клиента

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. В области действий на вкладке **Клиент** в группе **Организации** выберите **Контакты**.
3. Выберите **Добавить контакты**.
4. На странице **Контакты** в поле **Имя** откройте подстановку, выберите **Адам Картер**, затем выберите команду **Выбрать**, чтобы закрыть подстановку.
5. Нажмите **Сохранить**.
6. Закройте страницу **Контакты**.

### <a name="define-a-primary-contact"></a>Определение основного контакта

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. На экспресс-вкладке **Демографические данные продаж** в поле **Основное контактное лицо** выберите **Адам Картер**.

### <a name="set-the-e-invoicing-option"></a>Настройка параметра выставления электронных накладных

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. На экспресс-вкладке **Накладные и поставка** установите для параметра **Электронная накладная** значение **Да**.
3. Нажмите **Сохранить**.
4. Закройте страницу **Все клиенты**.

## <a name="process-a-customer-invoice-by-using-the-standard-er-configurations"></a><a name="ProcessInvoice1"></a>Обработка накладной клиента с использованием стандартных конфигураций электронной отчетности

Теперь можно использовать стандартные конфигурации электронной отчетности, импортированные в электронном виде, для отправки клиенту накладной с произвольным текстом.

### <a name="add-a-new-invoice"></a>Добавление новой накладной

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. На странице **Накладная с произвольным текстом** выберите **Создать**.
3. На экспресс-вкладке **Заголовок накладной с произвольным текстом** в поле **Счет клиента** выберите **DE-014**.
4. На экспресс-вкладке **Строки накладной** автоматически добавляется строка накладной. В этой строке установите следующие поля:

    - В поле **Описание** введите **Ноутбук**.
    - В поле **Счет ГК** выберите **401100**.
    - В поле **Цена за единицу** введите **1000**.

5. Нажмите **Сохранить**.

![Страница накладной с произвольным текстом](./media/er-quick-start3-add-invoice.png)

Дополнительные сведения см. в разделе [Создание накладной с произвольным текстом](../../../finance/accounts-receivable/create-free-text-invoice-new.md).

### <a name="post-a-new-invoice"></a>Разноска новой накладной

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. На странице **Накладная с произвольным текстом** в области действий выберите **Разнести**.
3. В диалоговом окне **Разноска накладной с произвольным текстом** выберите **ОК**.

![Страница сведений о накладной с произвольным текстом](./media/er-quick-start3-post-invoice.png)

### <a name="send-a-posted-invoice"></a>Отправка разнесенной накладной

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. На странице **Накладная с произвольным текстом** на панели действий в группе **Документ** выберите **Отправить** \> **Оригинал**.

    ![Предварительный просмотр исходной накладной](./media/er-quick-start3-send-invoice.png)

3. Закройте страницу **Накладная с произвольным текстом**.

### <a name="analyze-a-generated-e-invoice"></a>Анализ созданной электронной накладной

1. Перейдите в раздел **Управление организацией** \> **Электронная отчетность** \> **Задания электронной отчетности**.
2. На странице **Задания электронной отчетности** выберите начальную запись, которая содержит описание задачи **Отправить электронную накладную в формате XML**.
3. Выберите **Показать файлы** для доступа к списку созданных файлов.

    ![Страница заданий электронной отчетности](./media/er-quick-start3-jobs-list.png)

4. Выберите **Открыть**, чтобы загрузить созданный XML-файл электронной накладной.
5. Проанализируйте XML-файл электронной накладной. Обратите внимание, что в настоящее время налоговая схема клиента представлена атрибутами XML **schemeID** и **schemeAgencyID**. Также обратите внимание, что в настоящее время XML-элемент **cbc:CustomizationID** содержит следующий текст: `urn:www.cenbii.eu:transaction:biicoretrdm010:ver1.0:# urn:www.peppol.eu:bis:peppol5a:ver1.0`.

    ![Предварительный просмотр созданного XML-файла электронной накладной](./media/er-quick-start3-e-invoice1.png)

## <a name="add-a-custom-database-field"></a><a name="AddCustomField"></a>Добавление настраиваемого поля базы данных

Можно использовать функцию [настраиваемого поля](../../fin-ops/get-started/user-defined-fields.md) для выполнения следующих настроек в текущем экземпляре Finance:

- Настройте структуру базы данных, добавив новое настраиваемое поле базы данных, в котором хранится код плательщика федерального налога для каждого клиента.
- Настройте страницу **Клиент**, добавив новое поле ввода данных, которое можно использовать для ввода значения налогового кода в новое пользовательское поле базы данных.

Выполните следующие шаги, чтобы выполнить настройку.

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. На странице **Все клиенты** выберите ссылку на счет клиента **DE-014**.
3. На экспресс-вкладке **Общие** щелкните правой кнопкой мыши любое пустое место под полем **Язык**, затем выберите **Персонализация: верхняя группа**.

    Содержимое экспресс-вкладки **Общие** будет выделено, и появится меню **Персонализация**.

4. В меню **Персонализация** выберите **Добавить поле**.
5. В диалоговом окне **Добавление столбцов** выберите **Создать новое поле**.
6. В диалоговом окне **Создать новое поле** в поле **Имя таблицы** выберите **Клиенты**.
7. В поле **Префикс имени** введите **FederalTaxID**.

    > [!NOTE]
    > Полное имя поля было автоматически определено как **FederalTaxID\_Custom**.

8. В поле **Метка** введите **Код плательщика федерального налога**.
9. В поле **Тип** выберите **Текст**.
10. В поле **Длина** введите **20**.
11. Нажмите **Сохранить**.
12. В окне сообщения выберите **Да**, чтобы подтвердить, что вы хотите создать новую запись поля **FederalTaxID** для таблицы **Клиенты**.
13. Выберите **Вставить**, чтобы <a name="insert_custom_field"></a>добавить поле **FederalTaxID\_Custom** на текущую страницу.

    ![Страница всех клиентов](./media/er-quick-start3-create-new-field.gif)

14. Закройте страницу **Все клиенты**.

## <a name="refresh-the-er-metadata"></a><a name="RefreshERMetadata"></a>Обновление метаданных электронной отчетности

Необходимо обновить метаданные электронной отчетности, чтобы сделать добавленное вами настраиваемое поле [видимым](electronic-reporting-er-configure-parameters.md#frequently-asked-questions) в конструкторе сопоставления моделей электронной отчетности.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Перестроить ссылки на таблицы**.
2. В диалоговом окне **Обновление модели данных** нажмите кнопку **ОК**.

## <a name="design-the-custom-er-configurations"></a><a name="DesignCustomERConfigurations"></a>Проектирование пользовательских конфигураций электронной отчетности

Можно использовать конфигурации электронной отчетности, предоставляемые корпорацией Майкрософт, для разработки пользовательских конфигураций электронной отчетности, чтобы они создавали электронные накладные, содержащие новый налоговый код.

### <a name="customize-the-data-model-configuration"></a>Настройка конфигурации модели данных

В качестве пользователя в роли функционального консультанта по электронной отчетности вы можете разработать собственную модель данных электронной отчетности.

#### <a name="add-a-custom-data-model-configuration"></a>Добавление пользовательской конфигурации модели данных

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Модель накладной для клиента**.
3. В панели операций выберите **Создать конфигурацию**.
4. В раскрывающемся диалоговом окне в поле **Создать** выберите **Производное от Имя: модель накладных клиента, Майкрософт**, чтобы указать, что новая настраиваемая конфигурация модели данных электронной отчетности должна основываться на конфигурации модели данных электронной отчетности.
5. В поле **Имя** введите **Модель накладной (Litware)**.
6. Выберите **Создать конфигурацию**, чтобы добавить новую конфигурацию электронной отчетности.

Теперь можно использовать конструктор моделей данных электронной отчетности для редактирования версии 50.1 конфигурации электронной отчетности **Модель накладной (Litware)** в **черновом** [статусе](general-electronic-reporting.md#component-versioning).

![Версии 50.1 конфигурации электронной отчетности на странице конфигураций](./media/er-quick-start3-added-custom-model.png)

#### <a name="configure-a-custom-data-model"></a>Настройка пользовательской модели данных

Необходимо изменить пользовательскую модель данных, добавив новое поле, чтобы предоставить значение кода плательщика федерального налога. Этот код является частью данных о клиентах для каждого формата электронной отчетности, который будет использовать эту модель данных в качестве источника данных.

1. На странице **Конфигурации** в дереве конфигураций на левой панели выберите **Модель накладной (Litware)**.
2. На экспресс-вкладке **Версии** выберите версию **50.1** выбранной конфигурации модели данных электронной отчетности в статусе **Черновик**.
3. На панели операций выберите **Конструктор** для выбранной версии конфигурации.
4. На странице **Конструктор моделей данных** в дереве моделей данных выберите **Сведения о клиенте (Клиент)**.
5. Выберите **Создать**.
6. В диалоговом окне раскрывающегося списка в поле **Создать узел как** примите значение по умолчанию: **Дочерний от активного узла**.
7. В поле **Имя** введите **FederalTaxID\_Litware**.
8. В поле **Тип элемента** примите значение по умолчанию **Строка**.
9. Выберите **Добавить**, затем выберите **Сохранить**.

    ![Страница конструктора модели данных](./media/er-quick-start3-add-data-model-field.png)

    > [!NOTE]
    > Поля **Метка** и **Описание** описывают назначение нового поля. Эти поля можно заполнять на нескольких языках. Дополнительные сведения см. в разделе [Разработка многоязычных отчетов в электронной отчетности](er-design-multilingual-reports.md).

10. Закройте страницу **Конструктор модели данных**.

#### <a name="complete-a-custom-data-model-configuration"></a>Завершение пользовательской конфигурации модели данных

Необходимо [завершить](general-electronic-reporting.md#component-versioning) работу с версией 50.1 пользовательской модели данных электронной отчетности, чтобы она была доступна, чтобы можно было добавить другие пользовательские конфигурации электронной отчетности.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной**, затем выберите **Модель накладной (Litware)**.
3. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 50.1 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 50.2, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию модели данных электронной отчетности.

![Версия 50.1 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-model1.png)

### <a name="customize-the-model-mapping-configuration"></a>Настройка конфигурации сопоставления моделей

В качестве пользователя в роли разработчика электронной отчетности вы можете разработать собственное сопоставление моделей электронной отчетности.

#### <a name="add-a-custom-model-mapping-configuration"></a>Добавление пользовательской конфигурации сопоставлений моделей

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиенту**, затем выберите **Сопоставление модели накладной клиенту**.
3. В панели операций выберите **Создать конфигурацию**.
4. В раскрывающемся диалоговом окне в поле **Создать** выберите **Производное от Имя: сопоставление моделей накладных клиенту, Майкрософт**, чтобы указать, что новая настраиваемая конфигурация сопоставления модели электронной отчетности должна основываться на конфигурации сопоставления модели электронной отчетности.
5. В поле **Имя** введите **Сопоставление моделей накладных (Litware)**.
6. В поле **Целевая модель** выберите **Модель накладных (Litware)**.

    > [!IMPORTANT]
    > Этот шаг очень важен. Если его опустить, вы не сможете использовать пользовательскую модель данных в настроенном сопоставлении моделей.

7. Выберите **Создать конфигурацию**, чтобы добавить новую конфигурацию электронной отчетности.

![Добавление пользовательской конфигурации сопоставления моделей на странице конфигураций](./media/er-quick-start3-adding-custom-mapping.png)

#### <a name="configure-a-custom-model-mapping"></a>Настройка пользовательского сопоставления моделей

Необходимо изменить пользовательское сопоставление моделей и указать, как пользовательское поле **FederalTaxID\_Litware** в пользовательской модели данных должно заполняться данными приложения во время его выполнения.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиенту** \> **Сопоставление модели накладной клиенту**, затем выберите **Сопоставление модели накладной (Litware)**.
3. В области действий выберите **Конструктор**.
4. На странице **Сопоставление модели и источника данных** выберите сопоставление **Накладная клиента**.

    ![Страница сопоставления модели и источника данных](./media/er-quick-start3-select-customer-mapping.png)

5. Выберите **Конструктор**.
6. На странице **Конструктор сопоставления моделей** в области **Источники данных** разверните источник данных **CustInvoiceJour**, представляющий таблицу приложения **CustInvoiceJour**.
7. В разделе **CustInvoiceJour** разверните узел **Отношения**, чтобы просмотреть список отношений типа "многие к одному" (N:1) для таблицы **CustInvoiceJour**.
8. В разделе **CustInvoiceJour** \> **Отношения** разверните **Клиенты (CustTable)**, чтобы получить доступ к полям и отношениям таблицы **Клиенты (CustTable)**.
9. Выберите поле источника данных **FederalTaxID\_Custom**, реализованное [ранее](#insert_custom_field).
10. В области **Модель данных** разверните **Сведения о клиенте" (клиент)** и выберите поле модели данных **FederalTaxID\_Litware**.
11. Выберите **Связать**.

    ![Страница конструктора сопоставления модели](./media/er-quick-start3-customize-model-mapping.gif)

12. Нажмите **Сохранить**.
13. Закройте страницу **Конструктор сопоставления модели**.
14. Закройте страницу **Сопоставление модели и источника данных**.

#### <a name="complete-a-custom-model-mapping-configuration"></a>Завершение пользовательской конфигурации сопоставления модели

Необходимо [завершить](general-electronic-reporting.md#component-versioning) работу с версией 50.19.1 пользовательской конфигурации сопоставления модели электронной отчетности, чтобы сделать ее доступной для использования.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиенту** \> **Сопоставление модели накладной клиенту**, затем выберите **Сопоставление модели накладной (Litware)**.
3. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 50.19.1 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 50.19.2, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию сопоставления модели электронной отчетности.

![Версия 50.19.1 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-mapping1.png)

> [!NOTE]
> Поддерживаемый [жизненный цикл](general-electronic-reporting-manage-configuration-lifecycle.md) конфигурации не охватывает жизненный цикл изменений в базе данных. Если экспортировать версию 50.19.1 конфигурации **Сопоставление модели накладных (Litware)** из текущего экземпляра Finance и попробовать импортировать ее в другой экземпляр, который не содержит настраиваемого поля **FederalTaxID\_Custom** в таблице **CustTable**, то возникнет исключение. Исключение будет сообщать, что импортированная конфигурация электронной отчетности несовместима с метаданными целевого экземпляра Finance.

### <a name="customize-the-format-configuration"></a>Настройка конфигурации формата

В качестве пользователя в роли функционального консультанта по электронной отчетности вы можете разработать собственный формат электронной отчетности.

#### <a name="add-a-custom-format-configuration"></a>Добавление пользовательской конфигурации формата

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиента** \> **Накладная по продажам UBL** и выберите **Накладная по продажам PEPPOL**.
3. В панели операций выберите **Создать конфигурацию**.
4. В раскрывающемся диалоговом окне в поле **Создать** выберите **Производное от Имя: Накладная продаж PEPPOL, Майкрософт**, чтобы указать, что новая настраиваемая конфигурация формата электронной отчетности должна основываться на этой конфигурации формата электронной отчетности.
5. В поле **Имя** введите **Накладная по продажам PEPPOL (Litware)**.
6. В поле **Модель данных** выберите **Модель накладных (Litware)**, чтобы использовать пользовательские компоненты модели данных и сопоставления модели.

    > [!NOTE]
    > Этот шаг очень важен. Если его опустить, вы не сможете использовать пользовательскую модель данных в настроенном формате.

7. В поле **Модель данных** выберите корневое определение **InvoiceCustomer**.
8. Выберите **Создать конфигурацию**, чтобы добавить новую конфигурацию электронной отчетности.

![Добавление пользовательской конфигурации формата на странице конфигураций](./media/er-quick-start3-adding-custom-format.png)

Теперь можно использовать конструктор операций электронной отчетности для редактирования версии 11.2.2.1 конфигурации электронной отчетности **Накладная по продажам PEPPOL (Litware)** в **черновом** [статусе](general-electronic-reporting.md#component-versioning).

![Версии 11.2.2.1 конфигурации электронной отчетности на странице конфигураций](./media/er-quick-start3-added-custom-format.png)

#### <a name="configure-a-custom-format"></a>Настройка пользовательского формата

Необходимо изменить пользовательский формат, добавив новый элемент форматирования для заполнения значения федерального налогового кода клиента, для которого выставлена накладная.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиента** \> **Накладная по продажам UBL** \> **Накладная по продажам PEPPOL** и выберите **Накладная по продажам PEPPOL (Litware)**.
3. В области действий выберите **Конструктор**.
4. В дереве формата разверните **XMLHeader** \> **Накладная** \> **cac:AccountingCustomerParty** \> **cac:Party** \> **cac:PartyTaxScheme** \> **cac:TaxScheme** и выберите **cbc:ID**.
5. Выберите **Добавить**, затем выберите **XML** \> **Атрибут**.
6. В диалоговом окне **Свойство компонента** в поле **Имя** введите **FederalTaxID**.
7. Выберите **ОК**, чтобы добавить новый элемент формата для создания нового XML-атрибута **FederalTaxID** в созданном файле XML.
8. В дереве формата в разделе **XMLHeader** \> **Накладная** \> **cac:AccountingCustomerParty** \> **cac:Party** \> **cac:PartyTaxScheme** \> **cac:TaxScheme** \> **cbc:ID** выберите **FederalTaxID**.
9. Выберите **Переместить вверх**.

![Новый элемент формата на странице конструктора формата](./media/er-quick-start3-customized-format.png)

#### <a name="configure-a-custom-format-mapping"></a>Настройка пользовательского сопоставления формата

1. На странице **Конструктор форматов** на вкладке **Сопоставление** разверните источник данных **Накладная** типа **Модель**.
2. В области **Накладная** разверните **Сведения о клиенте (Клиент)** и выберите **FederalTaxID\_Litware**.
3. Выберите **Связать**.

    ![Страница конструктора форматов](./media/er-quick-start3-customized-format-mapping.png)

4. Выберите источник данных **Накладная** типа **Модель**, затем выберите **Правка**.
5. В поле **Версия** выберите версию **1** вашей пользовательской модели данных и выберите **ОК**.
6. Нажмите **Сохранить**.
7. Закройте страницу **Конструктор форматов**.

#### <a name="complete-a-custom-format-configuration"></a>Завершение пользовательской конфигурации формата

Необходимо [завершить](general-electronic-reporting.md#component-versioning) работу с версией 11.2.2.1 пользовательской конфигурации формата электронной отчетности, чтобы сделать ее доступной для использования.

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной клиента** \> **Накладная по продажам UBL** \> **Накладная по продажам PEPPOL** и выберите **Накладная по продажам PEPPOL (Litware)**.
3. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 11.2.2.1 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 11.2.2.2, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию формата электронной отчетности.

![Версия 11.2.2.1 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-format1.png)

## <a name="configure-the-accounts-receivable-parameters-to-start-to-use-custom-er-configurations"></a><a name="ConfigureAR2"></a>Настройка параметров модуля расчетов с клиентами, чтобы начать использовать пользовательские конфигурации электронной отчетности

1. Перейдите в раздел **Расчеты с клиентами** \> **Настройка** \> **Параметры модуля расчетов с клиентами**.
2. На вкладке **Электронные документы** на экспресс-вкладке **Электронная отчетность** в поле **Накладная по продаже и с произвольным текстом** выберите **Накладная по продаже PEPPOL (Litware)**.
3. Нажмите **Сохранить**.

![Страница параметров модуля "расчеты с клиентами", вкладка электронных документов, экспресс-вкладка электронной отчетности](./media/er-quick-start3-configure-ar2.png)

## <a name="update-a-customer-record-by-adding-a-federal-tax-identification-code"></a><a name="ConfigureCustomer2"></a>Обновление записи клиента путем добавления кода плательщика федерального налога

1. Перейдите в раздел **Расчеты с клиентами** \> **Клиенты** \> **Все клиенты**.
2. На странице **Все клиенты** выберите ссылку на счет клиента **DE-014**.
3. На экспресс-вкладке **Общие** в поле **Код плательщика федерального налога** введите **LITWARE-6789**.
4. Нажмите **Сохранить**.

    ![Страница сведения о клиенте DE-014](./media/er-quick-start3-added-tax-id-value.png)

5. Закройте страницу **Все клиенты**.

## <a name="process-a-customer-invoice-by-using-custom-er-configurations"></a><a name="ProcessInvoice2"></a>Обработка накладной клиента с использованием пользовательских конфигураций электронной отчетности

### <a name="select-and-send-a-posted-invoice"></a>Выберите и отправьте разнесенную накладную

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. На странице **Накладная с произвольным текстом** выберите накладную, которая была ранее добавлена и разнесена.
3. На панели действий в группе **Документ** выберите **Отправить** \> **Оригинал**.
4. Закройте страницу **Накладная с произвольным текстом**.

### <a name="analyze-a-generated-e-invoice"></a>Анализ созданной электронной накладной

1. Перейдите в раздел **Управление организацией** \> **Электронная отчетность** \> **Задания электронной отчетности**.
2. На странице **Задания электронной отчетности** выберите новейшую запись, которая содержит описание задачи **Отправить электронную накладную в формате XML**.
3. Выберите **Показать файлы** для доступа к списку созданных файлов.
4. Выберите **Открыть**, чтобы загрузить созданный XML-файл электронной накладной.
5. Проанализируйте XML-файл электронной накладной. Обратите внимание, что, в соответствии с настройкой, налоговая схема клиента включает пользовательский XML-атрибут **FederalTaxID** в дополнение к XML-атрибутам **schemeID** и **schemeAgencyID**. Значение этого нового XML-атрибута определяется кодом федерального налогоплательщика **LITWARE-6789**, который был введен для клиента, для которого выставлена накладная.

    ![Предварительный просмотр созданного XML-файла электронной накладной с вашими настройками](./media/er-quick-start3-e-invoice2.png)

## <a name="import-the-latest-versions-of-standard-er-configurations"></a><a name="ImportERConfigurations2"></a>Импорт последних версий стандартных конфигураций электронной отчетности

Чтобы сохранить набор стандартных конфигураций электронной отчетности в экземпляре Finance [в актуальном состоянии](general-electronic-reporting-manage-configuration-lifecycle.md), необходимо импортировать новые версии, когда они станут доступны в [репозитории](general-electronic-reporting.md#Repository) электронной отчетности, настроенном для этого экземпляра.

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Поставщики конфигураций** выберите плитку **Майкрософт**, затем выберите **Репозитории**, чтобы просмотреть список репозиториев для поставщика Майкрософт.
3. На странице **Репозитории конфигураций** выберите репозиторий типа **Глобальный**, затем выберите **Открыть**. Если будет предложено выполнить проверку подлинности для подключения к службе Regulatory Configuration Service, следуйте инструкциям по проверке подлинности.
4. На странице **Репозиторий конфигураций** в дереве конфигураций на левой панели выберите конфигурацию формата **Накладная по продаже PEPPOL**.
5. На экспресс-вкладке **Версии** выберите версию **32.6.7** выбранной конфигурации формата электронной отчетности, которая была выпущена для поддержки электронных накладных клиентов в формате PEPPOL BIS 3. Дополнительные сведения см. в статье [KB4490320](https://support.microsoft.com/help/4490320/an-update-for-european-union-to-support-export-of-customers-electronic).
6. Выберите **Импорт** для загрузки выбранной версии из глобального репозитория в текущий экземпляр Finance.

![Версия 32.6.7, выбранная на странице репозитория конфигураций](./media/er-quick-start3-import-solution2.png)

Сведения о том, как можно автоматизировать этот процесс, см. в разделе [Импорт обновленных версий конфигураций электронной отчетности](er-download-updated-versions-global-repo.md).

### <a name="review-the-imported-er-configurations"></a>Проверка импортированных конфигураций электронной отчетности

1. Перейдите в раздел **Управление организацией** \> **Рабочие области** \> **Электронная отчетность**.
2. На странице **Конфигурации локализации** в разделе **Конфигурации** выберите плитку **Конфигурации отчетности**.
3. Разверните экспресс-вкладку **Компоненты конфигурации**.
4. В дереве конфигураций в левой области разверните **Модель накладных**. Обратите внимание, что название **Модель накладных клиента** изменено на **Модель накладных** в одной из импортированных конфигураций модели данных электронной отчетности.
5. В дереве конфигураций в левой области разверните **Сопоставление модели накладных**. Обратите внимание, что название **Сопоставление модели накладных клиента** изменено на **Сопоставление модели накладных** в одной из импортированных конфигураций сопоставления модели электронной отчетности.
6. Разверните **Накладная по продажам UBL** \> **Накладная по продажам PEPPOL**.

Обратите внимание, что в дополнение к выбранному формату электронной отчетности **Накладная продажи PEPPOL** были импортированы другие необходимые последние версии конфигурации электронной отчетности. Поскольку новые версии конфигураций электронной отчетности постоянно публикуются в глобальном репозитории и LCS для обеспечения соответствия соответствующих решений электронной отчетности новым требованиям, были импортированы последние версии необходимой конфигурации модели данных и ее конфигураций сопоставления моделей.

Убедитесь, что в дереве конфигураций в конечном счете доступны следующие конфигурации электронной отчетности:

- Конфигурация модели данных электронной отчетности **Модель накладной**:

    - Версия 206 (ли новее) содержит версию 24 (ли новее) компонента модели данных электронной отчетности, представляющую структуру данных бизнес-домена выставления накладных. Эта конфигурация электронной отчетности была импортирована в качестве предка последней доступной версии конфигурации сопоставления модели электронной отчетности **Сопоставление модели накладных**.

    ![Версия 206 на странице конфигураций](./media/er-quick-start3-imported-solution2b1.png)

- Конфигурация сопоставления модели электронной отчетности **Сопоставление модели накладной**:

    - Версия 206.132 (или новее) была импортирована в качестве последней реализации версии 206 конфигурации модели данных электронной отчетности **Модель накладных**. Она содержит несколько компонентов электронной отчетности сопоставления моделей, в которых описывается заполнение модели данных данными приложения во время выполнения.

    ![Версия 206.132 на странице конфигураций](./media/er-quick-start3-imported-solution2b2.png)

- Конфигурации формата электронной отчетности **Накладная по продаже UBL**:

    - Версия 32.6 содержит формат и компоненты сопоставления форматов электронной отчетности. Компонент формата определяет макет отчета. Компонент сопоставления формата содержит источник данных модели и определяет, как источник данных используется для заполнения макет отчета во время выполнения. Этот формат электронной отчетности был настроен на генерирование электронных накладных в формате UBL. Он был импортирована в качестве родителя формата **Накладная по продаже PEPPOL**, который был выбран для импорта.

- Конфигурации формата электронной отчетности **Накладная по продаже PEPPOL**:

    - Версия 32.6.7 содержит компоненты формата и сопоставления формата электронной отчетности, которые были настроены для создания электронных накладных в формате PEPPOL.

    ![Версия 32.6.7 на странице конфигураций](./media/er-quick-start3-imported-solution2b3.png)

## <a name="adopt-the-changes-to-the-new-standard-er-configurations-in-your-custom-er-configurations"></a><a name="RebaseCustomERConfigurations"></a>Адаптация изменений в новых версиях стандартных конфигураций электронной отчетности в ваших пользовательских конфигурациях электронной отчетности

### <a name="adopt-your-custom-er-data-model"></a>Адаптация пользовательской модели данных электронной отчетности

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной**, затем выберите **Модель накладной (Litware)**.
3. На экспресс-вкладке **Версии** для черновой версии **50.2** выбранной конфигурации модели данных выберите **Повторно разместить**.
4. В поле **Целевая версия** убедитесь, что выбрана версия **206** базовой конфигурации модели данных электронной отчетности, затем выберите **ОК**.

    Черновая версия настраиваемой конфигурации модели данных электронной отчетности будет перенумерована с **50.2** на **206.2**, чтобы указать, что в данный момент она содержит настройки, объединенные с изменениями в последней версии (206) базовой конфигурации модели данных электронной отчетности.

    > [!NOTE]
    > Операция изменения базы обратима. Чтобы отменить это изменение базы, выберите версию **50.1** модели **Модель накладной (Litware)** на экспресс-вкладке **Версии**, затем выберите **Получить эту версию**. Версия 206.2 будет перенумерована обратно в **50.2**, а содержимое черновой версии 50.2 будет соответствовать содержимому версии 50.1.

5. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 206.2 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 206.3, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию модели данных электронной отчетности.

![Версия 206.2 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-model2.png)

### <a name="adopt-your-custom-er-model-mapping"></a>Адаптация сопоставления пользовательской модели электронной отчетности

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной** \> **Сопоставление модели накладной**, затем выберите **Сопоставление модели накладной (Litware)**.
3. На экспресс-вкладке **Версии** для черновой версии **50.19.2** выбранной конфигурации сопоставления модели электронной отчетности выберите **Повторно разместить**.
4. В поле **Целевая версия** убедитесь, что выбрана версия **206.132** базовой конфигурации сопоставления модели электронной отчетности, затем выберите **ОК**.

    Черновая версия настраиваемой конфигурации сопоставления модели электронной отчетности будет перенумерована с **50.19.2** на **206.132.2**, чтобы указать, что в данный момент она содержит настройки, объединенные с изменениями в последней версии (206.132) базовой конфигурации сопоставления модели электронной отчетности.

    Обратите внимание, что были обнаружены некоторые конфликты изменения базы. Теперь эти конфликты необходимо устранить вручную.

    ![Сообщение о конфликте изменения базы на странице конфигураций](./media/er-quick-start3-rebase-conflicts-model-mapping1.png)

5. В области действий выберите **Конструктор**, затем в списке сопоставлений выберите **Накладная клиента**.
6. Для каждого конфликта изменения базы выберите **Сохранить собственное значение**, так как необходимо сохранить номер версии пользовательской модели данных для каждого из упомянутых компонентов.

    ![Конфликты изменения базы на странице конструктора сопоставления модели](./media/er-quick-start3-rebase-conflicts-model-mapping2.png)

7. Выберите **Сохранить**, затем закройте страницу **Конструктор сопоставления модели**.
8. В списке сопоставлений выберите **Накладная по проекту**.
9. Для каждого конфликта изменения базы выберите **Сохранить собственное значение**, так как необходимо сохранить номер версии пользовательской модели данных для каждого из упомянутых компонентов.
10. Выберите **Сохранить**, затем закройте страницу **Сопоставления модели**.

    > [!NOTE]
    > Операция изменения базы обратима. Чтобы отменить это изменение базы, выберите версию **50.19.1** сопоставления модели **Сопоставление модели накладной (Litware)** на экспресс-вкладке **Версии**, затем выберите **Получить эту версию**. Версия 206.132.2 будет перенумерована обратно в **50.19.2**, а содержимое черновой версии 50.19.2 будет соответствовать содержимому версии 50.19.1.

11. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 206.132.2 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 206.132.3, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию сопоставления модели электронной отчетности.

![Версия 206.132.2 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-mapping2.png)

### <a name="adopt-your-custom-er-format"></a>Адаптация пользовательского формата электронной отчетности

1. Перейдите в раздел **Администрирование организации** \> **Электронная отчетность** \> **Конфигурации**.
2. На странице **Конфигурации** в дереве конфигураций на левой панели разверните **Модель накладной** \> **Накладная по продажам UBL** \> **Накладная по продажам PEPPOL** и выберите **Накладная по продажам PEPPOL (Litware)**.
3. На экспресс-вкладке **Версии** для черновой версии **11.2.2.2** выбранной конфигурации формата выберите **Повторно разместить**.
4. В поле **Целевая версия** убедитесь, что выбрана версия **32.6.7** базовой конфигурации формата электронной отчетности, затем выберите **ОК**.

    Черновая версия настраиваемой конфигурации формата электронной отчетности будет перенумерована с **11.2.2.2** на **32.6.7.2**, чтобы указать, что в данный момент она содержит настройки, объединенные с изменениями в последней версии (32.6.7) базовой конфигурации формата электронной отчетности.

    Обратите внимание, что были обнаружены некоторые конфликты изменения базы. Теперь эти конфликты необходимо устранить вручную.

5. В области действий выберите **Конструктор**.
6. Для каждого конфликта изменения базы выберите **Сохранить собственное значение**, так как необходимо сохранить номер версии пользовательской модели данных для каждого из упомянутых компонентов.
7. Нажмите **Сохранить**.
8. На вкладке **Сопоставление** выберите источник данных **Накладная** типа **Модель**, затем выберите **Правка**.
9. В поле **Версия** выберите версию **2** вашей пользовательской модели данных и выберите **ОК**.
10. Нажмите **Сохранить**.

    > [!NOTE]
    > Операция изменения базы обратима. Чтобы отменить это изменение базы, выберите версию **11.2.2.1** формата **Накладная по продажам PEPPOL (Litware)** на экспресс-вкладке **Версии**, затем выберите **Получить эту версию**. Версия 32.6.7.2 будет перенумерована обратно в **11.2.2.2**, а содержимое черновой версии 11.2.2.2 будет соответствовать содержимому версии 11.2.2.1.

11. Закройте страницу **Конструктор форматов**.
12. На экспресс-вкладке **Версии** выберите **Изменить статус** \> **Завершено**, затем выберите **ОК**.

Состояние версии 32.6.7.2 изменится с **Черновик** на **Завершено**, и версия становится доступной только для чтения. Добавляется новая редактируемая версия, 32.6.7.3, имеющая статус **Черновик**. Эту версию можно использовать для внесения дальнейших изменений в настраиваемую конфигурацию формата электронной отчетности.

![Версия 32.6.7.2 завершена на странице конфигураций](./media/er-quick-start3-completed-custom-format2.png)

## <a name="process-a-customer-invoice-by-using-new-versions-of-the-custom-er-configurations"></a><a name="ProcessInvoice3"></a>Обработка накладной клиента с использованием новых версий пользовательских конфигураций электронной отчетности

### <a name="select-and-send-a-posted-invoice"></a>Выберите и отправьте разнесенную накладную

1. Перейдите в раздел **Расчеты с клиентами** \> **Накладные** \> **Все накладные с произвольным текстом**.
2. На странице **Накладная с произвольным текстом** выберите накладную, которая была ранее добавлена и разнесена.
3. На панели действий в группе **Документ** выберите **Отправить** \> **Оригинал**.

    > [!NOTE] 
    > Поскольку теперь имеются две версии конфигурации формата электронной отчетности **Накладная по продажам PEPPOL (Litware)**, и ни одна из версий не имеет значения [даты вступления в силу](general-electronic-reporting.md#component-date-effectivity), используется последняя версия для создания электронной накладной.

4. Закройте страницу **Накладная с произвольным текстом**.

### <a name="analyze-a-generated-e-invoice"></a>Анализ созданной электронной накладной

1. Перейдите в раздел **Управление организацией** \> **Электронная отчетность** \> **Задания электронной отчетности**.
2. На странице **Задания электронной отчетности** выберите самую недавнюю запись, которая содержит описание задачи **Отправить электронную накладную в формате XML**.
3. Выберите **Показать файлы** для доступа к списку созданных файлов.
4. Выберите **Открыть**, чтобы загрузить созданный XML-файл электронной накладной.
5. Проанализируйте XML-файл электронной накладной. Обратите внимание, что, в соответствии с настройкой, налоговая схема клиента все еще включает пользовательский XML-атрибут **FederalTaxID** в дополнение к XML-атрибутам **schemeID** и **schemeAgencyID**. Кроме того, поскольку изменения в новой версии базового формата **Накладная по продаже UBL** были объединены с вашей настройкой, текст XML-элемента **cbc:CustomizationID** был изменен с `urn:www.cenbii.eu:transaction:biicoretrdm010:ver1.0:# urn:www.peppol.eu:bis:peppol5a:ver1.0` на `urn:cen.eu:en16931:2017#compliant#urn:fdc:peppol.eu:2017:poacc:billing:3.0`.

    ![Предварительный просмотр созданного XML-файла электронной накладной с настройками](./media/er-quick-start3-e-invoice3.png)

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Обзор электронной отчетности](general-electronic-reporting.md)
- [Загрузка конфигураций электронной отчетности из Lifecycle Services](download-electronic-reporting-configuration-lcs.md)
- [Загрузка конфигураций электронной отчетности из глобального репозитория Configuration Service](er-download-configurations-global-repo.md)
- [Создание накладных с произвольным текстом](https://docs.microsoft.com/dynamics365/finance/accounts-receivable/create-free-text-invoice-new)
- [Создание настраиваемых полей и работа с ними](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/get-started/user-defined-fields)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]