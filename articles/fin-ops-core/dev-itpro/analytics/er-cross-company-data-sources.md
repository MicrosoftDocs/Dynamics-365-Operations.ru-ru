---
title: Источники данных из разных компаний в электронной отчетности (ER)
description: В этом разделе объясняется использование источников данных из разных компаний в электронной отчетности (ER).
author: NickSelin
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERModelMappingDesigner, ERFormatMappingLegalEntityFilterTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 25c665c797d0cea10cbe337e86be4a07f1f5074a
ms.sourcegitcommit: ab3f5d0da6eb0177bbad720e73c58926d686f168
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2021
ms.locfileid: "5944469"
---
# <a name="cross-company-data-sources-in-electronic-reporting-er"></a>Источники данных из разных компаний в электронной отчетности (ER)

[!include[banner](../includes/banner.md)]

Можно разработать форматы электронной отчетности (ER) для создания исходящих документов в различных форматах. Когда создается документ, формат электронной отчетности обращается к источникам данных, которые были настроены в соответствующем соответствии моделей электронной отчетности. Чтобы настроить доступ к таблицам приложения для извлечения записей можно использовать источники данных электронной отчетности типа **Записи таблицы**. Если таблица доступа представляет собой общую таблицу (то есть это таблица, где сохраняются данные без идентификатора компании), этот источник данных возвращает все записи. Когда таблица доступа является таблицей, зависящей от компании (то есть таблицей, где данные сохраняются для каждой компании), этот источник данных возвращает только записи, которые были сохранены для текущей компании (то есть контекст компании, который соответствует формату электронной отчетности).

Каждый источник данных типа **Записи таблицы** в соответствии модели может быть теперь помечен как источник данных разных компаний. Таким образом, можно использовать источники данных типа **Записи таблицы** для доступа к данным разных компаний в таблицах приложений.

Если отметить источник данных как источник данных разных компаний, происходит следующее:

- Для источника данных, который относится к любой общей таблице, кроме CompanyInfo, источник данных возвращает все записи, которые существуют в используемой таблице. 
- Для источника данных, который ссылается на таблицу CompanyInfo, хотя CompanyInfo является общей таблицей, источник данных возвращает записи, содержащие идентификатор компании из определенной области.
- Для любой зависящей от компании таблицы источник данных возвращает записи используемой таблицы, которые содержат идентификатор компании из определенной области.

В диалоговом окне системного запроса при включении параметра **Запросить запрос** для любого источника данных, который помечен как данные разных компаний, можно вручную выбрать одну или несколько компаний, которые должны быть включены на вкладке **Диапазон компаний**.

> [!IMPORTANT]
> Как и другие фильтры, фильтр компании сохраняется как последнее используемое значение для запросов при запуске формата электронной отчетности. Фильтр не изменяется автоматически при изменении значения разных компаний для источника данных. Чтобы использовать другое значение разных компаний для другого источника данных, удалите соответствующей выбор конкретного пользователя.

Для каждого источника данных, который помечен как источник данных разных компаний, можно выбрать необходимые записи с помощью функций **ФИЛЬТР** и **ГДЕ** в выражениях электронной отчетности. Поле **dataAreaID** также может использоваться как идентификатор компании. В настоящее время поле **dataAreaID** ограничено следующие типы условий при использовании функции **ФИЛЬТР**:

- Только те условия, которые имеют одно сравнение поля **dataAreaID** поддерживаются.
- Допускаются только сравнения, имеющие выражения, которые не зависят от элементов списка записей.

Таким образом следующее выражение является допустимым.

```ER Expression
FILTER (MyTable, MyTable.dataAreaID = $StringUserInputParameter)
While shown below expressions will not pass the validation:
FILTER (MyTable, MyTable.dataAreaID = MyTable2RecordsList.MyField)
FILTER (MyTable, 
    OR(
        MyTable.dataAreaID = $StringUserInputParameter1,
        MyTable.dataAreaID = $StringUserInputParameter2
    )
)
```

По умолчанию область включает все компании текущего приложения. Тем не менее, это можно ограничить. Для ограничения доступа к данным разных компаний для одного формата электронной отчетности назначьте формату определенную организационную иерархию. Когда иерархия определена для формата электронной отчетности, возвращаются только записи для юридических лиц, которые представлены в назначенной иерархии, даже если формат обращается к источникам данных разных компаний. При ссылке на иерархию, которая больше не существует для формата электронной отчетности, применяется область по умолчанию, и формат обращается к источникам данных разных компаний. В этом случае возвращаются записи для всех компаний с приложением.

Обратите внимание, что при включении параметра **Использовать черновик** для организационной иерархии назначенной одному формату электронной отчетности, юридические лица из черновика версии этой иерархии будут использоваться для определения области для источников данных разных компаний. Если черновика версии не существует, юридические лица из последней опубликованной версии этой организационной иерархии будут использоваться для этого.

Обратите внимание, что при включении параметра **Использовать черновик** для организационной иерархии назначенной одному формату электронной отчетности, юридические лица из последней опубликованной версии этой организационной иерархии будут использоваться для определения области для источников данных разных компаний. Эффективность данных организационных иерархий пока не поддерживается в рамках электронной отчетности.

Иерархию можно назначить определенному формату на отдельной странице, к которой можно получить доступ из рабочего пространства электронной отчетности или с помощью пункта меню **Управление организацией \> Электронная отчетность \> Фильтр по юридическому лицу для форматов**. Чтобы получить доступ к странице, пользователю должен быть предоставлен доступ к привелегии **Поддерживать фильтры юридического лица для формата** (ERMaintainFormatMappingLegalEntityFilters). Ограничение объема юридических лиц на основе иерархии для формата применяется в дополнение к ограничению, которое пользователь может указать в диалоговом окне системного запроса. Пересечение этих ограничений используется при выполнении формата.

Для получения дополнительных сведений о данном компоненте запустите проводник по задаче, **Записи доступа электронной отчетности к зависимым от компании таблицам в режиме разных компаний**, которое входит в 7.5.4.3 Бизнес-процесс приобретения/разработки компонентов ИТ-услуг и решений (10677) и может быть загружено из [Центра загрузки Майкрософт](https://go.microsoft.com/fwlink/?linkid=874684). В этом проводнике по задаче описывается процесс конфигурирования соответствия модели электронной отчетности и формата электронной отчетности для доступа к таблицам приложений в режиме разных компаний.

Загрузите следующие файлы для завершения проводника по задаче:

- [Конфигурация модели электронной отчетности — CrossCompanyDataAccessModel.xml](https://download.microsoft.com/download/4/2/5/4258f891-7054-4821-aedd-3721ba25fdd5/CrossCompanyDataAccessModel.xml)
- [Конфигурация формата электронной отчетности — CrossCompanyDataAccessFormat.xml](https://download.microsoft.com/download/3/2/1/321deb75-3ba9-4323-99bf-207a52c60b5c/CrossCompanyDataAccessFormat.xml)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
