---
title: Исходящая операция запасов в POS
description: В этом разделе описываются возможности исходящие операции с запасами в POS-терминале.
author: hhaines
manager: annbe
ms.date: 07/30/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: josaw
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: Retail
ms.author: hhaines
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.9
ms.openlocfilehash: b8f0daf96e782e5ba6c985847bad81312e48d30b
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "4976622"
---
# <a name="outbound-inventory-operation-in-pos"></a>Исходящая операция запасов в POS

[!include [banner](includes/banner.md)]


В Microsoft Dynamics 365 Commerce версии 10.0.10 и более поздних, входящие и исходящие операции в POS-терминале заменяют операцию комплектации и приемки.

> [!NOTE]
> В версии 10.0.10 и выше все новые возможности в приложении POS, которые связаны с приемкой запасов магазина по отношению к заказам на покупку и заказам на перемещение, будут добавлены во входящую операцию операций. Если в настоящее время используется операция комплектации и приемки в POS-терминале, рекомендуется разработать стратегию для перемещения из этой операции в новые входящие и исходящие операции. Несмотря на то что операция комплектации и приемки не будет удалена из продукта, в ней не будет других инвестиций, с точки зрения функциональности или производительности в версии старше 10.0.9.

## <a name="prerequisite-configure-an-asynchronous-document-framework"></a>Необходимое условие: настройка асинхронной структуры документов

Исходящая операция включает в себя повышение производительности, чтобы гарантировать, что пользователи, имеющие большие объемы разноски прихода во многих магазинах или компаниях, и большие документы запасов могут обрабатывать эти документы в центральном офисе Commerce (HQ) без возникновения проблем со временем ожидания или сбоями. Эти усовершенствования требуют использования асинхронной структуры документов.

Когда используется асинхронная структура документов, можно зафиксировать изменения исходящего документа из POS в центральном офисе Commerce (HQ), а затем перейти к другим задачам, пока обработка в центральном офисе Commerce (HQ) выполняется в фоновом режиме. Чтобы убедиться в успешности разноски, можно проверить статус документа на странице списка документов **Исходящая операция** в POS. В приложении POS можно также использовать список активных документов для исходящей операции, чтобы просмотреть документы, которые не могут быть разнесены в центральном офисе Commerce (HQ). В случае сбоя документа пользователи POS могут внести изменения в него, а затем повторить попытку его обработки в центральном офисе Commerce (HQ).

> [!IMPORTANT]
> Необходимо настроить асинхронную структуру документов до того, как компания попытается использовать исходящую операцию в POS.

Чтобы настроить асинхронную структуру документов, выполните следующие процедуры.

### <a name="create-and-configure-a-number-sequence"></a>Создание и настройка номерной серии

1. Перейдите в раздел **Администрирование организации \> Номерные серии \> Номерные серии**.
2. На странице **Номерные серии** создайте номерную серию.
3. В полях **Код номерной серии** и **Имя** введите значения, определяемые пользователем.
4. На экспресс- вкладке **Ссылки** выберите **Добавить**.
5. В поле **Область** выберите **Параметры Commerce**.
6. В поле **Ссылка** выберите **Идентификатор операции розничного документа**.
7. На экспресс-вкладке **Общие сведения** в разделе **Настройка** установите для параметра **Непрерывная** значение **Нет**, чтобы избежать неполадок, связанных с производительностью.

### <a name="create-and-schedule-two-batch-jobs-for-the-document-processing-and-monitoring-tasks"></a>Создайте и запланируйте два пакетных задания для задач обработки и отслеживания документов

> [!NOTE]
> В Commerce версии 10.0.13 и более поздних версий нет необходимости настраивать пакетные задания через структуру пакетного задания. Пакетные процессы можно настроить в меню **Retail и Commerce > ИТ Retail и Commerce**. Используйте параметры меню **Монитор операций с документами Retail** и **Обработка операций с документами Retail** для настройки пакетных заданий

Создаваемые пакетные задания будут использоваться для обработки документов со сбоем или превышением времени ожидания. Они также будут использоваться, когда число активных документов запасов, обрабатываемых из POS, превышает значение, заданное системой.

1. Перейдите в раздел **Администрирование системы \> Запросы \> Пакетные задания**.
2. На странице **Пакетное задание** создайте два пакетных задания:

    - Настройка одного задания для выполнения класса **RetailDocumentOperationMonitorBatch**.
    - Настройка другого задания для выполнения класса **RetailDocumentOperationProcessingBatch**.

3. Планирование новых пакетных заданий для запуска на повторяющейся основе. Например, настройте план так, чтобы задания выполнялись каждые пять минут.

## <a name="prerequisite-add-outbound-operation-to-the-pos-screen-layout"></a>Необходимое условие: добавление исходящей операции в макет экрана POS

Прежде чем организация сможет использовать функцию исходящей операции, она должна настроить операцию POS **Исходящая операция** в одном или нескольких [макетах экрана POS](https://docs.microsoft.com/dynamics365/unified-operations/retail/pos-screen-layouts). Перед развертыванием новой операции в производственной среде необходимо тщательно проверить ее и обучить пользователей, чтобы использовать ее.

## <a name="overview"></a>Обзор

Исходящая операция позволяет пользователям POS выполнять следующие задачи:

- Разносить отгрузки по документам заказов на перемещение в тех случаях, когда магазин пользователя является назначенным складом отгрузки.
- Просмотр сведений об исторических отгрузках по заказу на перемещение, разнесенных магазином.
- Создание новых исходящих запросов на заказы на перемещение.

Когда исходящая операция запускается из приложения POS, появляется представление страницы списка. В этом представлении отображаются открытые документы заказов на перемещение, для которых имеются строки запасов, которые текущий магазин пользователя предполагает отгрузить и выполнить. Чтобы найти нужный документ, пользователи могут прокручивать список или использовать функцию поиска.

В списке исходящих документов запасов имеется три вкладки.

- **Активно** — на этой вкладке отображаются заказы на перемещение, имеющие статус **Запрошено** или **Частично отгружено**. Заказы содержат строки или количества по строкам, которые должны быть отгружены текущим магазином пользователя. Кроме того, на этой вкладке отображаются заказы, имеющие статус **обработка в HQ** (то есть они ожидают подтверждения успешной разноски из центрального офиса Commerce (HQ)), или **Сбой обработки** (то есть разноска в центральном офисе Commerce (HQ) завершилась неудачно, и пользователь должен исправить данные и повторить попытку отправки заказов).
- **Черновик** — на этой вкладке отображаются новые исходящие запросы на заказы на перемещение, созданные магазином данного пользователя. Однако эти документы были сохранены только локально. Они еще не отправлены в центральный офис Commerce (HQ) для обработки.
- **Завершение** — на этой вкладке отображается список документов по заказам на перемещение, которые в магазине полностью отгружены за последние семь дней. Эта вкладка предназначена только для информационных целей. Вся информация о документах — это данные для магазина, доступные только для чтения.

При просмотре документов на любой из вкладок поле **статус** помогает понять этап, на котором находится документ.

- **Черновик** — документ заказа на перемещение был сохранен только локально в базе данных канала магазина. Нет информации о запросе на перемещение, который еще не отправлен в центральный офис Commerce (HQ).
- **Запрошено** — заказ на покупку или заказ на перемещение был создан в центральном офисе Commerce (HQ) и полностью открыт. Текущий магазин пользователя еще не обработал отгрузки в отношении документа.
- **Частично отгружено** — документ заказа на перемещение содержит одну или несколько строк или частичных количеств для строки, которые были разнесены как отгруженные складом отгрузки. Эти отгруженные строки доступны для получения через входящую операцию.
- **Полностью отгружено** — заказ на перемещение содержал все строки и все количества строк, разнесенные как отгруженные складом отгрузки.
- **В обработке** — этот статус используется, чтобы уведомить пользователей устройства о том, что документ активно обрабатывается другим пользователем.
- **Приостановлено** — этот статус отображается после выбора **Приостановить получение** для временной остановки процесса получения.
- **Обработка в HQ** — документ был отправлен в центральном офисе Commerce (HQ) из приложения POS, но еще не был успешно разнесен в центральном офисе Commerce (HQ). Документ проходит через асинхронный процесс разноски документа. После успешного разноски документа в центральном офисе Commerce (HQ) его статус должно быть обновлено до **Получено полностью** или **Частично получено**.
- **Сбой обработки** — документ был разнесен в центральном офисе Commerce (HQ) и отклонен. В области **Подробно** отображается причина сбоя разноски. Документ необходимо изменить для исправления ошибок данных, а затем он должен быть повторно отправлен в центральный офис Commerce (HQ) для обработки.

При выборе строки документа в списке отображается область **Подробно**. В этой области отображаются дополнительные сведения о документе, например сведения о отгрузке и дате отгрузки. Индикатор выполнения показывает, сколько номенклатур все еще необходимо обработать. Если документ не был успешно обработан в центральном офисе Commerce (HQ), в области **Подробно** также отображаются сообщения об ошибках, имеющие отношение к этому сбою.

В представлении страницы списка документов можно выбрать **Сведения о заказе** на панели приложения, чтобы просмотреть сведения о документе. Можно также активировать обработку чеков в соответствующих строках документа.

В представлении страницы списка документов можно также создать новый исходящий заказ на перемещение для магазина.

## <a name="transfer-order-shipping-process"></a>Процесс отгрузки заказа на перемещение

После выбора документа заказа на перемещение на вкладке **Активный** можно выбрать **Сведения о заказе**, чтобы начать процесс выполнения. Появится представление **Список полного заказа**. На этой странице отображаются все строки документа, содержащие эту номенклатуру. На ней также отображаются подробные сведения о заказанном количестве.

Каждое сканирование штрих-кода обновляет количество в поле **Отгрузить** на одну единицу. Можно также ввести количество отгрузки, выбрав пункт **Отгрузить продукт** на панели приложения, ввести код номенклатуры, а затем ввести количество. Если номенклатура управляется местоположением, можно подтвердить или задать место отгрузки для строки документа.

В списке **Список полного заказа** можно вручную выбрать строку в списке и затем обновить количество **Отгрузить** для выбранной строки в области **Подробно**.

### <a name="over-delivery-shipping-validations"></a>Проверки отгрузки перепоставки

Проверки выполняются в процессе получения для строк документа. Они включают проверки на перепоставку. Если пользователь пытается получить больше запасов, чем было заказано в заказе на покупку, но либо перепоставка не настроена, либо полученное количество превышает допуск по перепоставке, настроенный для строки заказа на покупку, пользователь получает сообщение об ошибке и не может получить избыточное количество.

### <a name="underdelivery-close-lines"></a>Строки закрытия недопоставки

В Commerce версии 10.0.12 была добавлена функция, которая позволяет пользователям POS-терминалов закрывать или отменять оставшиеся количества при отгрузке исходящих заказов, если склад отгрузки определяет, что он не может отгружать все запрошенное количество. Количества могут быть также закрыты или отменены позже. Чтобы использовать эту возможность, компания должна быть настроена таким образом, чтобы допускать недопоставки заказов на перемещение. Кроме того, в строке заказа на перемещение должен быть определен процент недопоставки.

Чтобы настроить компанию для разрешения недопоставки заказов на перемещение в центральный офис Commerce (HQ), перейдите на **Управление запасами \> Настройка \> Параметры модуля "Управление запасами и складами"**. На странице **Параметры модуля "Управление запасами и складами"** на вкладке **заказы на перемещение** включите параметр **Допускается недопоставка**. Затем выполните задание планировщика распределения **1070**, чтобы синхронизировать изменения параметров с каналом магазина.

Процент недопоставки для строки заказа на перемещение может быть предопределенным для продуктов как часть конфигурации продукта в модуле Commerce Headquarters. Кроме того, они могут быть установлены или переписаны в конкретной строке заказа на перемещение через центральный офис Commerce (HQ).

После того, как организация закончила настройку недопоставки заказа на перемещение, пользователи POS увидят новый параметр **Закрыть оставшееся количество** в области **Подробно** при выборе строки исходящего заказа на перемещение посредством операции функции **Исходящая операция**. Когда пользователи завершают отгрузку с помощью операции **Завершить выполнение**, они могут отправить запрос в центральный офис Commerce (HQ), чтобы отменить оставшееся неотгруженное количество. Если пользователь закрывает оставшегося количества, Commerce выполняет проверку того, что количество, которое было отменено, попадает в допуск процента недопоставки, определенный в строке заказа на перемещение. При превышении допуска недопоставки пользователь получает сообщение об ошибке и не может закрыть оставшееся количество до тех пор, пока ранее отгруженное количество или количество "Отгрузить сейчас" не будут соответствовать или превышать допуск недопоставки.

После синхронизации отгрузки с центральным офисом Commerce (HQ) количества, указанные в поле **Отгрузить сейчас** в строке заказа на перемещение в POS, будут обновлены до статуса отгружено в центральный офис Commerce (HQ). Все неотгруженные количества, которые ранее были бы рассмотрены как "Осталось для отгрузки" количества (то есть количества, которые будут отгружены позже) вместо этого рассматриваются как отмененные количества. Количество "Осталось для отгрузки" для строки заказа на перемещение устанавливается равным **0** (нулю), а строка считается полностью отгруженной.

### <a name="shipping-location-controlled-items"></a>Отгрузка номенклатур, управляемых местоположением

Если номенклатуры, для которых выполняется отгрузка, управляются местоположением, пользователи могут выбрать местоположение, из которого они хотят отгрузить запасы в процессе отгрузки. Рекомендуется настроить местоположение отгрузки по умолчанию для склада магазина, чтобы повысить эффективность этого процесса. Даже если настроено местоположение по умолчанию, пользователи могут переопределить местоположение отгрузки для выбранных строк по мере необходимости.

Операция учитывает конфигурацию **Пропуск для приходов** в аналитике хранения **Местоположение** и не требует ввода аналитики местоположения, если настроен пропуск для приходов. Если для номенклатуры не разрешается использовать приходы без указания места, приложение POS показывает ошибку и требует, чтобы местоположение было введено до того, как поступление будет разнесено.

### <a name="ship-all"></a>Отгрузить все

По мере необходимости можно выбрать **Отгрузить все** на панели приложения для быстрого обновления количества **Отгрузить** по всем строкам документа до максимального значения, доступного для этих строк.

### <a name="cancel-fulfillment"></a>Отменить выполнение

Функция **Отмена выполнения** должна использоваться на панели приложения только в том случае, если требуется выйти из документа и не требуется сохранять какие-либо изменения. Например, в первоначальном состоянии был выбран неправильный документ и не требуется сохранять предыдущие данные отгрузки.

### <a name="pause-fulfillment"></a>Приостановить выполнение

Если вы выполняете заказ на перемещение, вы можете использовать функцию **Приостановить выполнение**, если хотите сделать перерыв в процессе. Например, может потребоваться выполнить другую операцию из POS, например, зарегистрировать продажу клиенту или отложить разноску отгрузки в центральный офис Commerce (HQ).

При выборе **Приостановить выполнение**, статус документа изменится на **Приостановлено**. Поэтому пользователь будет знать, что в документ были введены данные, но документ еще не был подтвержден. Когда вы будете готовы возобновить процесс выполнения, выберите приостановленный документ, а затем выберите **Сведения о заказе**. Все количества **Отгрузить**, которые были ранее сохранены, будут удержаны, и их можно будет просмотреть в представлении **Список полного заказа**.

### <a name="review"></a>Проверить

Перед окончательным обязательством выполнения в центральном офисе Commerce можно использовать функцию **Оценка** для проверки исходящего документа. Функция предупреждает о возможных отсутствующих или неправильных данные, которые могут привести к сбою обработки и предоставить вам возможность устранения ошибок перед отправкой запроса выполнения. Чтобы включить функцию **Оценка** на панели приложений, включите функцию **Включить проверку во входящих и исходящих операциях запасов POS** в рабочей области Управление функциями в центральном офисе Commerce (HQ).

Функция **Оценка** проверяет следующие ошибки в исходящем документе:
- **Избыточная отгрузка** — количество по отгрузке превышает заказанное количество. Уровень серьезности данной ошибки определяется конфигурацией перепоставки в центральном офисе Commerce (HQ).
- **Недостаточная отгрузка** — количество по отгрузке меньше заказанного количества. Уровень серьезности данной ошибки определяется конфигурацией недопоставки в центральном офисе Commerce (HQ).
- **Серийный номер** — серийный номер не предоставляется или недоступен для сериализованной номенклатуры, для которой требуется регистрация серийного номера в запасах.
- **Местоположение не задано** — местоположение не указано для номенклатуры, контролируемой местоположением, когда пустое местоположение не разрешено.
- **Удаленные строки** — в заказе есть строки, удаленные пользователем центрального офиса Commerce (HQ), который неизвестен для POS-приложения.

Если для параметра **Включить автоматическую проверку** установлено значение **Да** в **Параметры Commerce** > **Запасы** > **Операции с запасами магазина**, проверка выполняется автоматически, когда выбрана функция **Завершить выполнение**.

### <a name="finish-fulfillment"></a>Завершить выполнение

После ввода всех количеств **Отгрузить** для продуктов необходимо выбрать **Завершить выполнение** на панели приложений.

При использовании асинхронной обработки документов приходная накладная отправляется через асинхронную структуру документов. Время, необходимое для разноски документа, зависит от размера документа (количества строк) и от общего трафика обработки, происходящего на сервере. Обычно этот процесс происходит в считанные секунды. Если разноска документа проходит неудачно, пользователь получает уведомление по списку **Исходящая операция** на вкладке **Активный**, в которой статус документа будет обновлен на **Сбой обработки**. После этого пользователь может выбрать документ со сбоем в POS для просмотра сообщений об ошибках и причине сбоя в области **Подробно**. Документ со сбоем остается неразнесенным и требует, чтобы пользователь вернулся в строки документа, выбрав **Сведения о заказе** в POS. Затем пользователь должен обновить документ с учетом корректировок на основе ошибок. После исправления документа пользователь может повторить попытку его обработки, выбрав **Завершить выполнение** на панели приложения.

## <a name="create-an-outbound-transfer-order"></a>Создание исходящего заказа на перемещение

Из POS пользователи могут создавать новые документы заказов на перемещение. Чтобы начать процесс, выберите **Создать** на панели приложения, когда вы находитесь в главном списке документов **Исходящая операция**. После этого будет предложено выбрать **Переместить в** склад или магазин, в который текущий магазин будет отправлять запасы. Значения ограничиваются выбором, определенным в конфигурации группы выполнения магазина. В исходящем запросе на перемещение текущий магазин всегда будет складом **Переместить из** для заказа на перемещение. Это значение не может быть изменено.

Можно ввести значения в поля **Дата отгрузки**, **Дата получения** и **Способ поставки**. Можно также добавить примечание, которое будет храниться вместе с заголовком заказа на перемещение в виде вложения в документ в центральный офис Commerce (HQ).

После создания информации заголовка можно добавлять продукты в заказ на перемещение. Чтобы начать процесс добавления номенклатур и запрошенных количеств, отсканируйте штрих-коды или выберите **Добавить продукт**.

После ввода строк в исходящий заказ на перемещение необходимо выбрать **Сохранить**, чтобы сохранить изменения в документе локально, или **Отправить запрос**, чтобы отправить сведения о заказе в центральный офис Commerce (HQ) для дальнейшей обработки. Если выбрано значение **Сохранить**, черновик документа сохраняется в базе данных канала, а склад отгрузки не может выполнить документ до тех пор, пока он не будет успешно обработан с помощью **Отправить запрос**. Выберите **Сохранить** только в том случае, если вы не готовы зафиксировать запрос в центральный офис Commerce (HQ) для обработки.

Если документ сохраняется локально, он может быть найден на вкладке **черновики** в списке документов **Входящая операция**. Если документ имеет статус **Черновик**, его можно изменить, выбрав **Изменить**. Можно обновить, добавить или удалить строки по мере необходимости. Кроме того, можно удалить весь документ, пока он находится в статусе **черновика** , выбрав **Удалить** на вкладке **Черновики**.

После успешной отправки черновика в центральный офис Commerce (HQ) он отображается на вкладке **Активный** и имеет статус **Запрошено**. В этот момент только пользователи на складе отгрузки могут редактировать документ путем выбора **исходящей операции** в приложении POS. Пользователи на складе приемки могут просмотреть заказ на перемещение на вкладке **Активный** списка документов **Входящая операция**, но они не могут редактировать или удалять их. Блокировка редактирования позволяет избежать возникновения конфликтов, поскольку принимающий инициатор запроса изменяет заказ на перемещение одновременно с тем, как грузоотправитель комплектует и отгружает заказ. Если после отправки заказа на перемещение изменения необходимо выполнить из магазина или склада приемки, необходимо связаться с грузоотправителем и запросить ввести изменения.

После того, как документ будет иметь статус **Запрошено**, он готов для обработки на складе отгрузки. Когда отгрузка обрабатывается с использованием исходящей операции, статус документов заказов на перемещение обновляется с **Запрошено** на **Полностью отгружено** или **Частично отгружено**. После того, как документы будут иметь статус **Полностью отгружено** или **Частично отгружено**, магазин или склад приемки могут разносить приходы по ним, используя процесс получения входящей операции.

Заказы на перемещение с полной отгрузкой переносятся на вкладку **Завершено** списка документов **Исходящая операция**. Там они остаются видимыми для пользователей в магазине или складе приемки в режиме только для чтения, в течение семи дней.

## <a name="related-topics"></a>Связанные разделы

[Входящая операция с запасами в POS](pos-inbound-inventory-operation.md)
