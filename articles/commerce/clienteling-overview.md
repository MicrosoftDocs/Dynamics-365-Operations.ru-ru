---
title: Обзор отношений с клиентами
description: В этом разделе представлен обзор новых возможностей отношений с клиентами, доступных в приложении магазина.
author: bebeale
ms.date: 02/01/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: josaw
ms.custom: 260624
ms.assetid: a4f9d315-9951-451c-8ee6-37f9b3b15ef0
ms.search.region: global
ms.search.industry: Retail
ms.author: shajain
ms.search.validFrom: 2018-10-01
ms.dyn365.ops.version: Version 10.0.7
ms.openlocfilehash: b680ec227ecd70893999950a8be2ad152c476575
ms.sourcegitcommit: 9eadc7ca08e2db3fd208f5fc835551abe9d06dc8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2021
ms.locfileid: "5937020"
---
# <a name="clienteling-overview"></a><span data-ttu-id="367cc-103">Обзор отношений с клиентами</span><span class="sxs-lookup"><span data-stu-id="367cc-103">Clienteling overview</span></span>

[!include [banner](includes/banner.md)]


<span data-ttu-id="367cc-104">Многие розничные предприятия, особенно высококачественные розничные продавцы, хотят, чтобы консультанты обеспечивали долгосрочные торговые отношения с ключевыми клиентами.</span><span class="sxs-lookup"><span data-stu-id="367cc-104">Many retailers, especially high-end specialty retailers, want their sales associates to form long-term relationships with their key customers.</span></span> <span data-ttu-id="367cc-105">Предполагается, что консультанты должны знать о предпочтениях и отрицательном отношении своих клиентов, знать об истории покупок, предпочитаемых продуктах и важных датах, таких как годовщины и дни рождения.</span><span class="sxs-lookup"><span data-stu-id="367cc-105">The associates are expected to know about these customers' likes and dislikes, purchase history, product preferences, and important dates, such as anniversaries and birthdays.</span></span> <span data-ttu-id="367cc-106">Консультантам требуется место, где они могут получить эту информацию и при необходимости легко ее найти.</span><span class="sxs-lookup"><span data-stu-id="367cc-106">Associates need a place where they can capture this information and easily find it when it's required.</span></span> <span data-ttu-id="367cc-107">Если эти сведения доступны в едином представлении, консультанты могут легко ориентироваться на клиентов, соответствующих определенным критериям.</span><span class="sxs-lookup"><span data-stu-id="367cc-107">If this information is available in a single view, the associates can easily target customers who meet specific criteria.</span></span> <span data-ttu-id="367cc-108">Например, они могут найти всех клиентов, которые предпочитают покупать сумки или клиентов с важным событием, например, днем рождения или годовщиной.</span><span class="sxs-lookup"><span data-stu-id="367cc-108">For example, they can find all customers who prefer to shop for handbags, or customers who have an important event approaching, such as a birthday or anniversary.</span></span>

## <a name="client-book"></a><span data-ttu-id="367cc-109">Книга клиентов</span><span class="sxs-lookup"><span data-stu-id="367cc-109">Client book</span></span>

<span data-ttu-id="367cc-110">В Microsoft Dynamics 365 Commerce розничные предприятия могут использовать функцию клиентской книги, чтобы консультанты смогли сформировать долгосрочные отношения с основными клиентами.</span><span class="sxs-lookup"><span data-stu-id="367cc-110">In Microsoft Dynamics 365 Commerce, retailers can use the client book functionality to help store associates form long-term relationships with key customers.</span></span>

<span data-ttu-id="367cc-111">Клиентская книга включает карты клиентов с контактной информацией по каждому клиенту, вместе с тремя дополнительными свойствами, которые определены розничным продавцом и настроены в Headquarters.</span><span class="sxs-lookup"><span data-stu-id="367cc-111">The client book includes customer cards that show contact information for each customer, together with three more properties that are defined by the retailer and configured in Headquarters.</span></span> <span data-ttu-id="367cc-112">Розничные продавцы могут определить три наиболее важные вещи, которые должны быть известны продавцам-консультантам о клиентах.</span><span class="sxs-lookup"><span data-stu-id="367cc-112">Retailers can decide the three most important things that sales associates should know about customers.</span></span> <span data-ttu-id="367cc-113">Например, розничному продавцу ювелирных изделий может потребоваться включить важные даты, такие как годовщины или дни рождения, так как в эти даты люди покупают больше товаров.</span><span class="sxs-lookup"><span data-stu-id="367cc-113">For example, a jewelry retailer might want to include important dates such as anniversaries or birthdays, because these dates are occasions when people might buy more jewelry.</span></span> <span data-ttu-id="367cc-114">Аналогичным образом розничный продавец может попытаться включить предпочитаемые интересы и торговые марки клиента.</span><span class="sxs-lookup"><span data-stu-id="367cc-114">Similarly, a fashion retailer might want to include the customer's preferred shopping interests and brands.</span></span>

<span data-ttu-id="367cc-115">Кроме того, в клиентской книге можно отфильтровать список, чтобы отображались только клиенты, соответствующие определенным критериям.</span><span class="sxs-lookup"><span data-stu-id="367cc-115">The client book also lets sale associates filter the list so that it shows only customers who meet specific criteria.</span></span> <span data-ttu-id="367cc-116">Например, в магазин поступила новая коллекция мужской обуви, и продавец-консультант хочет сообщить клиентам, которые захотят купить мужскую обувь.</span><span class="sxs-lookup"><span data-stu-id="367cc-116">For example, a new collection of shoes has arrived in the store, and an associate wants to inform customers who like to buy shoes.</span></span> <span data-ttu-id="367cc-117">В этом случае продавец-консультант может отфильтровать клиентскую книгу, чтобы найти соответствующих клиентов, а затем предпринять дальнейшие действия.</span><span class="sxs-lookup"><span data-stu-id="367cc-117">In this case, the associate can filter the client book to find the relevant customers and then take further action.</span></span>

<span data-ttu-id="367cc-118">Если клиенты больше не считаются ключевыми клиентами по какой-либо причине и поэтому не нуждаются в тесном управлении, они могут быть удалены из клиентской книги.</span><span class="sxs-lookup"><span data-stu-id="367cc-118">If any customers are no longer considered key customers for some reason, and therefore should not be closely managed, sales associates can remove them from their client book.</span></span>

<span data-ttu-id="367cc-119">Некоторые розничные предприятия не хотят управлять клиентами на уровне продавца-консультанта.</span><span class="sxs-lookup"><span data-stu-id="367cc-119">Some retailers don't want to manage customers at the sales associate level.</span></span> <span data-ttu-id="367cc-120">Вместо этого они хотят управлять списком ключевых клиентов на уровне магазина.</span><span class="sxs-lookup"><span data-stu-id="367cc-120">Instead, they want to manage a list of key customers at the store level.</span></span> <span data-ttu-id="367cc-121">Эти розничные продавцы могут просматривать клиентов из книг клиентов магазина.</span><span class="sxs-lookup"><span data-stu-id="367cc-121">These retailers can view customers from store client books.</span></span> <span data-ttu-id="367cc-122">Используя этот параметр, розничные продавцы могут просматривать клиентов из книг клиентов всех торговых партнеров, адресная книга которых совпадает с адресной книгой текущего магазина.</span><span class="sxs-lookup"><span data-stu-id="367cc-122">By using this option, retailers can view the customers from the client books of all the sales associates whose address book matches the address book of the current store.</span></span> <span data-ttu-id="367cc-123">Таким образом, если продавец-консультант работает в нескольких магазинах юридического лица, в клиентской книге отображаются клиенты из всех этих магазинов.</span><span class="sxs-lookup"><span data-stu-id="367cc-123">In this way, if an associate works in multiple stores of the legal entity, the client book shows the customers from all those stores.</span></span> <span data-ttu-id="367cc-124">Эта функция поддерживает дополнительные возможности.</span><span class="sxs-lookup"><span data-stu-id="367cc-124">This functionality supports additional capabilities.</span></span> <span data-ttu-id="367cc-125">Например, клиенты могут быть переназначены от одного продавца-консультанта другому.</span><span class="sxs-lookup"><span data-stu-id="367cc-125">For example, customers can be reassigned from one associate to another associate.</span></span> <span data-ttu-id="367cc-126">Эта возможность полезна, когда продавец-консультант переходит на другое место в организации или покидает организацию.</span><span class="sxs-lookup"><span data-stu-id="367cc-126">This capability is useful when associates are transferred or leave the company.</span></span>

<span data-ttu-id="367cc-127">У каждого продавца-консультанта может быть одна клиентскую книгу для одного юридического лица, и продавец-консультант может добавить одного или нескольких клиентов в свою клиентскую книгу.</span><span class="sxs-lookup"><span data-stu-id="367cc-127">Each sales associate can have one client book per legal entity, and associates can add one or more customers to their client book.</span></span> <span data-ttu-id="367cc-128">В Commerce в настоящее время каждый клиент может быть добавлен только в одну клиентскую книгу.</span><span class="sxs-lookup"><span data-stu-id="367cc-128">In Commerce, each customer can currently be added to only one client book.</span></span> <span data-ttu-id="367cc-129">Однако корпорация Майкрософт планирует добавить функции, позволяющие добавлять одного клиента в несколько клиентских книг.</span><span class="sxs-lookup"><span data-stu-id="367cc-129">However, Microsoft plans to add functionality that lets a single customer be added to multiple client books.</span></span>

> [!NOTE]
> <span data-ttu-id="367cc-130">В отличие от поиска клиентов клиентская книга не фильтрует записи клиентов на основе адресных книг магазина</span><span class="sxs-lookup"><span data-stu-id="367cc-130">Unlike customer search, the client book doesn't filter customer records based on the store's address books.</span></span>

## <a name="activities-and-notes"></a><span data-ttu-id="367cc-131">Мероприятия и заметки</span><span class="sxs-lookup"><span data-stu-id="367cc-131">Activities and notes</span></span>

<span data-ttu-id="367cc-132">Интерактивные каналы предоставляют розничным компаниям способы изучения предпочтений клиента без необходимости их явного указания пользователями.</span><span class="sxs-lookup"><span data-stu-id="367cc-132">Online channels give retailers ways to learn about customer preferences without requiring that customers explicitly provide this information.</span></span> <span data-ttu-id="367cc-133">Наоборот, когда клиенты взаимодействуют с продавцами-консультантами в магазине, они явно передают информацию о своих предпочтениях.</span><span class="sxs-lookup"><span data-stu-id="367cc-133">By contrast, when customers interact with sales associates in the store, they explicitly share information about their preferences.</span></span> <span data-ttu-id="367cc-134">К сожалению, эту информацию можно потерять после завершения продажи.</span><span class="sxs-lookup"><span data-stu-id="367cc-134">Unfortunately, this information can be lost after the sale is over.</span></span> <span data-ttu-id="367cc-135">Однако если эти сведения записаны, они могут помочь предприятиям розничной торговли лучше понимать клиентов и, таким образом, помочь им в обеспечении лучших рекомендаций и улучшению общего опыта покупок.</span><span class="sxs-lookup"><span data-stu-id="367cc-135">However, if this information is recorded, it can help retailers better understand customers, and therefore help them provide better recommendations and a better overall shopping experience.</span></span>

<span data-ttu-id="367cc-136">Чтобы получить важную информацию, которой делятся клиенты, продавцы-консультанты могут использовать не только атрибуты клиентской книги, но также и функциональные возможности мероприятий и заметок.</span><span class="sxs-lookup"><span data-stu-id="367cc-136">To capture the critical information that customers share, sales associates can use not only the client book attributes, but also use the activities and notes functionality.</span></span> <span data-ttu-id="367cc-137">Розничные продавцы могут настраивать типы мероприятий, такие как сведения о посещении магазина, адрес электронной почты, номер телефона и встречи.</span><span class="sxs-lookup"><span data-stu-id="367cc-137">Retailers can configure the activity types, such as information about the store visit, email address, phone number, and appointments.</span></span> <span data-ttu-id="367cc-138">Мероприятия, которые создают продавцы-консультанты, можно просматривать в виде временной шкалы в POS-терминале.</span><span class="sxs-lookup"><span data-stu-id="367cc-138">Activities that associates create can be viewed in a timeline format at the point of sale (POS).</span></span> <span data-ttu-id="367cc-139">Их можно также просмотреть на вкладке **Мероприятия** на странице **Все клиенты \> Общее** в Headquarters.</span><span class="sxs-lookup"><span data-stu-id="367cc-139">They can also be viewed on the **Activities** tab on the **All customers \> General** page in Headquarters.</span></span>

<span data-ttu-id="367cc-140">Продавцы-консультанты могут также использовать заметки для записи общих сведений о клиенте, которые можно просмотреть перед каждым взаимодействием.</span><span class="sxs-lookup"><span data-stu-id="367cc-140">Sales associates can also use notes to capture generic customer information that can be referenced before every interaction.</span></span> <span data-ttu-id="367cc-141">Эти заметки сохраняются в Headquarters, и их можно просмотреть в профиле клиента или на странице сведений о клиенте в центре обработки вызовов.</span><span class="sxs-lookup"><span data-stu-id="367cc-141">These notes are saved in Headquarters, and can be viewed in the customer profile or on the customer details page in the call center.</span></span>

> [!NOTE]
> <span data-ttu-id="367cc-142">В настоящее время все заметки и мероприятия можно просматривать по любому продавцу-консультанту, работающему для юридического лица, и можно просматривать страницы сведений о клиенте.</span><span class="sxs-lookup"><span data-stu-id="367cc-142">Currently, all notes and activities can be viewed by any sales associate who works for the legal entity and can view customer details pages.</span></span> <span data-ttu-id="367cc-143">Заметки и мероприятия не ограничиваются продавцом-консультантом, который добавил клиента в клиентскую книгу.</span><span class="sxs-lookup"><span data-stu-id="367cc-143">Notes and activities aren't limited to the associate who added a customer to the client book.</span></span>

## <a name="integration-with-dynamics-365-customer-insights"></a><span data-ttu-id="367cc-144">Интеграция с Dynamics 365 Customer Insights</span><span class="sxs-lookup"><span data-stu-id="367cc-144">Integration with Dynamics 365 Customer Insights</span></span>

<span data-ttu-id="367cc-145">С помощью приложения Dynamics 365 Customer Insights розничные предприятия могут агрегировать данные из различных систем, которые клиенты используют для взаимодействия с торговой маркой розничной торговли.</span><span class="sxs-lookup"><span data-stu-id="367cc-145">By using the Dynamics 365 Customer Insights application, retailers can aggregate data from the various systems that customers use to interact with the retailer's brand.</span></span> <span data-ttu-id="367cc-146">Затем они могут использовать эти данные для создания единого представления клиента и получения аналитической информации.</span><span class="sxs-lookup"><span data-stu-id="367cc-146">They can then use this data to generate a single view of the customer and derive insights.</span></span> <span data-ttu-id="367cc-147">Интеграция Customer Insights с модулем Commerce позволяет розничным продавцам выбирать один или несколько способов, которые должны отображаться в карточке клиента в клиентской книге.</span><span class="sxs-lookup"><span data-stu-id="367cc-147">The integration of Customer Insights with Commerce lets retailers select one or more measures that should be shown on the customer card in the client book.</span></span> <span data-ttu-id="367cc-148">Например, розничные предприятия могут использовать данные в Customer Insights для расчета "вероятности оттока клиентов" для клиента и определить "следующее наилучшее действие".</span><span class="sxs-lookup"><span data-stu-id="367cc-148">For example, retailers can use the data in Customer Insights to calculate the "churn probability" for a customer and define the "next best action."</span></span> <span data-ttu-id="367cc-149">Если эти значения определены как меры, они могут отображаться в карточке клиента и могут предоставлять важную информацию для торговых партнеров.</span><span class="sxs-lookup"><span data-stu-id="367cc-149">If these values are defined as measures, they can be shown on the customer card and can provide crucial information to sales associates.</span></span> <span data-ttu-id="367cc-150">Дополнительные сведения о Customer Insights см. в разделе Документация по [Dynamics 365 Customer Insights](/dynamics365/ai/customer-insights/overview).</span><span class="sxs-lookup"><span data-stu-id="367cc-150">For more information about Customer Insights, see the [Dynamics 365 Customer Insights](/dynamics365/ai/customer-insights/overview) documentation.</span></span> <span data-ttu-id="367cc-151">Дополнительные сведения о мерах см. в разделе [Меры](/dynamics365/ai/customer-insights/pm-measures).</span><span class="sxs-lookup"><span data-stu-id="367cc-151">For more information about measures, see [Measures](/dynamics365/ai/customer-insights/pm-measures).</span></span>

## <a name="set-up-clienteling"></a><span data-ttu-id="367cc-152">Настройка отношений с клиентом</span><span class="sxs-lookup"><span data-stu-id="367cc-152">Set up clienteling</span></span>

<span data-ttu-id="367cc-153">Чтобы включить функцию отношений с клиентами в своей среде, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="367cc-153">To turn on the clienteling functionality in your environment, follow these steps.</span></span>

1. <span data-ttu-id="367cc-154">В рабочей области **Управление функциями** отфильтруйте функции модуля **Розничная торговля и коммерция**.</span><span class="sxs-lookup"><span data-stu-id="367cc-154">In the **Feature management** workspace, filter the features by the **Retail and commerce** module.</span></span>

    <span data-ttu-id="367cc-155">![Отношения с клиентам в списке функций модуля Commerce](./media/Enable_clienteling.png "Отношения с клиентам в списке функций модуля &quot;Розничная торговля и коммерция&quot;")</span><span class="sxs-lookup"><span data-stu-id="367cc-155">![Clienteling in the list of features for the Commerce module](./media/Enable_clienteling.png "Clienteling in the list of features for the Retail and commerce module")</span></span>

2. <span data-ttu-id="367cc-156">Включите функцию **Отношения с клиентами**, выбрав **Включить**.</span><span class="sxs-lookup"><span data-stu-id="367cc-156">Turn on the **Clienteling** feature by selecting **Enable now**.</span></span>
3. <span data-ttu-id="367cc-157">На странице **Параметры Commerce** на вкладке **Номерная серия** выберите строку **Идентификатор клиентской книги**.</span><span class="sxs-lookup"><span data-stu-id="367cc-157">On the **Commerce Parameters** page, on the **Number sequence** tab, select the **Client book identifier** row.</span></span> <span data-ttu-id="367cc-158">Затем в поле **Код номерной серии** выберите номерную серию.</span><span class="sxs-lookup"><span data-stu-id="367cc-158">Then, in the **Number sequence code** field, select a number sequence.</span></span> <span data-ttu-id="367cc-159">Система будет использовать эту номерную серию для присвоения кода клиентским книгам.</span><span class="sxs-lookup"><span data-stu-id="367cc-159">The system will use this number sequence to assign an ID to client books.</span></span>
4. <span data-ttu-id="367cc-160">Нажмите **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="367cc-160">Select **Save**.</span></span>
5. <span data-ttu-id="367cc-161">Создайте новую группу атрибутов, которая содержит атрибуты, которые необходимо получить для клиентов, управляемых в клиентских книгах.</span><span class="sxs-lookup"><span data-stu-id="367cc-161">Create a new attribute group that contains the attributes that you want to capture for customers who are managed in client books.</span></span> <span data-ttu-id="367cc-162">Инструкции см. в разделе [Атрибуты и группы атрибутов](./attribute-attributegroups-lifecycle.md).</span><span class="sxs-lookup"><span data-stu-id="367cc-162">For instructions, see [Attributes and attribute groups](./attribute-attributegroups-lifecycle.md).</span></span>

    - <span data-ttu-id="367cc-163">Определите необходимые атрибуты как **Возможно уточнение**.</span><span class="sxs-lookup"><span data-stu-id="367cc-163">Define the required attributes as **Can be refined**.</span></span> <span data-ttu-id="367cc-164">Затем продавцы-консультанты смогут использовать эти атрибуты для фильтрования своей клиентской книги.</span><span class="sxs-lookup"><span data-stu-id="367cc-164">Sales associates can then use these attributes to filter their client book.</span></span>
    - <span data-ttu-id="367cc-165">Настройка порядка отображения этих атрибутов.</span><span class="sxs-lookup"><span data-stu-id="367cc-165">Set the display order for these attributes.</span></span> <span data-ttu-id="367cc-166">Этот порядок отображения определяет, какие атрибуты должны отображаться в карточке клиента в клиентской книге.</span><span class="sxs-lookup"><span data-stu-id="367cc-166">This display order determines which attributes should be shown on the customer card in the client book.</span></span> <span data-ttu-id="367cc-167">Порядок отображения 1 считается выше порядка отображения 2.</span><span class="sxs-lookup"><span data-stu-id="367cc-167">A display order of 1 is considered higher than a display order of 2.</span></span> <span data-ttu-id="367cc-168">Поэтому атрибут с порядком отображения 1 будет показан перед атрибутом с порядком отображения 2.</span><span class="sxs-lookup"><span data-stu-id="367cc-168">Therefore, the attribute that has a display order of 1 will be shown before to the attribute that has a display order of 2.</span></span>

    > [!NOTE]
    > <span data-ttu-id="367cc-169">Можно сделать Customer Insights доступной с той же страницы.</span><span class="sxs-lookup"><span data-stu-id="367cc-169">You can make Customer Insights available from the same page.</span></span> <span data-ttu-id="367cc-170">Однако для аутентификации необходимо создать идентификатор приложения Azure и секрет.</span><span class="sxs-lookup"><span data-stu-id="367cc-170">However, an Azure application ID and secret must be created, for authentication purposes.</span></span> <span data-ttu-id="367cc-171">(Дополнительные сведения о требованиях см. в разделе [Включение интеграции Customer Insights с Commerce](#turn-on-the-integration-of-customer-insights-with-commerce) далее в этом разделе.) Если Customer Insights включено, то при выборе одной или нескольких мер, которые должны отображаться в карточке клиента, эти меры будут показаны первыми.</span><span class="sxs-lookup"><span data-stu-id="367cc-171">(For information about the requirements, see the [Turn on the integration of Customer Insights with Commerce](#turn-on-the-integration-of-customer-insights-with-commerce) section later in this topic.) If Customer Insights is turned on, and you select one or more measures that should be shown on the customer card, those measures will be shown first.</span></span> <span data-ttu-id="367cc-172">Затем на основании порядка отображения будут показаны группы атрибутов клиентской книги.</span><span class="sxs-lookup"><span data-stu-id="367cc-172">Next, client book attribute groups will be shown, based on the display order.</span></span> <span data-ttu-id="367cc-173">Например, если выбрать две меры в Customer Insights, эти две меры и один атрибут клиентской книги будут показаны в карточке клиента.</span><span class="sxs-lookup"><span data-stu-id="367cc-173">For example, if you select two measures from Customer Insights, those two measures and one client book attribute will be shown on the customer card.</span></span> <span data-ttu-id="367cc-174">(Отображаемый атрибут клиентской книги будет атрибутом, имеющим самый высокий порядок отображения.)</span><span class="sxs-lookup"><span data-stu-id="367cc-174">(The client book attribute that is shown will be the attribute that has the highest display order.)</span></span>

6. <span data-ttu-id="367cc-175">На странице **Параметры Commerce** на вкладке **Отношения с клиентами** в поле **Группа атрибутов клиентской книги** выберите только что созданную группу атрибутов.</span><span class="sxs-lookup"><span data-stu-id="367cc-175">On the **Commerce parameters** page, on the **Clienteling** tab, in the **Client book attribute group** field, select the attribute group that you just created.</span></span>

    <span data-ttu-id="367cc-176">![Выбрана группа атрибутов клиентской книги](./media/Client%20book%20attributes.png "Выбрана группа атрибутов клиентской книги")</span><span class="sxs-lookup"><span data-stu-id="367cc-176">![Client book attribute group selected](./media/Client%20book%20attributes.png "Client book attribute group selected")</span></span>

7. <span data-ttu-id="367cc-177">Чтобы получить мероприятия, происходящие на POS-терминале, определите типы мероприятий на странице **Типы мероприятий** (**Retail и Commerce \> Клиенты \> Типы мероприятий**).</span><span class="sxs-lookup"><span data-stu-id="367cc-177">To capture activities that occur at the POS, define the activity types on the **Activity types** page (**Retail and Commerce \> Customers \> Activity types**).</span></span>

    > [!NOTE]
    > <span data-ttu-id="367cc-178">Типы мероприятий извлекаются Commerce Scale Unit при первом вызове в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="367cc-178">Activity types are pulled by the Commerce Scale Unit when it makes a real-time call for the first time.</span></span> <span data-ttu-id="367cc-179">После извлечения мероприятий они кэшируются в течение нескольких часов.</span><span class="sxs-lookup"><span data-stu-id="367cc-179">After the activities are pulled, they are cached for a few hours.</span></span> <span data-ttu-id="367cc-180">При изменении типов действий дождитесь, пока кэш станет недействительным.</span><span class="sxs-lookup"><span data-stu-id="367cc-180">If you change the activity types, wait until the cache is no longer valid.</span></span> <span data-ttu-id="367cc-181">В качестве альтернативы, для непроизводственной среды перезапустите службу Commerce Scale Unit.</span><span class="sxs-lookup"><span data-stu-id="367cc-181">Alternatively, for non-production environments, restart the Commerce Scale Unit service.</span></span>

8. <span data-ttu-id="367cc-182">Добавьте две кнопки на соответствующий макет экрана POS, чтобы продавцы могли просматривать собственную клиентскую книгу и клиентскую книгу магазина.</span><span class="sxs-lookup"><span data-stu-id="367cc-182">Add two buttons to the appropriate POS screen layout, so that sales associates can view their own client book and the store client book.</span></span> <span data-ttu-id="367cc-183">(Храните клиентские книги с клиентами из всех клиентских книг всех продавцов-консультантов с общей адресной книгой с магазином.) Соответствующие операции именуются **Просмотр клиентов в клиентской книге** и **Просмотр клиентов из клиентские книги магазина** соответственно.</span><span class="sxs-lookup"><span data-stu-id="367cc-183">(Store client books include clients from all client books of all associates who share an address book with the store.) The corresponding operations are named **View customers in client book** and **View customers from store client books**, respectively.</span></span> <span data-ttu-id="367cc-184">Доступны три дополнительные операции, которые относятся к клиентской книге.</span><span class="sxs-lookup"><span data-stu-id="367cc-184">Three additional operations that are related to client books are available.</span></span> <span data-ttu-id="367cc-185">Эти операции определяют, какие консультанты могут добавлять, удалять и перераспределять клиентов из клиентской книги.</span><span class="sxs-lookup"><span data-stu-id="367cc-185">These operations determine which associates can add, remove, and reassign customers from the client book.</span></span> <span data-ttu-id="367cc-186">Они называются **Добавить клиента в клиентскую книгу**, **Удалить клиентов из клиентской книги** и **Переназначить клиентов в клиентскую книгу** соответственно.</span><span class="sxs-lookup"><span data-stu-id="367cc-186">They are named **Add customer to client book**, **Remove customers from client book**, and **Reassign customers to a client book**, respectively.</span></span>
9. <span data-ttu-id="367cc-187">Выполните следующие задания планирования распределения: 1040, 1150, 1110 и 1090.</span><span class="sxs-lookup"><span data-stu-id="367cc-187">Run the following distribution schedule jobs: 1040, 1150, 1110, and 1090.</span></span>

<span data-ttu-id="367cc-188">После выполнения этой процедуры с помощью продавцы-консультанты могут открыть страницу сведений о клиенте в POS-терминале и добавить клиентов в клиентскую книгу, просмотреть и записать мероприятия и заметки для клиентов и обратиться к клиентам, используя атрибуты клиента и клиентской книги, чтобы отфильтровать клиентскую книгу.</span><span class="sxs-lookup"><span data-stu-id="367cc-188">After you've completed this procedure, sales associates can open the customer details page at the POS, and add customers to their client book, view and capture activities and notes for customers, and target customers by using customer and client book attributes to filter the client book.</span></span> <span data-ttu-id="367cc-189">Следующая иллюстрация показывает пример клиентской книги.</span><span class="sxs-lookup"><span data-stu-id="367cc-189">The following illustration shows an example of a client book.</span></span>

<span data-ttu-id="367cc-190">![Пример клиентской книги](./media/client_book.png "Пример клиентской книги")</span><span class="sxs-lookup"><span data-stu-id="367cc-190">![Example of a client book](./media/client_book.png "Example of a client book")</span></span>

## <a name="turn-on-the-integration-of-customer-insights-with-commerce"></a><span data-ttu-id="367cc-191">Включите интеграцию Customer Insights с Commerce</span><span class="sxs-lookup"><span data-stu-id="367cc-191">Turn on the integration of Customer Insights with Commerce</span></span>

<span data-ttu-id="367cc-192">Чтобы включить интеграцию Customer Insights с Commerce, необходимо убедиться, что у вас есть активный экземпляр Customer Insights в клиенте, на котором подготовлена Commerce.</span><span class="sxs-lookup"><span data-stu-id="367cc-192">To turn on the integration of Customer Insights with Commerce, you must make sure that you have an active instance of Customer Insights in the tenant where Commerce is provisioned.</span></span> <span data-ttu-id="367cc-193">Кроме того, необходимо иметь учетную запись пользователя Azure Active Directory (Azure AD) с подпиской Azure.</span><span class="sxs-lookup"><span data-stu-id="367cc-193">You must also have an Azure Active Directory (Azure AD) user account that has an Azure subscription.</span></span>

<span data-ttu-id="367cc-194">Чтобы настроить интеграцию, сделайте следующее.</span><span class="sxs-lookup"><span data-stu-id="367cc-194">Follow these steps to set up the integration.</span></span>

1. <span data-ttu-id="367cc-195">На портале Azure выполните регистрацию нового приложения и запишите имя приложения, идентификатор приложения и секрет.</span><span class="sxs-lookup"><span data-stu-id="367cc-195">In the Azure portal, register a new application and make a note of the application name, application ID, and secret.</span></span> <span data-ttu-id="367cc-196">Эти сведения будут использоваться для проверки подлинности между службами между Commerce и Customer Insights.</span><span class="sxs-lookup"><span data-stu-id="367cc-196">This information will be used for service-to-service authentication between Commerce and Customer Insights.</span></span> <span data-ttu-id="367cc-197">Храните секрет безопасно, поскольку потребуется сохранить его в Key Vault.</span><span class="sxs-lookup"><span data-stu-id="367cc-197">Note the secret safely, as it will be required to save it in the key vault.</span></span> <span data-ttu-id="367cc-198">В следующем примере используйте CI_Access_name, CI_Access_AppID, CI_Access_Secret для имени приложения, идентификатора приложения и секрета соответственно.</span><span class="sxs-lookup"><span data-stu-id="367cc-198">For the following example, use CI_Access_name, CI_Access_AppID, CI_Access_Secret for the application name, application ID, and secret respectively.</span></span> <span data-ttu-id="367cc-199">Дополнительные сведения см. в разделе [Краткое описание: регистрация приложения на платформе Microsoft Identity](/azure/active-directory/develop/quickstart-register-app).</span><span class="sxs-lookup"><span data-stu-id="367cc-199">For more information, see [Quickstart: Register an application with the Microsoft identity platform](/azure/active-directory/develop/quickstart-register-app).</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="367cc-200">Примите меры, чтобы не забыть изменить секрет до того, как истечет срок его действия.</span><span class="sxs-lookup"><span data-stu-id="367cc-200">Take steps so that you will remember to change the secret before it expires.</span></span> <span data-ttu-id="367cc-201">В противном случае интеграция будет внезапно остановлена.</span><span class="sxs-lookup"><span data-stu-id="367cc-201">Otherwise, the integration will unexpectedly stop.</span></span>

2. <span data-ttu-id="367cc-202">Перейдите к вашему экземпляру Customer Insights и выполните поиск имени приложения, созданного выше (в данном примере "CI_Access_name").</span><span class="sxs-lookup"><span data-stu-id="367cc-202">Go to your Customer Insights instance and search for the name of the application created above (in this example, "CI_Access_name").</span></span>
3. <span data-ttu-id="367cc-203">Создайте Azure Key Vault и запишите имя и URL-адрес (в данном примере — "KeyVaultName", "KeyVaultURL").</span><span class="sxs-lookup"><span data-stu-id="367cc-203">Create an Azure key vault, and take a note of the name and URL (in this example, "KeyVaultName", "KeyVaultURL").</span></span> <span data-ttu-id="367cc-204">Инструкции см. в разделе [Краткое описание: настройка и получение секрета в Azure Key Vault с помощью портала Azure](/azure/key-vault/quick-create-portal).</span><span class="sxs-lookup"><span data-stu-id="367cc-204">For instructions, see [Quickstart: Set and retrieve a secret from Azure Key Vault using the Azure portal](/azure/key-vault/quick-create-portal).</span></span>
4. <span data-ttu-id="367cc-205">Сохраните секрет (в данном примере это "CI_Access_Secret") в хранилище.</span><span class="sxs-lookup"><span data-stu-id="367cc-205">Save the secret (in this example, "CI_Access_Secret") in the vault.</span></span> <span data-ttu-id="367cc-206">Когда этот секрет хранится в хранилище, секрет получает имя.</span><span class="sxs-lookup"><span data-stu-id="367cc-206">When this secret is stored in the vault, the secret gets a name.</span></span> <span data-ttu-id="367cc-207">Запишите имя секрета (в данном примере — "SecretName").</span><span class="sxs-lookup"><span data-stu-id="367cc-207">Note the secret name (in this example, 'SecretName").</span></span>
5. <span data-ttu-id="367cc-208">Для получения доступа к секрету из хранилища Azure Key Vault необходимо создать другое приложение с ИД приложения и секретом (в данном примере — "KeyVault_Access_AppID" и "KeyVault_Access_Secret").</span><span class="sxs-lookup"><span data-stu-id="367cc-208">To access the secret from Azure Key Vault, you need to create another application with an application ID and secret (in this example, "KeyVault_Access_AppID" and "KeyVault_Access_Secret").</span></span> <span data-ttu-id="367cc-209">Надежно запишите секрет, поскольку он не будет отображаться снова.</span><span class="sxs-lookup"><span data-stu-id="367cc-209">Note the secret safely, as it will not be displayed again.</span></span>
6. <span data-ttu-id="367cc-210">Затем необходимо предоставить разрешения приложению для доступа к Key Vault из Commerce с помощью интерфейсов API.</span><span class="sxs-lookup"><span data-stu-id="367cc-210">Next, you need to give permissions to the application to access the Key Vault from Commerce using APIs.</span></span> <span data-ttu-id="367cc-211">Перейдите на страницу приложения на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="367cc-211">Go to the application page in Azure portal.</span></span> <span data-ttu-id="367cc-212">В разделе **Управление** выберите **Разрешения API**.</span><span class="sxs-lookup"><span data-stu-id="367cc-212">Under the **Manage** section, select **API permissions**.</span></span> <span data-ttu-id="367cc-213">Добавьте разрешение для доступа к **Azure Key Vault**.</span><span class="sxs-lookup"><span data-stu-id="367cc-213">Add the permission to access **Azure key vault**.</span></span> <span data-ttu-id="367cc-214">Для этого разрешения выберите **Политика доступа**.</span><span class="sxs-lookup"><span data-stu-id="367cc-214">For this permission, select **Access policy**.</span></span> <span data-ttu-id="367cc-215">Выберите шаблон как **Управление секретами** и выберите параметры **Получить**, **Список**, **Расшифровать** и **Зашифровать**.</span><span class="sxs-lookup"><span data-stu-id="367cc-215">Select the template as **Secret management**, and select the **Get**, **List**, **Decrypt**, and **Encrypt** options.</span></span> 
5. <span data-ttu-id="367cc-216">В Commerce Headquarters перейдите в раздел **Администрирование системы \> Настройка \> Параметры Key Vault** и введите необходимые сведения для данного хранилища Key Vault.</span><span class="sxs-lookup"><span data-stu-id="367cc-216">In Commerce headquarters, go to **System administration \> Setup \> Key Vault parameters**, and enter the required information for the key vault.</span></span> <span data-ttu-id="367cc-217">Затем в поле **Клиент хранилища ключей** введите код приложения, который был использован на шаге 4, чтобы Commerce смог получить доступ к секретам в хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="367cc-217">Then, in the **Key Vault client** field, enter the application ID that you used in step 4, so that Commerce can access the secrets in the key vault.</span></span>
6. <span data-ttu-id="367cc-218">Чтобы добавить приложение, созданное на шаге 1, в список безопасных приложений (которые иногда называют списком безопасности), перейдите к Customer Insights и выберите доступ **Просмотр** для приложения.</span><span class="sxs-lookup"><span data-stu-id="367cc-218">To add the application that you created in step 1 to the list of safe applications (sometimes referred to as a safe list), go to Customer Insights, and select **View** access to the application.</span></span> <span data-ttu-id="367cc-219">Инструкции см. в разделе [Разрешения](/dynamics365/ai/customer-insights/pm-permissions).</span><span class="sxs-lookup"><span data-stu-id="367cc-219">For instructions, see [Permissions](/dynamics365/ai/customer-insights/pm-permissions).</span></span>
7. <span data-ttu-id="367cc-220">В разделе **Администрирование системы > Настройка > Параметры Key Vault** в Commerce HQ, обновите поля, как описано ниже:</span><span class="sxs-lookup"><span data-stu-id="367cc-220">On the **System administration > Setup > Key Vault parameters** page in Commerce HQ, update the fields as described below:</span></span> 

- <span data-ttu-id="367cc-221">**URL-адрес Key Vault**: "KeyVaultURL" (из шага 3 выше).</span><span class="sxs-lookup"><span data-stu-id="367cc-221">**Key Vault url**: "KeyVaultURL" (from step 3 above).</span></span>
- <span data-ttu-id="367cc-222">**Клиент Key Vault**: "KeyVault_Access_AppID" (из шага 5 выше).</span><span class="sxs-lookup"><span data-stu-id="367cc-222">**Key Vault client**: "KeyVault_Access_AppID" (from step 5 above).</span></span>
- <span data-ttu-id="367cc-223">**Секретный ключ Key Vault**: "KeyVault_Access_Secret" (из шага 5 выше).</span><span class="sxs-lookup"><span data-stu-id="367cc-223">**Key Vault secret key**: "KeyVault_Access_Secret" (from step 5 above).</span></span>
- <span data-ttu-id="367cc-224">В разделе **Секреты**:</span><span class="sxs-lookup"><span data-stu-id="367cc-224">Under **Secrets** section:</span></span>
    - <span data-ttu-id="367cc-225">**Имя**: любое имя, например "CISecret".</span><span class="sxs-lookup"><span data-stu-id="367cc-225">**Name**: Any name, for example "CISecret".</span></span>
    - <span data-ttu-id="367cc-226">**Описание**: любое значение.</span><span class="sxs-lookup"><span data-stu-id="367cc-226">**Description**: Any value.</span></span>
    - <span data-ttu-id="367cc-227">**Секрет**: **хранилище**://<Name of key vault>/<name of secret>> В данном примере это будет "хранилище://KeyVaultName/SecretName".</span><span class="sxs-lookup"><span data-stu-id="367cc-227">**Secret**: **vault**://<Name of key vault>/<name of secret>> In this  example it will be "vault://KeyVaultName/SecretName".</span></span>

<span data-ttu-id="367cc-228">После обновления полей выберите **Проверить**, чтобы обеспечить возможность доступа к секрету для приложения Commerce.</span><span class="sxs-lookup"><span data-stu-id="367cc-228">After you update the fields, select **Validate** to ensure the secret can be accessed by the Commerce application.</span></span>

8. <span data-ttu-id="367cc-229">В Commerce на странице **Параметры Commerce** на вкладке **Отношения с клиентами** на экспресс-вкладке **Dynamics 365 Customer Insights** задайте для параметра **ИД приложения** значение "CI_Access_AppID" (из шага 1).</span><span class="sxs-lookup"><span data-stu-id="367cc-229">In Commerce, on the **Commerce parameters** page, on the **Clienteling** tab, on the **Dynamics 365 Customer Insights** FastTab, set the **Application ID** to "CI_Access_AppID" (from step 1 above).</span></span> <span data-ttu-id="367cc-230">Для параметра **Имя секрета** выберите имя секрета, введенное на шаге 7 выше ("CISecret").</span><span class="sxs-lookup"><span data-stu-id="367cc-230">For **Secret name**, select the name of the secret entered in step 7 above ("CISecret").</span></span> <span data-ttu-id="367cc-231">Для параметра **Включить Customer Insights** выберите значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="367cc-231">Set the **Enable Customer Insights** option to **Yes**.</span></span> <span data-ttu-id="367cc-232">Если по какой-либо причине настройка не удалась, отображается сообщение об ошибке, и этот параметр будет задан как **Нет**.</span><span class="sxs-lookup"><span data-stu-id="367cc-232">If the setup is unsuccessful for any reason, an error message will be displayed, and this option will be set to **No**.</span></span> 

<span data-ttu-id="367cc-233">В Customer Insights могут быть несколько сред, таких как тестовая и производственная среда.</span><span class="sxs-lookup"><span data-stu-id="367cc-233">You can have multiple environments in Customer Insights, such as test and production environments.</span></span> <span data-ttu-id="367cc-234">В поле **Код экземпляра среды** введите соответствующую среду.</span><span class="sxs-lookup"><span data-stu-id="367cc-234">In the **Environment instance ID** field, enter the appropriate environment.</span></span> <span data-ttu-id="367cc-235">В поле **Альтернативный код клиента** введите свойство в Customer Insights, которое сопоставляется с номером счета клиента.</span><span class="sxs-lookup"><span data-stu-id="367cc-235">In the **Alternate customer ID** field, enter the property in Customer Insights that is mapped to the customer account number.</span></span> <span data-ttu-id="367cc-236">(В модуле Commerce номер счета клиента является кодом клиента.) Остальные три свойства являются мерами, которые будут отображаться в карточке клиента в книге клиентов.</span><span class="sxs-lookup"><span data-stu-id="367cc-236">(In Commerce, the customer account number is the customer ID.) The remaining three properties are the measures that will be shown on the customer card in the client book.</span></span> <span data-ttu-id="367cc-237">Можно выбрать до трех мер для отображения в карточке клиента.</span><span class="sxs-lookup"><span data-stu-id="367cc-237">You can select up to three measures to show on the customer card.</span></span> <span data-ttu-id="367cc-238">Однако нет необходимости в выборе каких-либо показателей.</span><span class="sxs-lookup"><span data-stu-id="367cc-238">However, you are not required to select any measures.</span></span> <span data-ttu-id="367cc-239">Как упоминалось ранее, в системе сначала отображаются эти значения, а затем отображаются значения для группы атрибутов книги клиентов.</span><span class="sxs-lookup"><span data-stu-id="367cc-239">As mentioned previously, the system shows these values first, and then it shows the values for the client book attribute group.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]