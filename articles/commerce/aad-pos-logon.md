---
title: Настройка аутентификации Azure Active Directory для входа на POS-терминал
description: В этой теме объясняется, как настроить Azure Active Directory как метод аутентификации в POS-терминале Microsoft Dynamics 365 Commerce.
author: boycezhu
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: Core, Operations, Retail
ms.search.region: global
ms.author: boycez
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.11
ms.openlocfilehash: 63121a9b5f1b062b7ca927f6b9eb1689ce8aa698
ms.sourcegitcommit: dc4898aa32f381620c517bf89c7856e693563ace
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "6270691"
---
# <a name="configure-azure-active-directory-authentication-for-pos-sign-in"></a>Настройка аутентификации Azure Active Directory для входа на POS-терминал

[!include [banner](includes/banner.md)]

В этой теме объясняется, как настроить Azure Active Directory (Azure AD) как метод аутентификации в POS-терминале Microsoft Dynamics 365 Commerce.

Розничные продавцы, использующие Dynamics 365 Commerce с другими облачными службами Майкрософт, такими как Microsoft Azure, Microsoft 365 и Microsoft Teams обычно хотят использовать Azure AD для централизованного управления учетными данными пользователя для безопасного и надежного входа в систему между приложениями. Чтобы использовать аутентификацию Azure AD для Commerce POS, необходимо сначала настроить Azure AD как метод аутентификации в Commerce Headquarters.

## <a name="configure-pos-authentication-method"></a>Настройка метода аутентификации POS

Чтобы настроить метод аутентификации POS в Commerce Headquarters, выполните следующие шаги.
    
1. Перейдите **Retail и Commerce \> Настройка канала \> Настройка POS \> Профили POS \> Профили функциональности** и выберите изменяемый профиль функциональности.
1. В разделе **Вход в POS для персонала** на экспресс-вкладке **Функции** выберите нужный метод аутентификации из раскрывающегося списка **Метод аутентификации при входе**.

    Есть три варианта **Метода аутентификации для входа в систему**:
    
    - **Идентификатор персонала и пароль** — этот параметр по умолчанию требует, чтобы пользователи POS вводили код персонала и пароль для входа в POS, а также для доступа к функции переопределения менеджера.
    - **Azure AD без единого входа** — этот параметр требует, чтобы пользователи POS использовали учетные данные Azure AD для входа в POS и доступа к функции переопределения менеджера. После обновления или повторного открытия клиента POS пользователь POS должен предоставить учетные данные Azure AD для повторного входа в систему.
    - **Azure AD с единым входом** — когда этот параметр выбран, пользователи POS могут входить в Cloud POS (CPOS), используя активные учетные данные Azure AD, используемые другими веб-приложениями в том же веб-браузере, или входить в Modern POS (MPOS), используя учетные данные Azure AD, зарегистрированные в Windows. Оба метода позволяют выполнять вход без необходимости ввода учетных данных Azure AD на экране входа в POS. Однако для доступа к функциям переопределения менеджера в POS все равно потребуется выполнить вход с использованием учетных данных Azure AD.

1. Перейдите **Retail и Commerce > ИТ Retail и Commerce > График распределения** и выполните задание **1070 (Конфигурация канала)**, чтобы синхронизировать последние настройки профиля функциональности с клиентами POS.

> [!NOTE]
> - Параметр метода аутентификации **Azure AD без единого входа** заменяет параметр **Azure Active Directory** в Commerce версии 10.0.18 и более ранних версий.
> - Аутентификация Azure AD требует наличия активного подключения к Интернету и не будет работать, если POS находится вне сети.

## <a name="associate-azure-ad-accounts-with-pos-users"></a>Связывание учётных записей Azure AD с пользователями POS

Для использования Azure AD в качестве метода аутентификации POS необходимо связать учетные записи Azure AD с пользователями POS в Commerce Headquarters. 

Чтобы связать учетные записи Azure AD с пользователями POS в Commerce Headquarters, выполните следующие действия.
    
1. Перейдите **Retail и Commerce > Сотрудники > Работники** и откройте запись работника.
1. В области действий выберите вкладку **Commerce**, затем в **Внешнее удостоверение** выберите **Связать существующее удостоверение**. 
1. В диалоговом окне **Использовать существующее внешнее удостоверение** выберите **Поиск по электронной почте**, введите адрес электронной почты Azure AD, затем выберите **Поиск**.
1. Выберите возвращенную учетную запись Azure AD, затем выберите **ОК**.

После этапов настройки выше будут заполнены поля **Псевдоним**, **UPN** и **Внешний подкод** на вкладке **Commerce** на странице сведений о работнике.

Необходимо выполнить задание **1060 (персонал)** в **Retail и Commerce > ИТ Retail и Commerce > График распределения**, чтобы синхронизировать данные последних пользователей POS и учетных записей Azure AD в канал.

> [!NOTE]
> После обновления информации о сотруднике, например пароля, разрешения POS, связанной учетной записи Azure AD или адресной книги сотрудника в Commerce Headquarters, настоятельно рекомендуется выполнить задание **1060 (персонал)** для синхронизации последней информации о работнике с каналом. Затем клиент POS может выбрать правильные данные для проверок аутентификации пользователя и авторизации.

## <a name="pos-lock-register-and-sign-out-with-azure-ad-authentication"></a>Регистр блокировки POS и выход с аутентификацией Azure AD

При настройке POS для использования метода аутентификации Azure AD происходит следующее:

- Функция **Блокировать регистр** будет недоступна в приложении POS. 
- Функция **Автоматически блокировать** ведет себя так же, как функция **Автоматический выход из системы**.
- Если пользователь POS выбирает **Выход из системы**, пользователю будет предложено войти в систему, используя учетные данные Azure AD при следующем запуске POS независимо от того, активирована ли функция единого входа.

## <a name="manager-override-functionality-with-azure-ad-authentication"></a>Функции переопределения менеджера с аутентификацией Azure AD

Когда POS настроен на использование аутентификации Azure AD, функция переопределения менеджера открывает диалоговое окно, запрашивающее учетные данные Azure AD пользователя-менеджера. После утверждения входа менеджера учетные данные Azure AD менеджера будут удалены, а учетные данные Azure AD предыдущего пользователя будут использоваться для последующих операций с POS.

> [!NOTE]
> - В Commerce версии 10.0.18 и более ранних версиях функция переопределения менеджера не поддерживается Azure AD. Идентификатор персонала и пароль требуются, даже если POS настроен на использование метода аутентификации Azure AD.
> - При использовании СPOS с веб-браузером Safari на устройстве Apple iOS необходимо сначала отключить **Блокировать всплывающие окна** в параметрах Safari, чтобы функция переопределения работала с аутентификацией Azure AD. 

## <a name="security-best-practices-for-azure-ad-based-pos-authentication-on-shared-devices"></a>Рекомендации по безопасности для аутентификации POS на основе Azure AD на общих устройствах

Многие розничные компании настраивают свою среду розничной торговли таким образом, что у нескольких пользователей был доступ к приложению POS с общего физического устройства. В этом контексте, в то время как единый вход предоставляет удобный и удобный механизм аутентификации, он может также создать брешь в системе безопасности, когда текущий пользователь POS может не знать, что учетные данные другого пользователя используются для выполнения транзакций или операций в POS. Прежде чем настроить POS для использования метода аутентификации Azure AD, настоятельно рекомендуется просмотреть политику безопасности и параметры входа общего устройства, чтобы определить, какой вариант подходит лучше.

- Если в розничной среде используется общая учетная запись (например, локальная учетная запись) для входа в систему физического устройства, рекомендуется использовать вариант **Azure AD без единого входа в систему**. Это гарантирует, что каждый пользователь POS будет явно предоставлять учетные данные Azure AD для входа в POS.
- Если розничной среде требуется, чтобы сотрудники использовали собственные учетные записи Azure AD для входа в POS и физическое устройство размещения, рекомендуется использовать вариант **Azure AD с единым входом**.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Настройка работника](tasks/worker.md)

[Создание профиля функциональности розничной торговли](retail-functionality-profile.md)


[Настройка функциональности расширенного входа для MPOS и Cloud POS](extended-logon.md)

[Рекомендации по безопасности для работы с Cloud POS в общих средах](dev-itpro/secure-retail-cloud-pos.md)



[!INCLUDE[footer-include](../includes/footer-banner.md)]
