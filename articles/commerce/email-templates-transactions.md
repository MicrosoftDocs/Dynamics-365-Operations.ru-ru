---
title: Создание шаблонов сообщений электронной почты для событий проводок
description: В этом разделе описывается создание, отправка и настройка шаблонов сообщений электронной почты для событий проводок в Microsoft Dynamics 365 Commerce.
author: stuharg
manager: annbe
ms.date: 06/01/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: Retail, Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: stuharg
ms.search.validFrom: 2020-01-20
ms.dyn365.ops.version: Release 10.0.8
ms.openlocfilehash: a02839088addfa9b405af486f3b795eace1671cc
ms.sourcegitcommit: 4db8c30c2f26af1896938dd3ece3756577374ecb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2020
ms.locfileid: "3416587"
---
# <a name="create-email-templates-for-transactional-events"></a>Создание шаблонов сообщений электронной почты для событий проводок

[!include [banner](includes/banner.md)]

В этом разделе описывается создание, отправка и настройка шаблонов сообщений электронной почты для событий проводок в Microsoft Dynamics 365 Commerce.

## <a name="overview"></a>Обзор

Dynamics 365 Commerce предоставляет готовое решение для отправки сообщений электронной почты, предупреждающих клиентов о событиях проводок (например, при размещении заказа, готовности заказа для отправки или отгруженном заказе). В этом разделе описываются шаги создания, отправки и настройки шаблонов сообщений электронной почты, используемых для отправки сообщений электронной почты по проводкам.

## <a name="create-an-email-template"></a>Создание шаблона сообщения эл. почты

Прежде чем можно будет сопоставить конкретное событие проводки с шаблоном сообщений электронной почты, необходимо создать шаблон.

Чтобы создать шаблон электронной почты, выполните следующие действия.

1. В головном офисе Commerce перейдите **Шаблоны сообщений электронной почты организации**, которые находятся в **Retail and Commerce \> Настройка центрального офиса \> Шаблоны сообщений электронной почты организации** или **Администрирование организации \> Настройка \> Шаблоны сообщений электронной почты организации**.
1. Выберите **Создать**.
1. В разделе **Общие** задайте следующие поля:

    - **Код сообщения электронной почты** — код сообщения электронной почты — это уникальный код шаблона, который отображается при выборе шаблона для сопоставления событию.
    - **Описание сообщения электронной почты** — это необязательное поле можно использовать для создания описания шаблона. Введенное значение появляется только в Commerce Headquarters.
    - **Имя отправителя** — введенное имя отображается в поле "от" для большинства клиентов электронной почты.
    - **Адрес электронной почты отправителя** — Введите адрес электронной почты, который должен использоваться для писем, отправленных с помощью данного шаблона.
    - **Код языка по умолчанию** — в этом поле указывается локализованная версия сообщения электронной почты, которое будет отправлено по умолчанию, если канал, который вызывает этот шаблон, не предоставляет каких-либо других языков.

1. В **Содержимое сообщения электронной почты**, выберите **Создать**.
1. В поле **Язык** введите язык для шаблона сообщения электронной почты. Можно добавить дополнительные языки и локализованные шаблоны позднее.
1. В поле **Тема** введите сообщение электронной почты, которое должно появиться в поле темы сообщения электронной почты.
1. Выберите **Правка**, чтобы загрузить шаблон сообщения электронной почты.

## <a name="create-an-email-message-body-by-using-html"></a>Создание текста сообщения электронной почты с помощью HTML

Текст сообщения электронной почты составлен в формате HTML. Можно использовать любой макет, стилизацию и фирменную символику, если разрешено использование HTML и встроенных каскадных таблиц стилей (CSS). Кроме того, можно использовать изображения, если они размещены на общедоступной конечной точке веб-узла. Чтобы добавить изображение, введите URL-адрес изображения в атрибут **src** маркера HTML **&lt;img&gt;**.

> [!NOTE]
> Клиенты электронной почты накладывают ограничения макета и стилей, которые могут потребовать корректировок кода HTML и CSS, которые используются в содержании сообщения. Рекомендуется ознакомиться с рекомендациями по созданию HTML-кода, который будет поддерживаться самыми популярными клиентами электронной почты.

## <a name="add-placeholders-to-the-email-message-body"></a>Добавление заполнителей в текст сообщения электронной почты

Сообщение электронной почты может содержать заполнители, которые заменяются значениями, связанными с клиентом и проводкой, при создании сообщения электронной почты. Заполнители всегда заключены в знаки процента (%) и вставляются непосредственно в документ HTML.

Рассмотрим пример:

```html
<p>
    Hello %customername%,<br />
    Order number %salesid%, can be picked up from the <b>%pickupstorename%</b> store.
</p>
```

### <a name="order-placeholders-sales-order-level"></a>Заполнители для заказа (уровень заказа на продажу)

Следующие заполнители извлекают и отображают данные, которые определены на уровне заказа на продажу (в противоположность уровню строки продаж).

| Имя заполнителя    | Значение заполнителя                                                |
|---------------------|------------------------------------------------------------------|
| customername        | Имя клиента, который разместил заказ.                   |
| salesid             | Код продажи по заказу.                                       |
| deliveryaddress     | Адрес поставки для отгруженных заказов.                         |
| customeraddress     | Адрес, к которому относится клиент.                                     |
| deliverydate        | Дата поставки.                                               |
| shipdate            | Дата отгрузки.                                                   |
| modeofdelivery      | Режим доставки для заказа.                                  |
| расходы по продаже             | Общая сумма накладных расходов для заказа.                                 |
| налога                 | Общая сумма налога для заказа.                                     |
| всего               | Общая сумма для заказа.                                  |
| ordernetamount      | Общая сумма для заказа минус общая сумма налога.             |
| скидка            | Общая скидка для заказа.                                |
| storename           | Название магазина, в котором был размещен заказ.                |
| storeaddress        | Адрес магазина, в котором был размещен заказ.                  |
| storeopenfrom       | Время начала работы магазина, в котором был размещен заказ.             |
| storeopento         | Время окончания работы магазина, в котором был размещен заказ.             |
| pickupstorename     | Название магазина, в котором будет скомплектован заказ.         |
| pickupstoreaddress  | Адрес магазина, в котором будет скомплектован заказ.      |
| pickupopenstorefrom | Время начала работы магазина, в котором будет скомплектован заказ. |
| pickupopenstoreto   | Время окончания работы магазина, в котором будет скомплектован заказ. |

### <a name="order-line-placeholders-sales-line-level"></a>Заполнители сроки заказа (уровень строки продаж)

Следующие заполнители извлекают и отображают данные для отдельных продуктов (строк) в заказе на продажу.

| Имя заполнителя               | Значение заполнителя |
|--------------------------------|-------------------|
| productid                      | Код продукта для строки. |
| lineproductname                | Название продукта. |
| lineproductdescription         | Описание продукта. |
| linequantity                   | Число единиц, заказанных для строки, плюс единица измерения (например, **ea** или **пара**). |
| lineunit                       | Единица измерения для данной строки. |
| linequantity_withoutunit       | Число единиц, заказанных для строки, без единицы измерения. |
| linequantitypicked             | Когда используется событие **PickOrder**, количество единиц, которое было скомплектовано. В противном случае — **0** (ноль). |
| linequantitypicked_withoutunit | Когда используется событие **PickOrder**, число единиц, которое было скомплектовано, без единицы измерения. В противном случае — **0** (ноль). |
| linequantitypacked             | Когда используются события **PackOrder** и **заказ, готовый для отправки**, число упакованных единиц. В противном случае — **0** (ноль). |
| linequantitypacked_withoutuom  | Когда используются события **PackOrder** и **заказ, готовый для отправки**, число упакованных единиц, без единицы измерения. В противном случае — **0** (ноль). |
| linequantityshipped            | Всегда равно **0**, за исключением случаев, когда используются отдельные события, как описано в следующей строке. |
| linequantityshipped_withoutuom | Когда используется событие **ShipOrder**, число единиц, которое было скомплектовано, без единицы измерения. В противном случае — **0** (ноль). |
| lineprice                      | Цена для одной единицы. |
| linenetamount                  | Цена строки после применения числа единиц и скидки. |
| linediscount                   | Скидка для отдельной единицы. |
| lineshipdate                   | Дата отгрузки для строки. |
| linedeliverydate               | Дата доставки для строки. |
| linedeliverymode               | Режим доставки для строки. |
| linedeliveryaddress            | Адрес поставки для строки. |
| giftcardnumber                 | Номер подарочного сертификата для продуктов типа подарочного сертификата. |
| giftcardbalance                | Баланс подарочного сертификата для продуктов типа подарочного сертификата. |
| giftcardmessage                | Сообщение подарочного сертификата для продуктов типа подарочного сертификата. |
| giftcardpin                    | Персональный идентификационный номер (PIN) подарочного сертификата для продуктов типа подарочного сертификата. (Этот заполнитель относится к внешним подарочным сертификатам.) |
| giftcardexpiration             | Дата окончания срока действия подарочного сертификата для продуктов типа подарочного сертификата. (Этот заполнитель относится к внешним подарочным сертификатам.) |
| giftcardrecipientname          | Имя получателя подарочного сертификата для продуктов типа подарочного сертификата. |
| giftcardbuyername              | Имя покупателя подарочного сертификата для продуктов типа подарочного сертификата. |

### <a name="format-of-order-line-placeholders-in-the-email-message-body"></a>Формат заполнителей для строк заказа в тексте сообщения электронной почты

При создании HTML для отдельных строк заказа в тексте сообщения электронной почты необходимо окружить повторяющийся блок HTML и заполнители для строк следующими заполнителями, помещенными в маркеры комментариев HTML.

```html
<!--%tablebegin.salesline%-->

(Insert the repeating block of HTML and placeholders for individual lines here.)

<!--%tableend.salesline%-->
```

Рассмотрим пример:

```HTML
<table>
    <tr>
        <td>Product name</td>
        <td>Quantity</td>
        <td>Price</td>
    </tr>
    <!--%tablebegin.salesline%-->
    <tr>
        <td>%lineproductname%</td>
        <td>%linequantity_withoutunit%</td>
        <td>%lineprice%</td>
    </tr>
    <!--%tableend.salesline%-->
</table>
```

## <a name="create-a-template-for-emailed-receipts"></a>Создание шаблона для отправки чеков по электронной почте

Чеки могут быть отправлены клиентам, которые делают покупки в розничном POS-терминале (POS). Как правило, шаги для создания шаблона для отправки чеков по электронной почте совпадают с шагами создания шаблонов для других событий проводок. Однако требуются следующие изменения:

- Код сообщения электронной почты для шаблона сообщения электронной почты должен быть **emailRecpt**.
- Текст чека вставляется в сообщение электронной почты с использованием заполнителя **%message%**. Чтобы убедиться, что текст чека правильно отрисовывается, заключите заполнитель **% message%** в маркеры HTML **&lt;pre&gt;** и **&lt;/pre&gt;**.
- Разрывы строк в HTML для колонтитулов электронной почты преобразуются в маркеры HTML **&lt;br /&gt;**, чтобы текст чека отображалось правильно. Чтобы исключить лишнее вертикальное расстояние в сообщениях электронной почты с чеками, удалите разрывы строк из любого места в HTML-коде, где вертикальное пространство не требуется.

Дополнительные сведения о настройке сообщений электронной почты с чеками см. в разделе [Настройка сообщений электронной почты с чеками](https://docs.microsoft.com/dynamicsax-2012/appuser-itpro/set-up-email-receipts).

## <a name="upload-the-email-html"></a>Загрузите HTML-код сообщения электронной почты

После создания и проверки кода HTML для содержания сообщения необходимо загрузить его в центральный офис Commerce. В настоящее время HTML-код сообщения электронной почты нельзя экспортировать. Таким образом, необходимо поддерживать основную копию HTML-кода вне центрального офиса Commerce.

Чтобы загрузить новый или измененный HTML-код шаблона сообщения электронной почты, выполните следующие действия.

1. В центральном офисе Commerce перейдите к **Retail и Commerce \> Настройка центрального офиса \> Шаблоны сообщений электронной почты организации**.
1. Выбор строки для языка, для которого требуется добавить или заменить HTML-код. Или выберите **создать**, чтобы создать строку для нового языка.
1. Выберите **Правка**.
1. В появившемся диалоговом окне выберите **Обзор**. Перейдите к документу HTML, который необходимо загрузить, выберите его и нажмите кнопку **открыть**.
1. Выберите **Отправить**.
1. После появления HTML-кода сообщения электронной почты в окне предварительного просмотра нажмите кнопку **ОК**.
1. Убедитесь, что установлен флажок **Имеет тело** для строки.

Если для отправки сообщения электронной почты уже настроен центральный офис Commerce, новое или обновленное сообщение электронной почты будет отправляться всем клиентам, выполняющим проводку, которая вызывает событие, сопоставленное с этим шаблоном.

Дополнительные сведения о настройке сообщений электронной почты в Dynamics 365 Commerce см. в разделе [Настройка и отправка сообщений электронной почты](../fin-ops-core/fin-ops/organization-administration/configure-email.md).

## <a name="additional-resources"></a>Дополнительные ресурсы 

[Настройка профиля уведомлений по электронной почте](email-notification-profiles.md)

[Настройка и отправка электронной почты](../fin-ops-core/fin-ops/organization-administration/configure-email.md)

[Настройка приема электронной почты](https://docs.microsoft.com/dynamicsax-2012/appuser-itpro/set-up-email-receipts)

[Отправка чеков по электронной почте из Modern POS ](email-receipts.md)
