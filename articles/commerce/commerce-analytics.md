---
title: Аналитика Commerce (предварительная версия)
description: В этой теме объясняется, как установить и использовать возможности аналитики в Microsoft Dynamics 365 Commerce.
author: AamirAllaq
ms.date: 11/23/2021
audience: Application user
ms.reviewer: sericks
ms.search.region: Global
ms.author: aamiral
ms.search.validFrom: 2021-11-12
ms.openlocfilehash: 8cfe2af756315b5be3eb22d99376a96166fffc52
ms.sourcegitcommit: f9fca3d55b47e615e5ef64669dab184e057ec234
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2021
ms.locfileid: "7862781"
---
# <a name="commerce-analytics-preview"></a>Аналитика Commerce (предварительная версия)

[!include [banner](includes/banner.md)]

В этой теме объясняется, как установить аналитику Commerce (предварительная версия), функциональную возможность аналитики, которая включена в Microsoft Dynamics 365 Commerce.

## <a name="commerce-analytics-preview-live-demo"></a>Живая демонстрация аналитики Commerce (предварительная версия)

Вы можете попробовать [живую демонстрацию аналитики Commerce (предварительная версия)](https://aka.ms/CommerceAnalyticsDemo).

![Сводка по аналитике Commerce (предварительная версия)](media/CommerceAnalytics_Summary.png)
![Платежи аналитики Analytics (предварительная версия)](media/CommerceAnalytics_Payments.png)
![Веб-действие аналитики Commerce (предварительная версия)](media/CommerceAnalytics_WebActivity.png)


## <a name="commerce-analytics-preview-system-architecture"></a>Архитектура системы аналитики Commerce (предварительная версия)

### <a name="key-components"></a>Ключевые компоненты

Аналитика Commerce (предварительная версия) состоит из следующих ключевых компонентов:

- Готовые к использованию интерактивные отчеты Power BI
- Представления SQL в Azure Synapse Analytics
- Объекты и онтологические данные в Azure Data Lake
- Необработанные данных в Data Lake

![Основные компоненты архитектуры системы аналитики Commerce](media/CommerceAnalyticsArchitecture_v2.png)

### <a name="data-flow"></a>Поток данных

#### <a name="step-1-data-generation"></a>Шаг 1. Создание данных

Данные поступают либо в виде данных проводок, либо в качестве данных поведения из одного из следующих источников:

- Младший сотрудник центра обработки звонков использует клиент Commerce HQ для обработки заказов на продажу.
- Кассир на POS-терминале обрабатывает проводки по продажам.
- Продажи создаются в пользовательских приложениях с помощью Headless Commerce (Commerce Scale Unit).
- Покупатель электронной коммерции просматривает ваш веб-сайт электронной коммерции.
- Покупатель электронной коммерции размещает заказ на вашем веб-сайте электронной коммерции.
- Данные создаются другими системами, например Dynamics 365 Connected Spaces.

#### <a name="step-2-ingestion-and-pre-processing"></a>Шаг 2. Приемка и предварительная обработка

Данные о проводках передаются в Commerce HQ либо напрямую (в случае заказов, которые фиксируются непосредственно в клиенте Commerce HQ), либо через Commerce Scale Unit (в случае заказов, зафиксированных в POS-терминале, в приложении электронной коммерции или в пользовательских клиентах, использующих Headless Commerce).

Затем функция экспорт в Data Lake используется для копирования данных о проводках в ваше озеро данные Data Lake в виде необработанных данных. В озере данных Data Lake необработанные данные хранятся в папке таблиц.

Данные веб-активности электронной коммерции отправляются непосредственно в Data Lake. Данные, которые производятся в других системах, например Dynamics 365 Connected Spaces, посылаются непосредственно в Data Lake в этих системах.

#### <a name="step-3-transformation-and-aggregation"></a>Шаг 3. Преобразование и агрегирование

После того как в необработанные данные записаны в ваше озеро данных Data Lake, служба аналитики Commerce читает их, преобразует, выполняет статистическую обработку и записывает обратно в Data Lake в форме логических сущностей (в папку сущностей) и статистических показателей (в папку онтологии).

#### <a name="step-4-querying"></a>Шаг 4. Выполнение запроса

Azure Synapse Analytics используется для запроса данных в вашем озере данных Data Lake с помощью интерфейса Transact-SQL (T-SQL). Этот интерфейс включает представления SQL. Представления SQL позволяют выполнять федеративные запросы данных в Data Lake, либо непосредственно через клиент T-SQL (для специальной аналитики), либо с помощью средства визуализации, такого как Power BI.

#### <a name="step-5-modeling-and-serving"></a>Шаг 5. Моделирование и обслуживание

Данные, запрашиваемые Azure Synapse Analytics, отправляются в семантическую модель Power BI. В зависимости от типа данных, они периодически импортируются в память в Power BI или непосредственно запрашиваются во время выполнения.

Наконец, данные визуализируются в визуальных элементах Power BI, чтобы пользователи могли просматривать их и взаимодействовать с ними.

## <a name="commerce-analytics-preview-functional-overview"></a>Функциональный обзор аналитики Commerce (предварительная версия)

### <a name="summary"></a>Сводка

Приложение шаблона аналитики Commerce содержит следующие главные страницы отчета:

1. [Фильтры верхнего уровня](#TopLevelFilters)
2. [Товары](#ProductsPage)
3. [Клиенты](#CustomersPage)
4. [Каналы](#ChannelsPage)
5. [Прод.](#SalesPage)
6. [Поля](#MarginsPage)
7. [Возвраты](#ReturnsPage)
8. [Скидки](#DiscountsPage)
9. [Оплаты](#PaymentsPage)
10. [Клиенты](#CustomersPage)
11. [Сравнение](#ComparisonPage)
12. [Веб-мероприятие](#WebActivityPage)
13. [Веб-действие — фильтр верхнего уровня](#WebActivityTopLevelFilters)

####  <a name="top-level-filters"></a><a name="TopLevelFilters"></a> Фильтры верхнего уровня

- Параметры данных

    - Год
    - Квартал
    - Месяц
    - Неделя
    - День

- Параметры канала

    - Информация о компании
    - Тип канала
    - Тип клиента
    - Тип продаж
    - Канал
    - Организационная иерархия

- Параметры продуктов

    - Иерархия категорий
    - Категория

####  <a name="products"></a><a name="ProductsPage"></a> Продукты

- Продажи
- Поле
- Возвраты

####  <a name="customers"></a><a name="CustomersPage"></a> Клиенты

- Продажи
- Поле
- Возвраты

#### <a name="channels"></a><a name="ChannelsPage"></a> Каналы

- Продажи
- Поле
- Возвраты

### <a name="sales"></a>Продажи <a name="SalesPage"></a>

- В местонахождению доставки
- По каналу/магазину/терминалу
- По сотрудникам
- По дате
- По часам
- По категориям продуктов

### <a name="margins"></a><a name="MarginsPage"></a> Маржа

- В местонахождению доставки
- Побочный продукт
- По дате

### <a name="returns"></a><a name="ReturnsPage"></a> Возвраты

- Возвраты по сумме

    - По магазину
    - Побочный продукт
    - По дате

- Возвраты по проводкам

    - По магазину
    - Побочный продукт
    - По дате

### <a name="discounts"></a><a name="DiscountsPage"></a> Скидки

- По магазину
- Побочный продукт
- По дате
- Декомпозиция

    - Информация о компании
    - Магазин
    - Тип скидки
    - Имя скидки
    - Продукт

### <a name="payments"></a><a name="PaymentsPage"></a> Платежи

- По каналу/терминалу
- По способы/типу оплаты
- По дате
- Декомпозиция

    - Информация о компании
    - Тип канала
    - Магазин
    - Терминал
    - Способ оплаты

### <a name="customers"></a><a name="CustomersPage"></a> Клиенты

- Сумма за временя жизни (LTV)

    LTV рассчитывается на основе общей суммы, которую клиент тратит на все каналы продаж Dynamics 365 Commerce (включая POS-терминал, электронную коммерцию и центр обработки звонков).

- Recency

    Новизна рассчитывается на основе количества дней, прошедших с момента последнего взаимодействия клиента с организацией по проводкам. В настоящее время новизна не учитывает нетранзакционные сигналы взаимодействия, такие как действие по просмотру электронной коммерции.

- Частота

    Частота рассчитывается на основе транзакционного взаимодействия клиента с организацией. В настоящее время частота не учитывает нетранзакционные сигналы взаимодействия, такие как действие по просмотру электронной коммерции.

- Длительность отношений

    Длительность отношений рассчитывается на основе количества дней с момента создания записи клиента в системе.

- Счетчик проводок

### <a name="comparison"></a><a name="ComparisonPage"></a> Сравнение

- Сравнение продуктов по периоду времени

    - Продажи и разница в продажах
    - Маржа и разница в марже

- Клиент за период времени

    - Продажи и разница в продажах
    - Маржа и разница в марже

### <a name="web-activity"></a><a name="WebActivityPage"></a> Веб-действие

#### <a name="top-level-filters"></a><a name="WebActivityTopLevelFilters"></a> Фильтры верхнего уровня

- Диапазон даты
- Тип канала
- Канал
- Иерархия категорий

#### <a name="acquisitions"></a>Ввод в эксплуатацию

- Просмотры страниц

    - По стране или региону
    - Побочный продукт
    - По статусу входа пользователя
    - По дате

- Заказы электронной коммерции
- Курс конвертации

    - По дате

- Воронка преобразования

    - Просмотры страниц по типам страниц (домашняя страница, страница категории или страница сведений о продукте)
    - В корзину
    - Оформить заказ
    - Покупка

#### <a name="sessions"></a>Сеансы

Сеанс — это эпизод посещения пользователем на веб-сайте электронной коммерции. Сеанс считается завершенным после 30 минут отсутствия активности или после 24 часов активного использования.

- По стране или региону
- По происхождению (внешний источник ссылки)
- По статусу входа пользователя
- Число сеансов

    - По дате
    - По странице входа

- Заказ на сеанс

    - По дате

- Доля сразу покинутых сеансов

    Сразу покинутый сеанс — это сеанс, в котором пользователь выходит сразу после посещения веб-сайта электронной коммерции. Дополнительные сведения см. в разделе [Доля ушедших сразу](https://en.wikipedia.org/wiki/Bounce_rate).

- Щелчков за сеанс

#### <a name="visitors"></a>Посетители

Анонимный посетитель на сайте электронной коммерции однозначно определяется на основе конкретного браузера и конкретного устройства, используемого пользователем. Аналитика Commerce не отслеживает анонимных посетителей в других браузерах или устройствах. Анонимный посетитель, использующий тот же браузер на одном и том же устройстве, уникально идентифицируется в нескольких сеансах пользователя, пока не будут очищены кэшированные данные в браузере или не пройдет некоторый период (обычно 12 месяцев), в зависимости от того, что происходит в первую очередь.

Если посетители просматривают веб-сайт электронной коммерции, когда они выполнили вход в систему, аналитика Commerce можно предоставить дополнительную информацию о них. Эта информация основана на существующей связи, которую организация имеет с посетителями в качестве результата их предыдущих покупок во всех каналах продаж Dynamics 365 Commerce (включая POS-терминал, электронную коммерцию и центр обработки звонков). Дополнительные сведения включают в себя новизну, длительность отношений, сумму за время жизни и данные частоты.

- Маржа посетителя
- Средние заказы посетителя
- Средние продажи посетителя
- Число посетителей электронной коммерции

    - По дате
    - По местоположению

        В настоящее время аналитика Commerce может предоставлять только структуру на уровне страны/региона для получения аналитической информации о местоположении для посетителей электронной коммерции.

    - По новизне

        Новизна рассчитывается на основе количества дней, прошедших с момента последнего взаимодействия клиента с организацией по проводкам. В настоящее время новизна не учитывает нетранзакционные сигналы взаимодействия, такие как действие по просмотру электронной коммерции.

    - По длительности отношений

        Длительность отношений рассчитывается на основе количества дней с момента создания записи клиента в системе.

    - По сумме за временя жизни (LTV)

        LTV рассчитывается на основе общей суммы, которую клиент тратит на все каналы продаж Dynamics 365 Commerce (включая POS-терминал, электронную коммерцию и центр обработки звонков).

    - По частоте

        Частота рассчитывается на основе транзакционного взаимодействия клиента с организацией. В настоящее время частота не учитывает нетранзакционные сигналы взаимодействия, такие как действие по просмотру электронной коммерции.

#### <a name="impressions"></a>Показы

Показ — это один просмотр визуального элемента продукта посетителем электронной коммерции. Например, посетитель электронной коммерции переходит на домашнюю страницу веб-сайта электронной коммерции и просматривает продукт "коврик для йоги" в модуле списка **Самые продаваемые**. Затем посетитель просматривает этот же продукт "коврик для йоги" в модуле списка **Отобрано для вас**. В этом случае имеются два показа продукта. 

В настоящее время показы отслеживаются на следующих поверхностях:

- Списки (например, **Рекомендуемые**, **Лучшие продажи**, **Отобрано для вас** и **Тенденции**)
- Модуль корзины
- Контейнер результатов поиска
- Контейнер результатов поиска по категориям

В настоящее время продукты, которые отображаются в модуле карусели или в пользовательских визуальных элементах, не учитываются в метриках, связанных с показами пользователям.

Страница **Отчет о показах** содержит следующие метрики:

- Число показов

    - По типу страницы и модулю

        Тип страницы — это универсальный тип страницы, который определяется для каждой страницы веб-сайта электронной коммерции. Тип модуля — это тип визуального модуля электронной коммерции, в котором показан продукт.

        Для просмотра показов по модулям, возможно, придется выполнить детализацию по страницам и визуальным модулям.

    - Побочный продукт
    - По статусу входа пользователя
    - По дате

- Число щелчков при показах

    Если посетитель электронной коммерции выбирает визуальный элемент продукта, то возникает щелчок при показе. Обычно посетитель при этом переходит на страницу сведений о продукте для продукта.

- Процент переходов (CTR) при показах

    CTR вычисляется как общее число щелчков при показах, деленное на общее число показов.

## <a name="commerce-analytics-preview-installation"></a>Установка аналитики Commerce (предварительная версия)

> [!NOTE]
> Аналитика Commerce (предварительная версия) находится на этапе предварительной версии в регионах США, Канада, Соединенное Королевство, Европа, Южная Азия, Восточная Азия, Австралия и Япония. Если ваша среда Finance and Operations находится в любом из этих регионов, эту функцию можно включить в вашей среде, используя Microsoft Dynamics Lifecycle Services (LCS). Прежде чем можно будет использовать эту функцию, см. раздел [Настройка экспорта в Azure Data Lake](../fin-ops-core/dev-itpro/data-entities/configure-export-data-lake.md).

### <a name="enable-and-configure-commerce-analytics-preview"></a><a name="enableCommerceAnalytics"></a>Включение и настройка аналитики Commerce (предварительная версия)

Для установки аналитики Commerce (предварительная версия) необходимо иметь разрешения на создание ресурсов в подписке Azure. Кроме того, необходимо иметь разрешения на установку надстроек в LCS. Ниже приведен обзор шагов:

1. [Подача формы получения предварительной версии для аналитики Commerce (предварительная версия)](#joinPreview).
2. [Включение и настройка экспорта в Data Lake](#enableExportToDataLake).
3. [Включение и настройка надстройки аналитики Commerce (предварительная версия)](#enableCommerceAnalyticsAddin).
4. [Создание маркера подписанного URL-адреса (SAS) для вашей учетной записи хранения](#getSASToken).
5. [Загрузка скриптов развертывания для представлений Azure Synapse](#downloadSynapseDeploymentScripts).
6. [Установка и настройка Azure Synapse workspace](#configureAzureSynapse).
7. [Установка приложения шаблона Power BI](#powerbi).

### <a name="submit-the-preview-intake-form-for-commerce-analytics-preview"></a><a name="joinPreview"></a>Подача формы получения предварительной версии для аналитики Commerce (предварительная версия)

Отправьте [форму получения предварительной версии для аналитики Commerce (предварительная версия)](https://forms.office.com/r/vW5VLJGXZ2). Чтобы форма была обработана, может потребоваться до трех рабочих дней. После завершения обработки электронное письмо с подтверждением будет отправлено на адрес электронной почты, который указан в форме.

### <a name="enable-and-configure-export-to-data-lake"></a><a name="enableExportToDataLake"></a>Включение и настройка экспорта в Data Lake

Аналитика Commerce (предварительная версия) опирается на функцию экспорта в Data Lake, чтобы экспортировать в Data Lake данные из Commerce HQ и сохранять данные актуальными. Перед настройкой аналитики Commerce (предварительная версия) включите и настройте экспорт в Data Lake, следуя шагам в разделе [Настройка экспорта в Azure Data Lake](../fin-ops-core/dev-itpro/data-entities/configure-export-data-lake.md).

При настройке экспорта в Data Lake запишите следующие сведения, так как их потребуется ввести позже:

- <a name="keyVault"></a>DNS-имя хранилища ключей и секретные имена, в которых хранится идентификатор приложения и секрет приложения. Дополнительные сведения см. в разделе [Добавление секретов в хранилище ключей](../fin-ops-core/dev-itpro/data-entities/configure-export-data-lake.md#addsecrets).
- <a name="storageAccount"></a>Имя учетной записи хранения для экземпляра Data Lake. Дополнительные сведения см. в разделе [Создание учетной записи Data Lake Storage (Gen2) в вашей подписке](../fin-ops-core/dev-itpro/data-entities/configure-export-data-lake.md#createsubscription).

### <a name="enable-and-configure-the-commerce-analytics-preview-add-in"></a><a name="enableCommerceAnalyticsAddin"></a>Включение и настройка надстройки аналитики Commerce (предварительная версия)

Чтобы установить надстройку аналитики Commerce (предварительная версия) в LCS, вы должны быть администратором среды в LCS для среды, которую планируется использовать.

Чтобы установить и настроить надстройку аналитики Commerce (предварительная версия), выполните следующие шаги.

1. Выполните вход в [LCS](https://lcs.dynamics.com/) и перейдите в вашу среду.
2. На странице **Среда** на вкладке **Надстройки сред** выберите **Установить новую надстройку**.
3. В диалоговом окне выберите **Аналитика Commerce (предварительная версия)**.

    Если надстройки **Аналитика Commerce (предварительная версия)** нет в списке, убедитесь, что вы присоединились к программе предварительной оценки.

4. В диалоговом окне **Настройка надстройки** укажите следующие сведения.

    | Информация | Источник | Пример значения |
    |---|---|---|
    | Код клиента Azure AD для вашей среды | Выполните вход на [портале Azure](https://portal.azure.com/) и откройте службу **Azure Active Directory**. Затем откройте страницу **Свойства** и скопируйте значение в поле **Код каталога**. | 72f988bf-0000-0000-00000-2d7cd011db47 |
    | DNS-имя вашего хранилища ключей | Введите [DNS-имя](#keyVault) вашего хранилища ключей. Вы должны были записать этой значение в предыдущем разделе. | `https://contosod365datafeedpoc.vault.azure.net/` |
    | Секрет, содержащий код приложения | Введите [имя секрета, в котором хранится код приложения](#keyVault). Вы должны были записать этой значение в предыдущем разделе. | app-id |
    | Секрет, содержащий секрет приложения | Введите [имя секрета, в котором хранится секрет приложения](#keyVault). Вы должны были записать этой значение в предыдущем разделе. | app-secret |

5. Примите условия предложения, установив флажок, а затем выберите **Установить**.

    Система устанавливает и настраивает надстройку аналитики Commerce (предварительная версия) для среды. Этот процесс может занять несколько минут. После завершения **Аналитика Commerce (предварительная версия)** должна быть перечислена на странице **Среда**, и статус должен быть **Установлено**.

### <a name="generate-a-sas-token-for-your-storage-account"></a><a name="getSASToken"></a>Создание токена SAS для учетной записи хранения

Маркер SAS позволяет внешним сущностям получать доступ к учетной записи хранения и иметь конкретный набор привилегий в течение конечного периода времени. Azure Synapse будет использовать маркер SAS для доступа к данным в Data Lake.

> [!NOTE]
> Из-за известного ограничения аналитики Commerce (предварительная версия) экземпляр Azure Synapse при истечении срока действия маркера SAS потеряет доступ к Data Lake. Таким образом, при создании токена SAS необходимо задать максимальную дату окончания срока действия, которую допускают политики безопасности организации.

Чтобы создать маркер SAS, выполните следующие действия.

1. На портале Azure перейдите к [учетной записи хранения](#storageAccount), которая была создана во время настройки экспорта в Data Lake.
2. В левой области под учетной записью хранения выберите **Подписанный URL-адрес**.
3. На странице **Параметры SAS** задайте следующие поля.

    | Поле | Значение |
    |---|---|
    | Разрешенные службы | Выберите **BLOB**. |
    | Разрешенные типы ресурсов | Выберите **Служба**, **Контейнер** и **Объект**. |
    | Разрешенные разрешения | Выберите **Чтение**, **Запись**, **Удаление**, **Список**, **Добавление** и **Создание**. |
    | Разрешения для управления версиями BLOB | Выберите **Разрешает удаление версий**. |
    | Дата и время начала и окончания срока действия | Установите соответствующие дату и время начала и окончания для маркера SAS. |
    | Разрешенные IP-адреса | Оставьте это поле пустым. |
    | Разрешенные протоколы | Выберите **Только HTTPS**. |
    | Предпочитаемый уровень маршрутизации | Выберите **Базовый (по умолчанию)**. |
    | Ключ подписывания | Выберите **key1** or **key2**, как требуется. |

4. Выберите **Создать SAS и строку подключения**.
5. Скопируйте значение в поле **Маркер SAS** и вставьте его в текстовый редактор, например Блокнот.

### <a name="download-the-deployment-scripts-for-azure-synapse-views"></a><a name="downloadSynapseDeploymentScripts"></a>Загрузка скриптов развертывания для представлений Azure Synapse

Чтобы создать и опубликовать необходимые представления в Azure Synapse workspace, необходимо выполнить набор сценариев. Выполните следующие шаги, чтобы загрузить скрипты.

1. В GitHub перейдите в репозиторий (репо) [microsoft/Dynamics365Commerce.Solutions](https://github.com/microsoft/Dynamics365Commerce.Solutions).
2. Загрузите сценарии на локальный компьютер, задав клонирование репозитория или загрузив его в виде ZIP-файла.

### <a name="install-and-configure-an-azure-synapse-workspace"></a><a name="configureAzureSynapse"></a>Установка и настройка Azure Synapse workspace

Чтобы установить и настроить Azure Synapse workspace, выполните следующие шаги.

1. Установите Azure Synapse workspace в вашу подписку Azure. Дополнительные сведения см. в разделе [Краткое описание. Создание рабочей области Synapse workspace](/azure/synapse-analytics/quickstart-create-workspace).
2. В Блокноте или другом текстовом редакторе откройте файл сценария **SetupSynapse.sql** из папки на локальном компьютере, которая был клонирован или загружен репозиторий Dynamics365Commerce.Solutions в предыдущем разделе. Файл сценария будет находиться в папке /Pipeline/CommerceAnalyticsSynapse/. В сценарии замените текст местозаполнителя значениями, как показано в следующей таблице.

    | Текст заполнителя | Значение замены |
    |---|---|
    | placeholder_storageaccount | Имя [учетной записи хранения](#storageAccount), которая была создана во время настройки экспорта в Data Lake. |
    | <a name="phContainer"></a>placeholder_container | Имя контейнера хранилища, который был создан в экземпляре Data Lake после успешной установки надстройки экспорта в Data Lake в LCS. Чтобы получить имя контейнера, необходимо использовать Обозреватель службы хранилища на портале Azure, чтобы просмотреть учетную запись хранения. |
    | placeholder_sastoken | Созданный вами [маркер SAS](#getSASToken). Обязательно удалите вопросительный знак (**?**) из начала значения маркера SAS. |
    | <a name="phUserPwd"></a>placeholder_password | Надежный пароль по вашему выбору. Запишите этот пароль. Он будет установлен в качестве пароля для новой учетной записи **reportreadonlyuser**, созданной сценарием. **Не** вводите пароль учетной записи **sqladminuser**. |

3. Скопируйте обновленное содержимое файла сценария.
4. На портале Azure перейдите в новую Azure Synapse workspace. На странице **Обзор** выберите **Открыть Synapse Studio**.
5. В Synapse Studio выберите **Создать \> Сценарий SQL** и вставьте содержимое файла сценария в редактор сценариев SQL.
6. Убедитесь, что в поле **Использовать базу данных** установлено значение **основная**.
7. Выберите **Выполнить** и дождитесь завершения выполнения сценария. Успешное выполнение сценария создаст базу данных для аналитики Commerce, учетные данные для доступа к Data Lake и учетную запись пользователя только для чтения, которая будет использоваться Power BI для подключения к экземпляру Azure Synapse.
8. На локальном компьютере откройте Windows PowerShell в режиме администратора и перейдите в папку /Pipeline/CommerceAnalyticsSynapse/, которая находится в папке, которая была клонирована или загружена в репозиторий Dynamics365Commerce.Solutions.
9. Настройте политику выполнения Windows PowerShell, выполнив следующую команду.

    ```powershell
    Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
    ```

10. Если модуль SQL Server PowerShell еще не установлен, установите его, выполнив следующую команду.

    ```powershell
    Install-Module sqlserver
    ```

    > [!NOTE]
    > Во время установки модуля может появиться предложение установить поставщика NuGet. В этом случае выберите **Y** для установки поставщика NuGet. Кроме того, может быть предложено подтвердить, что вы устанавливаете модули из ненадежного репозитория. В этом случае выберите **Y**, чтобы продолжить установку. При необходимости можно выполнить командлет **Set-PSRepository**, чтобы доверять репозиторию **PSGallery**.

11. Опубликуйте представления Azure Synapse, выполнив следующую команду.

    ```powershell
    .\PublishSynapseViews.ps1 -serverName SERVER_NAME -password PASSWORD -storageAccount STORAGE_ACCOUNT -containerName CONTAINER_NAME -datarootpath DATA_ROOT_PATH
    ```

    При выполнении этой команды замените значения местозаполнителей, как показано в следующей таблице.

    | Значение заполнителя | Значение замены |
    |---|---|
    | SERVER_NAME | Наименование конечной точки Azure Synapse Serverless SQL. Это значение можно получить на странице **Обзор** Azure Synapse workspace на портале Azure. |
    | PASSWORD | Пароль для учетной записи **sqladminuser**. |
    | STORAGE_ACCOUNT | Имя учетной записи хранения для Data Lake. |
    | CONTAINER_NAME | Имя контейнера, созданного функцией экспорта в Data Lake. Этот контейнер совпадает с контейнером, указанным в качестве значения [placeholder_container](#phContainer) на шаге 2. |
    | DATA_ROOT_PATH | Имя папки в контейнере, содержащей все данные. |

    > [!NOTE]
    > Имя учетной записи хранения, имя контейнера и путь к корню данных можно найти с помощью браузера службы хранилищ Azure и учетной записи хранилища Data Lake на портале Azure.

12. Дождитесь завершения выполнения сценария. Успешное выполнение сценария приведет к созданию представлений SQL в экземпляре Azure Synapse Serverless SQL.

### <a name="install-the-power-bi-template-app"></a><a name="powerbi"></a>Установка приложения шаблона Power BI

Чтобы установить приложение шаблона Power BI для аналитики Commerce (предварительная версия), выполните следующие шаги.

1. Выполните вход на [портал Power BI](https://powerbi.microsoft.com/), используя код вашей организации.
2. Установите приложение шаблона аналитики Commerce (предварительная версия) Power BI, перейдя по адресу [https://aka.ms/cdireport-installapp](https://aka.ms/cdireport-installapp). Может появиться предупреждение о том, что приложение отсутствует в списке AppSource. Выберите **Установить**.
3. Если приложение устанавливается в первый раз, переходите к шагу 5. Если это приложение было установлено раньше, отображаются следующие параметры обновления приложения:

    - **Обновление рабочей области и приложения** — обновление существующего приложения шаблона и перезапись существующих настроек приложения, таких как имя экземпляра приложения и конфигурации разрешений.
    - **Обновление только содержимого рабочей области без обновления приложения** — обновление существующего приложения шаблона, но сохранение существующих настроек приложения. *Этот параметр является рекомендуемым вариантом для обновлений приложения.*
    - **Установка другой копии приложения в новую рабочую область** — создание новой рабочей области, а затем создание копии имеющегося в ней приложения шаблона. Существующая рабочая область останется нетронутой.

4. Выберите один из вариантов обновления, затем выберите **Установить**.
5. Откройте установленное приложение, выбрав **Приложения** в левой области, затем выбрав приложение.
6. Подключите приложение к источнику данных, выбрав **Подключить**. Если вы установили приложение ранее, выберите ссылку **Подключить ваши данные** на желтой панели сообщений.
7. Задайте следующие поля.

    | Поле | Значение |
    |---|---|
    | Сервер | Введите имя конечной точки Azure Synapse Serverless SQL, созданной в предыдущем разделе. Это значение можно получить на странице **Обзор** Azure Synapse workspace на портале Azure. |
    | База данных | Введите **CommerceAnalytics**. |
    | Язык | Выберите значение в списке. Это поле используется для локализованных названий продуктов и категорий. Значение учитывает регистр. |
    | Диапазон дат | Выберите значение в списке. Данные за выбранное число месяцев будут импортированы в набор данных Power BI. Выбранное значение влияет на размер набора данных и на время, необходимое для синхронизации. |

8. Выберите **Далее**. Вам будет предложено ввести учетные данные для подключения к базе данных Azure Synapse SQL. Задайте поля, как показано в следующей таблице.

    | Поле | Значение |
    |---|---|
    | Метод проверки подлинности | Выберите **Базовый**. |
    | Имя пользователя | Введите **reportreadonlyuser**. |
    | Пароль | Введите значение, на которое вы заменили заполнитель [placeholder_password](#phUserPwd) в сценарии SetupSynapse.sql. Этот пароль представляет собой пароль для учетной записи **reportreadonlyuser**. |

9. Выберите **Выполните вход и подключитесь**.
10. Подождите, пока набор данных не будет успешно обновлен. Затем выберите кнопку **Изменить приложение**, чтобы открыть рабочую область приложения, в которой можно просмотреть статус обновления набора данных. В рабочей области приложения можно также дополнительно настроить расписания автоматического обновления для набора данных, управлять разрешениями и переименовывать экземпляр приложения.

### <a name="privacy"></a><a name="privacy"></a>Безопасность

Мы заботимся о конфиденциальности ваших данных. Чтобы получить дополнительные сведения, ознакомьтесь с нашим [заявлением о конфиденциальности](https://go.microsoft.com/fwlink/?LinkId=521839).

[!INCLUDE[footer-include](../includes/footer-banner.md)]
