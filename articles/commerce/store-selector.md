---
title: Модуль выбора магазина
description: В этой статье описывается модуль выбора магазина, а также описывается, как добавить его на страницы сайта в Microsoft Dynamics 365 Commerce.
author: anupamar-ms
ms.date: 05/18/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: anupamar
ms.search.validFrom: 2020-02-10
ms.dyn365.ops.version: ''
ms.custom: ''
ms.assetid: ''
ms.search.industry: ''
manager: annbe
ms.openlocfilehash: aa3aed837072cb6c3d4f7f92bec2f4b700408cf7
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/12/2022
ms.locfileid: "9268349"
---
# <a name="store-selector-module"></a>Модуль выбора магазина

[!include [banner](includes/banner.md)]

В этой статье описывается модуль выбора магазина, а также описывается, как добавить его на страницы сайта в Microsoft Dynamics 365 Commerce.

Клиенты могут использовать модуль выбора магазина для комплектации продукта в выбранном магазине после покупки в сети. В Commerce версии 10.0.13 модуль выбора магазина также содержит дополнительные возможности, позволяющие демонстрировать страницу **Поиск магазина** с ближайшими магазинами.

Модуль выбора магазина позволяет пользователям вводить местоположение (город, область, адрес и т. д.), чтобы искать магазины в радиусе поиска. При первом открытии модуля он использует местоположение браузера клиента, чтобы найти магазины (если предоставлено согласие).

## <a name="store-selector-module-usage"></a>Использование модуля выбора магазина

- Модуль выбора магазина может использоваться на странице сведений о продукте (PDP) для выбора магазина для комплектации.
- Модуль выбора магазина может использоваться на странице корзины для выбора магазина для комплектации.
- Модуль выбора магазина может использоваться на автономной странице, в которой отображаются все доступные магазины.

## <a name="fulfillment-group-setup-in-commerce-headquarters"></a>Настройка группы выполнения в Commerce headquarters

Чтобы в окне выбора магазинов отображались доступные магазины, группа выполнения должна быть настроена в Commerce Headquarters. Дополнительные сведения см. в [Настройка групп выполнения](customer-orders-overview.md#set-up-fulfillment-groups).

Кроме того, для каждого магазина в группе выполнения необходимо определить широту и долготу местоположения магазина в Headquarters.

Чтобы ввести значения широты и долготы для местоположения магазина в Commerce headquarters, выполните следующие действия.

1. Перейдите в **Управление запасами \> Настройка \> Разделение запасов**.
1. Выберите местонахождение склада на левой области.
1. На экспресс-вкладке **Адреса** выберите **Дополнительно**.

    ![Пример сведений о магазине в центральном офисе.](./media/Store-address.png)

1. На панели операций выберите **Правка**.
1. На экспресс-вкладке **Общие** введите значения для **широты** и **долготы**.

    ![Пример настройки широты и долготы для магазина в центральном офисе.](./media/Store-latitude-longitude.png)

1. На панели операций выберите **Сохранить**. 

### <a name="hide-a-store-from-the-store-selector-module"></a>Скройте магазин из модуля выбора магазина

Некоторые магазины в группе выполнения могут оказаться недопустимыми местами для самовывоза. Чтобы убедиться, что в модуле выбора магазина в качестве параметров отображаются только допустимые места для самовывоза, выполните следующие действия в Commerce Headquarters.

1. Выберите **Розничная торговля и коммерция \> Настройка Commerce \> Группы выполнения \> Все магазины**.
1. На панели операций выберите **Правка**.
1. В разделе **Настройка** для каждого магазина, который не является допустимым местом для отправки, снимите флажок **Местоположение, допускающее самовывоз**.
1. На панели операций выберите **Сохранить**.
1. Запустите график распределения 1070 **Конфигурация канала**.

## <a name="bing-maps-integration"></a>Интеграция карт Bing

Модуль выбора магазина интегрирован с [API приложения Карт Bing REST](/bingmaps/rest-services/) для использования функций геокодирования и автозаполнения в Bing. Требуется ключ API карт Bing, который должен быть добавлен на страницу общих параметров в центральном офисе Commerce. API геокодирования используется для преобразования местоположения в значения широты и долготы. Интеграция с API автозаполнения используется для отображения вариантов поиска, когда пользователи вводят местоположения в поле поиска.

Для API автозаполнения REST API необходимо убедиться, что следующие URL-адреса разрешены в политике безопасности содержимого сайта (CSP). Эта настройка выполняется в построителе сайтов Commerce путем добавления разрешенных URL-адресов в различные директивы CSP для сайта (например, **img-src**). Дополнительные сведения см. в разделе [Политика безопасности содержимого](manage-csp.md). 

- В директиву **connect-src** добавьте **&#42;.bing.com**.
- В директиву **img-src**, добавьте **&#42;.virtualearth.net**.
- В директиву **script-src** **добавьте &#42;.bing.com, &#42;.virtualearth.net**.
- В директиву **script style-src** добавьте **&#42;.bing.com**.

## <a name="pickup-in-store-mode"></a>Режим комплектации в магазине

Модуль выбора магазина поддерживает режим **Самовывоз из магазина**, в котором отображается список магазинов, в которых продукт доступен для комплектации. Кроме того, отображаются часы работы и запасы товаров для каждого магазина в списке. Для модуля выбора магазина требуется контекст продукта, чтобы отобразить доступность продукта и позволить пользователю добавлять продукт в корзину, если режим доставки задан как **комплектация** в выбранном магазине. Для получения дополнительной информации о см. раздел [Параметры запасов](inventory-settings.md). 

Модуль выбора магазина можно добавить в модуль поля покупки на странице PDP, чтобы отображать магазины, в которых продукт доступен для получения. Его также можно добавить в модуль корзины. В этом случае в модуле выбора магазина отображаются параметры отправки для каждого элемента строки в корзине. Модуль выбора магазина можно также добавить на другие страницы или модули через расширения и настройки.

Для работы этого сценария следует настроить режим доставки продуктов **самовывоз**. В противном случае модуль не будет отображаться на страницах продуктов. Подробные сведения о настройке режима доставки см. в разделе [Настройка способов доставки](/dynamicsax-2012/appuser-itpro/set-up-modes-of-delivery).

На следующем рисунке показан пример модуля выбора магазина, используемого на странице сведений о продукте.

![Пример модуля выбора магазина, используемого на странице сведений о продукте.](./media/BOPIS.PNG)

> [!NOTE]
> В версии 10.0.16 и более поздних может быть активирована новая функция, позволяющая организации определить несколько режимов самовывоза в вариантах доставки для клиентов.  Если эта функция включена, модуль выбора магазина и другие модули электронной коммерции будут усовершенствованы, чтобы позволить покупателю выбрать один из потенциально возможных вариантов поставки самовывозом, если они настроены.  Дополнительные сведения об этой функции см. в [этой документации](./multiple-pickup-modes.md). 

## <a name="find-stores-mode"></a>Режим поиска магазинов

Модуль выбора магазина также поддерживает режим **Поиск магазинов**. Этот режим можно использовать для создания страницы местоположений магазинов, на которой отображаются доступные магазины и сведения о них. В этом режиме модуль выбора магазина работает без контекста продукта и может использоваться как отдельный модуль на любой странице сайта. Кроме того, если для модуля включены соответствующие параметры, пользователи могут выбрать магазин в качестве предпочтительного магазина. Когда магазин выбран как предпочитаемый пользователем, идентификатор магазина сохраняется в файле cookie браузера. Поэтому пользователь должен принять сообщение о согласии cookie.

На следующем рисунке показан пример модуля выбора магазина, который используется вместе с модулем карты на странице местоположения магазинов.

![Пример модуля выбора магазина и модуля карты на странице местоположения магазина.](./media/ecommerce-Storelocator.PNG)

## <a name="render-a-map"></a>Отображение карты

Модуль выбора магазина может использоваться вместе с модулем карты для отображения местоположений магазинов на карте. Дополнительные сведения о модуле карты см. в разделе [Модуль карты](map-module.md)

## <a name="store-selector-module-properties"></a>Свойства модуля выбора магазина

| Имя свойства | значение | описание |
|---------------|-------|-------------|
| Заголовок | Текст | Заголовок модуля. |
| Режим | **Поиск магазинов** или **Самовывоз из магазина** | Режим **Поиск магазинов** отображает доступные магазины. Режим **Самовывоз из магазина** позволяет пользователям выбирать магазин для отправки. |
| Стиль | **Диалоговое окно** или **встроенный элемент** | Модуль может быть визуально представлен как встроенный, так и в диалоговом окне. |
| Установить в качестве предпочтительного магазина | **True** или **False** | Если это свойство имеет значение **Истина**, пользователи могут настроить предпочтительный магазин. Для этой функции требуется, чтобы пользователи приняли сообщение о согласии с cookie. |
| Показать все магазины | **True** или **False** | Если это свойство имеет значение **Истина**, пользователи могут пропустить свойство **Радиус поиска** и просмотреть все магазины. |
| Параметры автозаполнения: макс. результаты | Номер | Это свойство определяет максимальное число результатов автозаполнения, которые могут отображаться через API Автозаполнения Bing. |
| Радиус поиска | Номер | Это свойство определяет радиус поиска магазинов, в милях. Если значение не указано, используется радиус поиска по умолчанию в 50 миль. |
| Условия предоставления услуг | URL |  Это свойство задает URL-адрес условий предоставления услуг, которые необходимы для использования службы Карт Bing. |

## <a name="site-settings"></a>Параметры сайта

Модуль выбора магазина соблюдает [Параметры добавления продукта в корзину](add-cart-settings.md). После добавления номенклатуры в корзину из модуля выбора магазина, пользователи сайта увидят соответствующие настроенные бизнес-правила.

## <a name="add-a-store-selector-module-to-a-page"></a>Добавление модуля выбора магазина на страницу

Для режиме **Самовывоз из магазина** модуль может использоваться только на страницах PDP и корзины. Необходимо настроить режим **Самовывоз из магазина** в области свойств модуля.

- Сведения о порядке добавления модуля выбора магазина в модуль поля покупки можно найти в разделе [Модуль поля покупки](add-buy-box.md). 
- Сведения о порядке добавления модуля выбора магазина в модуль корзины можно найти в разделе [Модуль корзины](add-cart-module.md).

Чтобы настроить модуль выбора магазина, чтобы отобразить доступные магазины для страницы местоположения магазинов, как показано выше в этой статье, выполните следующие действия.

1. Перейдите к пункту **Шаблоны**, выберите **Создать**, чтобы создать шаблон.
1. В диалоговом окне **Создать шаблон** в разделе **Имя шаблона** введите **Шаблон маркетинга**, затем выберите **ОК**.
1. Выберите **Сохранить**, выберите **Завершить редактирование** для возврата шаблона, затем нажмите кнопку **Опубликовать**, чтобы опубликовать его.
1. Перейдите к разделу **Страницы**, выберите **Создать**, чтобы создать страницу.
1. В диалоговом окне **Создать страницу** в разделе **Имя страницы** введите **Местонахождения магазинов**, затем выберите **Далее**.
1. В области **Выбор шаблона** выберите созданный **шаблон маркетинга** и выберите **Далее**.
1. В области **Выбор макета** выберите макет страницы (например, **Гибкий макет**), а затем нажмите кнопку **Далее**.
1. В области **Проверка и завершение** проверьте конфигурацию страницы. Если необходимо изменить сведения о странице, нажмите кнопку **Назад**. Если сведения на странице верны, выберите **Создать страницу**. 
1. В слоте **Главный** новой страницы выберите многоточие (**...**), затем выберите **Добавить модуль**.
1. В диалоговом окне **Выбрать модуль** выберите модуль **Контейнер**, затем выберите **ОК**.
1. В ячейке **Контейнер** выберите многоточие (**...**), затем выберите **Добавить модуль**.
1. В диалоговом окне **Выбрать модули** выберите модуль **Контейнер с 2 столбцами**, затем выберите **ОК**.
1. В области свойства модуля установите значение **Ширина** как **Вписать в контейнер**.
1. Установите значение **Настройка столбца порта очень маленького представления** равным **100%**.
1. Установите значение **Настройка столбца порта небольшого представления** равным **100%**.
1. Установите значение **Настройка столбца порта среднего представления** равным **33% 67%**.
1. Установите значение **Настройка столбца порта большого представления** равным **33% 67%**.
1. В ячейке **Контейнер с 2 столбцами** выберите многоточие (**...**), затем выберите **Добавить модуль**.
1. В диалоговом окне **Выбрать модули** выберите модуль **Выбор магазина**, затем выберите **ОК**.
1. В области свойства модуля установите значение **Режим** как **Поиск магазинов**.
1. Задайте значение **Радиус поиска** в милях.
1. Задайте другие свойства, такие как **Установить в качестве предпочитаемого магазина**, **Показать все магазины** и **Включить автозаполнение**.
1. В ячейке **Контейнер с 2 столбцами** выберите многоточие (**...**), затем выберите **Добавить модуль**.
1. В диалоговом окне **Выбрать модуль** выберите модуль **Карта**, затем выберите **ОК**.
1. В области свойств модуля задайте любые дополнительные свойства, как требуется.
1. Выберите **Сохранить**, выберите **Завершить редактирование** для возврата страницы, затем нажмите кнопку **Опубликовать**, чтобы опубликовать ее.
 
## <a name="additional-resources"></a>Дополнительные ресурсы

[Обзор библиотеки модулей](starter-kit-overview.md)

[Модуль поля покупки](add-buy-box.md)

[Модуль корзины](add-cart-module.md)

[Краткий обзор страницы сведений о продукте](quick-tour-pdp.md)

[Краткий обзор корзины и оформления заказа](quick-tour-cart-checkout.md)

[Настройка способов поставки](/dynamicsax-2012/appuser-itpro/set-up-modes-of-delivery)

[Управление картами Bing для вашей организации](dev-itpro/manage-bing-maps.md)

[REST API Карт Bing Maps](/bingmaps/rest-services/)

[Модуль карт](map-module.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]
