---
title: Проверка проводок магазина для расчета журнала операций
description: В этом разделе описываются функции проверки проводок магазина в Microsoft Dynamics 365 Commerce.
author: analpert
ms.date: 12/15/2021
ms.topic: index-page
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgriffin
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: analpert
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: 008368ae32aa92682d578b75b148e0587fcc94e0
ms.sourcegitcommit: 70ac76be31bab7ed5e93f92f4683e65031fbdf85
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/16/2021
ms.locfileid: "7924779"
---
# <a name="validate-store-transactions-for-statement-calculation"></a>Проверка проводок магазина для расчета журнала операций

[!include [banner](includes/banner.md)]

В этом разделе описываются функции проверки проводок магазина в Microsoft Dynamics 365 Commerce. В процессе проверки определяются и помечаются проводки, которые приведут к ошибкам разноски, до того, как они будут собраны в процессе разноски журнала операций.

При попытке разнести журнал операций проверка может завершиться сбоем из-за несогласованных данных в таблицах проводок Commerce. Ниже приведены некоторые примеры факторов, которые могут привести к такой несогласованности:

- Общая сумма проводки в таблице заголовков не соответствует общей сумме проводок в строках.
- Количество номенклатур, указанное в таблице заголовков, не соответствует количеству номенклатур в таблице проводок.
- Сумма налогов в таблице заголовков не соответствует сумме налогов в строках. 

Если в процессе разноски журнала операций собираются несогласованные проводки, создаваемые накладные по продажам и журналы платежей могут привести к сбою разноски журнала операций. Процесс **Проверить проводки магазина** предотвращает эти ошибки, гарантируя, что только проводки, соответствующие правилам проверки проводок, будут переданы в процесс расчета журнала проводок.

На следующем рисунке показаны повторяющиеся дневные процессы для отправки проводок, проверки проводок, расчета и разноски журналов проводок, а также процессы на конец дня для расчета и разноски финансового отчета.

![Рисунок: повторяющиеся дневные процессы для отправки проводок, проверки проводок, расчета и разноски журналов проводок, а также процессы на конец дня для расчета и разноски финансового отчета](./media/valid-checker-statement-posting-flow.png)

## <a name="store-transaction-validation-rules"></a>Правила проверки проводок магазина

Процесс пакетной обработки **Проверить проводки магазина** проверяет согласованность таблиц проводок Commerce на основе следующих правил проверки.

> [!NOTE]
> Правила проверки будут продолжать добавляться в последующих выпусках.

### <a name="transaction-header-validation-rules"></a>Правила проверки заголовков проводок

В следующей таблице перечислены правила проверки заголовков проводок, в соответствии с которыми проверяются заголовки проводок розничной торговли, прежде чем эти проводки будут переданы в разноску журнала операций.

| Название | Описание |
|-------|-------------|
| Бизнес-дата | Это правило проверяет, что бизнес-дата проводки связана с открытым финансовым периодом в книге учета. |
| Округление валюты | Это правило проверяет, что суммы проводок округляются в соответствии с правилом округления валюты. |
| Счет клиента | Это правило проверяет, что клиент, используемый в проводке, существует в базе данных. |
| Сумма скидки | Это правило проверяет, что сумма скидки в заголовке равна сумме всех сумм скидок строк. |
| Статус разноски финансового документа (Бразилия) | Это правило проверяет, можно ли успешно разнести финансовый документ. |
| Валовая сумма | Это правило проверяет, что валовая сумма в заголовке проводки соответствует чистой сумме, включая налог, в строках проводки плюс накладные расходы. |
| Чистая сумма | Это правило проверяет, что чистая сумма в заголовке проводки соответствует чистой сумме, за исключением налога, в строках проводки плюс накладные расходы. |
| Чистая сумма + налог | Это правило проверяет, что валовая сумма в заголовке проводки соответствует чистой сумме, за исключением налога, в строках проводки плюс все налоги и накладные расходы. |
| Число номенклатур | Это правило проверяет, что число номенклатур, указанное в заголовке проводки, совпадает с суммой количеств в строках проводки. |
| Сумма платежа | Это правило проверяет, что сумма платежа в заголовке проводки совпадает с суммой всех проводок по оплате. |
| Расчет налогового освобождения | Это правило проверяет, что сумма рассчитанной суммы и суммы налогового освобождения в строках накладных расходов равна исходной рассчитанной сумме. |
| Налог включен в цену | Это правило проверяет, что флаг **Налог включен в цену** последовательно используется в заголовке проводки и налоговых проводках. |
| Проводка не пустая | Это правило проверяет, что проводка содержит строки и что хотя бы одна строка не аннулирована. |
| Недоплата/переплата | Это правило проверяет, что разница между валовой суммой и суммой платежа не превышает максимальную конфигурацию недоплаты/переплаты. |

### <a name="transaction-line-validation-rules"></a>Правила проверки строк проводок

В следующей таблице перечислены правила проверки строк проводок, в соответствии с которыми проверяются сведения о строке проводок розничной торговли, прежде чем эти проводки будут переданы в разноску журнала операций.

| Название | Описание |
|-------|-------------|
| Штрих-код | Это правило проверяет, что все штрих-коды номенклатур, используемые в строках проводки, существуют в базе данных. |
| Строки накладных расходов | Это правило проверяет, что сумма рассчитанной суммы и суммы налогового освобождения в строках накладных расходов равна исходной рассчитанной сумме. |
| Возвраты подарочных сертификатов | Это правило проверяет, что в проводке нет возвратов подарочных сертификатов. |
| Вариант номенклатуры | Это правило проверяет, что все номенклатуры и все варианты, используемые в строках проводки, существуют в базе данных. |
| Скидка по строке | Это правило проверяет, что сумма скидки по строке соответствует сумме проводок по скидкам. |
| Налог по строке | Это правило проверяет, что сумма налога по строке соответствует сумме налоговых проводок. |
| Отрицательная цена | Это правило проверяет, что отрицательные цены используются в строках проводок. |
| Под управлением серийного номера | Это правило проверяет, что серийный номер присутствует в строке проводки для номенклатур, управляемых серийным номером. |
| Аналитика серийного номера | Это правило проверяет, что серийный номер не указан, если аналитика серийного номера номенклатуры неактивна. |
| Несоответствие знака | Это правило проверяет, что знак количества и знак чистой суммы одинаковы во всех строках проводок. |
| Налоговое освобождение | Это правило проверяет, что сумма цены для номенклатуры строки и суммы налогового освобождения равна исходной цене. |
| Назначение налоговой группы | Это правило проверяет, что сочетание налоговой группы и налоговой группы номенклатуры создает допустимое пересечение налога. |
| Преобразования единиц измерения | Это правило проверяет, что единица измерения всех строк имеет допустимое преобразование в единицу измерения складского учета. |

## <a name="enable-the-store-transaction-validation-process"></a>Включение процесса проверки проводок магазина

Настройте задание **Проверить проводки магазина** для периодического выполнения в Commerce Headquarters (**Retail и Commerce \> ИТ Retail и Commerce \> Разноска POS**). Пакетное задание планируется на основе организационной иерархии магазина. Рекомендуется настроить этот процесс пакетной обработки так, чтобы он выполнялся с той же частотой, что пакетные задания **P-задание** и **Расчет журналов проводок**.

## <a name="results-of-the-validation-process"></a>Результаты выполнения процесса проверки

Результаты процесса пакетной обработки **Проверить проводки магазина** можно просмотреть в каждой проводке магазина розничной торговли. В поле **Статус проверки** в записи проводки задается значение **Успешно**, **Ошибка** или **Нет**. В поле **Время последней проверки** отображается дата последнего выполнения проверки.

В следующей таблице описываются все статусы проверки.

| Статус проверки | Описание |
|-------------------|-------------|
| Успешно | Все включенные правила проверки выполнены. |
| Ошибка | Включенное правило проверки обнаружило ошибку. Чтобы просмотреть дополнительные сведения об ошибке, выберите **Ошибки проверки** в области действий. |
| Нет | Для типа проводки не требуется применение правил проверки. |

![Страница проводок магазина, на которой показано поле "Статус проверки" и кнопка "Ошибки проверки".](./media/valid-checker-validation-status-errors.png)

Только проводки со статусом проверки **Успешно** будут переданы в журналы проводок. Чтобы просмотреть проводки со статусом **Ошибка**, проверьте плитку **Ошибки проверки кассовых проводок** в рабочей области **Финансовая информация магазина**.

![Плитки в рабочей области "Финансовая информация магазина".](./media/valid-checker-cash-carry-validation-failures.png)

Дополнительные сведения о том, как исправить ошибки проверки кассовых проводок, см. в разделе [Редактирование и аудит кассовых проводок и проводок управления кассами](edit-cash-trans.md).

## <a name="additional-resources"></a>Дополнительные ресурсы

[Редактирование и аудит кассовых проводок и проводок управления кассами](edit-cash-trans.md)

[!INCLUDE[footer-include](../includes/footer-banner.md)]
