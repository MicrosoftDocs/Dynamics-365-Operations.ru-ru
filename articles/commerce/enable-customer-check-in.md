---
title: Включение уведомлений о возврате клиентов в POS-терминале
description: В этой статье описывается, как включить уведомления о прибытии клиентов в POS Microsoft Dynamics 365 Commerce.
author: bicyclingfool
ms.date: 12/03/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ROBOTS: ''
audience: Application user
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.author: stuharg
ms.search.validFrom: 2021-04-01
ms.dyn365.ops.version: 10.0.19
ms.openlocfilehash: ae53657c95128eae793f670bd9dbc31d9fac0fe4
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2022
ms.locfileid: "8885153"
---
# <a name="enable-customer-check-in-notifications-in-point-of-sale-pos"></a>Включение уведомлений о возврате клиентов в POS-терминале

[!include [banner](includes/banner.md)]

В этой статье описывается, как включить уведомления о прибытии клиентов в POS Microsoft Dynamics 365 Commerce.

В сообщениях по электронной почте "заказ готов для отправки" организации могут создать ссылку или кнопку, которые позволяют пользователям уведомлять магазин о том, что они находятся в помещении компании, и ожидают получения товара. После этого клиенты получают подтверждение прибытия, и магазин получает уведомление в качестве задачи в своем приложении POS. Эта задача выступает в качестве напоминания для продавца для доставки заказа к автомобилю клиента. Поэтому клиент не должен входить магазин.

Workflow-процесс прибытия клиента также может быть настроен для сбора дополнительных сведений от клиентов, таких как номер места стоянки, марка, модель и цвет автомобиля, и инструкции по доставке. Помощник по розничному магазину может использовать эту информацию для облегчения выполнения заказов.

## <a name="enable-customer-check-in"></a>Включение прибытия клиента

Когда функция прибытия клиента включена, Commerce создает код подтверждения заказа (также называемый кодом ссылки на канал). Кроме того, в нем создаются коды подтверждения заказа для заказов, созданных через POS или каналы центра обработки звонков. 

Чтобы включить функцию прибытия клиента в Commerce Headquarters, выполните следующие действия.

1. Перейдите в раздел **Рабочие области \> Управление функциями**.
2. Выполните поиск на вкладке **Создание согласованного формата кода ссылки для канала по каналам**. 
3. Выберите функцию, затем в области свойств выберите **Включить сейчас**. 

## <a name="create-a-check-in-confirmation-page"></a>Создание страницы подтверждения прибытия

На веб-сайте электронной коммерции необходимо создать новую страницу, которая будет использоваться в качестве подтверждения прибытия. С помощью дополнительной настройки страница также может включать в себя форму, которая собирает дополнительные сведения от клиентов, чтобы облегчить выполнение заказа. Сведения о настройке страницы и модуля см. в разделе [Модуль прибытия клиента](check-in-pickup-module.md).

## <a name="configure-the-transactional-email-template"></a>Настройка шаблона транзакционных писем

Необходимо добавить ссылку или кнопку **Я здесь** в шаблон для транзакционного письма, которое клиенты получают, когда их заказ готов к отправке. Клиенты будут использовать эту ссылку или кнопку для уведомления магазина о том, что они прибыли забрать свой заказ. 

Добавьте ссылку или кнопку в шаблон, который сопоставлен с типом уведомления **Упаковка завершена** и режимом доставки, используемым для выполнения заказа самовывоза. В шаблоне создайте HTML-ссылку или кнопку, указывающую на URL-адрес созданной страницы подтверждения прибытия, включая имена и значения параметров, как показано в следующем примере.

`<a href="https://[YOUR_SITE_DOMAIN]/[CHECK-IN_CONFIRMATION_PAGE]?channelReferenceId=%confirmationid%&channelId=%channelid%&packingSlipId=%packingslipid%" target="_blank">I am here!</a>`

Дополнительные сведения о настройке шаблонов электронной почты см. в разделе [Настройка транзакционных писем по режиму доставки](customize-email-delivery-mode.md). 

## <a name="a-check-in-confirmation-task-is-created-in-pos"></a>Задача подтверждения прибытия создается в POS

После того, как клиент сообщит магазину о том, что он готов забрать товар, на странице прибытия отображается предупреждающее сообщение и необязательный QR-код, содержащий код подтверждения заказа клиента. В то же время в списке задач в POS создается задача для магазина, в котором клиент забирает заказ. Эта задача содержит все сведения о клиенте и заказе, необходимые для выполнения заказа. В поле инструкций задачи отображается вся информация, которая была собрана от клиента через форму дополнительной информации.

## <a name="end-to-end-testing"></a>Сквозное тестирование

При прибытии клиента требуется, чтобы отдельные параметры и значения были переданы на страницу прибытия, а затем — в API прибытия клиента. Таким образом, самый простой подход заключается в тестировании функции в среде, в которой можно создать и упаковать тестовый заказ. Таким образом создается сообщение электронной почты «заказ готов к получению», которое содержит URL-адрес, содержащий необходимые имена и значения параметров.

Чтобы проверить функцию прбытия клиента, выполните следующие действия.

1. Создайте страницу прибытия клиента, затем добавьте и настройте модуль прибытия клиента. Дополнительные сведения см. в разделе [Модуль прибытия для отправки](check-in-pickup-module.md). 
1. Верните страницу, но не публикуйте ее.
1. Добавьте следующую ссылку в шаблон сообщения электронной почты, который вызывается типом уведомления о завершении упаковки для режима получения поставки. Дополнительные сведения см. в разделе [Создание шаблонов сообщений электронной почты для событий проводок](email-templates-transactions.md).

    - **Для предварительных сред (UAT):** добавьте фрагмент кода из раздела [Настройка шаблона транзакционного сообщения электронной почты](#configure-the-transactional-email-template) ранее в этой статье.
    - **Для производственных сред:** добавьте следующий код комментария, чтобы это не повлияло на существующих клиентов.

        `<!-- https://[DOMAIN]/[CHECK_IN_PAGE]?channelReferenceId=%confirmationid%&channelId=%pickupchannelid%&packingSlipId=%packingslipid%&preview=inprogress -->`

1. Создайте заказ, в котором указывается режим поставки самовывозом.
1. При получении сообщения электронной почты, которое запускается с помощью типа уведомления о завершении упаковки, проверьте поток прибытия, открыв страницу прибытия с URL-адресом, который был добавлен ранее. Так как URL-адрес включает флаг `&preview=inprogress`, вам будет предложено выполнить проверку подлинности до того, как страница станет доступна для просмотра.
1. Введите любую дополнительную информацию, которая требуется для настройки модуля.
1. Убедитесь, что представление подтверждения прибытия отображается правильно.
1. Откройте POS-терминал для магазина, в котором будет получен заказ.
1. Выберите плитку **Заказы для вывоза** и убедитесь, что этот заказ отображается.
1. Убедитесь, что в области сведений отображаются все дополнительные сведения, которые были настроены в модуле прибытия.

После проверки того, что функция прибытия клиента работает от начала и до конца, выполните следующие действия.

1. Опубликуйте страницу прибытия.
1. Если тестирование выполняется в производственной среде, удалите комментарий с URL-адреса в шаблоне сообщения электронной почты «Заказ готов к получению», чтобы отображалось ссылка или кнопка **Я здесь**. Затем снова отправьте шаблон.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Модуль прибытия для отправки](check-in-pickup-module.md)

[Настройка транзакционных писем по способу доставки](customize-email-delivery-mode.md)

[Создание шаблонов сообщений электронной почты для событий проводок](email-templates-transactions.md)
