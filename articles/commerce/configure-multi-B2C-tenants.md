---
title: Настройка нескольких клиентов B2C в среде Commerce
description: В этом разделе описывается, когда и как настроить несколько клиентов "бизнес-потребитель" B2C Microsoft Azure Active Directory (Azure AD) по каналам для проверки подлинности пользователя в выделенной среде Dynamics 365 Commerce.
author: BrianShook
manager: annbe
ms.date: 03/02/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.region: Global
ms.search.industry: retail
ms.author: brshoo
ms.search.validFrom: 2020-02-12
ms.dyn365.ops.version: ''
ms.openlocfilehash: 9a1af453349d69ef94d725e138a898c73ea052fa
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "4997608"
---
# <a name="configure-multiple-b2c-tenants-in-a-commerce-environment"></a>Настройка нескольких клиентов B2C в среде Commerce

[!include [banner](includes/banner.md)]

В этом разделе описывается, когда и как настроить несколько клиентов "бизнес-потребитель" B2C Microsoft Azure Active Directory (Azure AD) по каналам для проверки подлинности пользователя в выделенной среде Dynamics 365 Commerce.

## <a name="overview"></a>Обзор

Dynamics 365 Commerce использует облачную службу удостоверений Azure AD B2C для поддержки учетных данных пользователя и потоков проверки подлинности. Пользователи могут использовать потоки проверки подлинности для регистрации, входа и сброса пароля. Azure AD B2C хранит конфиденциальные сведения о проверке подлинности пользователя, такие как имя пользователя и пароль. Запись пользователя является уникальной для каждого клиента B2C и использует либо учетные данные с именем пользователя (адресом электронной почты), либо учетные данные поставщика удостоверений социальных сетей.

В большинстве случаев в среде Commerce используется один клиент Azure AD B2C. Клиенты Commerce могут затем создать и опубликовать несколько сайтов в одной и той же среде Commerce, и на этих сайтах будут использоваться одинаковые учетные данные клиента. Однако, если сайты в среде должны рассматриваться как различные торговые марки и выглядеть для пользователей как отдельные предприятия, можно настроить клиент B2C для канала, который используется для разделения сайтов/торговых марок.

## <a name="considerations-when-multiple-b2c-tenants-are-set-up-per-channel"></a>Что следует учитывать при настройке нескольких клиентов B2C для одного канала

Часто, когда каждый канал или сайт рассматривается как отдельный бизнес, наилучшим вариантом в отношении потоков проверки подлинности пользователей в Commerce является использование отдельных юридических лиц. Однако, если требуется сохранить каждый канал или сайт в одной и той же среде и юридическом лице, но необходимо иметь отдельную проверку подлинности пользователей для каждого сайта, важно учесть следующие моменты перед продолжением:

- Пользователи будут иметь собственные отдельные учетные данные для каждого канала или сайта.

    Один человек может иметь две отдельные учетные записи для канала/сайта, так как каждая учетная запись будет уникальной записью в отдельном клиенте B2C.

- В среде Microsoft Dynamics для глобального поиска записей будут возвращены отдельные записи клиентов.

    Если пользователь использует один и тот же адрес электронной почты для каналов или сайтов, глобальный поиск по клиентам возвратит результаты для каждого канала или сайта. (Будет показан индикатор канала.)

- Адресная книга может использоваться для помощи в группировке пользователей, чтобы их можно было отслеживать по каналам.
- Число записей клиентов на канал может увеличиться, и это увеличение может повлиять на производительность глобальных операций поиска.
- Клиенты B2C должны быть тщательно отображены на канал, чтобы помочь предотвратить ситуации, в которых клиенты подписываются на неправильный клиент. В противном случае могут возникнуть проблемы с путаницей или отслеживанием.

На следующем рисунке показано несколько клиентов B2C в среде Commerce.

![Несколько клиентов B2C в среде Commerce](media/MultiB2C_In_Environment.png)

Если вы решите, что ваша компания требует отдельных клиентов B2C на канал в одной и той же среде Commerce, выполните процедуры, описанные в следующих разделах, чтобы запросить эту функцию.

## <a name="request-that-b2c-per-channel-be-enabled-in-your-environment"></a>Запрос на включение B2C на каждый канал в вашей среде

В настоящее время, если требуется, чтобы отдельные клиенты B2C на канал были доступны в одной и той же среде Commerce, необходимо отправить запрос в Dynamics 365 Commerce. Дополнительные сведения см. в разделе [Получение поддержки для служб Lifecycle Services (LCS)](../fin-ops-core/dev-itpro/lifecycle-services/lcs-support.md) или обсудите эту проблему с контактным лицом в решениях Commerce.

## <a name="configure-b2c-tenants-in-your-environment"></a>Настройка клиентов B2C в вашей среде

Чтобы настроить клиенты B2C в среде, выполните соответствующие процедуры в этом разделе.

### <a name="add-an-azure-ad-b2c-tenant"></a>Добавление клиента Azure AD B2C

Чтобы добавить клиента Azure AD B2C в среду, выполните следующие действия.

1. Выполните вход в конструктор сайтов Commerce для вашей среды в качестве системного администратора. Чтобы настроить клиентов Azure AD B2C, вы должны быть системным администратором в среде Commerce.
1. На левом панели навигации выберите **Настройки клиента**, чтобы развернуть их.
1. Выберите **Параметры B2C**, а затем выберите **Управление**.
1. Выберите **Добавить приложение B2C**, затем введите следующие сведения.

    - **Имя приложения**: введите имя, которое должно использоваться для приложения в контексте управления им в Commerce. Рекомендуется использовать имя приложения, которое было выбрано при настройке приложения Azure AD B2C на портале Azure. Таким образом можно избежать путаницы при управлении клиентами B2C в модуле Commerce.
    - **Имя клиента**: введите имя клиента B2C в том виде, в котором оно отображается на портале Azure.
    - **Идентификатор политики сброса пароля**: введите идентификатор политики (имя политики на портале Azure).
    - **Идентификатор политики регистрации или входа**: введите идентификатор политики (имя политики на портале Azure).
    - **GUID клиента**: введите идентификатор клиента Azure AD B2C в том виде, в котором он отображается на портале Azure (не является идентификатором приложения для клиента B2C).
    - **Идентификатор политики редактирования профиля**: введите идентификатор политики (имя политики на портале Azure).

1. После ввода этих сведений выберите **OK**, чтобы сохранить изменения.

> [!NOTE]
> Следует оставить пустыми такие поля, как **Область**, **Идентификатор неинтерактивной политики**, **Идентификатор неинтерактивного клиента**, **Имя для входа пользовательского домена** и **Идентификатор политики регистрации**, если только рабочая группа Dynamics 365 Commerce не укажет пользователю задать их.
Новый клиент Azure AD B2C должен появиться в списке под пунктом **Управление приложениями B2C**.

### <a name="manage-or-delete-an-azure-ad-b2c-tenant"></a>Управление клиентом Azure AD B2C или его удаление

1. Выполните вход в конструктор сайтов Commerce для вашей среды в качестве системного администратора. Чтобы настроить клиентов Azure AD B2C, вы должны быть системным администратором в среде Commerce.
1. На левом панели навигации выберите **Настройки клиента**, чтобы развернуть их.
1. Выберите **Параметры B2C**, а затем выберите **Управление**.
1. Чтобы отредактировать клиент B2C, выберите символ карандаша рядом с ним. Чтобы удалить клиент B2C, выберите символ корзины рядом с ним.
1. Выберите **Сохранить**, затем выберите **Опубликовать**, чтобы активировать изменения.

> [!WARNING]
> Когда клиент B2C настроен для действующего/опубликованного сайта, пользователи могли зарегистрироваться, используя учетные записи, присутствующие в клиенте. При удалении настроенный клиент в меню **Параметры клиента \> Клиент B2C**, удаляется связь этого клиента B2C с сайтами, связанными с любыми каналами клиента. В этом случае пользователи, возможно, больше не смогут входить в систему со своими учетными записями. Поэтому при удалении настроенного клиента будьте предельно осторожны.
>
> При удалении настроенного клиента этот клиент B2C и записи будут продолжать поддерживаться, но конфигурация системы Commerce для этого клиента будет изменена или удалена. Пользователи, пытающиеся зарегистрироваться или войти на сайт, будут создавать новую запись учетной записи в клиенте по умолчанию или новом связанном клиенте B2C, который настроен для канала сайта.
## <a name="configure-your-channel-with-a-b2c-tenant"></a>Настройка канала с помощью клиента B2C

1. Выполните вход в конструктор сайтов Commerce для вашей среды в качестве системного администратора. Чтобы настроить клиентов Azure AD B2C, вы должны быть системным администратором в среде Commerce.
1. На левом панели навигации выберите **Настройки сайта**, чтобы развернуть.
1. Выберите **Каналы**, затем выберите канал для настройки.
1. В области свойств справа в поле **Выбор приложения B2C** выберите настроенного клиента Azure AD B2C, который будет использоваться для этого канала.
1. На панели команд выберите **Сохранить и опубликовать**, чтобы зафиксировать новую или обновленную конфигурацию.

> [!WARNING]
> При изменении приложения B2C, назначенного каналу, удаляются текущие ссылки, которые были установлены для всех пользователей, которые уже зарегистрировались в среде. В таком случае любые учетные данные, связанные с назначенным в данный момент приложением B2C, будут недоступны пользователям. Поэтому изменяйте конфигурацию канала Azure AD B2C только в том случае, если канал настраивается впервые, и никакие пользователи не могли на него зарегистрироваться. В противном случае пользователям, возможно, придется повторно регистрироваться, чтобы создать запись в новом клиенте Azure AD B2C.
## <a name="additional-resources"></a>Дополнительные ресурсы

[Настройка доменного имени](configure-your-domain-name.md)

[Развертывание нового клиента электронной коммерции](deploy-ecommerce-site.md)

[Создание сайта электронной коммерции](create-ecommerce-site.md)

[Связывание сайта Dynamics 365 Commerce с интернет-каналом](associate-site-online-store.md)

[Управление файлами robots.txt](manage-robots-txt-files.md)

[Пакетная отправка перенаправлений URL-адресов](upload-bulk-redirects.md)

[Настройка клиента B2C в Commerce](set-up-B2C-tenant.md)

[Настройка специальных страниц для входа пользователей](custom-pages-user-logins.md)

[Добавление поддержки сети доставки контента (CDN)](add-cdn-support.md)

[Включение обнаружения магазинов на основе местоположения](enable-store-detection.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]