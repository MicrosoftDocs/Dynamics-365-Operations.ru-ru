---
title: Настройка клиента B2C в Commerce
description: В этой статье описывается, как настроить клиенты "бизнес-потребитель" (B2C) Azure Active Directory (Azure AD) для проверки подлинности сайта пользователя в Microsoft Dynamics 365 Commerce.
author: BrianShook
ms.date: 11/15/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: brshoo
ms.search.validFrom: 2020-02-13
ms.openlocfilehash: 3421dd3d67198a99ac236a56cbb4f300cb591a03
ms.sourcegitcommit: 774f8f97a0b14cf1199bd1802178ccf536a25ade
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2022
ms.locfileid: "9785152"
---
# <a name="set-up-a-b2c-tenant-in-commerce"></a>Настройка клиента B2C в Commerce

[!include [banner](includes/banner.md)]

В этой статье описывается, как настроить клиенты "бизнес-потребитель" (B2C) Azure Active Directory (Azure AD) для проверки подлинности сайта пользователя в Dynamics 365 Commerce.

Dynamics 365 Commerce использует Azure AD B2C для поддержки учетных данных пользователей и потоков проверки подлинности. Пользователь может регистрировать, выполнять вход и сбрасывать свои пароли в этих потоках. Azure AD B2C хранит конфиденциальные сведения о проверке подлинности пользователя, такие как имя пользователя и пароль. Запись пользователя в клиенте B2C хранит либо запись локальной учетной записи B2C, либо запись поставщика удостоверений социальных сетей B2C. Эти записи B2C будут связываться обратно с записью клиента в среде Commerce.

> [!WARNING] 
> Azure AD B2C выведет из использования старые пользовательские потоки 1 августа 2021 года. Поэтому необходимо запланировать миграцию ваших потоков пользователей на новую рекомендуемую версию. Новая версия обеспечивает равенство функций и новые функции. Библиотека модулей для Commerce версии 10.0.15 или выше должна использоваться с рекомендованными потоками пользователей B2C. Дополнительные сведения см. в разделе [Потоки пользователей в Azure Active Directory B2C](/azure/active-directory-b2c/user-flow-overview).
 
 > [!NOTE]
 > Ознакомительные среды Commerce поставляются с предварительно загруженным клиентом Azure AD B2C для демонстрационных целей. Загрузка собственного клиента Azure AD B2C с помощью описанных ниже шагов не является необходимым для ознакомительных сред.

> [!TIP]
> Можно дополнительно защитить пользователей сайта и повысить безопасность клиентов Azure AD B2C с помощью с защитой удостоверений и условным доступом Azure AD. Для просмотра возможностей, доступных для клиентов Azure AD B2C премиум P1 и премиум P2 см. раздел [Защита удостоверений и условный доступ для Azure AD B2C](/azure/active-directory-b2c/conditional-access-identity-protection-overview).

## <a name="dynamics-environment-prerequisites"></a>Необходимые условия для среды Dynamics

Прежде чем начать, убедитесь, что среда Dynamics 365 Commerce и канал электронной коммерции настроены соответствующим образом, выполнив следующие необходимые условия.

- Задайте для POS-операций значение **AllowAnonymousAccess** как "1" в центральном офисе Commerce:
    1. Перейдите к **POS-операциям**.
    1. Щелкните правой кнопкой мыши в сетке операций, а затем выберите **Персонализация**.
    1. Выберите **Добавить поле**.
    1. В списке доступных столбцов выберите столбец **AllowAnonymousAccess**, чтобы добавить его.
    1. Выберите **Обновить**.
    1. Для операции **612** "Добавление клиента" измените **AllowAnonymousAccess** на "1"
    1. Выполните задание **1090 (регистры)**.
- Установите для счета клиента номерной серии атрибут **Вручную** как **Нет** в центральном офисе Commerce:
    1. Перейдите в раздел **Retail и Commerce \> Настройка центрального офиса \> Параметры \> Параметры расчетов с клиентами**.
    1. Выберите **Номерные серии**.
    1. В строке **Счет клиента** дважды щелкните значение **Кода номерной серии**.
    1. На вкладке **Общие** для номерной серии установите значение **Вручную** как **Нет**.

После развертывания среды Dynamics 365 Commerce также рекомендуется [инициализировать начальные данные](enable-configure-retail-functionality.md) в среде.

## <a name="next-steps"></a>Далее

Чтобы продолжить процесс настройки клиента B2C в модуле Commerce, переходите к разделу [Создание или связывание существующего клиента Azure AD B2C с порталом Azure](create-link-aad-b2c-tenant.md).

## <a name="additional-resources"></a>Дополнительные ресурсы

[Создание или связывание существующего клиента Azure AD B2C с порталом Azure](create-link-aad-b2c-tenant.md)

[Создание приложения B2C](create-b2c-app.md)

[Создание политик потока пользователей](create-user-flow-policies.md)

[Добавление поставщиков удостоверений в социальных сетях (дополнительно)](add-social-identity-providers.md)

[Обновление Commerce headquarters с учетом новой информации Azure AD B2C](update-hq-aad-b2c-info.md)

[Настройка клиента B2C в конфигураторе сайта Commerce](config-b2c-tenant-site-builder.md)

[Дополнительные сведения B2C](additional-b2c-info.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]
