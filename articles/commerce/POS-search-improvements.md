---
title: Поиск продуктов и клиентов в POS
description: В этой теме приведен обзор усовершенствований, внесенных в функциональность поиска продукта и клиента в Dynamics 365 Commerce.
author: ShalabhjainMSFT
ms.date: 05/25/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application user
ms.reviewer: josaw
ms.custom: 141393
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Retail
ms.author: shajain
ms.search.validFrom: 2017-06-30
ms.dyn365.ops.version: Retail April 2017 update
ms.openlocfilehash: 460c7d3b00421ba43414f7343887edf9b8adad9c
ms.sourcegitcommit: 9dd2d32fc303023a509d58ec7b5935f89d1e9c6d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/26/2022
ms.locfileid: "8806436"
---
# <a name="product-search-and-customer-search-in-the-point-of-sale-pos"></a>Поиск продуктов и клиентов в POS

[!include [banner](includes/banner.md)]

В Modern Point of Sale (MPOS) и Cloud Point of Sale (CPOS) предусмотрена удобная функциональность поиска продуктов и клиентов. Поскольку панель поиска всегда присутствует в верхней части окон MPOS и CPOS, чтобы сотрудники могли быстро искать продукты и клиентов.

Сотрудники могут искать продукты в ассортиментах и каталогах, которые связаны с текущим магазином. Они также могут искать продукты в ассортиментах и каталогах, которые связаны с любым другим магазином в компании. Следовательно, кассиры могут продавать и принимать возвраты продуктов, не входящих в ассортимент магазина. Аналогичным образом, сотрудники могут выполнять поиск клиентов, которые связаны с текущим магазином или с любым другим магазином в компании. Кроме того, сотрудники выполнять поиск клиентов, которые связаны с другой компанией в родительской организации.

## <a name="product-search"></a>Поиск продукта

По умолчанию поиски продуктов выполняются в ассортименте магазина. Такой тип поиска называется *локальным поиском продукта*. Однако сотрудников легко могут переключаться на любой каталог, связанный с текущим магазина, либо выполнять поиск в другом магазине. Такой тип поиска называется *удаленным поиском продукта*. Чтобы сменить каталог, нажмите кнопку **Категории** в левой части страницы. Вверху появившейся области нажмите кнопку **Изменить каталог**, а затем выберите один из доступных каталогов. Система будет выполнит поиск продуктов в выбранном каталоге.

На странице **Изменить каталог** сотрудники легко могут выбрать любой магазин или выполнить поиск продуктов по всем магазинами.

![Изменение каталога.](./media/Changecatalog.png "Изменение каталога")

При локальном поиске продукта поиск производится в следующих свойствах продуктов:

- Номер продукта
- Наименование продукта:
- описание
- Измерения
- Штрих-код
- Имя для поиска

### <a name="additional-local-product-search-capabilities-conventional-sql-full-text-search"></a>Дополнительные возможности локального поиска продуктов (обычный полнотекстовый поиск SQL) 

- Для поиска по нескольким ключевым словам предприятия розничной торговли могут настроить поиск так, чтобы результаты включали *любое* из введенных слов или *все* слова. Параметр для этой функциональности доступен в профиле функциональности POS в новой группе, которая называется **Поиск продукта**. Значение по умолчанию — **Сопоставить любые условия поиска**. Это значение также является рекомендуемым. При использовании параметра **Сопоставить любые условия поиска** все продукты, которые полностью или частично соответствуют одному или нескольким условиям поиска, возвращаются в виде результатов. Эти результаты автоматически сортируются в порядке возрастания продуктов, которые имеют совпадения большинства ключевых слов (полное или частичное).

    При использовании значения **Сопоставить все условия поиска** возвращаются только продукты, в которых присутствуют все введенные слова. Это значение удобно использовать в случае, когда наименования продуктов длинные и сотрудникам хотелось бы видеть в результатах поиска ограниченный набор продуктов. Однако такой тип поиска имеет два ограничения:

    - Поиск выполняется по отдельным свойствам продуктов. Например, возвращаются только те продукты, у которых все введенные ключевые слова присутствуют в одном (хотя бы в одном) свойстве продукта.
    - Поиск не производится в аналитиках.
> [!NOTE]
> Следующие конфигурации **Сопоставить любые условия поиска**/**Сопоставить все условия поиска** в профилях функций POS применяются только для **локальных** поисков продуктов (обычный полнотекстовый поиск SQL). Эта конфигурация не влияет на работу поиска в облаке. Новая поисковая система обладает собственным усовершенствованным алгоритмом, который обеспечивает релевантность результатов поиска продуктов. 

- Предприятия розничной торговли могут настроить поиск продуктов так, чтобы при вводе наименований продуктов пользователями отображались предложения (варианты поиска). Новый параметр для этой функциональности доступен в профиле функциональности POS в новой группе, которая называется **Поиск продукта**. Параметр называется **Показывать предложения при вводе**. Эта функциональность позволяет сотрудникам быстрее находить продукты, которые они ищут, потому что им не нужно вводить имя целиком вручную.
- Алгоритм поиска продукта теперь также выполняет поиск введенных слов в свойстве **Имя поиска** продукта.

![Предложения продуктов.](./media/Productsuggestions.png "Предложения продуктов")

## <a name="customer-search"></a>Поиск клиента

Поиск клиентов позволяет находить клиентов для различных целей. Например, кассирам может потребоваться просмотреть список пожеланий клиента или историю его покупок либо добавить клиента в транзакцию. Алгоритм поиска соответствует условиям поиска для значений, которые присутствуют в следующих свойствах клиента:

- Название
- Адрес электронной почты
- Номер телефона
- Номер дисконтной карточки
- Адрес
- Расчетный счет

Среди этих свойств имя предоставляет наибольшую гибкость при поиске с несколькими ключевыми словами, так как алгоритм возвращает всех клиентов, которые соответствуют любому из искомых ключевых слов. Клиенты, в свойствах которых присутствует больше всего ключевых слов, выводятся вверху списка результатов. Это поведение помогает кассирам в ситуациях, когда они ищут путем ввода полного имени, но имя и фамилия были поменяны местами при начальном вводе данных. Однако по соображениям производительности все остальные свойства сохраняют порядок ключевых слов поиска. Таким образом, если порядок ключевых слов поиска не совпадает с порядком, в котором хранятся данные, результаты не будут возвращены.

По умолчанию поиск клиентов производится в адресных книгах клиентов, связанных с магазином. Такой тип поиска называется *локальным поиском клиента*. Однако сотрудники могут также выполнять поиск клиентов глобально. Иными словами, они могут искать клиентов по всем магазинам компании и по всем остальным юридическим лицам. Такой тип поиска называется *удаленным поиском клиента*.

Для глобального поиска сотрудники могут нажать кнопку **Результаты фильтра** внизу страницы, а затем выбрать вариант **Искать по всем магазинам**, как показано на приведенном ниже рисунке. В этом случае возвращаются не только клиенты. Возвращаются также все типы субъектов, присутствующих в адресной книге в главном офисе. К этим субъектам относятся сотрудники, поставщики, контакты и конкуренты.

> [!NOTE]
> Чтобы удаленный поиск клиента возвратил результаты, необходимо ввести не менее четырех символов.

Для клиентов, запрошенных из других юридических лиц, не отображается код клиента, поскольку в текущей компании для этих субъектов код клиента не создан. Однако если сотрудник открывает страницу сведений о клиенте, система автоматически создает для субъекта код клиента, а также связывает адресные книги клиентов магазина с клиентом. Следовательно, клиент будет присутствовать в локальных поисках в магазине, которые производятся позднее.

![Глобальный поиск клиента.](./media/Globalcustomersearch.png "Глобальный поиск клиента")

### <a name="additional-local-customer-search-capabilities"></a>Дополнительные возможности локального поиска клиента

Когда пользователь ищет номер телефона, система игнорирует специальные символы (такие как пробелы, дефисы и скобки), которые могли быть добавлены при создании клиента. Таким образом, кассирам не нужно беспокоиться о формате номера телефона при выполнении поиска. Например, если номер телефона клиента был введен как **123-456-7890**, кассир может искать клиента, вводя **1234567890** либо введя первые несколько цифр номера телефона.

> [!NOTE]
> У клиента может быть несколько телефонных номеров и несколько адресов электронной почты. Алгоритм поиска клиентов также выполняет поиск по дополнительным электронным адресам электронной почты и номерам телефонов, но на странице результатов поиска клиентов отображается только основное сообщение и номер телефона. Это может привести к путанице, поскольку результаты возвращенного клиента не будут показывать адрес электронной почты или номер телефона, по которому выполняется поиск. В следующем выпуске мы планируем улучшить экран результатов поиска клиентов, чтобы показать эту информацию.

Традиционной поиск клиента может требовать много времени, поскольку выполняется поиск по нескольким полям. Вместо этого кассиры могут выполнять поиск в одном свойстве клиента, таком как имя, адрес электронной почты или номер телефона. Свойства, которые использует алгоритм поиска клиента, совокупно обозначаются термином *критерии поиска клиентов*. Администратор системы можно легко настроить один или несколько критериев как ярлыки, которые будут отображаться в POS. Поскольку поиск ограничен только одним критерием, отображаются только релевантные результаты поиска и производительность гораздо лучше, чем производительность стандартного поиска клиентов. На следующем рисунке показаны ярлыки поиска клиента в POS.

![Ярлыки поиска клиентов.](./media/SearchShortcutsPOS.png "Ярлыки поиска клиентов")

Чтобы установить критерии поиска как ярлык, администратору необходимо открыть страницу **Параметры Commerce** в Commerce, а затем на вкладке **Критерии поиска POS** выбрать все условия, которые должны отображаться как ярлыки.

![Настройка ярлыков для поиска.](./media/ConfigureShortcutsAX.png "Настройка ярлыков для поиска")

> [!NOTE]
> Если добавлено слишком много ярлыков, раскрывающееся меню на панели поиска в POS будет загромождено, что может повлиять негативно повлиять на эффективность поиска сотрудниками. Рекомендуется добавлять только действительно необходимые ярлыки.

Поле **Порядок отображения** определяет порядок, в котором ярлыки отображается в POS. Критерии, которые отображаются, — это готовые свойства, которые использует алгоритм поиска клиентов для поиска клиентов. Однако партнеры могут добавить пользовательские свойства как ярлыки поиска. Чтобы добавить настраиваемые свойства в качестве ярлыков поиска, администратор системы должен расширить расширяемое перечисление (enum), которое используется для критериев поиска клиентов, а затем пометить настраиваемые свойства партнера в качестве ярлыков. Партнеры несет ответственность за написание кода поиска результатов, когда их пользовательские ярлыки используются для поиска.

Переводы для ярлыков необходимы, если требуется отобразить ярлыки на POS. Если язык канала отличен от языка системы, используемого по умолчанию, необходимо определить перевод для каждого ярлыка на ожидаемом языке. Можно определить переводы, выбрав **Перевести** для каждого ярлыка. 

> [!NOTE]
> Пользовательское свойство, которое добавлено в перечисление, не влияет на стандартный алгоритм поиска клиентов. Другими словами, алгоритм поиска клиентов не будет выполнять поиск в пользовательском свойстве. Пользователи могут использовать пользовательское свойство для поиска только в том случае, если это пользовательское свойство добавлено как ярлык или если алгоритм поиска по умолчанию переопределен.

Предприятия розничной торговли также могут задать режим поиска клиентов по умолчанию в POS на **Поиск по всем магазинам**. Эта конфигурация может быть полезной в сценариях, где клиенты, созданные за пределами POS, должны быть немедленно просмотрены (например, даже перед выполнением задания распределения). Для этого предприятие розничной торговли должно включить **Режим поиска клиентов по умолчанию** в профиль функциональности POS. Если для него установлено значение **Да**, при каждой попытке поиска клиента будет выполняться вызов головного офиса в реальном времени.

Чтобы помочь предотвратить непредвиденные проблемы производительности, эта конфигурация скрыта под флагом фокус-тестирования с именем **CUSTOMERSEARCH_ENABLE_DEFAULTSEARCH_FLIGHTING**. Таким образом, чтобы показать параметр **Режим поиска клиентов по умолчанию** в пользовательском интерфейсе, розничный магазин должен создать заявку в службе технической поддержки для своей среды приемочного тестирования пользователями (UAT) и производственных сред. После получения заявки группа инженеров будет работать во взаимодействии с розничным магазином, чтобы гарантировать, что продавец выполняет тестирование в непроизводственных средах, чтобы оценить производительность и реализовать все необходимые оптимизации.

## <a name="cloud-powered-customer-search"></a>Поиск клиента на облачной платформе

Общедоступная предварительная версия возможностей поиска клиентов с помощью службы Azure Cognitive Search выпущена в составе выпуска Commerce 10.0.18. В дополнение к повышению производительности у пользователей службы также есть преимущество от расширенной детализации и улучшенных возможностей релевантности. Повышение производительности особенно заметно, если используется функция "глобальный поиск" ("Поиск по всем магазинам") POS. Это связано с тем, что результаты поиска выбираются из индекса поиска Azure вместо запроса данных в Commerce Headquarters. 

### <a name="enable-the-cloud-powered-search-feature"></a>Включение функции поиска на облачной платформе

> [!NOTE]
> Требуется, чтобы Commerce headquarters и Commerce Scale Unit были обновлены до версии 10.0.18. Обновление POS не является обязательным.

Чтобы включить функцию поиска на облачной платформе в Commerce headquarters, выполните следующие действия.

1. Перейдите в раздел **Администрирование системы \> Рабочие области \> Управление функциями**.
1. Найдите и выберите **(Предварительная версия) Поиск клиента на облачной платформе**, а затем выберите **Включить сейчас**.
1. Перейдите в раздел **Retail и Commerce > Планировщик Commerce > Инициализировать планировщик Commerce** и нажмите кнопку **ОК**, чтобы открыть новое задание **1010_CustomerSearch** в форме **график распределения**.
1. Перейдите в раздел **Retail и Commerce > ИТ Retail и Commerce > График распределения**.
1. Выполните задание **1010_CustomerSearch**. Это задание публикует дату в индексе поиска Azure. После завершения публикации индекса статус задания будет настроен как **примененный**.
1. После того как статус задания **1010_CustomerSearch** настраивается на **примененный**, выполните задание **1110 Глобальная конфигурация**, чтобы обновить каналы POS вновь включенной функции в **управлении функциями**.
1. Впоследствии следует выполнять задание **1010_CustomerSearch** через регулярные интервалы времени, чтобы отправить клиентские обновления в индекс поиска.

> [!NOTE]
> Для первоначальной публикации индекса задание **1010_CustomerSearch** может занять несколько часов, так как все записи клиентов будут отправлены в индекс поиска Azure. Последующие обновления должны занять несколько минут. В период времени, когда функция поиска на облачной платформе включена, но публикация индекса еще не завершена, поиск клиента в POS будет использоваться по умолчанию для существующего поиска на основе SQL. Это гарантирует отсутствие прерываний для операций магазина.

### <a name="functional-differences-from-the-existing-search"></a>Функциональные различия для существующего поиска

В следующем списке показано отличие функций поиска клиента на облачной платформе от существующих функций поиска. 

- Клиенты, созданные и измененные в Commerce headquarters, отправляются в индекс поиска Azure при выполнении задания **1010_CustomerSearch**. Для обновления индекса эти обновления занимают как минимум 15-20 минут. Пользователи POS смогут выполнять поиск новых клиентов (или производить поиск по обновленной информации) примерно от 15 до 20 минут после обновления в Commerce headquarters. Если в бизнес-процессе требуется, чтобы клиенты, созданные в Commerce headquarters, сразу же были доступны для поиска в POS, эта служба может вам не подойти.
- Новые клиенты, созданные в POS, направляются в индекс поиска Azure из Commerce Scale Unit и сразу же могут быть доступны в любом магазине. Однако если функция асинхронного создания клиентов включена, новые записи клиентов не будут публиковаться в индексе поиска Azure из Commerce Scale Unit и не будут доступны из POS до тех пор, пока информация по клиенту не будет синхронизирована с Commerce headquarters, а коды клиентов не будут созданы для асинхронных клиентов. После этого задание **1010_CustomerSearch** сможет отправлять записи асинхронных клиентов в индекс поиска Azure. В среднем это займет около 30 минут до того момента, когда вновь созданных асинхронных клиентов можно будет искать в POS. В этой оценке предполагается, что выполнение заданий **1010_CustomerSearch**, **P-задание** и **Синхронизация клиентов и деловых партнеров из асинхронного режима** запланировано на каждые 15 минут.
- При поиске на облачной платформе также выполняется поиск вспомогательных адрес электронной почты и телефонных номеров клиентов, но в настоящее время результаты поиска клиентов показывают только основной номер телефона и основной адрес электронной почты клиентов. На первый взгляд может показаться, что были возвращены нерелевантные результаты поиска, но проверка дополнительного адреса электронной почты и телефона клиента в результатах поиска может помочь проверить, совпадает ли искомое ключевое слово с клиентом. Чтобы избежать такой путаницы, необходимо улучшить страницу результатов поиска, чтобы облегчить пользователям понять, почему был возвращен результат поиска.
- Требование поиска по крайней мере из 4 знаков в глобальном поиске ("Поиск по всем магазинам") не применимо к этой службе.

> [!NOTE]
> Возможности поиска клиентов при использовании службы поиска Azure Cognitive Search, доступны в регионах с ограничением для предварительного просмотра. Возможности поиска клиентов *недоступны* в следующих регионах:
> - Бразилия
> - Индия

[!INCLUDE[footer-include](../includes/footer-banner.md)]
