---
title: Настройка процесса расширенного импорта банковских выверок
description: Функция расширенной банковской выверки позволяет импортировать электронные банковские выписки и автоматически выверять их с банковскими проводками в Microsoft Dynamics 365 for Finance and Operations. В этой статье объясняется, как настроить функцию импорта для банковских выписок.
author: ShylaThompson
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: BankStatementFormat
audience: Application User
ms.reviewer: shylaw
ms.search.scope: Core, Operations
ms.custom: 106853
ms.assetid: 45dae275-ea45-4c7e-b38f-89297c7b5352
ms.search.region: Global
ms.author: saraschi
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 7a04517de6e7695cd27bbc6e6a825e1ccaac7306
ms.sourcegitcommit: 0f530e5f72a40f383868957a6b5cb0e446e4c795
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2019
ms.locfileid: "334573"
---
# <a name="set-up-the-advanced-bank-reconciliation-import-process"></a>Настройка процесса расширенного импорта банковских выверок

[!include [banner](../includes/banner.md)]

Функция расширенной банковской выверки позволяет импортировать электронные банковские выписки и автоматически выверять их с банковскими проводками в Microsoft Dynamics 365 for Finance and Operations. В этой статье объясняется, как настроить функцию импорта для банковских выписок. 

Настройка импорта банковской выписки зависит от формата электронной банковской выписки. Finance and Operations поддерживает три готовых формата банковской выписки: ISO20022, MT940 и BAI2.

## <a name="sample-files"></a>Образцы файлов
Для всех трех форматов вы должны иметь файлы, которые преобразуют электронную банковскую выписку из исходного формата в формат, который можно использовать в Finance and Operations. Требуемые исходные файлы находятся в узле **Ресурсы** в обозревателе приложений в Microsoft Visual Studio. После обнаружения файлов скопируйте их в одно известное расположение, чтобы их было легче отправить во время настройки.

| Имя ресурса                                           | Имя файла                            |
|---------------------------------------------------------|--------------------------------------|
| BankStmtImport\_BAI2CSV\_to\_BAI2XML\_xslt              | BAI2CSV-to-BAI2XML.xslt              |
| BankStmtImport\_BAI2XML\_to\_Reconciliation\_xslt       | BAI2XML-to-Reconciliation.xslt       |
| BankStmtImport\_BankReconciliation\_to\_Composite\_xslt | BankReconciliation-to-Composite.xslt |
| BankStmtImport\_ISO20022XML\_to\_Reconciliation\_xslt   | ISO20022XML-to-Reconciliation.xslt   |
| BankStmtImport\_MT940TXT\_to\_MT940XML\_xslt            | MT940TXT-to-MT940XML.xslt            |
| BankStmtImport\_MT940XML\_to\_Reconciliation\_xslt      | MT940XML-to-Reconciliation.xslt      |
| BankStmtImport\_SampleBankCompositeEntity\_xml          | SampleBankCompositeEntity.xml        |

## <a name="examples-of-bank-statement-formats-and-technical-layouts"></a>Примеры форматов банковской выписки и технических макетов
Ниже приводятся примеры определений технических макетов для расширенных файлов импорта банковской выписки и трех связанных примеров файлов банковской выписки: https://mbs.microsoft.com/customersource/northamerica/AX/learning/documentation/how-to-articles/exofbankstfotechlayouts  

| Определение технического макета                             | Пример файла банковской выписки          |
|---------------------------------------------------------|--------------------------------------|
| DynamicsAXMT940Layout                                   | MT940StatementExample                |
| DynamicsAXISO20022Layout                                | ISO20022StatementExample             |
| DynamicsAXBAI2Layout                                    | BAI2StatementExample                 |



## <a name="set-up-the-import-of-iso20022-bank-statements"></a>Настройка импорта банковских выписок ISO20022
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок ISO20022 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **ISO20022**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **ISO20022XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования Finance and Operations создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!-- For details about the expected format for ISO20022, see [Dynamics AX ISO20022 Layout](./media/dynamicsaxiso20022layout1.xlsx).-->
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
13. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок ISO20022.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **ISO20022**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **ISO20022**.
6.  Установите флажок **XML-файл**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  Выберите в поле **Формат выписки** формат, созданный ранее, например **ISO20022**.

## <a name="set-up-the-import-of-mt940-bank-statements"></a>Настройка импорта банковских выписок MT940
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок MT940 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **MT940**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **MT940TXT-to-MT940XML.xslt**, сохраненный ранее.
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **MT940XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования Finance and Operations создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!--- For details about the expected format for MT940, see [Dynamics AX MT940 Layout](./media/dynamicsaxmt940layout1.xlsx)-->
13. Нажмите **Создать**.
14. Для порядкового номера 3 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
15. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок MT940.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **MT940**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **MT940**.
6.  Задайте в поле **Тип файла** значение **TXT**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  При появлении запроса на подтверждение выбора и включение расширенной банковской выверки нажмите кнопку **OK**.
5.  Выберите в поле **Формат выписки** формат, созданный ранее, например **MT940**.

## <a name="set-up-the-import-of-bai2-bank-statements"></a>Настройка импорта банковских выписок BAI2
Во-первых, необходимо определить группу обработки формата банковской выписки для банковских выписок BAI2 с помощью структуры информационного объекта.

1.  Перейдите в раздел **Рабочие области** &gt; **Управление данными**.
2.  Нажмите кнопку **Импорт**.
3.  Введите имя формата, например **BAI2**.
4.  В поле **Формат исходных данных** установите значение **XML-элемент**.
5.  В поле **Имя объекта** установите значение **Банковские выписки**.
6.  Чтобы отправить файлы импорта, нажмите кнопку **Отправить** и перейдите к файлу **SampleBankCompositeEntity.xml**, сохраненному ранее.
7.  После отправки объекта банковских выписок и завершения сопоставления выберите действие **Просмотр карты** для объекта.
8.  Объект банковских выписок является составным объектом, состоящим из четырех отдельных объектов. В списке выберите **BankStatementDocumentEntity**, а затем нажмите кнопку **Просмотр карты**.
9.  На вкладке **Преобразования** щелкните **Создать**.
10. Для порядкового номера 1 щелкните **Отправить файл** и выберите файл **BAI2CSV-to-BAI2XML.xslt**, сохраненный ранее.
11. Нажмите **Создать**.
12. Для порядкового номера 2 щелкните **Отправить файл** и выберите файл **BAI2XML-Reconciliation.xslt**, сохраненный ранее. **Примечание.** Файлы преобразования Finance and Operations создаются для стандартного формата. Поскольку банки часто отклоняются от этого формата, может потребоваться обновить файл преобразования, чтобы он соответствовал формату банковской выписки. <!--- For details about the expected format for BAI2, see [Dynamics AX BAI2 Layout](./media/dynamicsaxbai2layout1.xlsx).-->
13. Нажмите **Создать**.
14. Для порядкового номера 3 щелкните **Отправить файл** и выберите файл **BankReconciliation-to-Composite.xslt**, сохраненный ранее.
15. Щелкните **Применить преобразования**.

После настройки группы обработки формата следующим шагом является определение правил формат банковской выписки для банковских выписок BAI2.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Настройка** &gt; **Настройка расширенной банковской выверки** &gt; **Формат банковской выписки**.
2.  Нажмите **Создать**.
3.  Укажите формат выписки, например **BAI2**.
4.  Вводится имя формата.
5.  Выберите в поле **Группа обработки** группу, определенную ранее, например **BAI2**.
6.  Задайте в поле **Тип файла** значение **TXT**.

Последним шагом является включение расширенной банковской выверки и задание формата выписки в банковском счете.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет и откройте его, чтобы просмотреть подробные сведения.
3.  На вкладке **Выверка** задайте для параметра **Расширенная банковская выверка** значение **Да**.
4.  При появлении запроса на подтверждение выбора и включение расширенной банковской выверки нажмите кнопку **OK**.
5.  Выберите в поле **Формат выписки** формат, созданный ранее, например **BAI2**.

## <a name="test-the-bank-statement-import"></a>Проверка импорта банковской выписки
Последним шагом является проверка импорта банковской выписки.

1.  Перейдите в раздел **Управление банком и кассовыми операциями** &gt; **Банковские счета**.
2.  Выберите банковский счет, для которого включена расширенная банковская выверка.
3.  На вкладке **Выверять** щелкните **Банковские выписки**.
4.  На странице **Банковская выписка** щелкните **Импортировать выписку**.
5.  В поле **Банковский счет** выберите банковский счет. Сведения в поле **Формат выписки** будут введены автоматически на основании параметров в банковском счете.
6.  Нажмите кнопку **Обзор** и выберите файл электронной банковской выписки.
7.  Щелкните **Загрузить**.
8.  Нажмите кнопку **OК**.

Если импорт прошел успешно, вы получите сообщение о том, что выписка была импортирована. Если импорт завершился ошибкой, в рабочей области **Управление данными** в разделе **Журнал заданий** найти задание. Щелкните **Сведения о выполнении** для задания, чтобы открыть страницу **Сводка по выполнению**, и щелкните **Просмотр журнала выполнения**, чтобы просмотреть ошибки импорта.



