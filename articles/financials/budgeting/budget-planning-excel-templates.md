---
title: "Шаблоны планирования бюджета для Excel"
description: "В этом разделе описывается, как создавать шаблоны Microsoft Excel, которые могут использоваться с бюджетными планами."
author: ryansandness
manager: AnnBe
ms.date: 01/12/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: BudgetPlanSetLayout
audience: Application User
ms.reviewer: shylaw
ms.search.scope: Core, Operations
ms.custom: 261794
ms.assetid: 1d8e99c1-b70d-41ba-991e-ab50b16797e0
ms.search.region: Global
ms.author: ryansand
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.translationtype: HT
ms.sourcegitcommit: a0739304723d19b910388893d08e8c36a1f49d13
ms.openlocfilehash: 156688b705337331e083ebc19fded57b028acb67
ms.contentlocale: ru-ru
ms.lasthandoff: 03/26/2018

---

# <a name="budget-planning-templates-for-excel"></a>Шаблоны планирования бюджета для Excel

[!include [banner](../includes/banner.md)]

В этом разделе описывается, как создавать шаблоны Microsoft Excel, которые могут использоваться с бюджетными планами.

В этом разделе показано, как создавать шаблоны Excel, которые будут использоваться с бюджетными планами, с помощью набора стандартных демонстрационных данных и именем пользователя Admin. Дополнительные сведения о планировании бюджета см. в разделе [Обзор планирования бюджета.](budget-planning-overview-configuration.md) Можно также ознакомиться с учебником [Планирование бюджета 101](budget-plan.md), чтобы изучить принципы настройки и использования базового модуля.

## <a name="generate-a-worksheet-using-budget-plan-document-layout"></a>Создайте книгу с помощью макета документа бюджетного плана

Документы бюджетного плана можно просматривать и редактировать, используя один или несколько макетов. Каждый макет может иметь связанный шаблон документа бюджетного плана для просмотра и редактирования данных бюджетного плана в электронной таблице Excel. В этом разделе шаблон документа бюджетного плана будут создаваться с использованием существующей конфигурации макета. 

1. Откройте **Список бюджетных планов** (**Бюджетирование** &gt; **Бюджетные планы**). 
2. Нажмите кнопку **Создать**, чтобы создать документ бюджетного плана. 

   [![Список бюджетных планов](./media/bpt11-1024x552.png)](./media/bpt11.png) 

3. Используйте параметр **Добавить** строку для добавления строк. Щелкните **Макеты** для просмотра конфигурации макет документа бюджетного плана. 

   [![Добавление бюджетных планов](./media/bpt2-1024x274.png)](./media/bpt2.png) 

Можно просмотреть конфигурацию макета и при необходимости изменить ее. 
1. Выберите **Шаблон** &gt; **Создать** для создания файла Excel для данного макета. 
2. После создания шаблона перейдите к пункту **Шаблон** &gt; **Вид**, чтобы открыть и просмотреть шаблон документа бюджетного плана. Можно сохранить файл Excel на локальном диске. 

[![Сохранить как](./media/bpt3-1024x545.png)](./media/bpt3.png)

> [!NOTE] 
> Макет документа бюджетного плана не может редактироваться после того, как с ним был связан шаблон Excel. Чтобы изменить макет, удалите связанный файл шаблона Microsoft Excel и создайте его заново. Это необходимо, чтобы сохранить синхронизацию полей в макете и на листе. 

Шаблон Excel будет содержать все элементы из макета документа бюджетного плана, где столбец **Доступно на листе** имеет значение True. Перекрытие элементов не допускается в шаблоне Excel. Например если формат содержит столбцы "Запрос Q1", "Запрос Q2", "Запрос Q3" и "Запрос Q4" и итоговый столбец запроса, представляющий общую сумму по всем 4 квартальным столбцам, только квартальные столбцы или итоговый столбец доступны для использования в шаблоне Excel. Файл Excel не может обновить пересекающиеся столбцы во время обновления, поскольку данные в таблице могут устареть и стать неточными.

[![Пример ](./media/bpt4-1024x615.png)](./media/bpt4.png)

> [!NOTE] 
> Чтобы избежать возможных проблем с просмотром и редактированием данных бюджетного плана с помощью Excel, один и тот же пользователь должен войти в Microsoft Dynamics 365 for Finance and Operations и Microsoft Dynamics Office Add-in Data Connector.

## <a name="add-a-header-to-budget-plan-document-template"></a>Добавление заголовка в шаблон документа бюджетного плана
Чтобы добавить сведения заголовка, выберите верхнюю строку в файле Excel и вставьте пустые строки. Щелкните **Дизайн** в **Соединитель данных** для добавления полей заголовка в файл Excel.

[![bpt5](./media/bpt5-1024x615.png)](./media/bpt5.png) 

На вкладке **Дизайн** щелкните поля **Добавить**, затем выберите **BudgetPlanHeader** в качестве источника данных сущности.

[![bpt6](./media/bpt6-1024x615.png)](./media/bpt6.png)

Наведите курсор на нужное место в файле Excel. Щелкните **Добавить метку**, чтобы добавить подпись поля в выбранном месте. Выберите **Добавить значение**, чтобы добавить в выбранное место значение поля. Для закрытия конструктора щелкните **Готово**.

## <a name="bpt7mediabpt7pngmediabpt7png"></a>[![bpt7](./media/bpt7.png)](./media/bpt7.png)

<a name="add-a-calculated-column-to-budget-plan-document-template-table"></a>Добавление рассчитанного столбца в таблицу шаблона документа бюджетного плана
--------------------------------------------------------------

Далее вычисляемые столбцы будут добавлены в созданный шаблон документа бюджетного плана. Столбец **Общий запрос**, в котором приводится сумма столбцов "Запрос Q1": "Запрос Q4", и столбец **Корректировка**, который пересчитывает столбец **Общий запрос**, умножая на заранее определенный множитель.

Щелкните **Дизайн** в **Соединитель данных** для добавления столбцов в таблицу. Щелкните **Изменить** рядом с источником данных **BudgetPlanWorksheet**, чтобы начать добавление столбцов.

[![bpt8](./media/bpt8-1024x301.png)](./media/bpt8.png) 

В выбранной группе полей отображаются столбцы, доступные в шаблоне. Нажмите кнопку **Формула**, чтобы добавить новый столбец. Задайте имя нового столбца, затем вставьте формулу в поле **Формула**. Щелкните **Обновить**, чтобы вставить столбец.

[![bpt12](./media/bpt12-1024x565.png)](./media/bpt12.png)

> [!NOTE] 
> Чтобы определить формулу, создайте формулу в электронной таблице и скопируйте ее в окно **Дизайн**. Связанная таблица Finance and Operations обычно называется "AXTable1". Например, чтобы просуммировать столбцы "Запрос Q1": "Запрос Q4" в электронной таблице, формула = AxTable1\[Запрос Q1\]+AxTable1\[Запрос Q2\]+AxTable1\[Запрос Q3\]+AxTable1\[Запрос Q4\].

Повторите эти шаги, чтобы вставить столбец **Корректировка**. Для этого столбца используйте формулу = AxTable1\[Общий запрос\]\*$I$1. Эта формула берет значение из ячейки "I1" и умножает значения в столбце **Общий запрос** для расчета величин корректировки.

Сохраните и закройте файл Excel. Вернитесь в Finance and Operations, затем в разделе **Макеты** щелкните **Шаблон &gt; Загрузить** для загрузки сохраненного шаблона Excel, который требуется использовать для бюджетного плана. 

[![bpt10](./media/bpt10-1024x352.png)](./media/bpt10.png) 

Закройте слайдер **Макеты**. В документе **Бюджетный план** нажмите **Лист** для просмотра и редактирования документа в Excel. Обратите внимание, что скорректированный шаблон Excel был использован для создания этого листа бюджетного плана, и вычисляемые столбцы обновляются с использованием формул, которые были определены на предыдущих шагах. 

[![bpt11](./media/bpt111-1024x431.png)](./media/bpt111.png)

## <a name="tips--tricks-for-creating-budget-plan-templates"></a>Советы и рекомендации по созданию шаблонов бюджетного плана
### <a name="can-i-add-and-use-additional-data-sources-to-a-budget-plan-template"></a>Можно ли добавлять и использовать дополнительные источники данных в шаблоне бюджетного плана?

Да, можно использовать меню **Дизайн**, чтобы добавить дополнительные сущности к тому же или другим листам в шаблоне Excel. Например, можно добавить источник данных **BudgetPlanProposedProject** для создания и одновременного ведения списка предложенных проектов при работе с данными бюджетного плана в Excel. Обратите внимание, что включение источников данных большого объема может повлиять на производительность книги Excel. 

Можно использовать параметр **Фильтр** в **Соединитель данных** для добавления нужных фильтров к дополнительным источникам данных.

### <a name="can-i-hide-the-design-option-in-the-data-connector-for-other-users"></a>Можно ли скрыть параметр "Дизайн" в соединителе данных для других пользователей?

Да, откройте параметры программы **Соединитель данных**, чтобы скрыть пункт **Дизайн** от других пользователей.

[![bpt13](./media/bpt13-1024x565.png)](./media/bpt13.png)

Разверните **Параметры соединителя данных** и снимите флажок **Включить дизайн**. Таким образом параметр **Дизайн** будет скрыт в программе **Соединитель данных**.

[![bpt14](./media/bpt14-1024x592.png)](./media/bpt14.png)

### <a name="can-i-prevent-users-from-accidently-closing-the-data-connector-while-working-with-data"></a>Можно ли исключить возможность случайного закрытия соединителя данных во время работы с данными?

Рекомендуется заблокировать шаблон, чтобы пользователи не могли закрыть его. Чтобы включить блокировку, щелкните **Соединитель данных** — в верхнем правом углу появится стрелка. 

[![bpt15](./media/bpt15-1024x285.png)](./media/bpt15.png) 

Щелкните стрелку для открытия дополнительного меню. Выберите **Блокировать**.

### <a name="bpt16mediabpt16-1024x614pngmediabpt16png"></a>[![bpt16](./media/bpt16-1024x614.png)](./media/bpt16.png)

### <a name="can-i-use-other-excel-features-like-cell-formatting-colors-conditional-formatting-and-charts-with-my-budget-plan-templates"></a>Можно ли использовать другие возможности Excel, такие как форматирование ячеек, цвета, условное форматирование и диаграммы с моими шаблонами бюджетного плана?

Да, большинство стандартных возможностей Excel будет работать в шаблонах бюджетного плана. Рекомендуется использовать цветовое кодирование для пользователей, чтобы различать столбцы только для чтения и столбцы, который можно изменять. Условное форматирование можно использовать для выделения проблемных областей бюджета. Итоги по столбцам можно легко представить с помощью стандартных формул Excel над таблицей.

Можно также создать и использовать сводные таблицы и диаграммы для дополнительного группирования и визуализации данных бюджета. На вкладке **Данные** в группе **Подключения** щелкните **Обновить все**, затем нажмите кнопку **Свойства подключения**. Перейдите на вкладку **Использование**. В разделе **Обновить** установите флажок **Обновлять данные при открытии файла**. 

[![bpt17](./media/bpt17-1024x614.png)](./media/bpt17.png)




