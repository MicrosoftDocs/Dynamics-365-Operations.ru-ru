---
title: Настройка финансовых отчетов в Excel (Россия)
description: В этом разделе приводится пошаговое описание процесса создания конфигурации электронной отчетности (ER), которая содержит шаблон для создания финансового отчета в формате Excel.
author: Anasyash
ms.date: 03/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.search.region: Russia
ms.author: anasyash
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.1
ms.openlocfilehash: 6181709837666fac72706064786313ac134c8d3c
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/02/2019
ms.locfileid: "1849306"
---
# <a name="configure-financial-reports-in-excel-russia"></a>Настройка финансовых отчетов в Excel (Россия)

[!include [banner](../includes/banner.md)]

В этом разделе поясняется, как пользователь с ролью "Системный администратор" или "Разработчик электронной отчетности" может создать новую конфигурацию электронной отчетности, содержащую шаблон для создания финансового отчета в формате Microsoft Excel.

Перед прочтением этой темы необходимо ознакомиться с разделом [Создание конфигураций электронной отчетности (ER)](../../dev-itpro/analytics/electronic-reporting-configuration.md?toc=/fin-and-ops/toc.json) и связанными разделами по электронной отчетности, посвященными созданию конфигурации.

## <a name="set-up-a-financial-report"></a>Настройка финансового отчета

Настройте финансовый отчет, чтобы он имел список ячеек финансового отчета и правил расчета ячеек в финансовых отчетах.

1. Отправьте настройки пакета управления данными. В этом примере отправьте настройки пакета управления данными **RU Accounting reporting 5.07 (2016).zip**, как описано в разделе [Учет отчетности в электронном формате](rus-accounting-reporting.md).
2. Выберите **Главная книга \> Настройка финансовых отчетов \> Финансовые отчеты**.
3. Выберите строку, которая имеет значение **Баланс** в столбце **Код отчета**.
4. Выберите **Настройка**.
5. На странице **Настройка реквизитов** настройте правила расчета для ячейки отчета, как описано в разделе [Финансовая отчетность (Россия)](rus-financial-reports.md#set-up-calculation-rules-for-report-cells).

## <a name="create-an-excel-template-for-the-financial-report"></a>Создание шаблона Excel для финансового отчета

Создание шаблона Excel для вашего финансового отчета. Как минимум необходимо назначить имена всем ячейкам Excel, которые должны иметь значения в отчете, который будет создан.

Например, загрузите [пример шаблона Excel для балансового отчета в России](https://mbs.microsoft.com/customersource/global/AX/learning/documentation/how-to-articles/BalancesheetRussia).

## <a name="create-an-er-configuration-for-the-financial-report-in-excel-format"></a>Создание конфигурации электронной отчетности для финансового отчета в формате Excel

Создайте формат конфигурации электронной отчетности, основанный на модели электронной отчетности **Модель финансовых отчетов**.

Перед выполнением этой процедуры см. раздел [Электронная отчетность — Разработка конфигурации для создания отчетов в формате OPENXML (ноябрь 2016 г.)](../../dev-itpro/analytics/tasks/er-design-reports-openxml-2016-11.md?toc=/fin-and-ops/toc.json) со сведениями о том, как настроить конфигурацию электронной отчетности, которая создает отчет в формате Excel.

1. Загрузите последнюю версию из перечисленных ниже конфигураций электронной отчетности:

    - Модель финансовых отчетов
    - Сопоставление моделей финансовых отчетов (RU)
    - Пример формата балансового отчета Excel (RU)

    Инструкции см. в разделе [Загрузка конфигураций электронной отчетности из Lifecycle Services](../../dev-itpro/analytics/download-electronic-reporting-configuration-lcs.md).

2. Перейдите в раздел **Рабочие области \> Электронная отчетность**.
3. Выберите плитку **Конфигурации отчетности**.
4. Создайте формат для финансового отчета в формате Excel:

    1. На странице **Конфигурации** выберите конфигурацию электронной отчетности **Модель финансовых отчетов**.
    2. В области действий выберите **Создать конфигурацию \> Формат на основе модели данных модели финансовых отчетов**.
    3. Введите имя.
    4. В поле **Тип формата** выберите **Excel**.
    5. В поле **Определение модели данных** введите **Финансовый отчет**.
    6. Выберите **Создать конфигурацию**.
    7. Выберите новую конфигурацию, затем на панели операций выберите **Конструктор**.
    8. На панели операций откройте вкладку **Импорт** и выберите **Импорт из Excel**.
    9. В диалоговом окне **Импорт из Excel** выберите **Добавить шаблон**, затем выберите файл Excel **Balance sheet.xls**.
    10. Задайте для параметра **Создать элемент формата листа Excel** значение **Да**.
    11. Нажмите **ОК**.
    12. Проверьте ячейки, которые создаются из имен в шаблоне Excel.

        ![Ячейки сопоставления формата](media/rus-format-designer-mapping.jpg)

    13. Закройте страницу.

5. Настройте формат электронной отчетности **Пример балансового отчета в формате Excel (RU)**:

    1. На странице **Конфигурации** выберите конфигурацию электронной отчетности **Пример балансового отчета в формате Excel (RU)**, затем в области действий выберите **Конструктор**.
    2. Разверните элемент формата **Excel = "Балансовый отчет"**, затем элемент формата **Лист\<стр.1_2\>**. Просмотрите все ячейки, которые будут содержать данные на выходе для финансового отчета.
    3. На вкладке **Сопоставление** просмотрите элементы **Модель финансовых отчетов**, которые являются источниками для ячеек финансового отчета.
    4. Проверьте ячейки от **ДД** до **PrevPrevYear** (**ДД**, **ММ**, **ГГГГ**, **Название компании** и так далее). Убедитесь в том, что они сопоставлены с элементами модели из группы **Заголовок**, которая содержит различные сведения об организации и отчете.

        > [!NOTE]
        > Если любая информация об организации в финансовом отчете не находится в области **Модель финансовых отчетов**, можно выполнить следующие действия:
        >
        > 1. Если отсутствующие данные являются внешними для Microsoft Dynamics 365 for Finance and Operations, создайте формат параметра пользовательского ввода.
        > 2. Создайте производную модель на основе модели **Модель финансовых отчетов** и добавьте новые элементы модели. Затем создайте сопоставление производной модели на основе **Сопоставление моделей финансовых отчетов** и свяжите новые элементы модели с источниками данных Finance and Operations.
        >
        > Дополнительные сведения о создании моделей данных электронной отчетности см. в разделе [Электронная отчетность — Разработка модели данных для конкретного домена](../../dev-itpro/analytics/tasks/er-design-domain-specific-data-model-2016-11.md?toc=/fin-and-ops/toc.json).
 
        Для получения дополнительных сведений о том, как сопоставить элементы модели данных с источниками данных, см. следующие разделы:

        - [Определение сопоставлений моделей электронной отчетности и выбор источников данных для них](../../dev-itpro/analytics/tasks/er-define-model-mapping-select-data-sources-2016-11.md?toc=/fin-and-ops/toc.json)
        - [Электронная отчетность Сопоставление модели данных с выбранными источникам данных](../../dev-itpro/analytics/tasks/er-map-data-model-selected-data-sources-2016-11.md?toc=/fin-and-ops/toc.json)

    5. Проверьте ячейки, в которые экспортируются значения финансового отчета. Например, ячейки **АктивВнеОбАНематАктПояснения**, **АктивВнеОбАНематАктСумОтч**, **АктивВнеОбАНематАктСумПрдщ**, and **АктивВнеОбАНематАктСумПрдшв** сопоставляются следующим расчетным полям: **Calculations.'\$Values'("\<Входной параметр = Имя ячейки\>").Value** или **Calculations.'\$Values'("\<Входной параметр = Код ячейки\>").Text**.

        Вычисляемое поле **Calculations.'\$Values'** содержит значение ячейки финансового отчета с кодом, равным значению "Входной параметр".

        Дополнительные сведения о модели финансовых отчетов см. в разделе [Настройка электронной отчетности для использования результатов расчетов финансового отчета](rus-financial-reports.md#configure-er-to-use-the-results-of-financial-report-calculations).

5. Свяжите рассчитанные значения ячеек финансового отчета с элементами ячеек формата электронной отчетности:

    1. Выберите ячейку формата электронной отчетности **АктивВнеОбАНематАктПояснения**, затем выберите **Удалить привязку**.
    2. Повторите предыдущий шаг для следующих трех ячеек формата электронной отчетности: **АктивВнеОбАНематАктСумОтч**, **АктивВнеОбАНематАктСумПрдщ** и **АктивВнеОбАНематАктСумПрдшв**.
    3. Для всех четырех ячеек формата электронной отчетности на вкладке **Формат** введите значение в поле **Имя**. Значение поля **Имя** должно быть равно значению поля **Код ячейки** в финансовом отчете. Для этого примера значение, введенное в поле **Имя**, должно быть равно значению поля **Диапазон Excel**: **АктивВнеОбАНематАктСумОтч**, **АктивВнеОбАНематАктСумПрдщ** или **АктивВнеОбАНематАктСумПрдшв**.

        ![Имя поля сопоставления формата](media/rus-format-designer-format.jpg)

    4. На вкладке **Сопоставление** разверните контейнер **Вычисления**, разверните вычисляемое поле **\$Значения** и выберите элемент **Текст**.
    5. В списке ячеек формата Excel выберите ячейку **АктивВнеОбАНематАктПояснения**, затем выберите **Привязать**.

        ![Текстовая строка сопоставления формата](media/rus-format-designer-mapping-text-string.jpg)

    6. На вкладке **Сопоставление** выберите элемент **Значение**.
    7. В списке ячеек формата Excel выберите ячейку **АктивВнеОбАНематАктСумОтч**, затем выберите **Привязать**.
    8. Повторите два предыдущих шага для двух других ячеек Excel, для которых ранее была отменена привязка.

## <a name="run-the-financial-report-format"></a>Выполнение формат финансового отчета

Можно настроить функцию электронных сообщений для выполнения любой конфигурации электронной отчетности. Дополнительные сведения см. в разделе [Настройка электронных сообщений для создания финансового отчета и сохранения результатов](rus-financial-reports.md#configure-electronic-messages-to-generate-the-financial-report-and-store-the-results).

Для запуска формата электронной отчетности, который основан на модели **Модель финансовых отчетов**, выполните следующие действия.

1. Выберите **Главная книга \> Запросы и отчеты \> Финансовые отчеты (Россия)**.
2. В диалоговом окне **Финансовые отчеты (Россия)** в поле **Сопоставление формата** выберите формат электронной отчетности, который должен запускаться. Например, выберите **Пример формата балансового отчета Excel (RU)**.
3. Нажмите **ОК**.
4. В диалоговом окне **Параметры электронного отчета** определите параметры отчета.

    | Поле                                                            | Описание |
    |------------------------------------------------------------------|-------------|
    | Имя подписавшего, отчество подписавшего, фамилия подписавшего | Введите полное имя подписавшего. |
    | До даты                                                          | Введите базовую дату финансового отчета. |
    | Дата утверждения                                                    | Введите дату утверждения финансового отчета. |
    | Дата отчета                                                   | Введите дату отчетности для корректирующего отчета. |
    | ОКВЭД                                      | Введите код типа хозяйственной деятельности ("ОКВЭД"). |
    | Код формы организации                                         | Введите код организационной формы ("ОКОПФ"). |
    | Код формы собственности                                              | Введите код формы собственности ("ОКФС"). |
    | Отчет                                                           | Выберите финансовый отчет, который должен быть рассчитан. В этом примере выберите **Баланс**. |

5. Нажмите **ОК**.
6. Просмотрите созданный отчет Excel.
